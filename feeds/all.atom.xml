<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>My Note Book</title><link href="http://liugehao.github.io/" rel="alternate"></link><link href="http://liugehao.github.io/feeds/all.atom.xml" rel="self"></link><id>http://liugehao.github.io/</id><updated>2013-12-24T00:00:00+01:00</updated><entry><title>linux/solr 4.6 和tomcat 8的安装</title><link href="http://liugehao.github.io/linuxsolr-46-he-tomcat-8de-an-zhuang.html" rel="alternate"></link><updated>2013-12-24T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-12-24:linuxsolr-46-he-tomcat-8de-an-zhuang.html</id><summary type="html">&lt;p&gt;=== tomcat ===
配置好jdk,解压tomcat,执行bin/startup.sh 启动&lt;/p&gt;
&lt;p&gt;=== solr安装 ===&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;将 dist 下的solr.war 放到tomcat的webapps下。&lt;/li&gt;
&lt;li&gt;启动tomcat 此时报错，solr.war 解压 关闭tomcat 删除solr.war&lt;/li&gt;
&lt;li&gt;得到solr 目录&lt;/li&gt;
&lt;li&gt;配置solr_home  :将下载的solr包中解压的example/solr 文件夹copy到 /opt/solr(路径可以任意修改)。&lt;/li&gt;
&lt;li&gt;修改tomcat/webapps/solr/WEB-INFO/web.xml
   {{{
    &lt;env-entry&gt;
       &lt;env-entry-name&gt;solr/home&lt;/env-entry-name&gt;
       &lt;env-entry-value&gt;/opt/solr&lt;/env-entry-value&gt;
       &lt;env-entry-type&gt;java.lang.String&lt;/env-entry-type&gt;
    &lt;/env-entry&gt;
   }}}&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;或者/root/tomcat/conf/Catalina/localhost目录下建立solr文件
   {{{
    &amp;lt;?xml version="1.0" encoding="UTF-8"?&amp;gt;
      &lt;Context docBase="/root/tomcat/webapps/solr" &gt; 
      &lt;Environment name="solr/home" type="java.lang.String" value="/opt/solr" override="true" /&gt;
    &lt;/Context&gt;
   }}}
 1. copy 下载包中的 example\lib\ext 下的jar包全部放到tomcat根目录下 的lib目录下
 1. 启动tomcat&lt;/p&gt;
&lt;p&gt;=== 安装分词 ===
{{{
wget https://mmseg4j.googlecode.com/files/mmseg4j-1.9.1.zip -O mmseg4j
cp mmseg4j/dist/* /root/tomcat/webapps/solr/WEB-INFO/lib&lt;/p&gt;
&lt;p&gt;}}}
vi /opt/solr/collection1/conf/schema.xml
add this lines to "fields" and "fieldtypes"
{{{
&lt;field name="simple" type="textSimple" indexed="true" stored="true" multiValued="true" /&gt;
  &lt;field name="complex" type="textComplex" indexed="true" stored="true" multiValued="true" /&gt;
  &lt;field name="max" type="textMaxWord" indexed="true" stored="true" multiValued="true" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;fieldtype name="textComplex" class="solr.TextField" positionIncrementGap="100"&gt;
        &lt;analyzer&gt;
            &lt;tokenizer class="com.chenlb.mmseg4j.solr.MMSegTokenizerFactory" mode="complex" dicPath="dic"&gt;&lt;/tokenizer&gt;
        &lt;/analyzer&gt;
    &lt;/fieldtype&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;fieldtype&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;textMaxWord&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;solr.TextField&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;positionIncrementGap=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;100&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;analyzer&amp;gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;tokenizer&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;com.chenlb.mmseg4j.solr.MMSegTokenizerFactory&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;mode=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;max-word&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;dicPath=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;dic&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/tokenizer&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;/analyzer&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/fieldtype&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;fieldtype&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;textSimple&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;solr.TextField&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;positionIncrementGap=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;100&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;analyzer&amp;gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;tokenizer&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;com.chenlb.mmseg4j.solr.MMSegTokenizerFactory&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;mode=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;simple&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;dicPath=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;dic&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/tokenizer&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;/analyzer&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/fieldtype&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}}}
open url "http://172.16.147.141:8080/solr/#/collection1/analysis" on Brower&lt;/p&gt;
&lt;p&gt;error:
{{{
TokenStream contract violation: reset()/close() call missing, reset() called multiple times, or subclass does not call super.reset(). Please see Javadocs of TokenStream class for more information about the correct consuming workflow.
}}}
solution:
{{{
find ./ -name MMSegTokenizer.java&lt;/p&gt;
&lt;p&gt;public void reset() throws IOException {
        //lucene 4.0
        //org.apache.lucene.analysis.Tokenizer.setReader(Reader)
        //setReader 自动被调用, input 自动被设置。
        super.reset();   //加这一句
        mmSeg.reset(input);
    }&lt;/p&gt;
&lt;p&gt;重新打包
mvn package 
root@debian:~/mmseg4j-1.9.1/mmseg4j-analysis/target# cp mmseg4j-analysis-1.9.2-SNAPSHOT.jar ~/tomcat/webapps/solr/WEB-INF/lib/mmseg4j-analysis-1.9.1.jar
}}}&lt;/p&gt;
&lt;p&gt;restart tomcat
open url "http://172.16.147.141:8080/solr/#/collection1/analysis" on Brower&lt;/p&gt;</summary></entry><entry><title>rehl5安装jdk</title><link href="http://liugehao.github.io/rehl5an-zhuang-jdk.html" rel="alternate"></link><updated>2013-12-24T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-12-24:rehl5an-zhuang-jdk.html</id><summary type="html">&lt;p&gt;{{{
解压jdk.tar.gz到任意目录&lt;/p&gt;
&lt;p&gt;/etc/profile文件   -- 全部用户有效&lt;/p&gt;
&lt;p&gt;在profile 文件的尾部面加入&lt;/p&gt;
&lt;p&gt;JAVA_HOME=/usr/java/jdk1.5.0_16  -- jdk 的安装路径
PATH=$JAVA_HOME/bin:$PATH
CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar &lt;/p&gt;
&lt;p&gt;export JAVA_HOME
export PATH
export CLASSPATH
export CATALINA_HOME    &lt;/p&gt;
&lt;p&gt;保存 退出
在shell输入 source /etc/profile 
}}}&lt;/p&gt;
&lt;p&gt;set default jdk for debin
{{{&lt;/p&gt;
&lt;p&gt;sudo update-alternatives --install /usr/bin/java java /usr/lib/jvm/java-7-sun/bin/java 300&lt;br /&gt;
sudo update-alternatives --install /usr/bin/javac javac /usr/lib/jvm/java-7-sun/bin/javac 300&lt;br /&gt;
sudo update-alternatives --install /usr/bin/jar jar /usr/lib/jvm/java-7-sun/bin/jar 300 &lt;br /&gt;
sudo update-alternatives --install /usr/bin/javah javah /usr/lib/jvm/java-7-sun/bin/javah 300 &lt;br /&gt;
sudo update-alternatives --install /usr/bin/javap javap /usr/lib/jvm/java-7-sun/bin/javap 300   &lt;/p&gt;
&lt;p&gt;sudo update-alternatives --config java&lt;br /&gt;
}}}&lt;/p&gt;</summary></entry><entry><title>在这里详述 db/mysql load file outfile。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-dbmysql-load-file-outfile.html" rel="alternate"></link><updated>2013-12-04T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-12-04:zai-zhe-li-xiang-shu-dbmysql-load-file-outfile.html</id><summary type="html">&lt;p&gt;{{{
LOAD DATA INFILE 'data.txt' INTO TABLE tbl_name
  FIELDS TERMINATED BY ',' ENCLOSED BY '"'
  LINES TERMINATED BY '\r\n'
  IGNORE 1 LINES;&lt;/p&gt;
&lt;p&gt;select * from driver into outfile "a.txt" fields terminated by ',' enclosed by '"'; 
}}}&lt;/p&gt;</summary></entry><entry><title>在这里详述 linux/hadoop python</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-linuxhadoop-python.html" rel="alternate"></link><updated>2013-11-28T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-11-28:zai-zhe-li-xiang-shu-linuxhadoop-python.html</id><summary type="html">&lt;p&gt;http://www.oschina.net/translate/a-guide-to-python-frameworks-for-hadoop&lt;/p&gt;
&lt;p&gt;python连接hadoop方式
 1. Hadoop流
 1. mrjob
 1. dumbo
 1. hadoopy
 1. pydoop
 1. 其它&lt;/p&gt;
&lt;p&gt;=== hadoop流：===&lt;/p&gt;
&lt;p&gt;在http://books.google.com/ngrams取得数据, 在hdfs上建立/ngrams 目录，CSV上传到/ngrams目录。&lt;/p&gt;
&lt;p&gt;mapper.py
{{{#!highlight python&lt;/p&gt;
&lt;h1&gt;! /usr/bin/env python&lt;/h1&gt;
&lt;p&gt;import os
import re
import sys&lt;/p&gt;
&lt;h1&gt;determine value of n in the current block of ngrams by parsing the filename&lt;/h1&gt;
&lt;p&gt;input_file = os.environ['map_input_file']
expected_tokens = int(re.findall(r'([\d]+)gram', os.path.basename(input_file))[0])&lt;/p&gt;
&lt;p&gt;for line in sys.stdin:
    data = line.split('\t')&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;# perform some error checking&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;continue&lt;/span&gt;

&lt;span class="cp"&gt;# unpack data&lt;/span&gt;
&lt;span class="n"&gt;ngram&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;year&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="cp"&gt;# more error checking&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ngram&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;expected_tokens&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;continue&lt;/span&gt;

&lt;span class="cp"&gt;# build key and emit&lt;/span&gt;
&lt;span class="n"&gt;pair&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;ngram&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ngram&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;expected_tokens&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;span class="n"&gt;print&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;%s&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s"&gt;%s&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s"&gt;%s&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s"&gt;%s&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pair&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;pair&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;reducer.py
{{{#!highlight python&lt;/p&gt;
&lt;h1&gt;! /usr/bin/env python&lt;/h1&gt;
&lt;p&gt;import sys&lt;/p&gt;
&lt;p&gt;total = 0
prev_key = False
for line in sys.stdin:
    data = line.split('\t')
    curr_key = '\t'.join(data[:3])
    count = int(data[3])&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;# found a boundary; emit current sum&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;prev_key&lt;/span&gt; &lt;span class="n"&gt;and&lt;/span&gt; &lt;span class="n"&gt;curr_key&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;prev_key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;print&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;%s&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s"&gt;%i&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prev_key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;total&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;prev_key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;curr_key&lt;/span&gt;
    &lt;span class="n"&gt;total&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;count&lt;/span&gt;
&lt;span class="cp"&gt;# same key; accumulate sum&lt;/span&gt;
&lt;span class="nl"&gt;else:&lt;/span&gt;
    &lt;span class="n"&gt;prev_key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;curr_key&lt;/span&gt;
    &lt;span class="n"&gt;total&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;count&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;emit last key&lt;/h1&gt;
&lt;p&gt;if prev_key:
    print &amp;gt;&amp;gt;sys.stdout, "%s\t%i" % (prev_key, total)
}}}&lt;/p&gt;
&lt;p&gt;exec:
{{{
../hadoop64/bin/hadoop jar ../hadoop64/share/hadoop/tools/lib/hadoop-streaming-2.2.0.jar -input /ngrams  -output /output-streaming  -mapper mapper.py  -combiner reducer.py  -reducer reducer.py  -jobconf stream.num.map.output.key.fields=3   -jobconf stream.num.reduce.output.key.fields=3   -jobconf mapred.reduce.tasks=10  -file mapper.py   -file reducer.py
}}}&lt;/p&gt;</summary></entry><entry><title>== 在这里详述 linux/hadoop x64 编译。==</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-linuxhadoop-x64-bian-yi.html" rel="alternate"></link><updated>2013-11-28T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-11-28:zai-zhe-li-xiang-shu-linuxhadoop-x64-bian-yi.html</id><summary type="html">&lt;p&gt;{{{
参考：http://blog.csdn.net/bamuta/article/details/13506893
apt-get install autoconf automake libtool cmake
apt-get install libncurses5-dev
apt-get install libssl-dev&lt;/p&gt;
&lt;p&gt;安装maven
下载，并解压
http://maven.apache.org/download.cgi 
[root@hadoop01 stable]# mvapache-maven-3.1.1 /usr/local/
将/usr/local/apache-maven-3.1.1/bin加到环境变量中&lt;/p&gt;
&lt;p&gt;apt-get install libprotobuf-dev&lt;/p&gt;
&lt;p&gt;mvn package -Pdist,native -DskipTests -Dtar
}}}&lt;/p&gt;
&lt;p&gt;ubuntu :
http://blog.changecong.com/2013/10/ubuntu-%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85-hadoop-2-2-0/
{{{
apt-get install g++ autoconf automake libtool cmake zlib1g-dev pkg-config libssl-dev
下载最新的protobuf： https://code.google.com/p/protobuf/downloads/list
解压，依次运行
$ ./configure --prefix=/usr
$ sudo make
$ sudo make check
$ sudo make install
apt-get install maven
最新的2.2.0 的Source Code 压缩包解压出来的code有个bug 需要patch后才能编译。否则编译hadoop-auth 会提示下面错误：
https://issues.apache.org/jira/browse/HADOOP-10110
patch -p0 &amp;lt; HADOOP-10110.patch 
编译hadoop:
mvn package -Pdist,native -DskipTests -Dtar
}}}&lt;/p&gt;
&lt;p&gt;最新的2.2.0 的Source Code 压缩包解压出来的code有个bug 需要patch后才能编译。否则编译hadoop-auth 会提示下面错误：
{{{
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.5.1:testCompile (default-testCompile) on project hadoop-auth: Compilation failure: Compilation failure:
[ERROR] /home/chuan/trunk/hadoop-common-project/hadoop-auth/src/test/java/org/apache/hadoop/security/authentication/client/AuthenticatorTestCase.java:[84,13] cannot access org.mortbay.component.AbstractLifeCycle
[ERROR] class file for org.mortbay.component.AbstractLifeCycle not found
}}}
Patch :https://issues.apache.org/jira/browse/HADOOP-10110&lt;/p&gt;</summary></entry><entry><title>在这里详述 db/Postgresql 正则表达式</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-dbpostgresql-zheng-ze-biao-da-shi.html" rel="alternate"></link><updated>2013-11-21T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-11-21:zai-zhe-li-xiang-shu-dbpostgresql-zheng-ze-biao-da-shi.html</id><summary type="html">&lt;p&gt;在postgresql中使用正则表达式时需要使用关键字“~”，以表示该关键字之前的内容需匹配之后的正则表达式，若匹配规则不需要区分大小写，可以使用组合关键字“~*”；&lt;/p&gt;
&lt;p&gt;相反，若需要查询不匹配这则表达式的记录，只需在该关键字前加否定关键字“！”即可。若正则表达式包含转义字符，则需在表达式前加关键字“E”。
例如：&lt;/p&gt;
&lt;p&gt;{{{
select * from user where email ~ '^[A-H]' --匹配email地址以A-H开头的记录&lt;br /&gt;
select * from user where email ~* '^[a-h]' --匹配email地址以A-H和a-h开头的记录&lt;br /&gt;
}}}&lt;/p&gt;
&lt;p&gt;至于正则表达式的匹配公式是通用的，可以参照下表。&lt;/p&gt;
&lt;p&gt;{{{
字符  描述
\   将下一个字符标记为一个特殊字符、或一个原义字符、或一个 后向引用、或一个八进制转义符。例如，'n' 匹配字符 "n"。'\n' 匹配一个换行符。序列 '\' 匹配 "\" 而 "(" 则匹配 "("。
^   匹配输入字符串的开始位置。如果设置了 RegExp 对象的 Multiline 属性，^ 也匹配 '\n' 或 '\r' 之后的位置。
$   匹配输入字符串的结束位置。如果设置了RegExp 对象的 Multiline 属性，$ 也匹配 '\n' 或 '\r' 之前的位置。
&lt;em&gt;   匹配前面的子表达式零次或多次。例如，zo&lt;/em&gt; 能匹配 "z" 以及 "zoo"。 * 等价于{0,}。
+   匹配前面的子表达式一次或多次。例如，'zo+' 能匹配 "zo" 以及 "zoo"，但不能匹配 "z"。+ 等价于 {1,}。
?   匹配前面的子表达式零次或一次。例如，"do(es)?" 可以匹配 "do" 或 "does" 中的"do" 。? 等价于 {0,1}。
{n} n 是一个非负整数。匹配确定的 n 次。例如，'o{2}' 不能匹配 "Bob" 中的 'o'，但是能匹配 "food" 中的两个 o。
{n,}    n 是一个非负整数。至少匹配n 次。例如，'o{2,}' 不能匹配 "Bob" 中的 'o'，但能匹配 "foooood" 中的所有 o。'o{1,}' 等价于 'o+'。'o{0,}' 则等价于 'o&lt;em&gt;'。
{n,m}   m 和 n 均为非负整数，其中n &amp;lt;= m。最少匹配 n 次且最多匹配 m 次。刘， "o{1,3}" 将匹配 "fooooood" 中的前三个 o。'o{0,1}' 等价于 'o?'。请注意在逗号和两个数之间不能有空格。
?   当该字符紧跟在任何一个其他限制符 (&lt;/em&gt;, +, ?, {n}, {n,}, {n,m}) 后面时，匹配模式是非贪婪的。非贪婪模式尽可能少的匹配所搜索的字符串，而默认的贪婪模式则尽可能多的匹配所搜索的字符串。例如，对于字符串 "oooo"，'o+?' 将匹配单个 "o"，而 'o+' 将匹配所有 'o'。
.   匹配除 "\n" 之外的任何单个字符。要匹配包括 '\n' 在内的任何字符，请使用象 '[.\n]' 的模式。
(pattern)   匹配pattern 并获取这一匹配。所获取的匹配可以从产生的 Matches 集合得到，在VBScript 中使用 SubMatches 集合，在Visual Basic Scripting Edition 中则使用 $0…$9 属性。要匹配圆括号字符，请使用 '(' 或 ')'。
(?:pattern) 匹配 pattern 但不获取匹配结果，也就是说这是一个非获取匹配，不进行存储供以后使用。这在使用 "或" 字符 (|) 来组合一个模式的各个部分是很有用。例如， 'industr(?:y|ies) 就是一个比 'industry|industries' 更简略的表达式。
(?=pattern) 正向预查，在任何匹配 pattern 的字符串开始处匹配查找字符串。这是一个非获取匹配，也就是说，该匹配不需要获取供以后使用。例如， 'Windows (?=95|98|NT|2000)' 能匹配 "Windows 2000" 中的 "Windows" ，但不能匹配 "Windows 3.1" 中的 "Windows"。预查不消耗字符，也就是说，在一个匹配发生后，在最后一次匹配之后立即开始下一次匹配的搜索，而不是从包含预查的字符之后开始。
(?!pattern) 负向预查，在任何不匹配Negative lookahead matches the search string at any point where a string not matching pattern 的字符串开始处匹配查找字符串。这是一个非获取匹配，也就是说，该匹配不需要获取供以后使用。例如'Windows (?!95|98|NT|2000)' 能匹配 "Windows 3.1" 中的 "Windows"，但不能匹配 "Windows 2000" 中的 "Windows"。预查不消耗字符，也就是说，在一个匹配发生后，在最后一次匹配之后立即开始下一次匹配的搜索，而不是从包含预查的字符之后开始
x|y 匹配 x 或 y。例如，'z|food' 能匹配 "z" 或 "food"。'(z|f)ood' 则匹配 "zood" 或 "food"。
[xyz]   字符集合。匹配所包含的任意一个字符。例如， '[abc]' 可以匹配 "plain" 中的 'a'。
[^xyz]  负值字符集合。匹配未包含的任意字符。例如， '[^abc]' 可以匹配 "plain" 中的'p'。
[a-z]   字符范围。匹配指定范围内的任意字符。例如，'[a-z]' 可以匹配 'a' 到 'z' 范围内的任意小写字母字符。
[^a-z]  负值字符范围。匹配任何不在指定范围内的任意字符。例如，'[^a-z]' 可以匹配任何不在 'a' 到 'z' 范围内的任意字符。
\b  匹配一个单词边界，也就是指单词和空格间的位置。例如， 'er\b' 可以匹配"never" 中的 'er'，但不能匹配 "verb" 中的 'er'。
\B  匹配非单词边界。'er\B' 能匹配 "verb" 中的 'er'，但不能匹配 "never" 中的 'er'。
\cx 匹配由x指明的控制字符。例如， \cM 匹配一个 Control-M 或回车符。 x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 'c' 字符。
\d  匹配一个数字字符。等价于 [0-9]。
\D  匹配一个非数字字符。等价于 [^0-9]。
\f  匹配一个换页符。等价于 \x0c 和 \cL。
\n  匹配一个换行符。等价于 \x0a 和 \cJ。
\r  匹配一个回车符。等价于 \x0d 和 \cM。
\s  匹配任何空白字符，包括空格、制表符、换页符等等。等价于 [ \f\n\r\t\v]。
\S  匹配任何非空白字符。等价于 [^ \f\n\r\t\v]。
\t  匹配一个制表符。等价于 \x09 和 \cI。
\v  匹配一个垂直制表符。等价于 \x0b 和 \cK。
\w  匹配包括下划线的任何单词字符。等价于'[A-Za-z0-9_]'。
\W  匹配任何非单词字符。等价于 '[^A-Za-z0-9_]'。
\xn 匹配 n，其中 n 为十六进制转义值。十六进制转义值必须为确定的两个数字长。例如， '\x41' 匹配 "A"。'\x041' 则等价于 '\x04' &amp;amp; "1"。正则表达式中可以使用 ASCII 编码。.
\num    匹配 num，其中 num 是一个正整数。对所获取的匹配的引用。例如，'(.)\1' 匹配两个连续的相同字符。
\n  标识一个八进制转义值或一个后向引用。如果 \n 之前至少 n 个获取的子表达式，则 n 为后向引用。否则，如果 n 为八进制数字 (0-7)，则 n 为一个八进制转义值。
\nm 标识一个八进制转义值或一个后向引用。如果 \nm 之前至少有is preceded by at least nm 个获取得子表达式，则 nm 为后向引用。如果 \nm 之前至少有 n 个获取，则 n 为一个后跟文字 m 的后向引用。如果前面的条件都不满足，若  n 和 m 均为八进制数字 (0-7)，则 \nm 将匹配八进制转义值 nm。
\nml    如果 n 为八进制数字 (0-3)，且 m 和 l 均为八进制数字 (0-7)，则匹配八进制转义值 nml。
\un 匹配 n，其中 n 是一个用四个十六进制数字表示的 Unicode 字符。例如， \u00A9 匹配版权符号 (?)。
}}}&lt;/p&gt;</summary></entry><entry><title>在这里详述 python/import data to postgresql from mysql。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-pythonimport-data-to-postgresql-from-mysql.html" rel="alternate"></link><updated>2013-11-07T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-11-07:zai-zhe-li-xiang-shu-pythonimport-data-to-postgresql-from-mysql.html</id><summary type="html">&lt;p&gt;{{{#!highlight python&lt;/p&gt;
&lt;h1&gt;!/usr/bin/env python&lt;/h1&gt;
&lt;h1&gt;coding=utf-8&lt;/h1&gt;
&lt;p&gt;import MySQLdb, psycopg2
import sys&lt;/p&gt;
&lt;h1&gt;psycopg2.paramstyle='qmark' #psycopg2.paramstyle 失效 ，全用%s&lt;/h1&gt;
&lt;p&gt;pconn = psycopg2.connect(host='172.16.147.133', user='postgres', password='l', database='address')
pc = pconn.cursor()&lt;/p&gt;
&lt;p&gt;def insert(row, table):
    lens = len(row)
    str = "insert into %s values (%s);" % (table, (', %s' * lens)[1:] )
    try:
        pc.execute(str, row)
    except:
        pass&lt;/p&gt;
&lt;p&gt;if &lt;strong&gt;name&lt;/strong&gt; == "&lt;strong&gt;main&lt;/strong&gt;":
    table = sys.argv[1]
    mconn = MySQLdb.connect(charset = 'gbk', host="192.168.1.16", user='caiwu', passwd='cai_xxxx', db='exp_address')
    mc = mconn.cursor()
    mc.arraysize = 10000
    mc.execute("select * from %s" % table)
    while 1:
        rows = mc.fetchmany()
        if not len(row):
            break
        for row in rows:
            insert(row, table)
    pconn.commit()
}}}&lt;/p&gt;</summary></entry><entry><title>在这里详述 linux/Debian 7解决中文乱码。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-linuxdebian-7jie-jue-zhong-wen-luan-ma.html" rel="alternate"></link><updated>2013-11-06T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-11-06:zai-zhe-li-xiang-shu-linuxdebian-7jie-jue-zhong-wen-luan-ma.html</id><summary type="html">&lt;p&gt;DEBIAN下中文显示&lt;/p&gt;
&lt;p&gt;一.首先检查LOCALE情况&lt;/p&gt;
&lt;p&gt;说明：DEBIAN因为基于GNU所以，对不同地域进行了不同的包支持，以LOCALE形式存在。&lt;/p&gt;
&lt;p&gt;1.挂载ISO文件包，前8个ISO包就可以（这里不在讲述）。&lt;/p&gt;
&lt;p&gt;2.启动终端&lt;/p&gt;
&lt;h1&gt;apt-get install locales&lt;/h1&gt;
&lt;p&gt;3.重新配置LOCALE&lt;/p&gt;
&lt;h1&gt;dpkg-reconfigure locales&lt;/h1&gt;
&lt;p&gt;在所有的语言包选择en_US.ISO-8859-1和zh_CN.GBK。其他en_US和zh_CN打头的也选上。然后选择zh_CN.GBK为默认的LOCALE，则系统为中文界面（这里也可以选en_US.ISO，使系统为英文界面）。&lt;/p&gt;
&lt;p&gt;3.运行LOCALE命令检查当前的LOCALE环境&lt;/p&gt;
&lt;h1&gt;locale&lt;/h1&gt;
&lt;p&gt;正确配置下会显式&lt;/p&gt;
&lt;p&gt;LANG =zh_CN.GBK&lt;/p&gt;
&lt;p&gt;........................以下显示略过&lt;/p&gt;
&lt;p&gt;ibus 没有输入窗口 错误 dpkg-reconfigure locales 选择zh-cn.UTF-8也可解决。&lt;/p&gt;</summary></entry><entry><title>Describe linux/no such file to load -- mkmf (LoadError) here.</title><link href="http://liugehao.github.io/describe-linuxno-such-file-to-load-mkmf-loaderror-here.html" rel="alternate"></link><updated>2013-11-05T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-11-05:describe-linuxno-such-file-to-load-mkmf-loaderror-here.html</id><summary type="html">&lt;p&gt;/usr/bin/ruby1.8 extconf.rb
extconf.rb:1:in `require': no such file to load -- mkmf (LoadError)
 from extconf.rb:1&lt;/p&gt;
&lt;p&gt;sudo apt-get install build-essential libopenssl-ruby ruby1.8-dev&lt;/p&gt;
&lt;p&gt;debian 7:
sudo apt-get install build-essential libopenssl-ruby ruby-dev&lt;/p&gt;</summary></entry><entry><title>在这里详述 php/php javascript rc4 base64 兼容</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-phpphp-javascript-rc4-base64-jian-rong.html" rel="alternate"></link><updated>2013-11-05T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-11-05:zai-zhe-li-xiang-shu-phpphp-javascript-rc4-base64-jian-rong.html</id><summary type="html">&lt;p&gt;php的处理方法默认按字节处理RC4，javascript默认是按UTF-8处理。 &lt;/p&gt;
&lt;p&gt;javascript的base64为了和PHP兼容，也可更改字符集。&lt;/p&gt;
&lt;p&gt;附代码文件&lt;/p&gt;
&lt;p&gt;https://github.com/cotdp/php-rc4&lt;/p&gt;
&lt;p&gt;[[attachment:index.php]]&lt;/p&gt;
&lt;p&gt;[[attachment:rc4.php]]&lt;/p&gt;</summary></entry><entry><title>python webkit scrapy</title><link href="http://liugehao.github.io/python-webkit-scrapy.html" rel="alternate"></link><updated>2013-11-01T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-11-01:python-webkit-scrapy.html</id><summary type="html">&lt;p&gt;ubuntu apt-get 安装pythonwebkit,jswebkit
{{{
apt-get install python-webkit jswebkit
}}}
debian
{{{
apt-get install python-jswebkit python-webkit
}}}
在scrapy的settings.py中加入：
{{{#!highlight python&lt;/p&gt;
&lt;h1&gt;which spider should use WEBKIT&lt;/h1&gt;
&lt;p&gt;WEBKIT_DOWNLOADER=['jxydt']
DOWNLOADER_MIDDLEWARES = {
'jx.dowloader.WebkitDownloader': 543,
}&lt;/p&gt;
&lt;p&gt;import os
os.environ["DISPLAY"] = ":0"
}}}
dowloader.py
{{{#!highlight python&lt;/p&gt;
&lt;h1&gt;!/usr/bin/env python&lt;/h1&gt;
&lt;h1&gt;-&lt;em&gt;- coding: utf-8 -&lt;/em&gt;-&lt;/h1&gt;
&lt;p&gt;from scrapy.http import Request, FormRequest, HtmlResponse&lt;/p&gt;
&lt;p&gt;import gtk
import webkit
import jswebkit
import settings&lt;/p&gt;
&lt;p&gt;class WebkitDownloader( object ):
    def process_request( self, request, spider ):
        if spider.name in settings.WEBKIT_DOWNLOADER:
            if( type(request) is not FormRequest ):
                webview = webkit.WebView()
                webview.connect( 'load-finished', lambda v,f: gtk.main_quit() )
                webview.load_uri( request.url )
                gtk.main()
                webview.execute_script("ShowMeResult();")
                js = jswebkit.JSContext( webview.get_main_frame().get_global_context() )
                renderedBody = str( js.EvaluateScript( 'document.body.innerHTML' ) )
                #print renderedBody
                return HtmlResponse( request.url, body=renderedBody )
}}}
爬虫
{{{#!highlight python
from scrapy.selector import HtmlXPathSelector
from scrapy.contrib.linkextractors.sgml import SgmlLinkExtractor
from scrapy.contrib.spiders import CrawlSpider, Rule
from jx.items import JxItem&lt;/p&gt;
&lt;p&gt;class JxydtSpider(CrawlSpider):
    name = 'jxydt'
    allowed_domains = ['jxydt.net.cn']
    start_urls = ['http://www.jxydt.net.cn/']&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;rules&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;Rule&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SgmlLinkExtractor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;allow&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Itemssdafdsfa1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;parse_item&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;follow&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;False&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;def&lt;/span&gt; &lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;hxs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HtmlXPathSelector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;JxItem&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hxs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="c1"&gt;//*[@id=&amp;quot;defen&amp;quot;]/center[1]/b/font/text()&amp;#39;).extract()[0]&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}}}
启动 Xvfb (假设DISPLAY=:0) Xvfb (用于非Xwindow环境)&lt;/p&gt;
&lt;p&gt;要与settings.py中的DISPLAY对应（本例中是:0)。
{{{
scrapy crawl jxydt
}}}&lt;/p&gt;</summary></entry><entry><title>Describe linux/sphinx写书 here.</title><link href="http://liugehao.github.io/describe-linuxsphinxxie-shu-here.html" rel="alternate"></link><updated>2013-10-29T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-10-29:describe-linuxsphinxxie-shu-here.html</id><summary type="html">&lt;p&gt;{{{
pip install sphinx
}}}&lt;/p&gt;
&lt;p&gt;生成项目
{{{
sphinx-quickstart
}}}&lt;/p&gt;
&lt;p&gt;生成pdf
{{{
apt-get install texlive-xetex # xelatex在此包中，先不安装下面的texlive试试
apt-get install latex-make&lt;/p&gt;
&lt;p&gt;apt-get install texlive # 先进行下面步骤，如果出错，安装texlive
make latex
cd builc/latex
xelatex [abc].tex #abc为tex文件名
}}}&lt;/p&gt;
&lt;p&gt;中文内容支持
{{{
fc-list :lang=zh #查看可用中文字体
l@x201i:~/tmp/abd$ fc-list :lang=zh
/usr/share/fonts/truetype/wqy/wqy-zenhei.ttc: WenQuanYi Zen Hei,文泉驛正黑,文泉驿正黑:style=Regular
/usr/share/fonts/truetype/wqy/wqy-zenhei.ttc: WenQuanYi Zen Hei Sharp,文泉驛點陣正黑,文泉驿点阵正黑:style=Regular
/usr/share/fonts/truetype/droid/DroidSansFallbackFull.ttf: Droid Sans:style=Regular
/usr/share/fonts/truetype/wqy/wqy-zenhei.ttc: WenQuanYi Zen Hei Mono,文泉驛等寬正黑,文泉驿等宽正黑:style=Regular&lt;/p&gt;
&lt;h1&gt;修改source/conf.py&lt;/h1&gt;
&lt;p&gt;latex_elements = {&lt;/p&gt;
&lt;h1&gt;Additional stuff for the LaTeX preamble.&lt;/h1&gt;
&lt;p&gt;'preamble': '''
\usepackage{xeCJK}
\setCJKmainfont[BoldFont=WenQuanYi Zen Hei, ItalicFont=WenQuanYi Zen Hei]{WenQuanYi Zen Hei}
\setCJKmonofont[Scale=0.9]{WenQuanYi Zen Hei}
\setCJKfamilyfont{song}[BoldFont=WenQuanYi Zen Hei]{WenQuanYi Zen Hei}
\setCJKfamilyfont{sf}[BoldFont=WenQuanYi Zen Hei]{WenQuanYi Zen Hei}
''',
}&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>mysql中增加远程表federated支持</title><link href="http://liugehao.github.io/mysqlzhong-zeng-jia-yuan-cheng-biao-federatedzhi-chi.html" rel="alternate"></link><updated>2013-10-29T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-10-29:mysqlzhong-zeng-jia-yuan-cheng-biao-federatedzhi-chi.html</id><summary type="html">&lt;p&gt;在my.cnf中[mysqld]下增加一行&lt;/p&gt;
&lt;p&gt;{{{
federated
}}}
重启mysql&lt;/p&gt;
&lt;p&gt;{{{#!highlight sql
CREATE TABLE federated_table (&lt;/p&gt;
&lt;p&gt;id    int(20) NOT NULL auto_increment,&lt;/p&gt;
&lt;p&gt;name  varchar(32) NOT NULL default '',&lt;/p&gt;
&lt;p&gt;other int(20) NOT NULL default '0',&lt;/p&gt;
&lt;p&gt;PRIMARY KEY (id),&lt;/p&gt;
&lt;p&gt;KEY name (name),&lt;/p&gt;
&lt;p&gt;KEY other_key (other)&lt;/p&gt;
&lt;p&gt;)&lt;/p&gt;
&lt;p&gt;ENGINE=FEDERATED&lt;/p&gt;
&lt;p&gt;DEFAULT CHARSET=latin1&lt;/p&gt;
&lt;p&gt;CONNECTION='mysql://root:password@remote_host:9306/federated/test_table';
}}}&lt;/p&gt;</summary></entry><entry><title>Describe linux/SonarQube install on rhel5.7 here.</title><link href="http://liugehao.github.io/describe-linuxsonarqube-install-on-rhel57-here.html" rel="alternate"></link><updated>2013-10-18T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-10-18:describe-linuxsonarqube-install-on-rhel57-here.html</id><summary type="html">&lt;p&gt;用linux自带jdk出错
安装sun(oracle)jdk [[linux/rehl5安装jdk]]&lt;/p&gt;
&lt;p&gt;==　下载安装软件 ==
{{{
wget http://dist.sonar.codehaus.org/sonar-3.7.2.zip
unzip sonar-3.7.2.zip
mv sonar-3.7.2 /etc/sonar
/etc/sonar/bin/linux-x86-64/sonar.sh console //start sonar{console | start |stop |restart|status|dump}
}}}
打开浏览器，输入 http://localhost:9000/　可见软件界面安装完毕 (default System administrator credentials are admin/admin)。&lt;/p&gt;
&lt;p&gt;'''默认使用h2数据库，如果使用：mysql postgresql'''　http://docs.codehaus.org/display/SONAR/Installing+and+Configuring+SonarQube+Runner&lt;/p&gt;
&lt;p&gt;==== 更改数据库,改成自己要使用的数据库，及密码，其它数据库url注释 ====
{{{ 
vi conf/sonar.properties
sonar.jdbc.username:  sonarqube
sonar.jdbc.password:  mypassword
sonar.jdbc.url:       jdbc:postgresql://localhost/sonarqube
}}}
更改后，/etc/sonar/bin/linux-x86-64/sonar.sh start&lt;/p&gt;
&lt;p&gt;'''sonar-runner 的数据库连接conf/sonar-runner.properties也要做相应更改'''&lt;/p&gt;
&lt;p&gt;== 使用方法 ==
 1. 下载 SonarQube runner
    {{{
    wget http://repo1.maven.org/maven2/org/codehaus/sonar/runner/sonar-runner-dist/2.3/sonar-runner-dist-2.3.zip
    unzip sonar-runner-dist-2.3.zip -d /etc
    }}}
 1. 下载示例项目
    {{{
    wget https://github.com/SonarSource/sonar-examples/archive/master.zip
    unzip sonar-examples-master.zip
    }}}
 1. 进入项目目录执行sonar-runner
    {{{
    cd sonar-examples-master/projects/languages/java/sonar-runner/java-sonar-runner-simple
    /etc/sonar-runner-2.3/bin/sonar-runner
    }}}
 1. 刷新浏览器，可见"Projects"中出现"Simple Java project analyzed with the SonarQube Runner"&lt;/p&gt;
&lt;p&gt;== 安装插件 ==
admin/admin登录后，点击"settings","Update Center",查看已安装的插件及，可以安装的插件。&lt;/p&gt;
&lt;p&gt;== 本地化 ==
admin/admin登录后，点击"settings","Update Center","Available Plugins"向下接至"Localiztion",安装语言包
点击"General Settings","Localiztion"，更改设置。&lt;/p&gt;</summary></entry><entry><title>在这里详述 ruby/custom_require.rb:36:in `require': cannot load such file -- mkmf (LoadError)。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-rubycustom_requirerb36in-require-cannot-load-such-file-mkmf-loaderror.html" rel="alternate"></link><updated>2013-10-17T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-10-17:zai-zhe-li-xiang-shu-rubycustom_requirerb36in-require-cannot-load-such-file-mkmf-loaderror.html</id><summary type="html">&lt;p&gt;{{{
root@x201i:/home/l# gem install classifier
Building native extensions.  This could take a while...
ERROR:  Error installing classifier:
    ERROR: Failed to build gem native extension.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;    &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ruby1&lt;/span&gt;&lt;span class="mf"&gt;.9.1&lt;/span&gt; &lt;span class="n"&gt;extconf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rb&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;/usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in &lt;code&gt;require': cannot load such file -- mkmf (LoadError)
    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in&lt;/code&gt;require'
    from extconf.rb:1:in `&lt;main&gt;'&lt;/p&gt;
&lt;p&gt;Gem files will remain installed in /var/lib/gems/1.9.1/gems/fast-stemmer-1.0.2 for inspection.
Results logged to /var/lib/gems/1.9.1/gems/fast-stemmer-1.0.2/ext/gem_make.out
}}}&lt;/p&gt;
&lt;p&gt;解决办法:
{{{
apt-get install ruby1.9.1-dev
}}}&lt;/p&gt;</summary></entry><entry><title>Describe linux/zeromq install on rhel6.4 with php extension here.</title><link href="http://liugehao.github.io/describe-linuxzeromq-install-on-rhel64-with-php-extension-here.html" rel="alternate"></link><updated>2013-10-14T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-10-14:describe-linuxzeromq-install-on-rhel64-with-php-extension-here.html</id><summary type="html">&lt;p&gt;=== zeromq install on rhel 6.4 x64 ===
{{{
cd /dev/yum.repo.d/
wget http://download.opensuse.org/repositories/home:/fengshuo:/zeromq/CentOS_CentOS-6/home:fengshuo:zeromq.repo
yum update
yum install zeromq
yum install zeromq-devel # for development
}}}&lt;/p&gt;
&lt;p&gt;=== php zermoq extension ===
{{{
yum install libxml2-devel&lt;/p&gt;
&lt;p&gt;wget http://cn2.php.net/distributions/php-5.5.4.tar.bz2
tar zxf php-5.5.4.tar.bz2
./configure
pear channel-discover pear.zero.mq
pecl install pear.zero.mq/zmq-beta&lt;/p&gt;
&lt;p&gt;cp ./php.ini-development /usr/local/lib/php.ini
vi /usr/local/lib/php.ini
}}}&lt;/p&gt;
&lt;h1&gt;add line  and save&lt;/h1&gt;
&lt;p&gt;{{{
extension=zmq.so
}}}&lt;/p&gt;
&lt;p&gt;=== php_zeromq_server.php ===
[[attachment:php_zeromq_server.php]]
{{{#!highlight php
&amp;lt;?php
$context = new ZMQContext(1);
// Socket to talk to clients
$responder = new ZMQSocket($context, ZMQ::SOCKET_REP);
$responder-&amp;gt;bind("tcp://*:5555");
while(true) {
// Wait for next request from client
$request = $responder-&amp;gt;recv();
//printf ("Received request: [%s]\n", $request);
// Do some 'work'
// Send reply back to client
$responder-&amp;gt;send("World");
}
}}}&lt;/p&gt;
&lt;p&gt;=== php_zeromq_client.php ===
[[attachment:php_zeromq_client.php]]
{{{#!highlight php
&amp;lt;?php
//count exec time
function time1(){
    list($a, $b) = explode(" ", microtime());
    return ((float)$a + (float)$b);
}
$start_time = time1();
$count = 100000;
$sucesscount = 0;
$context = new ZMQContext();
 //  Socket to talk to server
echo "Connecting to hello world server...\n";
$requester = new ZMQSocket($context, ZMQ::SOCKET_REQ);
$requester-&amp;gt;connect("tcp://localhost:5555");
for($request_nbr = 0; $request_nbr != $count; $request_nbr++) {
    //printf ("Sending request %d...\n", $request_nbr);
    $requester-&amp;gt;send("Hello");
    $reply = $requester-&amp;gt;recv();
    if($reply == "World")$sucesscount ++;
    //printf ("Received reply %d: [%s]\n", $request_nbr, $reply);
}
echo "\nseconds for send {$count} times 'hello' :" .  (time1()- $start_time)."\n sucesscount:{$sucesscount}";
}}}&lt;/p&gt;
&lt;p&gt;=== test ===
{{{
php php_zeromq_client.php &amp;amp; php php_zeromq_client.php &amp;amp; php php_zeromq_client.php &amp;amp; php php_zeromq_client.php &amp;amp; php php_zeromq_client.php &amp;amp; php php_zeromq_client.php &amp;amp; php php_zeromq_client.php &amp;amp; php php_zeromq_client.php &amp;amp; php php_zeromq_client.php &amp;amp; php php_zeromq_client.php &amp;amp;
}}}&lt;/p&gt;
&lt;p&gt;=== 测试结果  ==
单server进程，10客户进程并发，单进程１０Ｗ次发送接收，用时最快４２s，平均２０８３３/s　- ２３５００/s之间
{{{
seconds for send 100000 times 'hello' :42.54803109169
 sucesscount:100000
seconds for send 100000 times 'hello' :42.549309015274
 sucesscount:100000
seconds for send 100000 times 'hello' :42.571755886078
 sucesscount:100000
seconds for send 100000 times 'hello' :42.506102800369
 sucesscount:100000
seconds for send 100000 times 'hello' :42.516571998596
 sucesscount:100000
seconds for send 100000 times 'hello' :42.603147983551
 sucesscount:100000
seconds for send 100000 times 'hello' :42.622861862183
 sucesscount:100000
seconds for send 100000 times 'hello' :42.589258909225
 sucesscount:100000
seconds for send 100000 times 'hello' :42.608597040176
 sucesscount:100000
seconds for send 100000 times 'hello' :42.613350152969&lt;/p&gt;
&lt;p&gt;seconds for send 100000 times 'hello' :48.482357025146
 sucesscount:100000
seconds for send 100000 times 'hello' :48.780467987061
 sucesscount:100000
seconds for send 100000 times 'hello' :48.771656036377
 sucesscount:100000
seconds for send 100000 times 'hello' :48.794227838516
 sucesscount:100000
seconds for send 100000 times 'hello' :48.816515922546
 sucesscount:100000
seconds for send 100000 times 'hello' :48.832470178604
 sucesscount:100000
seconds for send 100000 times 'hello' :48.853888034821
 sucesscount:100000
seconds for send 100000 times 'hello' :48.85328912735
 sucesscount:100000
seconds for send 100000 times 'hello' :48.888187885284
 sucesscount:100000
seconds for send 100000 times 'hello' :48.886878013611
 sucesscount:100000&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>Describe liugehao-工作-201309 here.</title><link href="http://liugehao.github.io/describe-liugehao-gong-zuo-201309-here.html" rel="alternate"></link><updated>2013-10-10T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-10-10:describe-liugehao-gong-zuo-201309-here.html</id><summary type="html">&lt;p&gt;i. js文件压缩测试，去除注释 100%
 i. html css 图片压缩方法测试
 i. rabbitmq 安装配置及文档编写
 i. rabbitmq 与php连接测试程序编写
 i. rabbitmq 性能测试
 i. zeromq 安装与配置
 i. zeromq php 连接测试　３０％&lt;/p&gt;</summary></entry><entry><title>Describe linux/rabbitmq 安装 php扩展 here.</title><link href="http://liugehao.github.io/describe-linuxrabbitmq-an-zhuang-phpkuo-zhan-here.html" rel="alternate"></link><updated>2013-09-06T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-09-06:describe-linuxrabbitmq-an-zhuang-phpkuo-zhan-here.html</id><summary type="html">&lt;p&gt;{{{&lt;/p&gt;
&lt;p&gt;git clone https://github.com/alanxz/rabbitmq-c
cd rabbitmq-c/
git submodule init
git submodule update&lt;/p&gt;
&lt;p&gt;yum install cmake&lt;/p&gt;
&lt;p&gt;mkdir build &amp;amp;&amp;amp; cd build
cmake ..
cd .. &amp;amp;&amp;amp; make &amp;amp;&amp;amp; make install&lt;/p&gt;
&lt;p&gt;wget http://pecl.php.net/get/amqp-1.2.0.tgz
 tar zxf amqp-1.2.0.tgz
 cd amqp-1.2.0
 phpize
 ./configure
 make -j 8
 make install&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;=== 开启web监控 ===
{{{
/opt/rabbitmq/sbin/rabbitmq-plugins enable rabbitmq_management
}}}
如果出错 ,创建/etc/rabbitmq目录及需要文件(touch),后再执行一次。&lt;/p&gt;
&lt;p&gt;=== 要安装amqp 的 C 库 rabbitmq-c，否则报下面的错误 ===
{{{
checking for amqp files in default path... not found
}}}&lt;/p&gt;</summary></entry><entry><title>Describe linux/rhel 5.7 安装 rabbitmq here.</title><link href="http://liugehao.github.io/describe-linuxrhel-57-an-zhuang-rabbitmq-here.html" rel="alternate"></link><updated>2013-09-05T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-09-05:describe-linuxrhel-57-an-zhuang-rabbitmq-here.html</id><summary type="html">&lt;p&gt;=== 先安装erlang ===&lt;/p&gt;
&lt;p&gt;{{{
yum list|grep curses
rpm -ivh ncurses-devel-5.5-24.20060715.x86_64.rpm&lt;/p&gt;
&lt;p&gt;wget http://www.erlang.org/download/otp_src_R16B01.tar.gz
tar zxf otp_src_R16B01.tar.gz 
cd otp_src_R16B01
./configure
make &amp;amp;&amp;amp; make install&lt;/p&gt;
&lt;p&gt;}}}
=== 安装rabbitmq之前，设置环境变量 ===
{{{
export TARGET_DIR=/opt/rabbitmq
export SBIN_DIR=/opt/rabbitmq/sbin
export MAN_DIR=/opt/rabbitmq/man
}}}&lt;/p&gt;
&lt;p&gt;=== 安装rabbitmq ===
{{{
rpm -ivh xmlto-0.0.18-13.1.x86_64.rpm docbook-style-xsl-1.69.1-5.1.noarch.rpm w3m-0.5.1-18.el5.x86_64.rpm passivetex-1.25-5.1.1.noarch.rpm tetex-3.0-33.13.el5.x86_64.rpm xmltex-20020625-8.noarch.rpm tetex-fonts-3.0-33.13.el5.x86_64.rpm tetex-latex-3.0-33.13.el5.x86_64.rpm netpbm-progs-10.35.58-8.el5.x86_64.rpm tetex-dvips-3.0-33.13.el5.x86_64.rpm dialog-1.0.20051107-1.2.2.x86_64.rpm psutils-1.17-26.1.x86_64.rpm &lt;/p&gt;
&lt;p&gt;wget http://www.rabbitmq.com/releases/rabbitmq-server/v3.1.5/rabbitmq-server-3.1.5.tar.gz
 tar zxf rabbitmq-server-3.1.5.tar.gz 
cd rabbitmq-server-3.1.5
make -j 8
make install&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;最后还要设置一下日志与消息持久化目录，命令如下，其中的myuser是你当前的用户名
{{{
mkdir /var/log/rabbitmq&lt;br /&gt;
chown myuser /var/log/rabbitmq&lt;br /&gt;
mkdir /var/lib/rabbitmq&lt;br /&gt;
chown myuser /var/lib/rabbitmq&lt;br /&gt;
}}}&lt;/p&gt;
&lt;p&gt;=== 启动 ===
{{{
cd /opt/rabbitmq/sbin&lt;br /&gt;
./rabbitmq-server
}}}
为启动方便，可以把/opt/rabbitmq/sbin下的命令在/usr/local/bin下做一个链接，命令如下
{{{
   sudo ln -s /opt/rabbitmq/sbin/rabbitmq-server /usr/local/bin/rabbitmq-server
}}}&lt;/p&gt;
&lt;p&gt;=== 错误 ===
如果出现
{{{
ERROR: epmd error for host "yournewhostname": timeout (timed out establishing tcp connection) 
}}}
原因是, 主机名和ip不匹配了，需要更改/etc/hosts 
{{{
127.0.0.1 yournewhostname
}}}&lt;/p&gt;</summary></entry><entry><title>Describe python/virtualenv pip 技巧 here.</title><link href="http://liugehao.github.io/describe-pythonvirtualenv-pip-ji-qiao-here.html" rel="alternate"></link><updated>2013-09-04T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-09-04:describe-pythonvirtualenv-pip-ji-qiao-here.html</id><summary type="html">&lt;p&gt;== virtualenv ==
这里是导言吗？
用过Python的同学，肯定会对Python及程序的版本之间经常更换的api感到痛苦不以。就拿我折腾的Django来说吧，公司服务器上跑的是Django1.3、同事也是用1.3开发，但是因为我是新来，一个
pip install django
下去，就是1.4.2。好了，你自己写的Django Project自然没有问题，自己本地测试也没有问题。但是要和其他人交流的时候就蛋疼了，因为你的1.4.2跑不了1.3的程序……当然，这时，你可以选择卸载自己本地的Django，换成1.3，等你要重新测试自己的Django，怎么样，扯着蛋了吧。为了解决以上问题，virtualenv横空出世了。
正文
为了解决以上蛋疼问题，我们需要安装virtualenv。
{{{
sudo pip install virtualenv
}}}
安装好了以后，就可以在任何目录下新建一个virtual-environment（我更喜欢叫：盗梦空间），当然一般我习惯在项目的边上创建一个$project_name-env。例如：
{{{
virtualenv demo-env
}}}
这下，只需要
{{{
source demo-env/bin/activate
}}}
就可以激活这个虚拟环境了。如下图所示：&lt;/p&gt;
&lt;p&gt;注意到括号里的(demo-env)了没？对，我们已经进入了第一层梦境demo-env。
回到导言里的问题，我们需要在这里建立一个使用django1.3的环境，不让它干扰我们的本地环境。&lt;/p&gt;
&lt;p&gt;{{{
pip install Django==1.3
}}}
就可以了，然后在里面运行别人的Django程序，没有问题！装很多python程序，没有问题，这些都不会干扰你的本地环境，放心破坏吧！&lt;/p&gt;
&lt;p&gt;== PIP ==
刚才的virtualenv的介绍里已经说了pip的安装命令了。但你当pip只是个安装工具的话，那就大错特错了。pip还有一个更重要的功能——冻结当前梦境开发环境版本（freeze）。
{{{
(env1)l@x201i:~/pyproject/yuer$ pip freeze
argparse==1.2.1
bottle==0.11.6
bottle-sqlalchemy==0.4
psycopg2==2.5.1
wsgiref==0.1.2&lt;/p&gt;
&lt;p&gt;}}}
看到了刚才安装的django 1.3了没有？这就是我们目前的生产环境，把这输出结果写到requirement.txt里，别的程序猿们就知道你的程序至少在这个环境下可以跑，这时他们拿着requirement.txt，新建个virtualenv，
{{{
pip install -r requirement.txt
}}}
就可以运行你的程序了。
pip加速安装
通过pip安装程序，还可以用git和svn的方式，具体操作网上也有。但是对于懒人来说，直接用pip是最好不过的了，但是，有时这会很慢！！！慢到你抓狂。当然，和apt-get一样，pip也可以换源，或者叫添加镜像。
新建一个~/.pip/pip.conf，往里面写入
{{{
[global]
index-url=http://e.pypi.python.org/simple
timeout = 30
require-virtualenv = true
download-cache = /tmp&lt;/p&gt;
&lt;p&gt;[install]
use-mirrors = true
mirrors =&lt;/p&gt;
&lt;p&gt;http://d.pypi.python.org&lt;/p&gt;
&lt;p&gt;http://b.pypi.python.org&lt;/p&gt;
&lt;p&gt;http://c.pypi.python.org&lt;/p&gt;
&lt;p&gt;}}}
下载应该就会像飞了一样，配置文件过于清晰，所以我也不用多说了吧 ：）&lt;/p&gt;</summary></entry><entry><title>Describe liugehao-工作-201308 here.</title><link href="http://liugehao.github.io/describe-liugehao-gong-zuo-201308-here.html" rel="alternate"></link><updated>2013-09-02T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-09-02:describe-liugehao-gong-zuo-201308-here.html</id><summary type="html">&lt;p&gt;i. gwan kev value store ,测试程序编写，测试 100%
 i. weghttp 安装，测试g-wan
 i. weihtp 与ab 测试结果对比
 i. gwan key value store 减少扫描记录存储占用内存试验。存储每个快件的多条扫描记录压缩后的数据，占用内存大量减少，压缩比约6:1 100%
 i. php 调用　gwan 的key value store 试验
 i. gwan get post 上传最大数据量测试
 i. js文件压缩测试，去除注释 70%&lt;/p&gt;</summary></entry><entry><title>Describe linux/zeromq安装 here.</title><link href="http://liugehao.github.io/describe-linuxzeromqan-zhuang-here.html" rel="alternate"></link><updated>2013-08-30T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-30:describe-linuxzeromqan-zhuang-here.html</id><summary type="html">&lt;p&gt;{{{
apt-get install libtool autoconf automake uuid-dev g++
wget http://download.zeromq.org/zeromq-3.2.3.tar.gz
tar zxf zeromq-3.2.3.tar.gz
cd zeromq-3.2.3
./configure --build=sparc-linux
make
make install&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;pyzmq
{{{
pip install pyzmq
}}}
client.py
{{{#!highlight python
import sys
import zmq&lt;/p&gt;
&lt;h1&gt;Socket to talk to server&lt;/h1&gt;
&lt;p&gt;context = zmq.Context()
socket = context.socket(zmq.SUB)&lt;/p&gt;
&lt;p&gt;print "Collecting updates from weather server..."
socket.connect ("tcp://localhost:5556")&lt;/p&gt;
&lt;h1&gt;Subscribe to zipcode, default is NYC, 10001&lt;/h1&gt;
&lt;p&gt;zip_filter = sys.argv[1] if len(sys.argv) &amp;gt; 1 else "10001"
socket.setsockopt(zmq.SUBSCRIBE, zip_filter)&lt;/p&gt;
&lt;h1&gt;Process 5 updates&lt;/h1&gt;
&lt;p&gt;total_temp = 0
for update_nbr in range (5):
    string = socket.recv()
    zipcode, temperature, relhumidity = string.split()
    total_temp += int(temperature)
    print "Average temperature for zipcode '%s' was %dF" % (zip_filter, total_temp / update_nbr)
}}}&lt;/p&gt;
&lt;p&gt;server.py
{{{#!highlight python
import zmq
import random&lt;/p&gt;
&lt;p&gt;context = zmq.Context()
socket = context.socket(zmq.PUB)
socket.bind("tcp://*:5556")&lt;/p&gt;
&lt;p&gt;while True:
    zipcode = random.randrange(1,100000)
    temperature = random.randrange(1,215) - 80
    relhumidity = random.randrange(1,50) + 10&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;zipcode&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;temperature&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;relhumidity&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>== python/Python 排列,组合生成器 yield ==</title><link href="http://liugehao.github.io/pythonpython-pai-lie-zu-he-sheng-cheng-qi-yield.html" rel="alternate"></link><updated>2013-08-30T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-30:pythonpython-pai-lie-zu-he-sheng-cheng-qi-yield.html</id><summary type="html">&lt;p&gt;参数数字，固定排列和组合字符串的长度&lt;/p&gt;
&lt;p&gt;f=perm('abcdefghijklmnopqrstuvwxyz01234567890', 4)&lt;/p&gt;
&lt;p&gt;{{{#!highlight python&lt;/p&gt;
&lt;h1&gt;生成全排列&lt;/h1&gt;
&lt;p&gt;def perm(items, n=None):
    if n is None:
        n = len(items)
    for i in range(len(items)):
        v = items[i:i+1]
        if n == 1:
            yield v
        else:
            rest = items[:i] + items[i+1:]
            for p in perm(rest, n-1):
                yield v + p&lt;/p&gt;
&lt;h1&gt;生成组合&lt;/h1&gt;
&lt;p&gt;def comb(items, n=None):
    if n is None:
        n = len(items)  &lt;br /&gt;
    for i in range(len(items)):
        v = items[i:i+1]
        if n == 1:
            yield v
        else:
            rest = items[i+1:]
            for c in comb(rest, n-1):
                yield v + c&lt;/p&gt;
&lt;p&gt;a = perm('abc')
for b in a:
    print b
    break
print '-'*20
for b in a:
    print b 
}}}&lt;/p&gt;</summary></entry><entry><title>linux/bash/awk中RS,ORS,FS,OFS区别与联系</title><link href="http://liugehao.github.io/linuxbashawkzhong-rsorsfsofsqu-bie-yu-lian-xi.html" rel="alternate"></link><updated>2013-08-27T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-27:linuxbashawkzhong-rsorsfsofsqu-bie-yu-lian-xi.html</id><summary type="html">&lt;p&gt;学习awk时，一定要记得动手去实践，只有在实践中才能发现问题，以下就我在学习中和实践中的经验，总结一下RS,ORS,FS,OFS的区别和联系。&lt;/p&gt;
&lt;p&gt;'''一，RS与ORS'''&lt;/p&gt;
&lt;p&gt;1，RS是记录分隔符，默认的分隔符是\n，具体用法看下&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[root@krlcgcms01 mytest]# cat test1     /&lt;em&gt; //测试文件 &lt;/em&gt;/&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;111 222&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;333 444&lt;/li&gt;
&lt;li&gt;555 666&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;2，RS默认分割符\n&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[root@krlcgcms01 mytest]# awk '{print $0}' test1  /&lt;em&gt; //awk 'BEGIN{RS="\n"}{print $0}' test1 这二个是一样的 &lt;/em&gt;/&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;111 222&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;333 444&lt;/li&gt;
&lt;li&gt;555 666&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其实你可以把'''上面test1文件里的内容理解为，111 222\n333 444\n555 6666，利用\n进行分割'''。看下一个例子&lt;/p&gt;
&lt;p&gt;3，自定义RS分割符&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[zhangy@localhost test]$ echo "111 222|333 444|555 666"|awk 'BEGIN{RS="|"}{print $0,RT}'&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;111 222 |&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;333 444 |&lt;/li&gt;
&lt;li&gt;555 666&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;结合上面一个例子，就很容易理解RS的用法了。&lt;/p&gt;
&lt;p&gt;4，RS也可能是正则表达式&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[zhangy@localhost test]$ echo "111 222a333 444b555 666"|awk 'BEGIN{RS="[a-z]+"}{print $1,RS,RT}'&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;111 [a-z]+ a&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;333 [a-z]+ b&lt;/li&gt;
&lt;li&gt;555 [a-z]+&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;从例3和例4，我们可以发现一点，'''当RT是利用RS匹配出来的内容。如果RS是某个固定的值时，RT就是RS的内容'''。&lt;/p&gt;
&lt;p&gt;5，RS为空时&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[zhangy@localhost test]$ cat -n test2&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;1  111 222&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;2&lt;/li&gt;
&lt;li&gt;3  333 444&lt;/li&gt;
&lt;li&gt;4  333 444&lt;/li&gt;
&lt;li&gt;5&lt;/li&gt;
&lt;li&gt;6&lt;/li&gt;
&lt;li&gt;7  555 666&lt;/li&gt;
&lt;li&gt;[zhangy@localhost test]$ awk 'BEGIN{RS=""}{print $0}' test2&lt;/li&gt;
&lt;li&gt;111 222&lt;/li&gt;
&lt;li&gt;333 444&lt;/li&gt;
&lt;li&gt;333 444&lt;/li&gt;
&lt;li&gt;555 666&lt;/li&gt;
&lt;li&gt;[zhangy@localhost test]$ awk 'BEGIN{RS="";}{print "&amp;lt;",$0,"&amp;gt;"}' test2  /&lt;em&gt; //这个例子看着比较明显 &lt;/em&gt;/&lt;/li&gt;
&lt;li&gt;&amp;lt; 111 222 &amp;gt;&lt;/li&gt;
&lt;li&gt;&amp;lt; 333 444     /&lt;em&gt; //这一行和下面一行，是一行 &lt;/em&gt;/&lt;/li&gt;
&lt;li&gt;333 444 &amp;gt;&lt;/li&gt;
&lt;li&gt;&amp;lt; 555 666 &amp;gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;从这个例子，'''可以看出当RS为空时，awk会自动以多行来做为分割符'''。&lt;/p&gt;
&lt;p&gt;6，ORS记录输出分符符，默认值是\n&lt;/p&gt;
&lt;p&gt;'''把ORS理解成RS反过程，这样更容易记忆和理解'''，看下面的例子。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[zhangy@localhost test]$ awk 'BEGIN{ORS="\n"}{print $0}' test1  /&lt;em&gt; //awk '{print $0}' test1二者是一样的 &lt;/em&gt;/&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;111 222&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;333 444&lt;/li&gt;
&lt;li&gt;555 666&lt;/li&gt;
&lt;li&gt;[zhangy@localhost test]$ awk 'BEGIN{ORS="|"}{print $0}' test1&lt;/li&gt;
&lt;li&gt;111 222|333 444|555 666|&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;'''二，FS与OFS'''&lt;/p&gt;
&lt;p&gt;1，FS指定列分割符&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[zhangy@localhost test]$ echo "111|222|333"|awk '{print $1}'&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;111|222|333&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;[zhangy@localhost test]$ echo "111|222|333"|awk 'BEGIN{FS="|"}{print $1}'&lt;/li&gt;
&lt;li&gt;111&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;2，FS也可以用正则&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[zhangy@localhost test]$ echo "111||222|333"|awk 'BEGIN{FS="[|]+"}{print $1}'&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;111&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;3，FS为空的时候&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[zhangy@localhost test]$ echo "111|222|333"|awk 'BEGIN{FS=""}{NF++;print $0}'&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;1 1 1 | 2 2 2 | 3 3 3&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;'''当FS为空的时候，awk会把一行中的每个字符，当成一列来处理'''。&lt;/p&gt;
&lt;p&gt;4，RS被设定成非\n时，\n会成FS分割符中的一个&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[zhangy@localhost test]$ cat test1&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;111 222&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;333 444&lt;/li&gt;
&lt;li&gt;555 666&lt;/li&gt;
&lt;li&gt;[zhangy@localhost test]$ awk 'BEGIN{RS="444";}{print $2,$3}' test1&lt;/li&gt;
&lt;li&gt;222 333&lt;/li&gt;
&lt;li&gt;666&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;'''222和333之间是有一个\n的，当RS设定成444后，222和333被认定成同一行的二列了，其实按常规思想是二行的一列才对'''。&lt;/p&gt;
&lt;p&gt;5，OFS列输出分隔符&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[zhangy@localhost test]$ awk 'BEGIN{OFS="|";}{print $1,$2}' test1&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;111|222&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;333|444&lt;/li&gt;
&lt;li&gt;555|666&lt;/li&gt;
&lt;li&gt;[zhangy@localhost test]$ awk 'BEGIN{OFS="|";}{print $1 OFS $2}' test1&lt;/li&gt;
&lt;li&gt;111|222&lt;/li&gt;
&lt;li&gt;333|444&lt;/li&gt;
&lt;li&gt;555|666&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;'''test1只有二列，如果100列，都写出来太麻烦了吧。'''&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[zhangy@localhost test]$ awk 'BEGIN{OFS="|";}{print $0}' test1&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;111 222&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;333 444&lt;/li&gt;
&lt;li&gt;555 666&lt;/li&gt;
&lt;li&gt;[zhangy@localhost test]$ awk 'BEGIN{OFS="|";}{NF=NF;print $0}' test1&lt;/li&gt;
&lt;li&gt;111|222&lt;/li&gt;
&lt;li&gt;333|444&lt;/li&gt;
&lt;li&gt;555|666&lt;/li&gt;
&lt;/ol&gt;</summary></entry><entry><title>章节3 课时 42 讲解proc-sysctl</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-42-jiang-jie-proc-sysctl.html" rel="alternate"></link><updated>2013-08-27T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-27:zhang-jie-3-ke-shi-42-jiang-jie-proc-sysctl.html</id><summary type="html">&lt;p&gt;proc 目录,是内存中的数值,没有来源，只是入口，到内存结构中，
proc目录下只是一个接口，不可更改，以文件形式存在，&lt;/p&gt;
&lt;p&gt;mount -t proc　none /aaa&lt;/p&gt;
&lt;p&gt;/proc/sys 下文件多数可更改，少数不能改
更改之后马上第一次，但下次启动无效（因为更改的是内存的值），这里只提供入口方法&lt;/p&gt;
&lt;h1&gt;echo 1 &amp;gt; icmp_echo_ignore_all　//使机器不可ping&lt;/h1&gt;
&lt;h1&gt;sysctl -w net.ipv4.icmp_echo_ignore_all=1 //功能同上&lt;/h1&gt;
&lt;h1&gt;cat /proc/sys/net/ipv4/net.ipv4.icmp_echo_ignore_all&lt;/h1&gt;
&lt;p&gt;1&lt;/p&gt;
&lt;h1&gt;vi /etc/sysctl.conf&lt;/h1&gt;
&lt;p&gt;net.ipv4.icmp_echo_ignore_all=1&lt;/p&gt;
&lt;h1&gt;sysctl -p //把sysctl.conf中的重写一遍到proc/sys&lt;/h1&gt;
&lt;h1&gt;sysctl -a //把所有可更改的内核参数显示出来&lt;/h1&gt;
&lt;p&gt;ip_forward //数据包转发&lt;/p&gt;
&lt;h1&gt;sysctl -p -f /tmp/a.sysctl //把a.sysctl刷到内核&lt;/h1&gt;
&lt;p&gt;常用参数
 * file-max 打开最大数量文件参数
 * shm 共享内存　sysctl-a |grep shm
 * syn 防止洪水攻击设置
 * icmp ,broadcasts 广播包
   ping 192.168.0.0 -b 
 * cat /proc/meminfo 查看内存
   free 命令
 * vmstat 机器慢时，查看原因
   (vmsat 1 10 间隔一秒做１０次，系统状态显示出来)
   si so(swap in out)　如果占用率高，内存不足，频繁使用swap
   bi bo block设备读出与入，free 内存占用，cpu用户进程占用cpu
   us 用户空间进程
   sy 占用高，可能网络受攻击
   id 剩余cpu
   wa IO wait ，cpu等待硬盘寻道完成找到数据
 * top &amp;lt;,&amp;gt;上现翻页
 * ps aux
   a 显示所有终端上的程序
   u 显示项目更多
   x 后面守护进程全部显示
     带方括号的，内核线程
 * ps pstree top,都是查/proc下的进程，数字文件夹为内核进程id 
 * df 查看磁盘使用 
 * hostname 也是设置在内核中(/proc)
   hostname abc 更改hostname
   vi /etc/sysconfig/network //永久更改
 * uname -a 
   32bit pae内核支持大内存不好，
   4ＧＢ支持大于于 安装 kernel-PAE内核（软件内存管理）
   大内存安装x86_64 硬件支持大内存，支持比３２位好
 * uptime 负载（top中也可看到）
   1,5,15分钟等待执行任务的个数
   数字不应该多于cpu个数
 * swapon 打开swap
   swapon -s 可以看所有swap空间使用情况
 * pmap 查看内存情况
   pmap -p 1 调用了哪些库，占用内存情况
 * du -s /etc 看一个目录多大
   du -sh /etc ／／h以Ｍ,Ｇ,Ｋ方式显示
 * fdisk -l
 * iostat 1 10 //要安装sysstat这个包，查看每个硬盘io情况&lt;br /&gt;
 * cat /proc/bus/pci/devices 查看所有的ＰＣＩ设备
   lspic 同上
 * lsusb 查看现在有哪些ＵＳＢ设备连接，都是去/proc找相应文件
 * dmidecode 查看BIOS返回的信息（硬件版本号等）
 * x86info 查看cpu标准特性,比如指令集的支持等&lt;/p&gt;</summary></entry><entry><title>章节3 课时 43 讲解modprobe.conf</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-43-jiang-jie-modprobeconf.html" rel="alternate"></link><updated>2013-08-27T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-27:zhang-jie-3-ke-shi-43-jiang-jie-modprobeconf.html</id><summary type="html">&lt;p&gt;内核模块加载方法多种
  1. kernel kernel.org 下载内核源码make menuconfig
     demsg | more
  1. initrd mkinitrd 制作驱动映象，（启动相关驱动放在initrd或者kernel中）
  1. /etc/rc.d/rc.sysinit 驱动的80-90%在这里配置
  1. /etc/modprobe.conf 放和启动无关的驱动，生产驱动，网卡驱动
     grep modprobe /etc/rc.d/rc.sysinit&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt; &lt;span class="n"&gt;depmod&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;grep&lt;/span&gt; &lt;span class="n"&gt;bond&lt;/span&gt; &lt;span class="err"&gt;查找内核模块&lt;/span&gt; &lt;span class="err"&gt;（&lt;/span&gt;&lt;span class="n"&gt;depmond&lt;/span&gt; &lt;span class="err"&gt;加载所有内核模块）&lt;/span&gt;

 &lt;span class="err"&gt;网卡多链路，&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="err"&gt;块网卡当一块用&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;modprobe&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;
 &lt;span class="n"&gt;alias&lt;/span&gt; &lt;span class="n"&gt;bond0&lt;/span&gt; &lt;span class="n"&gt;bonding&lt;/span&gt; &lt;span class="err"&gt;加载&lt;/span&gt;&lt;span class="n"&gt;bonding&lt;/span&gt;&lt;span class="err"&gt;模块，别名&lt;/span&gt;&lt;span class="n"&gt;bond0&lt;/span&gt;
 &lt;span class="n"&gt;options&lt;/span&gt; &lt;span class="n"&gt;bond0&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="err"&gt;负载均衡模式&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="err"&gt;高可用方式&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;options&lt;/span&gt; &lt;span class="err"&gt;加载某个模块，时设置参数&lt;/span&gt;
 &lt;span class="n"&gt;ifenslave&lt;/span&gt; &lt;span class="n"&gt;bond0&lt;/span&gt; &lt;span class="n"&gt;eth1&lt;/span&gt; &lt;span class="n"&gt;eth0&lt;/span&gt; &lt;span class="err"&gt;执行命令才生效，把它放在&lt;/span&gt;&lt;span class="n"&gt;rc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;
 &lt;span class="n"&gt;system&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="err"&gt;设置&lt;/span&gt;&lt;span class="n"&gt;IP&lt;/span&gt;&lt;span class="err"&gt;，&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;system&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;tui&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="err"&gt;或者&lt;/span&gt;&lt;span class="n"&gt;netocnfig&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="n"&gt;bond0&lt;/span&gt;

 &lt;span class="k"&gt;switch&lt;/span&gt;&lt;span class="err"&gt;交换机要支持多链路&lt;/span&gt;

 &lt;span class="n"&gt;hba&lt;/span&gt;&lt;span class="err"&gt;光纤卡也可以&lt;/span&gt;&lt;span class="n"&gt;bond&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="err"&gt;实现负载均衡&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary></entry><entry><title>章节3 课时 44 讲解mod-tools</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-44-jiang-jie-mod-tools.html" rel="alternate"></link><updated>2013-08-27T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-27:zhang-jie-3-ke-shi-44-jiang-jie-mod-tools.html</id><summary type="html">&lt;p&gt;{{{&lt;/p&gt;
&lt;h1&gt;rpm -qf /sbin/lsmod&lt;/h1&gt;
&lt;p&gt;module-init-tools-3.3-0.pre3.1.60.el5&lt;/p&gt;
&lt;h1&gt;rpm -qfl /sbin/lsmod //l 显示该包中的所有文件&lt;/h1&gt;
&lt;p&gt;lsmod 显示所有模块
加载内核模块
modprobe usb-storage 
insmod 加载不上就报错
lsmod |grep fat&lt;/p&gt;
&lt;p&gt;modprobe  vfat 加载vfat,同时加载fat ,vfat 依赖fat
modprobe -r vfat 卸载vfat,fat&lt;/p&gt;
&lt;p&gt;insmod /lib/modules/2.6.18-194.el5/kernel/fs/vfat/vfat.ko  出错&lt;/p&gt;
&lt;p&gt;insmod /lib/modules/2.6.18-194.el5/kernel/fs/fat/fat.ko
insmod /lib/modules/2.6.18-194.el5/kernel/fs/vfat/vfat.ko 成功&lt;/p&gt;
&lt;p&gt;rmmod vfat 卸载
rmmod fat &lt;/p&gt;
&lt;p&gt;depmod -a 把所有系统中的所有内核版本，内核模块分别注册在各自版本内核模块中
depmod 2.6.18-194.el5 把内核2.6.18-194.el5的模块全部注册&lt;/p&gt;
&lt;p&gt;modinfo 查看模块信息&lt;/p&gt;
&lt;p&gt;如果由厂商提供设备的驱动模块（不在内核中）
cp xxx /lib/modules/2.6.18-194.el5/kernel/... 
modprobe xxx&lt;/p&gt;
&lt;p&gt;或者&lt;/p&gt;
&lt;p&gt;insmod /tmp/abc.ko &lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>章节3 课时 45 讲解devices-file-dd</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-45-jiang-jie-devices-file-dd.html" rel="alternate"></link><updated>2013-08-27T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-27:zhang-jie-3-ke-shi-45-jiang-jie-devices-file-dd.html</id><summary type="html">&lt;p&gt;{{{
一切皆文件&lt;/p&gt;
&lt;p&gt;/proc/xxx 
／&lt;/p&gt;
&lt;p&gt;ls -l 时第一字节
b block型设备文件
c 字符型设备文件
s 网络类型文件
p 管道类型文件
d 目录
- 普通文件&lt;/p&gt;
&lt;p&gt;root@x201i:/dev# ls -l /dev/sda /dev/tty1
brw-rw---T 1 root disk 8, 0 Aug 27 08:48 /dev/sda 主设备号8，辅助设备号0 
crw-rw 1 root tty  4, 1 Aug 27 08:48 /dev/tty1&lt;/p&gt;
&lt;p&gt;cat /dev/sda 时
kernel 去找文件 /proc/devices -&amp;gt;找block类型主设备号8
modules(driver) sd 对应sd_mod.ko模块
控制权交给模块sd_mod,  辅助设备号0 ,找0标号设备
然后输出&lt;/p&gt;
&lt;p&gt;monod /opt/myhd b 8 0 //创建了和/sda一样的设备文件
cat /opt/myhd //输出和cat /dev/sda一样&lt;/p&gt;
&lt;p&gt;mknod /opt/mytty c 4 1 和/dev/tty1一样的设备文件
＊ root创建文件权限644，如果创建了文件，其它用户可以访问，其它用户dd到一个镜像，在其它机器mount后，可以访问没有权限访问的文件。&lt;/p&gt;
&lt;p&gt;mknod /opt/ppp p 管道&lt;/p&gt;
&lt;p&gt;vi kernel|source/Documention/devices.txt内核源码 ，有设备号约写&lt;/p&gt;
&lt;p&gt;start_udev(udev) 搜索所有内核模块,在/dev目录下重建所有设备文件&lt;/p&gt;
&lt;p&gt;dd if=/dev/sda of=/dev/sdb bs=1024  count=xxx //bs块大小,count块数
dd if=/dev/zero of=/dev/sda2 bs=1M //把分区中数据清0,数据无法恢复&lt;/p&gt;
&lt;p&gt;cat /dev/sda &amp;gt; /dev/null 丢弃数据，重定向到/dev/null
tar cf /tmp/a.tar /etc/passwd &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 正确错误输出都到/dev/null
tar cf /tmp/a.tar /etc/passwd &amp;amp;&amp;gt;/dev/null 同上&lt;/p&gt;
&lt;p&gt;常见设备
tty1 c 4 1
tty2 c 4 3
tty0 c 4 0 //当前控制台
hda b 3 0 //硬盘设备号64个，最多可创建63个分区，再多无法区分
hdb b 3 64 
}}}&lt;/p&gt;</summary></entry><entry><title>章节3 课时 46 讲解network-fconfig-ip-route-config</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-46-jiang-jie-network-fconfig-ip-route-config.html" rel="alternate"></link><updated>2013-08-27T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-27:zhang-jie-3-ke-shi-46-jiang-jie-network-fconfig-ip-route-config.html</id><summary type="html">&lt;p&gt;{{{
ifconfig 看不到没有设置IP的网卡
ifconfig eth1 192.168.0.11
ifconfig eth1 down
ifconfig eth1 up&lt;/p&gt;
&lt;p&gt;ip ad sh = ip address show 命令显示IP地址，功能比ifconfig 强大&lt;/p&gt;
&lt;p&gt;ip ad help 帮助
ip ad add 192.168.1.254 dev eth1 添加一个IP ，ifconfig看不到
{{{
root@x201i:/tmp# ip help
Usage: ip [ OPTIONS ] OBJECT { COMMAND | help }
       ip [ -force ] -batch filename
where  OBJECT := { link | addr | addrlabel | route | rule | neigh | ntable | tunnel | tuntap | maddr | mroute | mrule | monitor | xfrm | netns | l2tp }
       OPTIONS := { -V[ersion] | -s[tatistics] | -d[etails] | -r[esolve] | -f[amily] { inet | inet6 | ipx | dnet | link } | -l[oops] { maximum-addr-flush-attempts } | -o[neline] | -t[imestamp] | -b[atch] [filename] | -rc[vbuf] [size]
root@x201i:/tmp# ip link help
}}}
ip ifconfig 命令重启后，丢弃。解决方法添加到rc.local或者创建/etc/sysconfig/network-scripts/ifcfg-ethx 文件。&lt;/p&gt;
&lt;p&gt;策略路由：
  百分之几的流量走路由1，百分之几的流量走路由2 ....&lt;/p&gt;
&lt;p&gt;查看哪个网卡插了网线&lt;br /&gt;
mii-tool -v 有的网卡支持mii-tool,有的不支持
mii-tool -F 强制10/100m，全，半双工任一模式&lt;/p&gt;
&lt;p&gt;/etc/sysconfig/network-scripts/ifcfg-eth0 网卡配置文件
添加IP地址
cp ifcfg-eth0 ifcfg-eth0:1 //后面数据随便
vi ifcfg-eth0:1
DEVICE=eth0:1
IPADDR=192.168.1.12&lt;/p&gt;
&lt;p&gt;BOOTPROTO=static (dhcp) static可以删除IP设置
ONBOOT=yes (no) 系统启动会自动启动接口，
保存文件后
service network restart 生效
system-config-network-tui(gui)
netconfig命令 默认没有安装
netconfig -d eth0:2 192.168.1.23 永久添加
netconfig -d eth0 192.168.1.23 永久更改&lt;/p&gt;
&lt;p&gt;ip ad add 10.0.0.1/8 dev eth0&lt;/p&gt;
&lt;p&gt;chkconfig network on&lt;/p&gt;
&lt;p&gt;init
3完整多用户模式
4没人用
5图型界面&lt;/p&gt;
&lt;p&gt;chkconfig network on
关掉iptables或者-F 清掉iptables
chkconfig iptables off
iptables -F &lt;/p&gt;
&lt;p&gt;vi /etc/resolv.conf 设置dns地址
nameserver 8.8.8.8
nameserver 8.8.4.4
search abc.com //搜索域中主机&lt;/p&gt;
&lt;p&gt;vi /etc/sysconfig/network 设置网关地址
GATEWAY＝
vi /etc/sysconfig/network-scripts/ifcfg-eth0  设置网关
不管设置了几个网关，只有一条生效，另外的是备用的
root@x201i:/tmp# route -n //最上面的生效
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         10.20.57.1      0.0.0.0         UG    0      0        0 wlan1
0.0.0.0         0.0.0.0         0.0.0.0         U     1002   0        0 eth0
10.20.57.0      0.0.0.0         255.255.255.0   U     0      0        0 wlan1
169.254.0.0     0.0.0.0         255.255.0.0     U     0      0        0 eth0
169.254.0.0     0.0.0.0         255.255.0.0     U     1000   0        0 wlan1
192.168.122.0   0.0.0.0         255.255.255.0   U     0      0        0 virbr0&lt;/p&gt;
&lt;p&gt;数据包发送，看走哪个路由，决定由哪个网卡发送。
多个网卡不要设置同一网段IP，不要设置2个默认网关&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;路由 
   route add -net 20.0.0.0 netmask 255.255.255.0 gw 192.168.0.200
   当发送数据包给20.0.0.0 子网掩码 255.255.255.0 (20.0.0.1-254)时，把数据包发给192.168.0.200，让它转发
   route del -net 20.0.0.0 netmask 255.255.255.0
   route del default gw 192.168.1.12 删除默认路由
   route del -net 0.0.0.0 netmask 0.0.0.0 gw 10.20.57.1 同上
   route -n 显示路由&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>章节3 课时 47 讲解network-command-troubleshooting</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-47-jiang-jie-network-command-troubleshooting.html" rel="alternate"></link><updated>2013-08-27T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-27:zhang-jie-3-ke-shi-47-jiang-jie-network-command-troubleshooting.html</id><summary type="html">&lt;p&gt;{{{
ping -b 10.20.57.0 //ping广播包
traceroute www.sina.com.cn //看哪里不通
mtr www.sina.com //可以看到经过哪些路由，哪个路由的掉包率&lt;/p&gt;
&lt;p&gt;ping www.sina.com.cn
dig www.sina.com.cn
host www.sina.com.cn
nslookup www.sina.com.cn&lt;/p&gt;
&lt;p&gt;nslookup&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;www.sina.com.cn
set q=ns //q=a记录
set q=ns
com ／／查询根
Server:     8.8.4.4
Address:    8.8.4.4#53&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Non-authoritative answer:
com nameserver = j.gtld-servers.net.
com nameserver = l.gtld-servers.net.
com nameserver = c.gtld-servers.net.
com nameserver = b.gtld-servers.net.
com nameserver = d.gtld-servers.net.
com nameserver = g.gtld-servers.net.
com nameserver = f.gtld-servers.net.
com nameserver = e.gtld-servers.net.
com nameserver = h.gtld-servers.net.
com nameserver = a.gtld-servers.net.
com nameserver = i.gtld-servers.net.
com nameserver = k.gtld-servers.net.
com nameserver = m.gtld-servers.net.&lt;/p&gt;
&lt;p&gt;Authoritative answers can be found from:&lt;/p&gt;
&lt;blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;ftp lftp命令比ftp好用&lt;/p&gt;
&lt;p&gt;telnet ip port 测试端口是否打开&lt;/p&gt;
&lt;p&gt;tcpdump port 22 抓包，检测网络&lt;/p&gt;
&lt;p&gt;elinks links 访问对方网站
wget 下载，可以下载整站，可以下载限制层数&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>章节3 课时 48 讲解dhclient-nmap</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-48-jiang-jie-dhclient-nmap.html" rel="alternate"></link><updated>2013-08-27T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-27:zhang-jie-3-ke-shi-48-jiang-jie-dhclient-nmap.html</id><summary type="html">&lt;p&gt;{{{
抓包图形界面
ethercal&lt;/p&gt;
&lt;p&gt;文本
tcpdump&lt;/p&gt;
&lt;p&gt;nmap -sS -P0 -o 192.168.0.1
nmap -sS -O -P0 192.168.0.254 -p 1-65535
cat /etc/services  应用程序的默认端口说明
cat /etc/protocols internet协议内容&lt;/p&gt;
&lt;p&gt;dhclient //dhcp 服务器指定&lt;/p&gt;
&lt;p&gt;dhclient -s 192.168.0.1 获取指定服务器指定的IP地址&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>章节3 课时 49 讲解autofs-nis-ruser</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-49-jiang-jie-autofs-nis-ruser.html" rel="alternate"></link><updated>2013-08-27T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-27:zhang-jie-3-ke-shi-49-jiang-jie-autofs-nis-ruser.html</id><summary type="html">&lt;p&gt;{{{
fstab 系统不启动，不能正常运行
root帐号,mount -a &lt;/p&gt;
&lt;p&gt;autofs 
/etc/auto.master /etc/auto.misc&lt;/p&gt;
&lt;p&gt;mount /dev/cdrom /misc/cd&lt;/p&gt;
&lt;p&gt;vi /etc/auto.master
   /misc /etc/auto.misc
vi /etc/auto.misc
cd  -fstype=iso9660,ro,nosuid,nodev :/dev/cdrom //cd自动加载。/misc目录下cd目录（一访问cd目录自动加载光盘),nosuid,nodev控制权限
service autofs restart
chkconfig autofs on&lt;/p&gt;
&lt;p&gt;例子：
linux   -ro,soft,intr ftp.example.org:/pub/linux
removable   -fstype=ext2  :/dev/hdd
boot    -fstype=ext2    :/dev/hda1
floppy  -fstype=auto    :/dev/fd0
floppy  -fstype=ext2    :/dev/fd0
ser1    -ro,soft,intr   192.168.0.1:/var/abc  //intr可以中断方式，soft软方式，ro只读,nfs&lt;/p&gt;
&lt;p&gt;服务器192.168.0.1：
useradd -d /rhome/shrek shrek //添加用户设置主目录/rhome/shrek
vi /etc/exports
 /rhome 192.168.0.0/255.255.255.0(rw,async)
service nfs restart&lt;/p&gt;
&lt;p&gt;另一台服务器 192.168.0.2
vi /etc/auto.master
 /rhome /etc/auto.rhome
vi /etc/auto.rhome
 *  -rw,intr,soft   192.168.0.1:/rhome/&amp;amp;&lt;/p&gt;
&lt;p&gt;service autofs restart
 chkconfig autofs on
登录192.168.0.2时，自动挂载192.168.0.1 机器上的用户主目录&lt;/p&gt;
&lt;p&gt;ls /rhome/shrek
以上配置相当于以下挂载语句
 mount -o intr,soft,rw 192.168.0.1:/rhome/shrek /rhome/shrek&lt;/p&gt;
&lt;p&gt;rpm -ql autfs
 查看文档
 man 5 autfs //查看第五号文档&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>Describe linux/gwan 网页接收与发送的最大字节数设置 here.</title><link href="http://liugehao.github.io/describe-linuxgwan-wang-ye-jie-shou-yu-fa-song-de-zui-da-zi-jie-shu-she-zhi-here.html" rel="alternate"></link><updated>2013-08-26T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-26:describe-linuxgwan-wang-ye-jie-shou-yu-fa-song-de-zui-da-zi-jie-shu-she-zhi-here.html</id><summary type="html">&lt;p&gt;更改MAX_ENTITY_SIZE的值。&lt;/p&gt;
&lt;p&gt;{{{#!highlight c
// ============================================================================
// C servlet example for the G-WAN Web Application Server (http://www.gwan.ch/)
// 
// entity_size.c: how to modify the maximum HTTP entity size accepted by G-WAN
//
//           Many production servers disable entities to avoid abuse. G-WAN so
//           far used a limit slightly larger than 4KiB.
//
//           This example shows how to modify this (server-global) limit from 
//           a servlet but this can also be done in the init() or the main()
//           calls of a connection handler:
//
//           u32 &lt;em&gt;max_entity_size = (int&lt;/em&gt;)get_env(argv, MAX_ENTITY_SIZE);
//           *max_entity_size = 200 * 1024; // new size in bytes (200 KiB)
//
//           You can change the limit at any time (even for the time a given 
//           user is connected) by using filtering in a connection handler.
//           Your servlets will decide what to do with the entity anyway so
//           you can dispose or store on disk or do real-time processing, see
//           the entity.c example.
// ============================================================================&lt;/p&gt;
&lt;h1&gt;include "gwan.h"   // G-WAN exported functions&lt;/h1&gt;
&lt;p&gt;int main(int argc, char &lt;em&gt;argv[])
{
   u32 &lt;/em&gt;old_entity_size = (u32*)get_env(argv, MAX_ENTITY_SIZE);
   u32  new_entity_size = 2 * 1024 * 1024 * 1024; // 2 MiB&lt;/p&gt;
&lt;p&gt;xbuf_xcat(get_reply(argv), 
             "&lt;pre&gt;\n"
             "Old entity size: %llk\n"
             "New entity size: %llk\n" // "New entity size: 2.00 MiB"
             "&lt;/pre&gt;",           &lt;br /&gt;
             *old_entity_size, new_entity_size);&lt;/p&gt;
&lt;p&gt;*old_entity_size = new_entity_size; // raise the limit to 2 MiB&lt;/p&gt;
&lt;p&gt;return 200; // return an HTTP code (200:'OK')
}
// ============================================================================
// End of Source Code
// ============================================================================&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>章节3 课时 41 讲解init-chkconfig</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-41-jiang-jie-init-chkconfig.html" rel="alternate"></link><updated>2013-08-26T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-26:zhang-jie-3-ke-shi-41-jiang-jie-init-chkconfig.html</id><summary type="html">&lt;p&gt;ls /sbin/init //初始化程序 ,桌面，图标，输入法加载，...
{{{
/etc/inittab //init主配置文件
  /etc/rc.d/rc.sysinit //首先访问
  /etc/rc.d/rc X
    /etc/rc.d/rcX.d/Sxxxx start(软链接/etc/rc.d/init.d/xxxx)
    /etc/rc.d/rc.local (系统开机运行程序放置位置，profile是bash启动运行程序配置）
  minigetty /dev/tty1-6
     login -&amp;gt; bash
         /etc/profile ~/.bash_profile&lt;/p&gt;
&lt;p&gt;init 5: gdm (图型界面)&lt;/p&gt;
&lt;p&gt;init 运行级别　，init $1 第一个参数如果不写，默认为９，
id:5:initdefault:  //默认进入系统　设置６不停重启　0开机后立即关机&lt;/p&gt;
&lt;p&gt;si::sysinit:/etc/init.d/rcS（rc.sysinit ）　//默认执行
 －》mount -a //用到/etc/fstab 如果此处出错，rc.sysinit出错，检测文件系统
 －》mount -o rw,remount /dev/sda2 /  //加载文件系统，scsi驱动等&lt;/p&gt;
&lt;p&gt;echo -en "\033[0;31m" aa //设成红色
echo -en "\033[0;3４m" Ｂlue Hat　//蓝色&lt;/p&gt;
&lt;p&gt;1:2345:respawn:/sbin/getty 38400 tty1
2:23:respawn:/sbin/getty 38400 tty2
3:23:respawn:/sbin/getty 38400 tty3
4:23:respawn:/sbin/getty 38400 tty4
5:23:respawn:/sbin/getty 38400 tty5
6:23:respawn:/sbin/getty 38400 tty6&lt;/p&gt;
&lt;p&gt;12:23:respawn:/usr/bin/top 一直执行top,如果停止，会重新启动&lt;/p&gt;
&lt;p&gt;respawn 进程被杀掉后会重新启动
x:5:respawn:/etc/X11/prefdm -nodaemon //运行级别５(init 5 )以respawn 方式运行prefdm ，显示图型界面&lt;/p&gt;
&lt;p&gt;init 3 (./rc 3)
/etc/rc.d/rc3.d/S&lt;em&gt; 
如果K开头的脚本开启了，init关闭K开闲脚本，启动Ｓ开关不脚本。
ls /etc/rc.d/rc3.d/&lt;/em&gt;sshd /etc/rc.d/rc5.d/*sshd
/etc/rc.d/rc3.dK25sshd /etc/rc.d/rc5.d/S55sshd&lt;/p&gt;
&lt;p&gt;ls /etc/rc.d/rc3.d/&lt;em&gt;sshd /etc/rc.d/rc5.d/&lt;/em&gt;sshd
/etc/rc.d/rc3.dK25sshd --&amp;gt;../init.d/sshd
/etc/rc.d/rc5.d/S55sshd --&amp;gt;../init.d/sshd
软链接，Ｋ开头，默认关闭，Ｓ开头默认开启&lt;/p&gt;
&lt;p&gt;开启关闭 执行　/etc/rc.d/rc 3 
时运行/etc/rc.d/rc3.d/K开头脚本 stop
/etc/rc.d/rc3.d/S开头脚本 start&lt;/p&gt;
&lt;p&gt;pf::pwoerfail 有ups时停电延时关机，
pr:12345:pwoerkwait　如果来电，停止关机&lt;/p&gt;
&lt;p&gt;更改/etc/inittab 使其生效　init q&lt;/p&gt;
&lt;p&gt;h}}}
chkconfig 更改状态
{{{
/etc/init.d/mysql8
服务启动脚本支持chkconfig 必须有如下２行，虽然是注释&lt;/p&gt;
&lt;h1&gt;chkconfig: - 55 45&lt;/h1&gt;
&lt;h1&gt;description: mysql database server.&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;默认关闭　启动顺序５５，关闭顺序４５&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;chkconfig: 35 55 45&lt;/h1&gt;
&lt;p&gt;35是指运行级别为３，５时开启&lt;/p&gt;
&lt;p&gt;chkconfig --add mysql8 //添加到启动列表　会添加软件链接/etc/rc.d/rc3.d/S55mysql8
chkconfig mysql8 off //默认不启动　会添加软件链接/etc/rc.d/rc3.d/L55mysql8
}}}&lt;/p&gt;</summary></entry><entry><title>章节3 课时 39 讲解grub-kernel-root</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-39-jiang-jie-grub-kernel-root.html" rel="alternate"></link><updated>2013-08-25T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-25:zhang-jie-3-ke-shi-39-jiang-jie-grub-kernel-root.html</id><summary type="html">&lt;p&gt;grub&amp;gt;
root (hd0,0)
kernel /vmlinuz-2.6.18-194.el5 ro root=LABEL=/ rhgb quiet
initrd /initrd-2.6.18-194.el5.img&lt;/p&gt;
&lt;p&gt;root (hd0,0) //hda,sda 是设备文件，驱动之后的设备。grub 第一个硬盘hd0,第一个分区0
kernel /vmlinuz-2.6.18-194.el5 此/指hd0,0
kernel vmlinuz-2.6.18-194.el5 root=/dev/sda2 //root=根分区,可以启动不同分区的linux
ro 只读方式，不写ro也是只读&lt;/p&gt;
&lt;p&gt;rhgb 显示图型，隐藏开机输出字符, rhel 专有。可以去掉
quite 内核安静，不显示内核信息　。可以去掉&lt;/p&gt;
&lt;p&gt;mkinitrd 打包驱动模块到initrd...img&lt;/p&gt;
&lt;p&gt;root (hd0,&lt;TAB&gt;) //可以使用tab键查看
kernel /vmli&lt;TAB&gt;
initrd /initrd-&lt;TAB&gt;
boot //输入完成后，boot启动
help
rootnoverify (hd0,3) 启动另一个bootloader(bootloader 有很多种，grub是其中一种)&lt;/p&gt;
&lt;p&gt;{{{
kernel /vmlinuz-2.6.18-194.el5 ro root=LABEL=/ rhgb quiet vga=0x314 selinux=off acpi=off hello
selinux=off(0) 不确定是off ,0
acpi 电源管理
有效参数被内核加载，如果不认识的参数，原封传给init
init 1 ／／init进入单用户模式，不需要输入密码（红旗安全模式4）
init 6 //关机
}}}&lt;/p&gt;
&lt;p&gt;default=0
timeout=5
splashimage=(hd0,0)/grub/splash.xpm.gz //显示开机图片
password --md5 $1$djfksdSFAdskajfd 
//不加md5则为明文密码，它人登录后可见
//如果按c,或e编辑，可进入单用户模式，加上密码后必须输入密码才能进单用户模式&lt;/p&gt;
&lt;p&gt;生成密码命令 grubmd5-crypt&lt;/p&gt;
&lt;p&gt;可以把密码加在title下，输入密码才可以启动系统。&lt;/p&gt;
&lt;p&gt;kernel /vmlinuz-2.6.18-194.el5 ro root=LABEL=/ init=/bin/bash
init=/bin/bash 最简启动，不启动/sbin/init,直接启动bash,省掉其它初始化&lt;/p&gt;</summary></entry><entry><title>章节3 课时 40 讲解initrd-usb-scsi</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-40-jiang-jie-initrd-usb-scsi.html" rel="alternate"></link><updated>2013-08-25T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-25:zhang-jie-3-ke-shi-40-jiang-jie-initrd-usb-scsi.html</id><summary type="html">&lt;p&gt;initrd = init ram disk &lt;/p&gt;
&lt;p&gt;grub 把kernel initrd从硬盘读出，放入内存，把引导交给kernel, 载入驱动initrd&lt;/p&gt;
&lt;p&gt;mkinitrd --with usb_mod&lt;/p&gt;
&lt;p&gt;root@x201i:/lib/modules/3.2.0-4-amd64/kernel/drivers/usb/host#
3种usb2.0驱动uhci ehci ohci&lt;/p&gt;
&lt;p&gt;加载驱动，写入到a.img镜像，内核版本号文件
mkinitrd --with uhci-hck --with usb-storage --with sd_mod --with scsi_mod /boot/a.img 2.6.18-194.el&lt;/p&gt;
&lt;p&gt;更改 /boot/grub/grub.conf
加载a.img 替换原来initrd...img&lt;/p&gt;
&lt;p&gt;initrd..img 是个压缩包，里面有很多文件&lt;/p&gt;
&lt;p&gt;.ko　文件　内核模块&lt;/p&gt;
&lt;p&gt;默认编译内核驱动模块
./configure
make
make install
如果没有make install 脚本　，
cp xxxx.ko /lib/modules/2.6.18...el5(版本号)/kernel/drivers/scsi(如果是scsi驱动)
然后执行　depmod ,扫描所有的内核驱动模块，放在注册文件中
然后可以运行mkinitrd　--with，重新生成内核驱动&lt;/p&gt;</summary></entry><entry><title>章节3 课时 34 screen文本控制台的窗口操作</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-34-screenwen-ben-kong-zhi-tai-de-chuang-kou-cao-zuo.html" rel="alternate"></link><updated>2013-08-23T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-23:zhang-jie-3-ke-shi-34-screenwen-ben-kong-zhi-tai-de-chuang-kou-cao-zuo.html</id><summary type="html">&lt;p&gt;相当于nohup 后台运行，不会因为连接断开而中断运行。但是可以恢复执行状态，切换多个进程。&lt;/p&gt;
&lt;p&gt;screen 命令　　执行运行时间长的命令，以防止网络中断　&lt;/p&gt;
&lt;p&gt;screen bash&lt;/p&gt;
&lt;p&gt;screen 直接打开screen&lt;/p&gt;
&lt;p&gt;pstree |grep screen&lt;/p&gt;
&lt;p&gt;screen -r  恢复到原来的任务&lt;/p&gt;
&lt;p&gt;screen -dr 终止连接退回bash　，但不中止程序运行.&lt;/p&gt;
&lt;p&gt;screen -r pid 多个screen时恢复到指定的screen&lt;/p&gt;
&lt;p&gt;在screen中，CTRL+a ，开一个新的screen窗体。&lt;/p&gt;
&lt;p&gt;screen -x 恢复到最近断开的screen&lt;/p&gt;
&lt;p&gt;pstree | grep -A2 -B2 screen 查看screen以及上下２行&lt;/p&gt;
&lt;p&gt;在一个screen中，CTRL+a 按下n，在多个窗口中切换&lt;/p&gt;
&lt;p&gt;在screen中，CTRL+a　c 打开新窗口&lt;/p&gt;
&lt;p&gt;screen CTRL +a d 退出screen 用-r 恢复&lt;/p&gt;
&lt;p&gt;在screen中bash中exit后，如此此screen中没有了窗口，　-r 连接不上，可以杀掉此screen进程&lt;/p&gt;
&lt;p&gt;screen CTRL+a \ 后　屏幕没反应，过一会回到最初bash （杀掉了自己）　&lt;/p&gt;</summary></entry><entry><title>章节3 课时 35 讲解syslog</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-35-jiang-jie-syslog.html" rel="alternate"></link><updated>2013-08-23T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-23:zhang-jie-3-ke-shi-35-jiang-jie-syslog.html</id><summary type="html">&lt;p&gt;tail -f /var/log/messages messages是程序首选信息输出。监视messages, 服务有问题，服务启动有问题　，首先看messages&lt;/p&gt;
&lt;p&gt;相似的，如果邮件出不去　，查看地邮件日志 /var/log/maillog&lt;/p&gt;
&lt;p&gt;apache /var/log/httpd/error_log &lt;/p&gt;
&lt;p&gt;syslog 有２个组件 klogd syslogd&lt;/p&gt;
&lt;p&gt;klogd kernel日志,kernel 直接写日志　通过dmesg看日志缓存
{{{
dmesg　当前缓存
cat /var/log/dmesg 缓存写到文件中
}}}
syslogd &lt;/p&gt;
&lt;p&gt;klogd man 2 syslog&lt;/p&gt;
&lt;p&gt;syslogd 配置文件 /etc/syslog.conf&lt;/p&gt;
&lt;p&gt;syslogd man 3 syslog&lt;/p&gt;
&lt;p&gt;syslogd,klogd 共同配置文件　/etc/sysconfig/syslog&lt;/p&gt;
&lt;p&gt;syslog库，syslogd服务
/etc/syslog.conf&lt;/p&gt;
&lt;p&gt;authpriv.*   /var/log/secure&lt;/p&gt;
&lt;p&gt;内容.级别　　写到哪个文件&lt;/p&gt;
&lt;p&gt;*.info;mail.none;authpriv.none;cron.none /var/log/messages
所有的info及以上级别日志，除了mail.none... 与到messages&lt;/p&gt;
&lt;p&gt;'''日志写入：'''
{{{
root@x201i:/home/l# logger " &lt;code&gt;date&lt;/code&gt; backup finish ....."
root@x201i:/home/l# tail -1 /var/log/messages
Aug 23 11:11:57 x201i l:  Fri Aug 23 11:11:57 CST 2013 backup finish .....
}}}&lt;/p&gt;
&lt;p&gt;'''可以远程日志'''&lt;/p&gt;
&lt;p&gt;'''不要把大量的日志，写入到日志服务器（或者应用程序日志）
紧急、报警日志写到日志服务器'''
syslogd -r &lt;/p&gt;
&lt;p&gt;日志服务器 192.168.0.1 
{{{
vi /etc/sysconfig/syslog
SYSLOGD_OPTIONS="-m 0 -r"  #-m 0 不进行mark
service syslogd restart
}}}&lt;/p&gt;
&lt;p&gt;服务器１　/etc/syslog.conf
*.alert @192.168.0.1
logwatch
netstat --antup&lt;/p&gt;</summary></entry><entry><title>章节3 课时 36 讲解cron-anacron</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-36-jiang-jie-cron-anacron.html" rel="alternate"></link><updated>2013-08-23T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-23:zhang-jie-3-ke-shi-36-jiang-jie-cron-anacron.html</id><summary type="html">&lt;p&gt;atd 简单的，轻量级，可控性小
chkconfig adt off 关闭
//只执行一次的任务，使用率不高&lt;/p&gt;
&lt;h1&gt;at 12:00&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;echo '12' 
CTRL +d&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;crond 
 * crond
  cron 
  i. 用户执行 crontab -e
    /var/spool/cron 保存用户cron配置,文件名为
    crontab -u shrek -e //root 可更改其它用户cron
    crontab -e 
    前五个位置放时间：分钟　小时　日　月　周　命令
    1 5 * * * dump -3uf /tmp/boot.dump /boot //每天５点１分执行备份,或者使用tar。'''dump可以识别分区　dump -3uf /tmp/boot.dump /dev/boot. dump 可以增量备份'''
    0uf 完整备份文件　3uf 增量备份　4uf 对３的增量　
    每天都做3uf 差量备份，&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="mi"&gt;0u&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="mi"&gt;1u&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="mi"&gt;2u&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="mi"&gt;3u&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="mi"&gt;4u&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="err"&gt;每一天的差量备份，恢复时间增加（按顺序一个一个恢复）。&lt;/span&gt;

&lt;span class="mi"&gt;31&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="n"&gt;dump&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0u&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mnt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt; &lt;span class="o"&gt;+%&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dump&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;boot&lt;/span&gt; 
&lt;span class="err"&gt;每周日备份一次完整的&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;boot&lt;/span&gt;&lt;span class="err"&gt;到磁盘，最后每个月保留一个备份文件&lt;/span&gt;

&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="err"&gt;*/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="n"&gt;lover&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;txt&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;mail&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;i miss you again `date`&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;周一到周五，每隔２小时发一封邮件&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;i. 系统执行 /etc/cron.d/&lt;em&gt;
    /etc/cron. 下保存系统cron
    /etc/crontab 配置文件
    {{{
    01 *    * &lt;/em&gt; *   root    run-parts /etc/cron.hourly
    #root 以root用户执行，run-parts 执行/etc/cron.hourly目录下所有文件
    #要考虑权限问题，可执行，用户环境变量等&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="mi"&gt;25&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;   &lt;span class="n"&gt;root&lt;/span&gt;    &lt;span class="n"&gt;test&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sbin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;anacron&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;parts&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cron&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;daily&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;47&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;   &lt;span class="n"&gt;root&lt;/span&gt;    &lt;span class="n"&gt;test&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sbin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;anacron&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;parts&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cron&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;weekly&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;52&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;    &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;   &lt;span class="n"&gt;root&lt;/span&gt;    &lt;span class="n"&gt;test&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sbin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;anacron&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;parts&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cron&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;monthly&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;span class="n"&gt;sysstat&lt;/span&gt; &lt;span class="err"&gt;包，安装后可用每１０分钟执行　可用&lt;/span&gt;&lt;span class="n"&gt;sar&lt;/span&gt;&lt;span class="err"&gt;查看系统状态&lt;/span&gt;
&lt;span class="n"&gt;vi&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cron&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sa&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="err"&gt;　&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="c1"&gt;//每几个小时，或者每几分钟执行&lt;/span&gt;
&lt;span class="c1"&gt;// 该文件权限一定要 -rw---　600,非周期执行&lt;/span&gt;
&lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;root&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;share&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;spamassassin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sa&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cron&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;tee&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sa&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;
&lt;span class="c1"&gt;//每天４点１０分执行脚本&lt;/span&gt;

&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cron&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;daily&lt;/span&gt; &lt;span class="err"&gt;用得最多的&lt;/span&gt;
&lt;span class="n"&gt;tmpwatch&lt;/span&gt; &lt;span class="err"&gt;删除&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="err"&gt;目录下１０天没用的&lt;/span&gt;
&lt;span class="n"&gt;logrotate&lt;/span&gt; &lt;span class="err"&gt;截断日志&lt;/span&gt;
&lt;span class="n"&gt;mlocate&lt;/span&gt;&lt;span class="err"&gt;　执行&lt;/span&gt;&lt;span class="n"&gt;updatedb&lt;/span&gt;

&lt;span class="n"&gt;which&lt;/span&gt; &lt;span class="n"&gt;ls&lt;/span&gt; &lt;span class="err"&gt;查找可执行文件&lt;/span&gt;
&lt;span class="n"&gt;locate&lt;/span&gt; &lt;span class="n"&gt;shadow&lt;/span&gt; &lt;span class="err"&gt;查找所有文件　，正则表达式&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;shadow&lt;/span&gt;&lt;span class="err"&gt;$&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;updatedb&lt;/span&gt; &lt;span class="err"&gt;把所有文件查找一遍存储文件&lt;/span&gt;

   &lt;span class="c1"&gt;//system&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;anacrond
  会把以前没有执行的计划补回来,比如每点４点执行的程序，因为每天晚上关机，所以开机会补&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>章节3 课时 37 讲解cups-setenforcing</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-37-jiang-jie-cups-setenforcing.html" rel="alternate"></link><updated>2013-08-23T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-23:zhang-jie-3-ke-shi-37-jiang-jie-cups-setenforcing.html</id><summary type="html">&lt;p&gt;cups 通用unix打印系统，响应本机或者外界打印&lt;/p&gt;
&lt;p&gt;chkconfig --list cups 查看是否运行服务&lt;/p&gt;
&lt;p&gt;chkconfig --list |grep cups &lt;/p&gt;
&lt;p&gt;lpd 老式打印系统，&lt;/p&gt;
&lt;p&gt;cups 有收费版本，为了兼容lpd，有服务cpus-ltd&lt;/p&gt;
&lt;p&gt;system-config-printer 配置打印机&lt;/p&gt;
&lt;p&gt;system-config--....
{{{
seLinux &lt;/p&gt;
&lt;h1&gt;getenforce&lt;/h1&gt;
&lt;p&gt;Permissive&lt;/p&gt;
&lt;h1&gt;setenforce 0 //半闭selinux&lt;/h1&gt;
&lt;h1&gt;getenforce&lt;/h1&gt;
&lt;p&gt;Enforcing&lt;/p&gt;
&lt;p&gt;//永久关闭selinux
vi /etc/selinux/config
SELINUX=disabled&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;LANG= 回车，语言改成默认英文&lt;/p&gt;</summary></entry><entry><title>章节3 课时 38 讲解grub-grub-troubleshooting</title><link href="http://liugehao.github.io/zhang-jie-3-ke-shi-38-jiang-jie-grub-grub-troubleshooting.html" rel="alternate"></link><updated>2013-08-23T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-23:zhang-jie-3-ke-shi-38-jiang-jie-grub-grub-troubleshooting.html</id><summary type="html">&lt;p&gt;开机过程
BIOS--&amp;gt;Bootloader --&amp;gt; Kernel--&amp;gt; init --&amp;gt; service --&amp;gt; login --&amp;gt; bash&lt;/p&gt;
&lt;p&gt;智能手机
Bootloader(bios+bootloader)-&amp;gt;Kernel-&amp;gt;&lt;/p&gt;
&lt;p&gt;window xp bootloader ntldr
boot.ini 引导多个windows&lt;/p&gt;
&lt;p&gt;sector 512byte
 446 MBR
  64 DPT
   2 55AA&lt;/p&gt;
&lt;p&gt;/boot/grub/stage1 512byte　//出问题，硬盘不可引导
 /boot/grub/stage1_5_ext3 　　//出问题，屏幕出到“GRUB ”无反应，或者屏幕不停刷gurb
 上面２个已经写入硬盘最前面
 /boot/grub/stage2 写在分区里，不可删除，如果删除系统无法启动&lt;/p&gt;
&lt;p&gt;／boot/grub/grub.conf 如果手工编译grub的话文件名为：1stmenu&lt;/p&gt;
&lt;p&gt;''' 修复'''
stage1 stage1_5出问题
grub-install /dev/sda&lt;/p&gt;
&lt;p&gt;stage5出问题　，光盘启动　linux rescue
chroot /mnt/sysimage //默认要分区挂载位置
rpm -ivh grub....&lt;/p&gt;
&lt;p&gt;grub.conf(1stmenu)找不到,
grub&amp;gt;  //手动方式引导&lt;/p&gt;</summary></entry><entry><title>Describe linux/gwan g-wan keyvalue store zlib base64 here.</title><link href="http://liugehao.github.io/describe-linuxgwan-g-wan-keyvalue-store-zlib-base64-here.html" rel="alternate"></link><updated>2013-08-22T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-22:describe-linuxgwan-g-wan-keyvalue-store-zlib-base64-here.html</id><summary type="html">&lt;p&gt;requests post数据时，进行了escape, 所以在http服务器端要unescape才是原数据。&lt;/p&gt;
&lt;p&gt;file kv4.c
{{{#!highlight c&lt;/p&gt;
&lt;h1&gt;include "gwan.h" // G-WAN exported functions&lt;/h1&gt;
&lt;h1&gt;include &lt;malloc.h&gt;&lt;/h1&gt;
&lt;h1&gt;include &lt;string.h&gt;&lt;/h1&gt;
&lt;h1&gt;include &lt;stdlib.h&gt;&lt;/h1&gt;
&lt;h1&gt;include &lt;base64.c&gt;&lt;/h1&gt;
&lt;p&gt;typedef struct record_s // this is a user-defined 'record' structure
{
    char *content; 
    u64 tm;
} record_t;&lt;/p&gt;
&lt;p&gt;int main(int argc, char &lt;em&gt;argv[])
{
    xbuf_t &lt;/em&gt;reply = get_reply(argv);
    char &lt;em&gt;act="", &lt;/em&gt;content="", *tm="";&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nx"&gt;get_arg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;act=&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;act&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nx"&gt;get_arg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;content=&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nb"&gt;content&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nx"&gt;get_arg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;txm=&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;tm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;






&lt;span class="nx"&gt;kv_t&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;vhost_ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;kv_t&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="nx"&gt;get_env&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;US_VHOST_DATA&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="c1"&gt;//persistent ptr&lt;/span&gt;
&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;forum_store&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;//convenience pointer (var-&amp;gt;m instead of (*var)-&amp;gt;m)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;vhost_ptr&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;!*&lt;/span&gt;&lt;span class="nx"&gt;vhost_ptr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;vhost_ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;kv_t&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="nx"&gt;malloc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;kv_t&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="nx"&gt;kv_init&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;vhost_ptr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;users&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt; 
&lt;span class="n"&gt;forum_store&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;vhost_ptr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;



&lt;span class="nx"&gt;u64&lt;/span&gt; &lt;span class="n"&gt;txm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;atof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;tm&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;act&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;xbuf_xcat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;reply&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n\n&lt;/span&gt;&lt;span class="s2"&gt;%s %s %llu&amp;lt;br&amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;act&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;content&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;txm&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;kv_item&lt;/span&gt; &lt;span class="nb"&gt;item&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;record_t&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;record&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="c1"&gt;//printf(&amp;quot;before unescape:%d\n&amp;quot;,strlen(content));&lt;/span&gt;
    &lt;span class="nx"&gt;unescape_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;content&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="c1"&gt;//printf(&amp;quot;unescaped:%d\n&amp;quot;,strlen(content));&lt;/span&gt;
    &lt;span class="c1"&gt;//char tmp[strlen(content)];&lt;/span&gt;
    &lt;span class="c1"&gt;//printf(&amp;quot;content:%s\n&amp;quot;, content);&lt;/span&gt;

    &lt;span class="c1"&gt;//base64_decode(tmp, content, strlen(content));&lt;/span&gt;

    &lt;span class="c1"&gt;//printf(&amp;quot;content(tmp):%s\n&amp;quot;, tmp);&lt;/span&gt;
    &lt;span class="n"&gt;record&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;record_t&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="nx"&gt;malloc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;record_t&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="nx"&gt;record&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="nb"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;char&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="nx"&gt;strdup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;content&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;//content ,tmp&lt;/span&gt;
    &lt;span class="nx"&gt;record&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;tm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;txm&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="c1"&gt;//printf(&amp;quot;bin len:%d\n&amp;quot;, strlen(record-&amp;gt;content));&lt;/span&gt;
    &lt;span class="n"&gt;item.key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;record&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;tm&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;item.klen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;u64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="c1"&gt;//sizeof(str) - 1; // faster&lt;/span&gt;
    &lt;span class="n"&gt;item.val&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;char&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="nx"&gt;record&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;item.flags&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;kv_add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;forum_store&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nb"&gt;item&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;// add an entry to the name_dat Store index&lt;/span&gt;

&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;act&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;g&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;

    &lt;span class="nx"&gt;record_t&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;record&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;record_t&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="nx"&gt;kv_get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;forum_store&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;txm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;u64&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="nx"&gt;xbuf_xcat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;reply&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="nx"&gt;record&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="nx"&gt;record&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="nb"&gt;content&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;not found&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="p"&gt;}&lt;/span&gt;


&lt;span class="c1"&gt;//xbuf_xcat(reply, &amp;quot;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Count&amp;lt;/b&amp;gt;: %d key(s) in KV store&amp;lt;br&amp;gt;&amp;quot;,&lt;/span&gt;
&lt;span class="c1"&gt;//            forum_store-&amp;gt;nbr_items);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;return 200; // return an HTTP code (200:'OK')&lt;/p&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;}}}
python file:
{{{#!highlight python&lt;/p&gt;
&lt;h1&gt;!/usr/bin/env python&lt;/h1&gt;
&lt;h1&gt;-&lt;em&gt;- coding: utf-8 -&lt;/em&gt;-&lt;/h1&gt;
&lt;p&gt;import MySQLdb, zlib, requests, os, base64&lt;/p&gt;
&lt;p&gt;conn = MySQLdb.connect(host='127.0.0.1', user='root', passwd='liuyou', db='base')
cur1 =conn.cursor()&lt;/p&gt;
&lt;h1&gt;cur1.execute("select distinct tm from smi limit 1000000;")&lt;/h1&gt;
&lt;p&gt;tmp = "".join(os.popen('mysql -h localhost -uroot -pliuyou base --execute="select * from smi limit 10000,10"', 'r').readlines()[1:])
tmp = tmp.replace("\t0\t","\t\t").replace("\t0\t","\t\t").replace("\t0.0000\t","\t\t").replace("0000-00-00 00:00:00","")
tmp = zlib.compress(tmp, 9)
"""
print "\n%s\n" % tmp
tmp1 = zlib.compress(tmp, 9)
print "\n%s\n" % tmp1
tmp = base64.b64encode(tmp1)
print "\n%s\n" % tmp
print zlib.decompress(base64.b64decode(tmp))&lt;/p&gt;
&lt;h1&gt;tmp = zlib.compress(tmp, 9)&lt;/h1&gt;
&lt;h1&gt;tmp = zlib.compress(str(os.popen('mysql -h localhost -uroot -pliuyou base --execute="select * from smi limit 10000,10"', 'r').readlines()[1:]))&lt;/h1&gt;
&lt;p&gt;"""&lt;/p&gt;
&lt;h1&gt;while 1:&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#row = cur1.fetchone()&lt;/span&gt;
&lt;span class="c"&gt;#if row is None:&lt;/span&gt;
&lt;span class="c"&gt;#    break&lt;/span&gt;
&lt;span class="c"&gt;#print row[0]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;for i in xrange(1,100000):
    print i,len(tmp)
    requests.post("http://127.0.0.1:8080/?kv4.c&amp;amp;act=a&amp;amp;txm=%d" % i, data={
        "content": tmp
    },timeout=3 , verify=False)
}}}&lt;/p&gt;
&lt;p&gt;base64.c
{{{#!highlight c&lt;/p&gt;
&lt;h1&gt;include &lt;string.h&gt;&lt;/h1&gt;
&lt;p&gt;char b64string[] =
    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";&lt;/p&gt;
&lt;p&gt;long base64_encode (to, from, len)
    char &lt;em&gt;to, &lt;/em&gt;from;
    unsigned int len;
{
    char &lt;em&gt;fromp = from;
    char &lt;/em&gt;top = to;
    unsigned char cbyte;
    unsigned char obyte;
    char end[3];&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(;&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fromp&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b64string&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)];&lt;/span&gt;
    &lt;span class="n"&gt;obyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x30&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;        &lt;span class="cm"&gt;/* 0011 0000 */&lt;/span&gt;

    &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fromp&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;obyte&lt;/span&gt; &lt;span class="o"&gt;|=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;          &lt;span class="cm"&gt;/* 0000 1111 */&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b64string&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;obyte&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;obyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x3C&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;        &lt;span class="cm"&gt;/* 0011 1100 */&lt;/span&gt;

    &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fromp&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;obyte&lt;/span&gt; &lt;span class="o"&gt;|=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;          &lt;span class="cm"&gt;/* 0000 0011 */&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b64string&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;obyte&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b64string&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x3F&lt;/span&gt;&lt;span class="p"&gt;)];&lt;/span&gt;&lt;span class="cm"&gt;/* 0011 1111 */&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fromp&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fromp&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b64string&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)];&lt;/span&gt;
    &lt;span class="n"&gt;obyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x30&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;        &lt;span class="cm"&gt;/* 0011 0000 */&lt;/span&gt;

    &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;obyte&lt;/span&gt; &lt;span class="o"&gt;|=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b64string&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;obyte&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;obyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x3C&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;        &lt;span class="cm"&gt;/* 0011 1100 */&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b64string&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;obyte&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;top&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;/&lt;em&gt; badchar(): check if c is decent; puts either the &lt;/em&gt;/
/&lt;em&gt; location of c or null into p.                  &lt;/em&gt;/&lt;/p&gt;
&lt;h1&gt;define badchar(c,p) (!(p = memchr(b64string, c, 64)))&lt;/h1&gt;
&lt;p&gt;long base64_decode (to, from, len)
    char &lt;em&gt;to, &lt;/em&gt;from;
    unsigned int len;
{
    char &lt;em&gt;fromp = from;
    char &lt;/em&gt;top = to;
    char *p;
    unsigned char cbyte;
    unsigned char obyte;
    int padding = 0;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(;&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fromp&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;badchar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;b64string&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;obyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;     &lt;span class="cm"&gt;/* 1111 1100 */&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fromp&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;badchar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;b64string&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;obyte&lt;/span&gt; &lt;span class="o"&gt;|=&lt;/span&gt; &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;        &lt;span class="cm"&gt;/* 0000 0011 */&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;obyte&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;obyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;     &lt;span class="cm"&gt;/* 1111 0000 */&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fromp&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;padding&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;badchar&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;b64string&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;obyte&lt;/span&gt; &lt;span class="o"&gt;|=&lt;/span&gt; &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;        &lt;span class="cm"&gt;/* 0000 1111 */&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;obyte&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;obyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;     &lt;span class="cm"&gt;/* 1100 0000 */&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fromp&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;padding&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;badchar&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cbyte&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;cbyte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;b64string&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;obyte&lt;/span&gt; &lt;span class="o"&gt;|=&lt;/span&gt; &lt;span class="n"&gt;cbyte&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;         &lt;span class="cm"&gt;/* 0011 1111 */&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;obyte&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>Describe linux/rhce视频/31-33 终端 sudo autologin respawn terminal here.</title><link href="http://liugehao.github.io/describe-linuxrhceshi-pin-31-33-zhong-duan-sudo-autologin-respawn-terminal-here.html" rel="alternate"></link><updated>2013-08-21T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-21:describe-linuxrhceshi-pin-31-33-zhong-duan-sudo-autologin-respawn-terminal-here.html</id><summary type="html">&lt;p&gt;== 31 tty pts ttys0 terminal ==&lt;/p&gt;
&lt;p&gt;tty1 tty2 tty3 ...虚拟控制台&lt;/p&gt;
&lt;p&gt;/dev/ttyS0 com口&lt;/p&gt;
&lt;p&gt;pstree 命令查看进程树时，所有进程的父进程为init(/etc/inittab)&lt;/p&gt;
&lt;p&gt;运行级别为2345时&lt;/p&gt;
&lt;p&gt;respawn 反复打开子进程 ,如果它监视的子进程被关闭，会自动启动&lt;/p&gt;
&lt;p&gt;运行/sbin/mingetty 打开虚拟控制台&lt;/p&gt;
&lt;h1&gt;/sbin/mingetty tty12 //执行此命令后，准备好tty12控制台&lt;/h1&gt;
&lt;p&gt;/sbin/agetty ttyS0 //com&lt;/p&gt;
&lt;p&gt;xwindows下终端，伪终端 pts/0&lt;/p&gt;
&lt;p&gt;/dev/pts/ 多伪终端一个登录，多一个文件&lt;/p&gt;
&lt;p&gt;skill -9 pts/2 //杀掉进程及子进程&lt;/p&gt;
&lt;p&gt;== 32 讲解autologin-respawn　==
x:5:respawnn:/etc/X11/prefdm --nodaemon #gdm kdm xdm
 图形界面&lt;/p&gt;
&lt;p&gt;6a:2345:respawn:/sbin/mingetty tty10 --autologin shrek 
 自动登录,F10控制台, exit后又重新登录&lt;/p&gt;
&lt;p&gt;init q 
 重载/etc/inittab&lt;/p&gt;
&lt;p&gt;== 33 用户权限体系及sudo ==
dd &amp;lt; /dev/zero &amp;gt; /dev/sda 硬盘用０填充，数据没有了，也恢复不了&lt;/p&gt;
&lt;p&gt;dd &amp;lt; /dev/zero &amp;gt; /tmp/aa  用０填充aa文件&lt;/p&gt;
&lt;p&gt;相当于 dd if=/dev/zero of /tmp/aa&lt;/p&gt;
&lt;p&gt;visudo 命令实际是编辑/etc/sudo文件&lt;/p&gt;
&lt;p&gt;命令别名，一组命令&lt;/p&gt;
&lt;p&gt;主机别名，一些主机&lt;/p&gt;
&lt;p&gt;....&lt;/p&gt;
&lt;p&gt;shrek ALL = /bin/hostname //shrek用户从所有地方来，可以运行hostname&lt;/p&gt;
&lt;p&gt;%shrek ALL = /bin/hostname //%开头用户组&lt;/p&gt;
&lt;p&gt;shrek ALL = NOPASSWD: /sbin/hostname //不用输入密码&lt;/p&gt;</summary></entry><entry><title>Describe linux/vi上下左右键变abcd .bashrc here.</title><link href="http://liugehao.github.io/describe-linuxvishang-xia-zuo-you-jian-bian-abcd-bashrc-here.html" rel="alternate"></link><updated>2013-08-21T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-21:describe-linuxvishang-xia-zuo-you-jian-bian-abcd-bashrc-here.html</id><summary type="html">&lt;p&gt;ubuntu使用的是默认的vim-tiny，那么你可以在终端中输入如下命令：
{{{
export TERM=linux
}}}
'''terminal 类型位于 /usr/share/terminfo目录下'''&lt;/p&gt;
&lt;p&gt;这样可以解决上下左右键变成ABCD这些，ubuntu11.04默认的是TERM=xterm，你可以使用echo $term来查看一下。如果不是最新的11.4，上述操作不能成功的话，尝试使用export TERM=vt100试试。&lt;/p&gt;
&lt;p&gt;如果你安装过了vim，那么找到vimrc_example.vim拷贝的用户目录下，改名为.vimrc。&lt;/p&gt;
&lt;p&gt;==== 最好方案 ====
{{{
apt-get isntall vim
}}}&lt;/p&gt;</summary></entry><entry><title>mysql mysqldump 导出 csv 数据</title><link href="http://liugehao.github.io/mysql-mysqldump-dao-chu-csv-shu-ju.html" rel="alternate"></link><updated>2013-08-20T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-20:mysql-mysqldump-dao-chu-csv-shu-ju.html</id><summary type="html">&lt;ul&gt;
&lt;li&gt;导出本地数据库数据到本地文件
 {{{#!highlight sql
  mysql -A service_db -h your_host -utest -ptest&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;mysql&amp;gt; select * from t_apps where created&amp;gt;'2012-07-02 00:00:00' into outfile /tmp/apps.csv
 }}}&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;导出远程数据库数据到本地文件
 {{{#!highlight sql
  mysql -A service_db -h your_host -utest -ptest -ss -e "SELECT * from t_apps limit 300;" | sed 's/\t/","/g;s/^/"/;s/$/"/;s/\n//g' &amp;gt; apps.csv
 }}}
 (sed部分可略,尤其是处理包含汉字的数据时. 如果内容包含中文,可在select语句前加入set names utf8;)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使用mysqldump导出远程或本地数据到本地文件
 {{{#!highlight sql
  mysqldump -h your_host -utest -ptest -w "id&amp;lt;300" service_db t_apps &amp;gt; tt.sql
 }}}
 如果只导数据加上 -t or --no-create- info ;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如果只导结构加上 -d or --no-data;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;mysqldump不能指定导出的列,变通方法如下:
 {{{#!highlight sql
  mysql -u USERNAME --password=PASSWORD --database=DATABASE --execute='SELECT &lt;code&gt;FIELD&lt;/code&gt;, &lt;code&gt;FIELD&lt;/code&gt; FROM &lt;code&gt;TABLE&lt;/code&gt; LIMIT 0, 10000 '  &amp;gt; file.csv
 }}}
 -X 导出xml&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>Describe linux/bash 笔记 here.</title><link href="http://liugehao.github.io/describe-linuxbash-bi-ji-here.html" rel="alternate"></link><updated>2013-08-17T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-17:describe-linuxbash-bi-ji-here.html</id><summary type="html">&lt;p&gt;=== 命令组合 ===
 ||管道|| | ||
 ||&amp;lt;|4&amp;gt;重定向|| &amp;lt; 重定向输入。指定文件读取数据，而不是键盘输入||
 ||&amp;gt; &amp;gt;&amp;gt; 重定向输出。将输出结果覆盖、追加到指定文件 ||
 ||2&amp;gt; 2&amp;gt;&amp;gt; 标准错误输出。　结果覆盖、追加到指定文件||
 ||&amp;amp;&amp;gt; &amp;amp;&amp;gt;&amp;gt; 将标准输出和错误信息覆盖、追加到指定文件 ||&lt;/p&gt;
&lt;p&gt;下面２条相同结果
{{{
find / -name shrek &amp;gt; /tmp/find 2&amp;gt;&amp;amp;1
find / -name shrek &amp;amp;&amp;gt; /tmp/find 
cat &amp;lt;&amp;lt; EEE
skjdf
sfd
EEE(^D)&lt;/p&gt;
&lt;p&gt;}}}
 多条命令的逻辑关系
 || 逻辑与 ||&amp;amp;&amp;amp; 语名都执行成功。前面成功，执行后面的。如果前面失败，后面的不执行。||
 ||逻辑或 ||　｜｜ 前面成功不执行后面。前面失败，执行后面的。||
 ||逻辑分隔||；　按顺序执行多条语句 ||
===　3 变量 ===&lt;/p&gt;
&lt;p&gt;环境变量，系统变量，用户变量.__env__查看所有变量
 || 双引号 || " ||　允许引用、转义\ ||
 ||单引号 ||'|| 不允许引用、转义||
 ||反撇号 ||` $() ||以命令输出替换||&lt;/p&gt;
&lt;p&gt;|| $? || 前一条命令状态值　０为正常，其它为出错  ||
 || $０ || 脚本自身程序名  ||
 || $１－９ || 命令的１－９个参数  ||
 || $* || 命令行所有参数的内容  ||
 || $# || 命令行所有参数的个数  ||
{{{&lt;/p&gt;
&lt;h1&gt;./t.sh abc def //输入 #?２个参数，第一个$1 abc，第二个$2是def #*是abc def&lt;/h1&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;=== 数值运算及处理 ===
'''expr''' expr 数值１　运算符　数值２
'''$[]'''  $[数值１　运算符　数值２]
{{{
expr 2 + 3
expr 2 - 3
expr 2 * 3  *号是bash通配符，需转义
expr 2 / 3
x = 2;y =3;
echo $[ 3 * 3] 不需转义
echo $[x * y]
expr $x * $y
}}}&lt;/p&gt;
&lt;p&gt;let 变量名++、let 变量名-- 
{{{
x = 4
let x++;echo $x
let x+=2; echo $x
}}}
随机数
random 变量　
{{{
echo $RANDOM 默认范围0-32767
echo $[RANDOM % 100] 0-100
}}}
生成数字序列　
seq 首数　末数　#从１开始，首数可省略
{{{&lt;/p&gt;
&lt;h1&gt;seq 3&lt;/h1&gt;
&lt;p&gt;1
2
3&lt;/p&gt;
&lt;h1&gt;seq 3 5&lt;/h1&gt;
&lt;p&gt;3
4
5
}}}
seq 首数 增量 末数
{{{&lt;/p&gt;
&lt;h1&gt;seq 3 2 10&lt;/h1&gt;
&lt;p&gt;3
5
7
9
}}}&lt;/p&gt;
&lt;p&gt;小数运算
将计算交给'''bc'''
{{{
echo "34.3 - 3.4" | bc
echo "scale=4;10/3" | bc #scale　限制小数位数
}}}&lt;/p&gt;
&lt;p&gt;=== 字符串截取 ===&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;目录命令
  . dirname 路径　不包括文件名或者最后的目录名
  . basenme 文件名或者最后的路径名
    {{{
    #Var1 = "/etc/nginx/nginx.conf"
    #dirname $Var1
    /etc/nginx
    #basename $Var1
    nginx.conf
    }}}&lt;/li&gt;
&lt;li&gt;字符串替换
  . expr substr $var1 开始位置 截取长度 //起始位置从１开始
  . ${变量名称:起始位置:截取长度}  //起始位置从0开始
  . 
{{{&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Var1 = "0123456739"&lt;/h1&gt;
&lt;h1&gt;expr substr 4 3&lt;/h1&gt;
&lt;p&gt;456&lt;/p&gt;
&lt;h1 Var:4:3="Var:4:3"&gt;echo $&lt;/h1&gt;
&lt;p&gt;567&lt;/p&gt;
&lt;h1&gt;echo ${Var::3} //从开头取&lt;/h1&gt;
&lt;p&gt;123
}}}
  . ${Var1/3/0} //第一个３替换同成０
  . ${Var1//3/0}　//所有的３都替换成０
}}}
 * 随机字符串
  . 从/dev/urandom 获取随机字符（有可能乱码），能过/usr/bin/md5sum 生成纯ascii字符，再通过/usr/bin/cut截取固定长度的字符。cat urandom会一直出字符，只取第一行生成md5
    {{{
　　　head -1 /dev/urandom | md5sum
      echo $var1 | cut -b 起始位置-结束位置 //开头字符可省略 cut -b -5；最后８个字符时，cut -b 18-
      head-1 /dev/urandom |md5sum |cut -b -8 //取８个随机字符
    }}}&lt;/p&gt;
&lt;p&gt;=== 17 输入输出管道及重定向 ===&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;过滤器命令&lt;/span&gt;
&lt;span class="err"&gt;输入输出重定向&lt;/span&gt;
&lt;span class="err"&gt;输入源　输出到屏幕　&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="n"&gt;ls&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="err"&gt;标准正确输出&lt;/span&gt;
&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="err"&gt;标准错误输出&lt;/span&gt;

&lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="err"&gt;编写文件　Ｃ&lt;/span&gt;&lt;span class="n"&gt;trl&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="err"&gt;结束&lt;/span&gt;
&lt;span class="err"&gt;下面２条相同结果&lt;/span&gt;
&lt;span class="p"&gt;{{{&lt;/span&gt;
&lt;span class="n"&gt;find&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="n"&gt;shrek&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;find&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="n"&gt;shrek&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt; 
&lt;span class="p"&gt;}}}&lt;/span&gt;

&lt;span class="err"&gt;编辑器　&lt;/span&gt;&lt;span class="n"&gt;vi&lt;/span&gt;

&lt;span class="p"&gt;{{{&lt;/span&gt;
&lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;EEE&lt;/span&gt;
&lt;span class="n"&gt;skjdf&lt;/span&gt;
&lt;span class="n"&gt;sfd&lt;/span&gt;
&lt;span class="n"&gt;EEE&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;D&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;span class="err"&gt;写入&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;txt&lt;/span&gt;
&lt;span class="p"&gt;{{{&lt;/span&gt;
&lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;txt&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;EEE&lt;/span&gt;
&lt;span class="n"&gt;sdfsd&lt;/span&gt;
&lt;span class="n"&gt;sfd&lt;/span&gt;
&lt;span class="n"&gt;EEE&lt;/span&gt;
&lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;span class="n"&gt;tr&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;a-z&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;A-Z&amp;quot;&lt;/span&gt; &lt;span class="err"&gt;小写变大写&lt;/span&gt;
&lt;span class="p"&gt;{{{&lt;/span&gt;
&lt;span class="n"&gt;tr&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;a-z&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;A-Z&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;passwd&lt;/span&gt;

&lt;span class="n"&gt;ls&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etcl&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;grep&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;wc&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;
&lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;span class="err"&gt;在管道使用的时候，复制一份，&lt;/span&gt;&lt;span class="n"&gt;tee&lt;/span&gt; &lt;span class="err"&gt;。比如想看下中间结果&lt;/span&gt;
&lt;span class="p"&gt;{{{&lt;/span&gt;
&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;x201i&lt;/span&gt;&lt;span class="o"&gt;:~&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;ll&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;grep&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;tee&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;wc&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;
&lt;span class="n"&gt;total&lt;/span&gt; &lt;span class="mi"&gt;512304&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rwxr&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;xr&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;    &lt;span class="mi"&gt;221287&lt;/span&gt; &lt;span class="n"&gt;Nov&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;  &lt;span class="mi"&gt;2010&lt;/span&gt; &lt;span class="n"&gt;aliedit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sh&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rw&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;      &lt;span class="mi"&gt;8942&lt;/span&gt; &lt;span class="n"&gt;Jun&lt;/span&gt; &lt;span class="mi"&gt;23&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;41&lt;/span&gt; &lt;span class="n"&gt;examples&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;desktop&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rw&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rw&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;      &lt;span class="mi"&gt;7307&lt;/span&gt; &lt;span class="n"&gt;Aug&lt;/span&gt;  &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;02&lt;/span&gt; &lt;span class="n"&gt;pgadmin&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rw&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rw&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="mi"&gt;524288000&lt;/span&gt; &lt;span class="n"&gt;Jul&lt;/span&gt; &lt;span class="mi"&gt;23&lt;/span&gt; &lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;
&lt;span class="mi"&gt;5&lt;/span&gt;
&lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;span class="err"&gt;密码替换&lt;/span&gt;
&lt;span class="p"&gt;{{{&lt;/span&gt;
&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;x201i&lt;/span&gt;&lt;span class="o"&gt;:~&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;tr&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;a-m&amp;quot;&amp;quot;n-z&amp;quot;&amp;quot;A-M&amp;quot;&amp;quot;N-Z&amp;quot;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;N-Z&amp;quot;&amp;quot;A-M&amp;quot;&amp;quot;n-z&amp;quot;&amp;quot;a-m&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;love&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;very&lt;/span&gt; &lt;span class="n"&gt;much&lt;/span&gt;
&lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="n"&gt;YBIR&lt;/span&gt; &lt;span class="n"&gt;LBH&lt;/span&gt; &lt;span class="n"&gt;IREL&lt;/span&gt; &lt;span class="n"&gt;ZHPU&lt;/span&gt;
&lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;span class="err"&gt;加密文件&lt;/span&gt;
&lt;span class="p"&gt;{{{&lt;/span&gt;
&lt;span class="n"&gt;tr&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;a-m&amp;quot;&amp;quot;n-z&amp;quot;&amp;quot;A-M&amp;quot;&amp;quot;N-Z&amp;quot;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;N-Z&amp;quot;&amp;quot;A-M&amp;quot;&amp;quot;n-z&amp;quot;&amp;quot;a-m&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;passwd&lt;/span&gt;&lt;span class="err"&gt;　&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;passwd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bak&lt;/span&gt;
&lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;span class="n"&gt;passwd&lt;/span&gt;&lt;span class="err"&gt;加密码后邮件发出&lt;/span&gt;
&lt;span class="p"&gt;{{{&lt;/span&gt;
&lt;span class="n"&gt;tr&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;a-m&amp;quot;&amp;quot;n-z&amp;quot;&amp;quot;A-M&amp;quot;&amp;quot;N-Z&amp;quot;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;N-Z&amp;quot;&amp;quot;A-M&amp;quot;&amp;quot;n-z&amp;quot;&amp;quot;a-m&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;mail&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;for you &amp;quot;&lt;/span&gt; &lt;span class="n"&gt;abc&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;baidu&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;
&lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;== 6 条件测试 ==&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;测试操作规范
  . 测试的本质
  　　. 是一条命令
  　　. 根据　$?　返回前一条命令返回的状态。成功为0,再则不成功
  . 操作规范
     . 格式1 test 条件表达式
     . 格式2: [ 条件表达式 ]
  . 练习方法
    . 直接跟 &amp;amp;&amp;amp; echo YES 判断结果
    . 用法： [ 条件表达式 ] &amp;amp;&amp;amp; echo YES
    {{{
        l@x201i:~$ ls -dl /etc/grub/ /boot/grub
        ls: cannot access /etc/grub/: No such file or directory
        drwxr-xr-x 5 root root 5120 Jul 30 07:30 /boot/grub
        l@x201i:~$ [-d "/etc/grub" ] &amp;amp;&amp;amp; echo YES //前面要有空格，-d 是否为目录
        bash: [-d: command not found
        l@x201i:~$ [ -d "/etc/grub" ] &amp;amp;&amp;amp; echo YES
        l@x201i:~$ [ -d "/boot/grub" ] &amp;amp;&amp;amp; echo YES
        YES&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;文件状态检测
   . 存在及识别
    . -e: 目标是否存在 (Exist)
    . -d: 是否为目录 (Directory)
    . -f: 是否为文件（File)
  . 权限的检测
    . -r:　是否有读取的权限(Read)
    . -w: 是否有写入权限(Write)
    . -x: 是否有执行权限(eXcute)
    {{{
      ls -l /etc/shadow //只有root用户有写入权限，root组也无读取权限。文件所有者可写文件
      [ -x "/etc/shadow"] &amp;amp;&amp;amp; echo YES
    }}}&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;整数值比较、字母匹配
  . -eq: 等于 (Equal)
  . -ne: 不等于 (Not Equal)
  . -gt: 大于　(Greater Than)
  . -lt: 小于 (Lesser Than)
  . -ge: 大于或等于 (Greater or Equal)
  . -le: 小于或等于 (Lesser or Equal)
  {{{
        root@x201i:/home/l# who |wc -l
        3
        root@x201i:/home/l# [ $(who | wc -l ) -eq 2] &amp;amp;&amp;amp; echo YES
        bash: [: missing `]' //方括号前附近都要有空格
        root@x201i:/home/l# [ $(who | wc -l ) -eq 2 ] &amp;amp;&amp;amp; echo YES
        root@x201i:/home/l# [ $(who | wc -l ) -eq 3 ] &amp;amp;&amp;amp; echo YES
        YES
        root@x201i:/home/l#
  }}}&lt;/li&gt;
&lt;li&gt;字符串匹配
  . =:  两人个字符串相同
  . !=: 两个字符串不相同
  . 字符串可以用&amp;lt;、&amp;gt;，不常用
  {{{
    root@x201i:/home/l# echo $USER
    root
    root@x201i:/home/l# [ $USER != "root" ] &amp;amp;&amp;amp; echo YES
    root@x201i:/home/l# [ $USER = "root" ] &amp;amp;&amp;amp; echo YES
    YES
  }}}&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;== 使用if判断结构 ==&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;程序流控制
  . 执行过程顺序化、自动化&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;单分支／双分支的if应用
   . 单分支结构
   {{{
     if 条件测试
         then 命令序列
     fi
     //检查目录/opt/mrepo是否存在，不存在则创建
     BACK_DIR="/opt/mrepo"
     if [ ! -d $BACK_DIR ] 
     then
       mkdir -p $BACK_DIR
     fi&lt;/p&gt;
&lt;p&gt;//双分支&lt;/p&gt;
&lt;p&gt;if 条件测试
 then 命令序列1
 else 命令序列2
 fi
 检查目标主机是否存活，显示检测结果
 #!/bin/bash
 ping -c 3 -i 0.2 -W 3 $1 &amp;amp;&amp;gt; /dev/null
 if [ $? -eq 0 ]
 then 
     echo "host $1 is up."
 else
     echo "host $1 is down."
 fi
   }}}&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;多重分支的应用
   {{{
     if 条件测试１
         then 命令序列１
     elif 条件测试２
         then 命令序列２
     ... ...
     else
         命令序列
     fi&lt;/p&gt;
&lt;p&gt;#!/bin/bash
 read -p "请输入您的分数（0-100）：" GRADE
 if [ $GRADE -ge 85 ]  &amp;amp;&amp;amp; [ $GRADE -le 100 ]; then
     echo "$GRADE 分!优秀"
 elif [ $GRADE -ge 70 ] &amp;amp;&amp;amp; [ $GRADE -le 84 ]; then
     echo "$GRADE 分,合格"
 else
     echo "$GRADE 分？不合格"
 fi&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;== 8 使用for循环 ==&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;for语句结构
   {{{
     for 变量名 in 取值列表
     do
         命令序列
     done&lt;/p&gt;
&lt;p&gt;for i in "1st" "2nd" "3rd"
 do
   echo $i;
 done&lt;/p&gt;
&lt;p&gt;逐词输出/etc/host.conf
 for i in $(cat /etc/host.conf)
 do
   echo $i
 done&lt;/p&gt;
&lt;p&gt;给一个users.txt 每行一个用户名称，初始口令1223456, 首次登录必须改密码,chage 更改密码天数
 for i in $(cat /root/users.txt)
 do
   useradd $i
   echo "123456" | passwd --stdin $i
   chage -d 0 $i
 done&lt;/p&gt;
&lt;p&gt;检测一个ＩＰ范围主机状态192.168.1.1 -192.168.1.10&lt;/p&gt;
&lt;p&gt;IP_PRE="192.168.1."
 for IP in $(seq 1 10)
 do
   ping -c 3 -i 0.2 -W 3 ${IP_PRE}$IP &amp;amp;&amp;gt; /dev/null
   if [ $? -eq 0 ]; then
     echo "${IP_PRE}$IP is up."
   else
     echo "${IP_PRE}$IP is down."
   fi
 done&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;== 9 使用case分支 ==
 * 服务脚本格式
    {{{
    case 变量值 in 
    模式１）
        命令序列１
        ;;
    模式２）
        命令序列２
        ;;
        ......&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="err"&gt;默认命令序列&lt;/span&gt;
&lt;span class="n"&gt;esac&lt;/span&gt;
&lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;span class="p"&gt;{{{&lt;/span&gt;
&lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="err"&gt;控制参数&lt;/span&gt; &lt;span class="n"&gt;in&lt;/span&gt;
&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="err"&gt;启动ＸＸ服务&lt;/span&gt;
    &lt;span class="p"&gt;;;&lt;/span&gt;
&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="err"&gt;停止ＸＸ服务&lt;/span&gt;
    &lt;span class="p"&gt;;;&lt;/span&gt;
    &lt;span class="p"&gt;......&lt;/span&gt;
&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="err"&gt;显示服务脚本的用法&lt;/span&gt;
&lt;span class="n"&gt;esac&lt;/span&gt;
&lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;例子
    {{{
    #!/bin/bash
    read -p "请输入一个字符，并按回车确认：" KEY
    case "$KEY" in
    [a-z]|[A-Z])
        echo "您输入的是字母。"
        ;;
    [0-9])
        echo "您输入的是数字。"
        ;;
    *)
        echo "您输入的是空格、功能键或控制字母。"
    esac&lt;/p&gt;
&lt;h1&gt;!/bin/bash&lt;/h1&gt;
&lt;p&gt;case "$1" in
start)
    sleep 3600 &amp;amp;
    ;;
stop)
    pkill -x "sleep"
    ;;
*)
    echo "用法： $0 (start|stop|"
esac
}}}
运行：
{{{
l@x201i:~/tmp/bash$ ./sleep.sh start
l@x201i:~/tmp/bash$ pgrep -lx "sleep"
6788 sleep
l@x201i:~/tmp/bash$ ./sleep.sh stop
l@x201i:~/tmp/bash$ pgrep -lx "sleep"
l@x201i:~/tmp/bash$ ./sleep.sh 
用法： ./sleep.sh (start|stop|
}}}&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;添加为系统服务
    在脚本开头设置chkconfig参数&lt;/p&gt;
&lt;p&gt;checkconfig： - 90 10
告诉checkconfig需要哪几个运行级别。切换运行级别时启动进程顺序是９０，停止顺序是１０
description: Daemon script for sleepd Server
说明&lt;/p&gt;
&lt;p&gt;系统服务文件放在/etc/init.d目录下
{{{&lt;/p&gt;
&lt;h1&gt;cat /etc/init.d/sleepd&lt;/h1&gt;
&lt;h1&gt;!/bin/bash&lt;/h1&gt;
&lt;p&gt;checkconfig： - 90 10
description: Daemon script for sleepd Server
case "$1" in
start)
    sleep 3600 &amp;amp;
    ;;
stop)
    pkill -x "sleep"
    ;;
*)
    echo "用法： $0 (start|stop|"
esac&lt;/p&gt;
&lt;h1&gt;chkconfig --add sleepd　／／设置开机自动运行&lt;/h1&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;=== １０  awk 文本处理工具 ===
 * awk基本命令格式
    awk '模式  {操作}' 文件１  文件２
    NR  当前处理行的序数（行号）
    FS  字段间隔，缺省为空格或ＴＡＢ
    $n  当前行的第n个字段
    $0  当前行的所有文本内容&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;常见用法示例
    awk 'NR==1{print}' /etc/hosts
    head -1 /etc/hosts&lt;/p&gt;
&lt;p&gt;NR指行号,相当于head,但输出第３行head做不到
{{{
l@x201i:~/tmp/bash$ cat file.txt 
1 This is the first line.
2 Hello, Everybody!
3 192.168.4.2 w2k8.benet.com
4 hunter:x:504:504::/home/hunter:/bin/bash
}}}
. awk 'NR==1,NR==3{print}' file.txt    输出第１至３行&lt;/p&gt;
&lt;p&gt;. awk '(NR==1)||(NR==3){print}' file.txt    输出第一行和第三行&lt;/p&gt;
&lt;p&gt;. awk '(NR%2)==1{print}' file.txt    输出奇数行&lt;/p&gt;
&lt;p&gt;. awk '(NR%2)==0{print}' file.txt    输出偶数行&lt;/p&gt;
&lt;p&gt;. awk '/2/{print}' file.txt&lt;/p&gt;
&lt;p&gt;. awk '/bash$/{print}' file.txt     正则表达式&lt;/p&gt;
&lt;p&gt;. awk "NR==2,NR==3{print $1,$3}' file.txt    输出第二行到第三行的第１，３列 &lt;/p&gt;
&lt;p&gt;. awk -F. '$5=="benet"{print $0}' file.txt    点分隔，第五字段等于benet的行&lt;/p&gt;
&lt;p&gt;{{{
l@x201i:~/tmp/bash$ awk '(NR==1)||(NR==3){print}' file.txt
1 This is the first line.
3 192.168.4.2 w2k8.benet.com
l@x201i:~/tmp/bash$ awk 'NR==1,NR==3{print}' file.txt
1 This is the first line.
2 Hello, Everybody!
3 192.168.4.2 w2k8.benet.com
}}}&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;=== sed 替换文本内容 ===
 * 语法格式
  . sed '编辑指令' 文件１　文件２　......
  . sed -n '编辑指令' 文件１　文件２　......
  . sed -i '编辑指令' 文件１　文件２　......
  . -n 只输出编辑指令影响的行
  . -i 直接修改源文件内容。不加-i,修改结果输出，不会修改有源文件
  . sed -n '3,5p' /etc/host //p 相当于awk中的print,第３到５行
  . 格式：[地址１[,地址２]操作类型
  . 多条指令之间以分号隔开
  　{{{
  　sed -n '3p;5p' /etc/host
  　打印第３行；打印第５行
  　}}}
  . p 输出/打印文件行
  . n 取下一行文本（跳过当前行)
  . d 删除
  . s 字符串替换
  . a 追加新文本
  . sed -n 'p;n' file.txt //隔行输出, 奇数行
  . sed -n 'n;p' file.txt //偶数行
  . sed -n '/w2k8/.$p' file.txt //正则 从包含w2k8的行开始到最后，输出。$最后一行
  . sed -n '/\&amp;lt;This&gt;/p' file.txt 包含单词This的行
  . sed '2,3d' file.txt //输出删除第２到第三行文本后的结果，没有-i 不影响原文件
  . sed '/w2k8/d;$d' file.txt //删除包含w2k8的行，删除最后一行
  . sed '/ne/!d' file.txt //删除不符合条件的行
  . sed '3,4s/hunter/BADBOY/g' file.txt //g 替换所有的，否则替换每行第一个。替换第３到第４行。行数省略，默认所有行。
  . sed '1,2s/^/#/g' file.txt　//第１到２行，添加＃号
  . sed 's/ter//g' file.txt //删除所有ter&lt;/p&gt;</summary></entry><entry><title>Describe linux/Linux查看系统配置常用命令 here.</title><link href="http://liugehao.github.io/describe-linuxlinuxcha-kan-xi-tong-pei-zhi-chang-yong-ming-ling-here.html" rel="alternate"></link><updated>2013-08-15T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-15:describe-linuxlinuxcha-kan-xi-tong-pei-zhi-chang-yong-ming-ling-here.html</id><summary type="html">&lt;p&gt;{{{
系统&lt;/p&gt;
&lt;h1&gt;uname -a               # 查看内核/操作系统/CPU信息&lt;/h1&gt;
&lt;h1&gt;head -n 1 /etc/issue   # 查看操作系统版本&lt;/h1&gt;
&lt;h1&gt;cat /proc/cpuinfo      # 查看CPU信息&lt;/h1&gt;
&lt;h1&gt;hostname               # 查看计算机名&lt;/h1&gt;
&lt;h1&gt;lspci -tv              # 列出所有PCI设备&lt;/h1&gt;
&lt;h1&gt;lsusb -tv              # 列出所有USB设备&lt;/h1&gt;
&lt;h1&gt;lsmod                  # 列出加载的内核模块&lt;/h1&gt;
&lt;h1&gt;env                    # 查看环境变量&lt;/h1&gt;
&lt;p&gt;资源&lt;/p&gt;
&lt;h1&gt;free -m                # 查看内存使用量和交换区使用量&lt;/h1&gt;
&lt;h1&gt;df -h                  # 查看各分区使用情况&lt;/h1&gt;
&lt;h1&gt;du -sh &amp;lt;目录名&amp;gt;        # 查看指定目录的大小&lt;/h1&gt;
&lt;h1&gt;grep MemTotal /proc/meminfo   # 查看内存总量&lt;/h1&gt;
&lt;h1&gt;grep MemFree /proc/meminfo    # 查看空闲内存量&lt;/h1&gt;
&lt;h1&gt;uptime                 # 查看系统运行时间、用户数、负载&lt;/h1&gt;
&lt;h1&gt;cat /proc/loadavg      # 查看系统负载&lt;/h1&gt;
&lt;p&gt;磁盘和分区&lt;/p&gt;
&lt;h1&gt;mount | column -t      # 查看挂接的分区状态&lt;/h1&gt;
&lt;h1&gt;fdisk -l               # 查看所有分区&lt;/h1&gt;
&lt;h1&gt;swapon -s              # 查看所有交换分区&lt;/h1&gt;
&lt;h1&gt;hdparm -i /dev/hda     # 查看磁盘参数(仅适用于IDE设备)&lt;/h1&gt;
&lt;h1&gt;dmesg | grep IDE       # 查看启动时IDE设备检测状况&lt;/h1&gt;
&lt;p&gt;网络&lt;/p&gt;
&lt;h1&gt;ifconfig               # 查看所有网络接口的属性&lt;/h1&gt;
&lt;h1&gt;iptables -L            # 查看防火墙设置&lt;/h1&gt;
&lt;h1&gt;route -n               # 查看路由表&lt;/h1&gt;
&lt;h1&gt;netstat -lntp          # 查看所有监听端口&lt;/h1&gt;
&lt;h1&gt;netstat -antp          # 查看所有已经建立的连接&lt;/h1&gt;
&lt;h1&gt;netstat -s             # 查看网络统计信息&lt;/h1&gt;
&lt;p&gt;进程&lt;/p&gt;
&lt;h1&gt;ps -ef                 # 查看所有进程&lt;/h1&gt;
&lt;h1&gt;top                    # 实时显示进程状态&lt;/h1&gt;
&lt;p&gt;用户&lt;/p&gt;
&lt;h1&gt;w                      # 查看活动用户&lt;/h1&gt;
&lt;h1&gt;id &amp;lt;用户名&amp;gt;            # 查看指定用户信息&lt;/h1&gt;
&lt;h1&gt;last                   # 查看用户登录日志&lt;/h1&gt;
&lt;h1&gt;cut -d: -f1 /etc/passwd   # 查看系统所有用户&lt;/h1&gt;
&lt;h1&gt;cut -d: -f1 /etc/group    # 查看系统所有组&lt;/h1&gt;
&lt;h1&gt;crontab -l             # 查看当前用户的计划任务&lt;/h1&gt;
&lt;p&gt;服务&lt;/p&gt;
&lt;h1&gt;chkconfig --list       # 列出所有系统服务&lt;/h1&gt;
&lt;h1&gt;chkconfig --list | grep on    # 列出所有启动的系统服务&lt;/h1&gt;
&lt;h1&gt;chkconfig nginx on|off&lt;/h1&gt;
&lt;p&gt;程序&lt;/p&gt;
&lt;h1&gt;rpm -qa                # 查看所有安装的软件包&lt;/h1&gt;
&lt;p&gt;全部脚印不留脚印
}}}&lt;/p&gt;</summary></entry><entry><title>redis and hiredis install</title><link href="http://liugehao.github.io/redis-and-hiredis-install.html" rel="alternate"></link><updated>2013-08-15T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-15:redis-and-hiredis-install.html</id><summary type="html">&lt;p&gt;=== Redis安装步骤 ===&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;redis server安装
    {{{
    wget http://redis.googlecode.com/files/redis-2.4.6.tar.gz #下载文件
    tar xzf redis-2.4.6.tar.gz
    cd redis-2.4.6
    make
    cp src/redis-server src/redis-cli /usr/bin/ #方便在终端在任何地方直接运行
    cp redis.conf /etc/
    ufw allow 6379 #ubuntu下开启端口
    }}}&lt;/p&gt;
&lt;p&gt;修改/etc/redis.conf,让server以守护进程在后台执行。
daemonize yes&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;启动redis服务
    {{{
    redis-server /etc/redis.conf
    }}}&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;检测redis服务是否正常启动
    {{{
    ps -ef | grep redis
    }}}&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;=== Hiredis install ===
    Hiredis客户端下载地址：https://github.com/redis/hiredis&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;Hiredis&lt;/span&gt;&lt;span class="err"&gt;安装步骤：&lt;/span&gt;
&lt;span class="p"&gt;{{{&lt;/span&gt;
&lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="n"&gt;antirez&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;hiredis&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="n"&gt;cc6a7f&lt;/span&gt;
&lt;span class="n"&gt;make&lt;/span&gt;


&lt;span class="n"&gt;mkdir&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;hiredis&lt;/span&gt;
&lt;span class="n"&gt;cp&lt;/span&gt; &lt;span class="n"&gt;libhiredis&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;hiredis&lt;/span&gt; &lt;span class="err"&gt;#将动态连接库&lt;/span&gt;&lt;span class="n"&gt;libhiredis&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="err"&gt;至&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;hiredis&lt;/span&gt;
&lt;span class="n"&gt;mkdir&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;hiredis&lt;/span&gt;
&lt;span class="n"&gt;cp&lt;/span&gt; &lt;span class="n"&gt;hiredis&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;hiredis&lt;/span&gt;
&lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;span class="err"&gt;&amp;#39;&amp;#39;&amp;#39;注意６４位系统的&lt;/span&gt;&lt;span class="n"&gt;lib64&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;rehl6&lt;/span&gt;&lt;span class="mf"&gt;.4&lt;/span&gt;&lt;span class="err"&gt;上按这方法报错未定义方法。&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;=== 连接hiredis服务器 ===
 1. 连接
    {{{
    #include &lt;stdio.h&gt;
    #include &lt;hiredis/hiredis.h&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;redisContext&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;redisConnect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;127.0.0.1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6379&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;//redis server默认端口&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
&lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;connection error: %s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;发送命令至服务器 
    {{{
    redisReply *reply = redisCommand(conn, "set key value");
    }}}&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;关闭Reply对象
    {{{
    freeReplyObject(reply);
    }}}&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;关闭连接
    {{{
    redisFree(conn);
    }}}&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;'''具体一些其他的API可以看文件的README.md '''&lt;/p&gt;</summary></entry><entry><title>linux/rhce视频/18 解决linux访问比较慢的问题</title><link href="http://liugehao.github.io/linuxrhceshi-pin-18-jie-jue-linuxfang-wen-bi-jiao-man-de-wen-ti.html" rel="alternate"></link><updated>2013-08-14T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-14:linuxrhceshi-pin-18-jie-jue-linuxfang-wen-bi-jiao-man-de-wen-ti.html</id><summary type="html">&lt;p&gt;{{{
icmp协议：
ping www.sina.com.cn
traceroute www.sina.com.cn
mtr www.sina.com.cn
通路　，掉包率&lt;/p&gt;
&lt;p&gt;查看本机
top
vmstat 
netstat
netstat -antup
  tcp listen
  udp 无状态&lt;/p&gt;
&lt;p&gt;特别多的　ESTABLISHED　，有可能多人在看网站，也可能是ＣＣ攻击（恶意访问，查看ＩＰ，同一ＩＰ数多为ＣＣ）
如果连接中ESTABLISHED占少数，syn-flood DDOS攻击&lt;/p&gt;
&lt;p&gt;抓包工具
iptraf tcpdump wireshark&lt;/p&gt;
&lt;p&gt;arping 网关ＩＰ　
如果有２个mac地址，有arp欺骗，（一般情况下，出现次数多的mac为假网关）&lt;/p&gt;
&lt;p&gt;arp -s ip mac 绑定网关&lt;/p&gt;
&lt;p&gt;ifconfig eth0:1 192.168.1.2 网卡添加多地址
}}}&lt;/p&gt;</summary></entry><entry><title>python/使用Python进行自动化测试</title><link href="http://liugehao.github.io/pythonshi-yong-pythonjin-xing-zi-dong-hua-ce-shi.html" rel="alternate"></link><updated>2013-08-14T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-14:pythonshi-yong-pythonjin-xing-zi-dong-hua-ce-shi.html</id><summary type="html">&lt;ul&gt;
&lt;li&gt;单元测试&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;. unittest ：Python自带的单元测试框架
  . pyunit：Junit的Python版本&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用Pyhon进行Windows GUI测试&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这部分的功能主要就是和大家平时使用的QTP类似。在Windows下我们可以使用pywinauto这个开源的框架：
  http://code.google.com/p/pywinauto/
  来个小例子：
  {{{
  app.Notepad.MenuSelect("Help-&amp;gt;About Notepad")
  app.AboutNotepad.OK.Click()
  app.Notepad.Edit.TypeKeys ("pywinauto Works!", with_spaces = True)
  }}}
  呵呵，强大吧&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用Python进行Web自动化测试&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;使用Python进行Web自动化测试的工具有很多，这里就向大家推荐一下我比较熟悉的Selenium（Web Driver）吧。
  http://seleniumhq.org&lt;/p&gt;
&lt;p&gt;我的其他博客有关于Selenium的文章，大家可以看一下。
  RF也是不错的框架啊，基于关键字驱动的
  http://robotframework.org/
  twill: a simple scripting language for Web browsing
  http://twill.idyll.org/&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用Python进行性能测试&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;. Python Web Performance Tool http://pywebperf.sourceforge.net/
  . Pylot   http://www.pylot.org/gettingstarted.html
  . Pymeter  http://pymeter.sourceforge.net/&lt;/p&gt;</summary></entry><entry><title>Describe linux/RHEL6/CentOS6/Scientific Linux 6虚拟机克隆导致的网卡问题解决方法 here.</title><link href="http://liugehao.github.io/describe-linuxrhel6centos6scientific-linux-6xu-ni-ji-ke-long-dao-zhi-de-wang-qia-wen-ti-jie-jue-fang-fa-here.html" rel="alternate"></link><updated>2013-08-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-13:describe-linuxrhel6centos6scientific-linux-6xu-ni-ji-ke-long-dao-zhi-de-wang-qia-wen-ti-jie-jue-fang-fa-here.html</id><summary type="html">&lt;p&gt;刚才在VM虚拟机里测试Scientific Linux 6（RHEL6的重编译版，相当于CentOS 6），看看是否可用于生产环境。因为镜像是在家里的电脑安装的，复制过来启动系统发现网卡启动失败，提示：&lt;/p&gt;
&lt;p&gt;Bringing up interface eth0: Device eth0 does not seem to be present, delaying initialization.   [FAILED]&lt;/p&gt;
&lt;p&gt;Google了一下，发现是网卡mac地址写入硬件问题导致。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;环境：&lt;/span&gt;&lt;span class="n"&gt;Virtualbox&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;RHEL&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt; &lt;span class="n"&gt;x64&lt;/span&gt;
&lt;span class="err"&gt;用&lt;/span&gt;&lt;span class="n"&gt;VirtualBox&lt;/span&gt;&lt;span class="err"&gt;的&lt;/span&gt;&lt;span class="n"&gt;vboxmanager&lt;/span&gt;&lt;span class="err"&gt;克隆的虚拟机，操作系统&lt;/span&gt;&lt;span class="n"&gt;RHEL6&lt;/span&gt;&lt;span class="err"&gt;，启动后发现网卡不能用了。重启网络服务，报以下错误&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;Bringing&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt; &lt;span class="n"&gt;interface&lt;/span&gt; &lt;span class="n"&gt;eth0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Device&lt;/span&gt; &lt;span class="n"&gt;eth0&lt;/span&gt; &lt;span class="n"&gt;does&lt;/span&gt; &lt;span class="n"&gt;not&lt;/span&gt; &lt;span class="n"&gt;seem&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;present&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delaying&lt;/span&gt; &lt;span class="n"&gt;initialization&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;FAILED&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="err"&gt;在&lt;/span&gt;&lt;span class="n"&gt;RHEL5&lt;/span&gt;&lt;span class="err"&gt;里也发生类似事情，因为复制虚拟机&lt;/span&gt;&lt;span class="n"&gt;MAC&lt;/span&gt;&lt;span class="err"&gt;会重新生成，但是操作系统的&lt;/span&gt;&lt;span class="n"&gt;MAC&lt;/span&gt;&lt;span class="err"&gt;却写在&lt;/span&gt;&lt;span class="n"&gt;ifcfg&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ethx&lt;/span&gt;&lt;span class="err"&gt;里，造成了不一致，所以不能启动网络接口，在&lt;/span&gt;&lt;span class="n"&gt;RHEL5&lt;/span&gt;&lt;span class="err"&gt;里可以使用&lt;/span&gt;&lt;span class="n"&gt;kudzu&lt;/span&gt;&lt;span class="err"&gt;或者注释网卡配置文件的&lt;/span&gt;&lt;span class="n"&gt;MAC&lt;/span&gt;&lt;span class="err"&gt;字段来解决这个问题。但是在&lt;/span&gt;&lt;span class="n"&gt;RHEL6&lt;/span&gt;&lt;span class="err"&gt;里，&lt;/span&gt;&lt;span class="n"&gt;kudzu&lt;/span&gt;&lt;span class="err"&gt;已经被&lt;/span&gt;&lt;span class="n"&gt;hal&lt;/span&gt;&lt;span class="err"&gt;服务取代了。虽然&lt;/span&gt;&lt;span class="n"&gt;lspci&lt;/span&gt;&lt;span class="err"&gt;能够正常认到网卡，但是却无法使用&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="n"&gt;restart&lt;/span&gt;&lt;span class="err"&gt;来启动服务。尝试注释&lt;/span&gt;&lt;span class="n"&gt;ifcfg&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;eth0&lt;/span&gt;&lt;span class="err"&gt;的&lt;/span&gt;&lt;span class="n"&gt;MAC&lt;/span&gt;&lt;span class="err"&gt;字段，还是报错。查看了下&lt;/span&gt;&lt;span class="n"&gt;udev&lt;/span&gt;&lt;span class="err"&gt;的规则，发现了问题的所在。&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;{{{
    [root@Oracle ~]# cat /etc/udev/rules.d/70-persistent-net.rules
    # This file was automatically generated by the /lib/udev/write_net_rules
    # program, run by the persistent-net-generator.rules rules file.
    #
    # You can modify it, as long as you keep each rule on a single
    # line, and change only the value of the NAME= key.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;# net device () (custom name provided by external tool)&lt;/span&gt;
&lt;span class="n"&gt;SUBSYSTEM&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ACTION&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DRIVERS&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="o"&gt;?*&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ATTR&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="err"&gt;″&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ATTR&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="err"&gt;″&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KERNEL&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;eth&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;NAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;eth0&lt;/span&gt;&lt;span class="err"&gt;″&lt;/span&gt;

&lt;span class="cp"&gt;# net device ()&lt;/span&gt;
&lt;span class="n"&gt;SUBSYSTEM&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ACTION&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DRIVERS&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="o"&gt;?*&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ATTR&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;66&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;63&lt;/span&gt;&lt;span class="err"&gt;″&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ATTR&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="err"&gt;″&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KERNEL&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;eth&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;NAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;eth1&lt;/span&gt;&lt;span class="err"&gt;″&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;Oracle&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}}}
    原来UDEV这里把克隆前的MAC当成了当前虚拟机的eth0 MAC，而重新生成的08:00:27:32:66:63是eth1的MAC。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;解决这个问题，只要删除旧的&lt;/span&gt;&lt;span class="n"&gt;UDEV&lt;/span&gt;&lt;span class="err"&gt;配置，修改为：&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;{{{
    [root@Oracle ~]# cat /etc/udev/rules.d/70-persistent-net.rules
    # This file was automatically generated by the /lib/udev/write_net_rules
    # program, run by the persistent-net-generator.rules rules file.
    #
    # You can modify it, as long as you keep each rule on a single
    # line, and change only the value of the NAME= key.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;# net device () (custom name provided by external tool)&lt;/span&gt;
&lt;span class="n"&gt;SUBSYSTEM&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ACTION&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DRIVERS&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="o"&gt;?*&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ATTR&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;66&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;63&lt;/span&gt;&lt;span class="err"&gt;″&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ATTR&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="err"&gt;″&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KERNEL&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;eth&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;NAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;eth0&lt;/span&gt;&lt;span class="err"&gt;″&lt;/span&gt;

&lt;span class="err"&gt;重启&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="err"&gt;服务有时可以有时不行，重启系统就一切&lt;/span&gt;&lt;span class="n"&gt;OK&lt;/span&gt;&lt;span class="err"&gt;！试过多次！&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;Oracle&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="n"&gt;restart&lt;/span&gt;
&lt;span class="n"&gt;Shutting&lt;/span&gt; &lt;span class="n"&gt;down&lt;/span&gt; &lt;span class="n"&gt;interface&lt;/span&gt; &lt;span class="n"&gt;eth0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;OK&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;Shutting&lt;/span&gt; &lt;span class="n"&gt;down&lt;/span&gt; &lt;span class="n"&gt;loopback&lt;/span&gt; &lt;span class="n"&gt;interface&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;OK&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;Bringing&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt; &lt;span class="n"&gt;loopback&lt;/span&gt; &lt;span class="n"&gt;interface&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;OK&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;Bringing&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt; &lt;span class="n"&gt;interface&lt;/span&gt; &lt;span class="n"&gt;eth0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;OK&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;Oracle&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="n"&gt;ifconfig&lt;/span&gt; &lt;span class="n"&gt;eth0&lt;/span&gt;
&lt;span class="n"&gt;eth0&lt;/span&gt; &lt;span class="n"&gt;Link&lt;/span&gt; &lt;span class="n"&gt;encap&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;Ethernet&lt;/span&gt; &lt;span class="n"&gt;HWaddr&lt;/span&gt; &lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;66&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;63&lt;/span&gt;
&lt;span class="n"&gt;inet&lt;/span&gt; &lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;172.16.100.3&lt;/span&gt; &lt;span class="n"&gt;Bcast&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;172.16.100.255&lt;/span&gt; &lt;span class="n"&gt;Mask&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;255.255.255.0&lt;/span&gt;
&lt;span class="n"&gt;inet6&lt;/span&gt; &lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fe80&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;a00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;27ff&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;fe32&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;6663&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt; &lt;span class="n"&gt;Scope&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;Link&lt;/span&gt;
&lt;span class="n"&gt;UP&lt;/span&gt; &lt;span class="n"&gt;BROADCAST&lt;/span&gt; &lt;span class="n"&gt;RUNNING&lt;/span&gt; &lt;span class="n"&gt;MULTICAST&lt;/span&gt; &lt;span class="n"&gt;MTU&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1500&lt;/span&gt; &lt;span class="n"&gt;Metric&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;RX&lt;/span&gt; &lt;span class="n"&gt;packets&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;206&lt;/span&gt; &lt;span class="n"&gt;errors&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;dropped&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;overruns&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;TX&lt;/span&gt; &lt;span class="n"&gt;packets&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;203&lt;/span&gt; &lt;span class="n"&gt;errors&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;dropped&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;overruns&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;carrier&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="nl"&gt;collisions:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;txqueuelen&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;span class="n"&gt;RX&lt;/span&gt; &lt;span class="n"&gt;bytes&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;21157&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;20.6&lt;/span&gt; &lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;TX&lt;/span&gt; &lt;span class="n"&gt;bytes&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;24515&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;23.9&lt;/span&gt; &lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}}}
参考：http://bbs.chinaunix.net/viewthread.php?tid=1918368&lt;/p&gt;
&lt;p&gt;我的测试环境是VMware Workstation 7.1 + SL 6 x64
最简单的解决办法是直接删除70-persistent-net.rules配置文件
{{{
rm -fr /etc/udev/rules.d/70-persistent-net.rules
reboot
}}}
重启系统就ok了，系统会自动生成一个新的。&lt;/p&gt;</summary></entry><entry><title>Describe linux/rhel/redhat笔记 here.</title><link href="http://liugehao.github.io/describe-linuxrhelredhatbi-ji-here.html" rel="alternate"></link><updated>2013-08-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-13:describe-linuxrhelredhatbi-ji-here.html</id><summary type="html">&lt;p&gt;echo "aaa" &amp;gt; tty1　＃输出内容到tty终端&lt;/p&gt;
&lt;p&gt;vi /etc/inittab
id:3:initdefault  #3默认不启动xwindow,5开机启动xwindow&lt;/p&gt;
&lt;p&gt;1:2345:respawn:/sbin/ningetty tty1 #tty终端数量&lt;/p&gt;
&lt;p&gt;===9 10 课时，系统命令初步 ===
linux一切皆文件，硬件也抽象成文件形式
{{{
cd ~abc 进入abc家目录
touch a 更改文件时间，如果没有文件则创建
touch /tmp/{a,b} 创建a,b２个文件
stat a 查看文件a的时间
pws 显示当前路径
ls -F 增加标记。可执行文件加/,可执行文件加*...
alias ls='ls --color=tty'　增加颜色
unalias 取消别名
source .bashrc 升效
cp -r 文件夹
rm -i 交互模式，是否删除
rm -r 删除文件夹
rm -rf 删除文件夹和文件不询问
rm -f 不问是否删除
cp -r 文件夹
rmdir 删除空文件夹
pstree 查看进程树&lt;/p&gt;
&lt;p&gt;hostname 查看、更改主机名（不保存，下次重启变回原来主机名）
/etc/ssconfig/network 主机名信息&lt;/p&gt;
&lt;p&gt;ifconfig 查看更改ＩＰ
ifconfig eth0 192.168.1.12 (不永久第一次)
vi /etc/sysconfig/network-scraipts/ifcfg-eth0 网络配置文件&lt;/p&gt;
&lt;p&gt;netconfig 改文件，自动改ifconfig的配置到配置文件，再service network restart 升效&lt;/p&gt;
&lt;p&gt;file /bin/ls ＃file 文件名，查看文件类型
file p.img
p.img: Linux rev 1.0 ext4 filesystem data, UUID=c6f89be8-9267-4953-b4f5-ff368c58d9c4 (extents) (huge files)&lt;/p&gt;
&lt;p&gt;使用cifs 需要先安装 cifs-utils包&lt;/p&gt;
&lt;p&gt;mount /dev/cdrom /mnt
mount -t iso9660 /dev/cdrom /mnt
mount -t cifs //192.168.0.1/tools /mnt
mount -t cifs -o username=administrator //192.168.0.1/tools /mnt #win share
mount 192.168.0.254:/var/ftp/pub /mnt #nfs linux共享。nfs速度快&lt;/p&gt;
&lt;p&gt;cat /dev/cdrom &amp;gt;a.iso 做镜象文件
mount -t iso9660 -o loop a.iso /mnt #loop 虚拟成一个回环设备&lt;/p&gt;
&lt;p&gt;ls -l 不是文件实际占的大小，文件夹４Ｋ，
du -s 看文件夹大小，汇总　-h 显示k,m,g&lt;/p&gt;
&lt;p&gt;shutdown -h 16:00 ＃１６点关机
init 0 关闭服务，然后调halt -p -f 断电。自己用机器，直接init 0关机&lt;/p&gt;
&lt;p&gt;shutdown -r now　会调用
init 6&lt;/p&gt;
&lt;p&gt;}}}
=== 用户及组管理初步 ===
useradd shrek
添加用户，做下列量系列动作：
{{{
/etc/passwd
/etc/shadow
/etc/group
/etc/gshadow&lt;/p&gt;
&lt;p&gt;mkdir /home/shrek
cp -r /etc/skel/.* /home/shrek
chown -R shrek:shrek /home/shrek
}}}&lt;/p&gt;
&lt;p&gt;/etc/passwd
l:x:1000:1000:liugehao,,,:/home/l:/bin/bash
用户名:密码(x表示有密码):用户id:组ＩＤ:用户全名注释:家目录:用户所用shell
/sbin/nologin 表示不允许登录&lt;/p&gt;
&lt;p&gt;/etc/shadow
l:$6$2WQbK4Hs$Ai12QpRxzKwxurcjkhseUQtnX1H4cN6yEJZBFAcGAc1Cwmyuir.M.xNHerZCptZ.pQaLbutBF7yp3/qVld7Wj1:15913:0:99999:7:::
用户名：单向加密后的密码：19700101天数:密码最短历史:密码最长历史天数:密码过期天数通知:帐号禁用的unix天数::&lt;/p&gt;
&lt;p&gt;/etc/group
l:x:1000:
libvirt-qemu:x:124:libvirt-qemu,l
组名：是否有组密码：组ＩＤ：用户,用户&lt;/p&gt;
&lt;p&gt;linux 只有２种用户，一种是ＩＤ为０的root,另一种是ＵＩＤ不为０的，把普通用户加到root组，只是某些文件管理权限。&lt;/p&gt;
&lt;p&gt;/etc/gshadow
组密码文件&lt;/p&gt;
&lt;p&gt;/etc/login.defs
修改默认密码天数，过期警告天数等&lt;/p&gt;
&lt;p&gt;userdel shrek 删除用户
userdel -r shrek 彻底删除用户，一并删除主目录，email&lt;/p&gt;
&lt;p&gt;usermod 更改用户主目录,passwd,comment
usermod -G root,bin,todd shrek 把shrek加入到oot,bin,todd 组。-a append &lt;/p&gt;
&lt;p&gt;id l
uid=1000(l) gid=1000(l) groups=1000(l),122(kvm),123(libvirt),124(libvirt-qemu),125(vde2-net)&lt;/p&gt;
&lt;p&gt;gpasswd -M l,root,shrek root 多个用户加入到一个组&lt;/p&gt;
&lt;p&gt;usermod -g 切换组ＩＤ，一个用户只有一个组ＩＤ，可以有多个组&lt;/p&gt;
&lt;p&gt;删除/etc/passwd后，单用户模式登录后，用/etc/passwd-恢复，(/etc/shadow)&lt;/p&gt;
&lt;p&gt;Alt-Fx 控制台tty1，
xwindow 登录或者远程登录后，打开terminal 控制台是pts/1...
skill -9 pts/3 杀掉pts/3的登录&lt;/p&gt;
&lt;p&gt;查看用户
users 
w
who&lt;/p&gt;
&lt;p&gt;write pts/2 root 给pts2用户发消息
echo aaaaksdjf &amp;gt; pts/2
mesg y 打开write
wall xxxkjfdskfjs 发送给所有人&lt;/p&gt;
&lt;p&gt;last　查看用户登录日志&lt;/p&gt;
&lt;p&gt;lastlog 每个用户最后一次登录时间&lt;/p&gt;
&lt;p&gt;finger shrek 看某个用户的登录时间，信息,email等&lt;/p&gt;
&lt;p&gt;=== １６课时　文本处理及正则表达式　===
 * 命令 cat tail head less more
{{{
tail -f 监视文件，如果文件发生变化，显示发生变化
cut -d: -f1 /etc/passwd //　-d以冒号为分隔符，　-f显示第一列
cut -d: -f1 /etc/passwd |grep root //显示第一列，并且第一列中包括root的行
cut -d: -f7 /etc/passwd　显示shell
}}}&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;grep 
-v 反向选择
-R 对目录下文件和子文件夹下文件进行筛选
-l 只显示文件外
''正则表达式用单引号
-c 显示行号
-A2　显示上下文中下面２行
-B2　显示上下文中上面２行&lt;/li&gt;
&lt;li&gt;grep 正则
||. ||表示任何一个字符 ||
||.＊ ||表示０个或者任意个字符 ||
||^a ||a开头的行 ||
||a$ ||表示以a结束的行 ||
||&lt;good ||表示以good开头的单词 ||
||sh&gt; ||表示以sh结尾的单词 ||
||[abc] ||表示当前位置是a,b或者c ||
||[^abc] ||表示除a b c以外的字符 ||
||a*||空,a,aa,aaa,.... ||
||a? ||表示０个或者一个a ||
||a+ ||表示a,aa,aaa,... ||
||a{n} ||表示n个a ||&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;grep '.{40,}' /usr/share/dict/words　取超过４０字符的单词
  grep '^i.{18}n$' /usr/share/dict/words 查看i18n的单词
  查看配置文件，过滤注释行和空行
  grep -v '^#' /etc/nginx/nginx.conf | grep -v '^$'
  cut -d: -f2-4 -c1-5 冒号分隔符，显示第二到第四段,1-5个字符
  -r 反向排序&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;locate -r '' 正则查找文件&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;sort 
  -r 反向排序
  -t:　以冒号分隔符
  -n 数字形式排序
  +3 从第二列开始排　//-k3
  sort -t: -k3nr /etc/passwd   按第三列数字方式排倒序&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;wc 统计
  -l 行
  -w 单词
  -c 字符&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;uniq 统计
  cut -d: -f7 /etc/passwd |sort | uniq 第７列排序后　distinct。-c 统计行数&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;diff 文件对比,可以生成patch文件
  patch -p0 &amp;lt; pathch文件　// -p 级别&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>Describe .net/陈键的短信api调用 here.</title><link href="http://liugehao.github.io/describe-netchen-jian-de-duan-xin-apidiao-yong-here.html" rel="alternate"></link><updated>2013-08-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-13:describe-netchen-jian-de-duan-xin-apidiao-yong-here.html</id><summary type="html">&lt;p&gt;== 余额查看 ==
{{{#!highlight c#
using System.Text;
using System.Net;
using System.IO;
using System.Web;
using System;
namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            string linkUrl = "https://sms-api.luosimao.com/v1/status.json",
                username = "api", 
                password = "key-b2652cf62f07dd09a4d561dcb4528041"; //api key&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;        &lt;span class="n"&gt;HttpWebRequest&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpWebRequest&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;HttpWebRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;linkUrl&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;auth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Basic &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;Convert&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ToBase64String&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Text&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Encoding&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Default&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBytes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;:&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Headers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Authorization&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;auth&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

        &lt;span class="n"&gt;HttpWebResponse&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpWebResponse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetResponse&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;StreamReader&lt;/span&gt; &lt;span class="n"&gt;respStream&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;StreamReader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetResponseStream&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;respStream&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReadToEnd&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Read&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;


&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;}}}
== 发送短信 ==
{{{#!highlight c#
using System.Net;
using System.IO;
using System.Text;
using System;&lt;/p&gt;
&lt;p&gt;namespace ConsoleApplication1
{
    class Class1
    {
        static void Main(string[] args)
        {
            string mobile = "18602112511",
                message = "Test send message use luosimao!【luosimao】",
                username = "api",
                password = "key-b2652cf62f07dd09a4d561dcb4528041",
                url = "https://sms-api.luosimao.com/v1/send.json";&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;        &lt;span class="n"&gt;byte&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;byteArray&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Encoding&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;UTF8&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBytes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;mobile=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;mobile&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;amp;message=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;HttpWebRequest&lt;/span&gt; &lt;span class="n"&gt;webRequest&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpWebRequest&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;WebRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Uri&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;auth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Basic &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;Convert&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ToBase64String&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Text&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Encoding&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Default&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBytes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;:&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;webRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Headers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Authorization&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;auth&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;webRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Method&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;POST&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;webRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ContentType&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;application/x-www-form-urlencoded&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;webRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ContentLength&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;byteArray&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="n"&gt;Stream&lt;/span&gt; &lt;span class="n"&gt;newStream&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;webRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetRequestStream&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;newStream&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;byteArray&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;byteArray&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Length&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;newStream&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Close&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;


        &lt;span class="n"&gt;HttpWebResponse&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpWebResponse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;webRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetResponse&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;StreamReader&lt;/span&gt; &lt;span class="n"&gt;php&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;StreamReader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetResponseStream&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;Encoding&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Default&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;Message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReadToEnd&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Message&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Read&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>Describe python/数据库操作paramstyle here.</title><link href="http://liugehao.github.io/describe-pythonshu-ju-ku-cao-zuo-paramstyle-here.html" rel="alternate"></link><updated>2013-08-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-13:describe-pythonshu-ju-ku-cao-zuo-paramstyle-here.html</id><summary type="html">&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;用?还是%s取决于paramstyle参数的配置，dbapi2.0文档  http://www.python.org/dev/peps/pep-0249/    里的解释
{{{
                'qmark'         Question mark style,
                                e.g. '...WHERE name=?'
                'numeric'       Numeric, positional style,
                                e.g. '...WHERE name=:1'
                'named'         Named style,
                                e.g. '...WHERE name=:name'
                'format'        ANSI C printf format codes,
                                e.g. '...WHERE name=%s'
                'pyformat'      Python extended format codes,
                                e.g. '...WHERE name=%(name)s'
}}}
    也就是说如果 mysqldb 默认不是'qmark' 而是'format'风格的话 可以这样写&lt;/p&gt;
&lt;p&gt;execute('insert into queuelog (a,b,c,d,e) values (%s,%s,%s,%s,%s)' ,Datalist)&lt;/p&gt;
&lt;p&gt;'''重点是不要自己拼接sql语句'''。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;2、关于execute是单条插入的问题 dbapi2.0定义了 executemany，下面这个例子是mysqldb文档里的
{{{
c.executemany(
      """INSERT INTO breakfast (name, spam, eggs, sausage, price)
      VALUES (%s, %s, %s, %s, %s)""",
      [
      ("Spam and Sausage Lover's Plate", 5, 1, 8, 7.95 ),
      ("Not So Much Spam Plate", 3, 2, 0, 3.95 ),
      ("Don't Wany ANY SPAM! Plate", 0, 4, 3, 5.95 )
      ] )
}}}&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>Describe 文章/有一类PM here.</title><link href="http://liugehao.github.io/describe-wen-zhang-you-lei-pm-here.html" rel="alternate"></link><updated>2013-08-12T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-12:describe-wen-zhang-you-lei-pm-here.html</id><summary type="html">&lt;p&gt;有一类PM，其它不擅长，就擅长排工时。
用一个软件，画各人工时长度，安排哪些任务先做哪些任务后做。
后来我就觉得PM就是排工时的，让开发或测试人员报个工时，然后安排下，给上级一个进度表，这就是他全部工作了。
当然，他还有个存在价值时跟上级讨价还价项目deadline。&lt;/p&gt;</summary></entry><entry><title>Describe 生活/联通报修 here.</title><link href="http://liugehao.github.io/describe-sheng-huo-lian-tong-bao-xiu-here.html" rel="alternate"></link><updated>2013-08-11T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-11:describe-sheng-huo-lian-tong-bao-xiu-here.html</id><summary type="html">&lt;p&gt;青浦联通报修电话：39281570 &lt;/p&gt;</summary></entry><entry><title>Describe c/c语言连接mysql here.</title><link href="http://liugehao.github.io/describe-ccyu-yan-lian-jie-mysql-here.html" rel="alternate"></link><updated>2013-08-09T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-09:describe-ccyu-yan-lian-jie-mysql-here.html</id><summary type="html">&lt;p&gt;{{{
apt-get install libmysqlclient-dev
}}}
{{{#!highlight sql
create table t1( id integer auto_increment primary key ,name varchar(20), sex char[1]);
}}}
mysql.c文件：
{{{#!highlight c&lt;/p&gt;
&lt;h1&gt;include &lt;stdio.h&gt;&lt;/h1&gt;
&lt;h1&gt;include &lt;stdlib.h&gt;&lt;/h1&gt;
&lt;h1&gt;include &lt;string.h&gt;&lt;/h1&gt;
&lt;h1&gt;include &lt;mysql/mysql.h&gt;&lt;/h1&gt;
&lt;h1&gt;define MAX_COLUMN_LEN 32&lt;/h1&gt;
&lt;p&gt;int main(int argc, char &lt;em&gt;argv[])
{
    MYSQL my_connection;
    MYSQL_RES &lt;/em&gt;result;
    MYSQL_ROW sql_row;
    MYSQL_FIELD &lt;em&gt;fd;
    char column[MAX_COLUMN_LEN][MAX_COLUMN_LEN];
    int res;
    mysql_init(&amp;amp;my_connection);
    if(mysql_real_connect(&amp;amp;my_connection, "127.0.0.1", "root", "liuyou", "test1", 3306, NULL, 0))
    {
        perror("Connect");
        res = mysql_query(&amp;amp;my_connection, "select * from t1");
        if(!res)
        {
            result = mysql_store_result(&amp;amp;my_connection);
            if(result)
            {
                int i,j;
                printf("the result nuber is %lu\n", (unsigned long)mysql_num_rows(result));
                for(i=0;fd=mysql_fetch_field(result);i++)
                {
                    bzero(column[i], sizeof(column[i]));
                    strcpy(column[i], fd-&amp;gt;name);
                }
                j = mysql_num_fields(result);
                for(i=0;i&amp;lt;j;i++)
                {
                    printf("%s\t", column[i]);
                }
                printf("\n");
                while(sql_row=mysql_fetch_row(result))
                {
                    for(i=0;i&amp;lt;j;i++)
                    {
                        printf("%s\t",sql_row[i]);
                    }
                    printf("\n");
                }
            }
        }
        else
        {
            perror("select");
        }
    }
    else
    {
        perror("connect:error");
    }
    //mysql_free_result(MYSQL_RES &lt;/em&gt;result);//释放结果资源
    mysql_free_result(result); //先释放，后插入&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sql&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;sex&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;malloc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;请输入名字:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;gets&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;性别:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;gets&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;sex&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="n"&gt;sprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sql&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;insert into test1.t1 values (null,&amp;#39;%s&amp;#39;, &amp;#39;%c&amp;#39;);&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sex&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sql&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;mysql_query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;my_connection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sql&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;mysql_commit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;my_connection&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="n"&gt;mysql_close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;my_connection&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}
}}}&lt;/p&gt;
&lt;p&gt;编译：
{{{
l@x201i:~/tmp/gcc$ gcc mysql.c   &amp;amp;&amp;amp; ./a.out
/tmp/ccdPMZug.o: In function &lt;code&gt;main':
mysql.c:(.text+0x23): undefined reference to&lt;/code&gt;mysql_init'
mysql.c:(.text+0x5e): undefined reference to &lt;code&gt;mysql_real_connect'
mysql.c:(.text+0x85): undefined reference to&lt;/code&gt;mysql_query'
mysql.c:(.text+0xa1): undefined reference to &lt;code&gt;mysql_store_result'
mysql.c:(.text+0xbc): undefined reference to&lt;/code&gt;mysql_num_rows'
mysql.c:(.text+0x12e): undefined reference to &lt;code&gt;mysql_fetch_field'
mysql.c:(.text+0x145): undefined reference to&lt;/code&gt;mysql_num_fields'
mysql.c:(.text+0x1e3): undefined reference to &lt;code&gt;mysql_fetch_row'
mysql.c:(.text+0x212): undefined reference to&lt;/code&gt;mysql_free_result'
mysql.c:(.text+0x2ad): undefined reference to &lt;code&gt;mysql_query'
mysql.c:(.text+0x2bc): undefined reference to&lt;/code&gt;mysql_commit'
mysql.c:(.text+0x2cb): undefined reference to `mysql_close'
collect2: error: ld returned 1 exit status&lt;/p&gt;
&lt;p&gt;}}}
出错，增加　-l mysqlclient
{{{
l@x201i:~/tmp/gcc$ gcc mysql.c -l mysqlclient  &amp;amp;&amp;amp; ./a.out
}}}&lt;/p&gt;</summary></entry><entry><title>Describe linux/linux显示历史命令 here.</title><link href="http://liugehao.github.io/describe-linuxlinuxxian-shi-li-shi-ming-ling-here.html" rel="alternate"></link><updated>2013-08-09T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-09:describe-linuxlinuxxian-shi-li-shi-ming-ling-here.html</id><summary type="html">&lt;p&gt;使用 HISTTIMEFORMAT 显示时间戳&lt;/p&gt;
&lt;p&gt;当你从命令行执行 history 命令后，通常只会显示已执行命令的序号和命令本身。如果你想要查看命令历史的时间戳，那么可以执行：
{{{&lt;/p&gt;
&lt;h1&gt;export HISTTIMEFORMAT='%F %T '&lt;/h1&gt;
&lt;h1&gt;history | more&lt;/h1&gt;
&lt;p&gt;1 2008-08-05 19:02:39 service network restart
2 2008-08-05 19:02:39 exit
3 2008-08-05 19:02:39 id
4 2008-08-05 19:02:39 cat /etc/redhat-release
}}}
注意：这个功能只能用在当 HISTTIMEFORMAT 这个环境变量被设置之后，之后的那些新执行的 bash 命令才会被打上正确的时间戳。在此之前的所有命令，都将会显示成设置 HISTTIMEFORMAT 变量的时间。&lt;/p&gt;</summary></entry><entry><title>Describe linux/gwan g-wan key value store here.</title><link href="http://liugehao.github.io/describe-linuxgwan-g-wan-key-value-store-here.html" rel="alternate"></link><updated>2013-08-07T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-07:describe-linuxgwan-g-wan-key-value-store-here.html</id><summary type="html">&lt;p&gt;add data: http://localhost:8080/?kv4.c&amp;amp;act=a&lt;/p&gt;
&lt;p&gt;get data:  http://localhost:8080/?kv4.c&amp;amp;body=999999&lt;/p&gt;
&lt;p&gt;首先定义结构　record_t　指针，分配内存空间，存储数据，添加进k/v存储。&lt;/p&gt;
&lt;p&gt;{{{#!highlight c&lt;/p&gt;
&lt;h1&gt;include "gwan.h" // G-WAN exported functions&lt;/h1&gt;
&lt;h1&gt;include &lt;malloc.h&gt;&lt;/h1&gt;
&lt;h1&gt;include &lt;string.h&gt;&lt;/h1&gt;
&lt;h1&gt;include &lt;stdlib.h&gt;&lt;/h1&gt;
&lt;p&gt;typedef struct record_s // this is a user-defined 'record' structure
{
   char &lt;em&gt;name;  // the Key(name) is a field of the Value(name, email)
   char &lt;/em&gt;email; 
   u32   id;    &lt;br /&gt;
} record_t;&lt;/p&gt;
&lt;p&gt;int main(int argc, char &lt;em&gt;argv[])
{
    xbuf_t &lt;/em&gt;reply = get_reply(argv);
    char &lt;em&gt;act="", &lt;/em&gt;body="";
    get_arg("act=", &amp;amp;act, argc, argv);&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nx"&gt;get_arg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;body=&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nb"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="nx"&gt;xbuf_xcat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;reply&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-- %s --- %s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;act&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;body&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="nx"&gt;kv_t&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;vhost_ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;kv_t&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="nx"&gt;get_env&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;US_VHOST_DATA&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="c1"&gt;//persistent ptr&lt;/span&gt;
&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;forum_store&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;//convenience pointer (var-&amp;gt;m instead of (*var)-&amp;gt;m)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;vhost_ptr&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;!*&lt;/span&gt;&lt;span class="nx"&gt;vhost_ptr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;vhost_ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;kv_t&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="nx"&gt;malloc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;kv_t&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="c1"&gt;//threads and posts stored here&lt;/span&gt;

    &lt;span class="nx"&gt;kv_init&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;vhost_ptr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;users&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt; 
&lt;span class="n"&gt;forum_store&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;vhost_ptr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;act&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;kv_item&lt;/span&gt; &lt;span class="nb"&gt;item&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;record_t&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;record&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;u32&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;char&lt;/span&gt; &lt;span class="nx"&gt;str&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;;
    char email&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;;
    while(i&lt;span class="nt"&gt;&amp;lt; 15000000&lt;/span&gt;&lt;span class="err"&gt;)&lt;/span&gt;
    &lt;span class="err"&gt;{&lt;/span&gt;
        &lt;span class="err"&gt;//&lt;/span&gt;&lt;span class="na"&gt;sprintf&lt;/span&gt;&lt;span class="err"&gt;(&lt;/span&gt;&lt;span class="na"&gt;str&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt; &lt;span class="err"&gt;&amp;quot;%&lt;/span&gt;&lt;span class="na"&gt;d&lt;/span&gt;&lt;span class="err"&gt;&amp;quot;,&lt;/span&gt; &lt;span class="na"&gt;i&lt;/span&gt;&lt;span class="err"&gt;);&lt;/span&gt;
        &lt;span class="err"&gt;//&lt;/span&gt;&lt;span class="na"&gt;sprintf&lt;/span&gt;&lt;span class="err"&gt;(&lt;/span&gt;&lt;span class="na"&gt;email&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt; &lt;span class="err"&gt;&amp;quot;%&lt;/span&gt;&lt;span class="na"&gt;d&lt;/span&gt;&lt;span class="err"&gt;&amp;quot;,&lt;/span&gt; &lt;span class="na"&gt;i&lt;/span&gt; &lt;span class="err"&gt;*&lt;/span&gt; &lt;span class="na"&gt;3&lt;/span&gt;&lt;span class="err"&gt;);&lt;/span&gt;
        &lt;span class="na"&gt;record =&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="s"&gt;(record_t*)malloc(sizeof(record_t));&lt;/span&gt;
        &lt;span class="na"&gt;record-&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;name = (char*)strdup(str);
        record-&amp;gt;email = (char*)strdup(email);
        record-&amp;gt;id = i;
        item.key = (char *)&lt;span class="ni"&gt;&amp;amp;record-&amp;gt;id;&lt;/span&gt;
        item.klen = sizeof(u32);//sizeof(str) - 1; // faster
        item.val = (char*)record;
        item.flags = 0;
        kv_add(forum_store, &lt;span class="ni"&gt;&amp;amp;item);&lt;/span&gt; // add an entry to the name_dat Store index

        i++;
    }
}
xbuf_xcat(reply, &amp;quot;&lt;span class="nt"&gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&lt;/span&gt;Count&lt;span class="nt"&gt;&amp;lt;/b&amp;gt;&lt;/span&gt;: %d key(s) in KV store&lt;span class="nt"&gt;&amp;lt;br&amp;gt;&lt;/span&gt;&amp;quot;,
forum_store-&amp;gt;nbr_items);

u32 val=atof(body);
//printf(&amp;quot;%s, %d\n&amp;quot;, body, val);
record_t *record = (record_t*)kv_get(forum_store, (char*)&lt;span class="err"&gt;&amp;amp;&lt;/span&gt;val, sizeof(u32));

xbuf_xcat(reply,
        &amp;quot;&lt;span class="nt"&gt;&amp;lt;br&amp;gt;&lt;/span&gt;record with id = &amp;#39;%u&amp;#39; name&amp;#39;s field: \&amp;quot;%s\&amp;quot;, email: %s &lt;span class="nt"&gt;&amp;lt;br&amp;gt;&lt;/span&gt;&amp;quot;,
        val,
        record ? record-&amp;gt;name : &amp;quot;&lt;span class="nt"&gt;&amp;lt;font&lt;/span&gt; &lt;span class="na"&gt;color=&lt;/span&gt;&lt;span class="s"&gt;#ff4040&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;not found&lt;span class="nt"&gt;&amp;lt;/font&amp;gt;&lt;/span&gt;&amp;quot;,
record ? record-&amp;gt;email : &amp;quot;&lt;span class="nt"&gt;&amp;lt;font&lt;/span&gt; &lt;span class="na"&gt;color=&lt;/span&gt;&lt;span class="s"&gt;#ff4040&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;not found&lt;span class="nt"&gt;&amp;lt;/font&amp;gt;&lt;/span&gt;&amp;quot;);

//char n&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; = &amp;quot;100010&amp;quot;;
//record_t *p = (record_t *)kv_get(forum_store, body, 6); // 0:not found
//      xbuf_xcat(reply, &amp;quot;&lt;span class="nt"&gt;&amp;lt;br&amp;gt;&lt;/span&gt;pierre&amp;#39;s email address: %s &lt;span class="nt"&gt;&amp;lt;br&amp;gt;&lt;/span&gt;&amp;quot;, p-&amp;gt;email);

return 200; // return an HTTP code (200:&amp;#39;OK&amp;#39;)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>Describe linux/weighttp install here.</title><link href="http://liugehao.github.io/describe-linuxweighttp-install-here.html" rel="alternate"></link><updated>2013-08-07T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-07:describe-linuxweighttp-install-here.html</id><summary type="html">&lt;p&gt;wiki: http://redmine.lighttpd.net/projects/weighttp/wiki
{{{
git clone git://git.lighttpd.net/weighttp
cd weighttp
./waf configure
}}}
{{{
checking for libary ev :not found
}}}
libev: http://dist.schmorp.de/libev/
{{{
wget http://dist.schmorp.de/libev/libev-4.15.tar.gz
tar -zxf libev-4.15.tar.gz
cd libev-4.15 
./configure
make &amp;amp;&amp;amp; make install
ldconfig
}}}
{{{
./waf build&lt;/p&gt;
&lt;p&gt;./waf install #root
}}}&lt;/p&gt;
&lt;p&gt;{{{
[root@localhost lib]# weighttp
weighttp: error while loading shared libraries: libev.so.4: cannot open shared object file: No such file or directory&lt;/p&gt;
&lt;p&gt;[root@localhost libev-4.15]# find / -name libev.so.4
/usr/local/lib/libev.so.4&lt;/p&gt;
&lt;p&gt;ln -s /usr/local/lib/libev.so.4 /usr/lib/libev.so.4&lt;/p&gt;
&lt;p&gt;or &lt;/p&gt;
&lt;p&gt;vi /etc/ld.so.conf.d/local.conf
add a line
/usr/local/lib
}}}&lt;/p&gt;</summary></entry><entry><title>Describe liugehao-工作-201307 here.</title><link href="http://liugehao.github.io/describe-liugehao-gong-zuo-201307-here.html" rel="alternate"></link><updated>2013-08-07T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-07:describe-liugehao-gong-zuo-201307-here.html</id><summary type="html">&lt;p&gt;i. g-wan 安装　测试　php python c java
 i. gwan kev value store ,测试程序编写，测试 60%&lt;/p&gt;</summary></entry><entry><title>Describe tmp/weighttp here.</title><link href="http://liugehao.github.io/describe-tmpweighttp-here.html" rel="alternate"></link><updated>2013-08-07T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-08-07:describe-tmpweighttp-here.html</id><summary type="html">&lt;p&gt;{{{
./waf configure
checking for libary ev :not found&lt;/p&gt;
&lt;p&gt;http://dist.schmorp.de/libev/
wget http://dist.schmorp.de/libev/libev-4.15.tar.gz
tar -zxf libev-4.15.tar.gz
cd libev-4.15 
./configure
make &amp;amp;&amp;amp; make install&lt;/p&gt;
&lt;p&gt;./waf build&lt;/p&gt;
&lt;p&gt;./waf install #root&lt;/p&gt;
&lt;p&gt;[root@localhost lib]# weighttp
weighttp: error while loading shared libraries: libev.so.4: cannot open shared object file: No such file or directory&lt;/p&gt;
&lt;p&gt;[root@localhost libev-4.15]# find / -name libev.so.4
/usr/local/lib/libev.so.4&lt;/p&gt;
&lt;p&gt;ln -s /usr/local/lib/libev.so.4 /usr/lib/libev.so.4&lt;/p&gt;
&lt;p&gt;or &lt;/p&gt;
&lt;p&gt;vi /etc/ld.so.conf.d/local.conf
add a line
/usr/local/lib&lt;/p&gt;
&lt;p&gt;k/v:10,000,000
weighttp -n 500000 -c 200 -k -t 2 http://localhost:8080/?kv4.c
finished in 3 sec, 855 millisec and 335 microsec, 129690 req/s, 55473 kbyte/s
requests: 500000 total, 500000 started, 500000 done, 500000 succeeded, 0 failed, 0 errored
status codes: 500000 2xx, 0 3xx, 0 4xx, 0 5xx
traffic: 219000732 bytes total, 125500732 bytes http, 93500000 bytes data&lt;/p&gt;
&lt;p&gt;finished in 3 sec, 405 millisec and 360 microsec, 146827 req/s, 62803 kbyte/s
requests: 500000 total, 500000 started, 500000 done, 500000 succeeded, 0 failed, 0 errored
status codes: 500000 2xx, 0 3xx, 0 4xx, 0 5xx
traffic: 219000000 bytes total, 125500000 bytes http, 93500000 bytes data&lt;/p&gt;
&lt;p&gt;finished in 3 sec, 904 millisec and 48 microsec, 128072 req/s, 54780 kbyte/s
requests: 500000 total, 500000 started, 500000 done, 499998 succeeded, 2 failed, 0 errored
status codes: 499998 2xx, 0 3xx, 0 4xx, 0 5xx
traffic: 218999124 bytes total, 125499498 bytes http, 93499626 bytes data&lt;/p&gt;
&lt;p&gt;k/v:15,000,000&lt;/p&gt;
&lt;p&gt;finished in 3 sec, 8 millisec and 936 microsec, 166171 req/s, 71239 kbyte/s
requests: 500000 total, 500000 started, 500000 done, 499997 succeeded, 3 failed, 0 errored
status codes: 499997 2xx, 0 3xx, 0 4xx, 0 5xx
traffic: 219498683 bytes total, 125499247 bytes http, 93999436 bytes data&lt;/p&gt;
&lt;p&gt;finished in 3 sec, 912 millisec and 640 microsec, 127790 req/s, 54785 kbyte/s
requests: 500000 total, 500000 started, 500000 done, 500000 succeeded, 0 failed, 0 errored
status codes: 500000 2xx, 0 3xx, 0 4xx, 0 5xx
traffic: 219500000 bytes total, 125500000 bytes http, 94000000 bytes data&lt;/p&gt;
&lt;p&gt;hello.c 
inished in 3 sec, 500 millisec and 846 microsec, 142822 req/s, 36683 kbyte/s
requests: 500000 total, 500000 started, 500000 done, 500000 succeeded, 0 failed, 0 errored
status codes: 500000 2xx, 0 3xx, 0 4xx, 0 5xx
traffic: 131504736 bytes total, 124504736 bytes http, 7000000 bytes data&lt;/p&gt;
&lt;p&gt;finished in 3 sec, 529 millisec and 817 microsec, 141650 req/s, 36380 kbyte/s
requests: 500000 total, 500000 started, 500000 done, 500000 succeeded, 0 failed, 0 errored
status codes: 500000 2xx, 0 3xx, 0 4xx, 0 5xx
traffic: 131500000 bytes total, 124500000 bytes http, 7000000 bytes data&lt;/p&gt;
&lt;p&gt;finished in 3 sec, 139 millisec and 163 microsec, 159278 req/s, 40908 kbyte/s
requests: 500000 total, 500000 started, 500000 done, 500000 succeeded, 0 failed, 0 errored
status codes: 500000 2xx, 0 3xx, 0 4xx, 0 5xx
traffic: 131500000 bytes total, 124500000 bytes http, 7000000 bytes data&lt;/p&gt;
&lt;p&gt;finished in 3 sec, 548 millisec and 549 microsec, 140902 req/s, 36188 kbyte/s
requests: 500000 total, 500000 started, 500000 done, 500000 succeeded, 0 failed, 0 errored
status codes: 500000 2xx, 0 3xx, 0 4xx, 0 5xx
traffic: 131500000 bytes total, 124500000 bytes http, 7000000 bytes data&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>Describe linux/rhel6 install apache here.</title><link href="http://liugehao.github.io/describe-linuxrhel6-install-apache-here.html" rel="alternate"></link><updated>2013-07-30T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-07-30:describe-linuxrhel6-install-apache-here.html</id><summary type="html">&lt;p&gt;{{{
wget ftp://ftp.pbone.net/mirror/ftp.sourceforge.net/pub/sourceforge/f/fu/fuduntu/sources/apr-1.4.6-1.fu2013.src.rpm
./configure &amp;amp;&amp;amp; make &amp;amp;&amp;amp; make install
wget ftp://ftp.pbone.net/mirror/ftp.sourceforge.net/pub/sourceforge/f/fu/fuduntu/sources/apr-util-1.4.1-3.fu2013.src.rpm
./configure --with-apr=/usr/local/apr &amp;amp;&amp;amp; make &amp;amp;&amp;amp; make install
wget &lt;apache.src&gt;
./configure --prefix=/usr/local/apache --enable-so --enable-mods-shared=most --with-mpm=worker 
}}}&lt;/p&gt;</summary></entry><entry><title>Describe linux/debian安装wn722n(ath9k-htc) here.</title><link href="http://liugehao.github.io/describe-linuxdebianan-zhuang-wn722nath9k-htc-here.html" rel="alternate"></link><updated>2013-07-29T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-07-29:describe-linuxdebianan-zhuang-wn722nath9k-htc-here.html</id><summary type="html">&lt;ol&gt;
&lt;li&gt;Add a "non-free" component to /etc/apt/sources.list, for example:
{{{&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;Debian 7.0 "Wheezy"&lt;/h1&gt;
&lt;p&gt;deb http://http.debian.net/debian/ wheezy main contrib non-free
}}}
 1. Update the list of available packages and install the firmware-atheros package:
{{{&lt;/p&gt;
&lt;h1&gt;apt-get update &amp;amp;&amp;amp; apt-get install firmware-atheros&lt;/h1&gt;
&lt;p&gt;}}}
 1. Connect the device to your system. The ath9k_htc kernel module is automatically loaded for supported devices.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Configure your wireless interface as appropriate. &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;更多相关：[[http://wiki.debian.org/ath9k_htc]]&lt;/p&gt;</summary></entry><entry><title>Describe linux/无线网卡make: ***/lib/modules/3.2.0-4-amd64/build: No such file or directory here.</title><link href="http://liugehao.github.io/describe-linuxwu-xian-wang-qia-make-libmodules320-4-amd64build-no-such-file-or-directory-here.html" rel="alternate"></link><updated>2013-07-29T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-07-29:describe-linuxwu-xian-wang-qia-make-libmodules320-4-amd64build-no-such-file-or-directory-here.html</id><summary type="html">&lt;p&gt;安装tp-link wn722n usb无线网卡时出错
{{{
wget wireless.kernel.org/download/compat-wireless-2.6/compat-wireless-2.6.tar.bz2
tar -jxf compat*.bz2
cd compat-wireless-2012-05-10
apt-get install gcc make
 ./scripts/driver-select ath9k_htc 
make
}}}
出错：
{{{
root@x201i:/home/l/software/tp-link_wn722n/compat-wireless-2012-05-10# make
make -C /lib/modules/3.2.0-4-amd64/build M=/home/l/software/tp-link_wn722n/compat-wireless-2012-05-10 modules
make: &lt;strong&gt;&lt;em&gt; /lib/modules/3.2.0-4-amd64/build: No such file or directory.  Stop.
make: &lt;/em&gt;&lt;/strong&gt; [modules] Error 2
}}}&lt;/p&gt;
&lt;p&gt;{{{&lt;/p&gt;
&lt;p&gt;apt-get install linux-headers-3.2.0-4-amd64
}}}
[[linux/debian安装wn722n(ath9k-htc)]]&lt;/p&gt;</summary></entry><entry><title>Describe db/debian 7 intall postgresql9.2 here.</title><link href="http://liugehao.github.io/describe-dbdebian-7-intall-postgresql92-here.html" rel="alternate"></link><updated>2013-07-28T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-07-28:describe-dbdebian-7-intall-postgresql92-here.html</id><summary type="html">&lt;p&gt;{{{
apt-get install python-software-properties
wget --quiet -O - http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc | sudo apt-key add - 
add-apt-repository "deb http://apt.postgresql.org/pub/repos/apt/ wheezy-pgdg main" 
apt-get update 
apt-get install postgresql
}}}&lt;/p&gt;</summary></entry><entry><title>Describe linux/AB 测试nginx socket: Too many open files (24) here.</title><link href="http://liugehao.github.io/describe-linuxab-ce-shi-nginx-socket-too-many-open-files-24-here.html" rel="alternate"></link><updated>2013-07-28T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-07-28:describe-linuxab-ce-shi-nginx-socket-too-many-open-files-24-here.html</id><summary type="html">&lt;p&gt;su - root&lt;/p&gt;
&lt;p&gt;ulimit -n 35768(要改的数)&lt;/p&gt;
&lt;p&gt;PS:这应该不难理解，linux是通过文件来对设备进行管理，ulimit -n是设置同时打开文件的最大数值，ab中每一个连接打开一个设备文件，所以设置这个值就可以解决了。&lt;/p&gt;
&lt;p&gt;详细配置：[[linux/sysctl.conf limits.conf]]&lt;/p&gt;</summary></entry><entry><title>Describe linux/apache ab 测试 here.</title><link href="http://liugehao.github.io/describe-linuxapache-ab-ce-shi-here.html" rel="alternate"></link><updated>2013-07-28T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-07-28:describe-linuxapache-ab-ce-shi-here.html</id><summary type="html">&lt;p&gt;{{{
sudo apt-get install apache2-utils&lt;/p&gt;
&lt;p&gt;ab -n 10000 -c 500 http://www.baidu.com/
-c 并发用户数
-n 请求总数
}}}&lt;/p&gt;</summary></entry><entry><title>Describe linux/debian中文乱码 here.</title><link href="http://liugehao.github.io/describe-linuxdebianzhong-wen-luan-ma-here.html" rel="alternate"></link><updated>2013-07-28T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-07-28:describe-linuxdebianzhong-wen-luan-ma-here.html</id><summary type="html">&lt;p&gt;{{{
apt-get install ttf-wqy-zenhei（安装字体） 　　
apt-get install ibus ibus-gtk ibus-pinyin（安装输入法）
打开终端，执行命令： &lt;/p&gt;
&lt;p&gt;dpkg-reconfigure locales
安装时选择的是英语，会缺少中文字体，用以下命令安装字体：&lt;/p&gt;
&lt;p&gt;apt-get install xfonts-intl-chinese wqy* &lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>Describe linux/flash安装 here.</title><link href="http://liugehao.github.io/describe-linuxflashan-zhuang-here.html" rel="alternate"></link><updated>2013-07-28T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-07-28:describe-linuxflashan-zhuang-here.html</id><summary type="html">&lt;p&gt;Installing using the plugin tar.gz:
 1. Unpack the plugin tar.gz and copy the files to the appropriate location.&lt;br /&gt;
 1. Save the plugin tar.gz locally and note the location the file was saved to.
 1. Launch terminal and change directories to the location the file was saved to.
 1. Unpack the tar.gz file.  Once unpacked you will see the following:
     libflashplayer.so
     /usr
 1. Identify the location of the browser plugins directory, based on your Linux distribution and Firefox version
 1. Copy libflashplayer.so to the appropriate browser plugins directory.  At the prompt type:
        + cp libflashlayer.so &lt;BrowserPluginsLocation&gt;
 1. Copy the Flash Player Local Settings configurations files to the /usr directory.  At the prompt type:
        + sudo cp -r usr/* /usr&lt;/p&gt;</summary></entry><entry><title>Describe linux/sysctl.conf limits.conf here.</title><link href="http://liugehao.github.io/describe-linuxsysctlconf-limitsconf-here.html" rel="alternate"></link><updated>2013-07-28T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-07-28:describe-linuxsysctlconf-limitsconf-here.html</id><summary type="html">&lt;p&gt;vi /etc/security/limits.conf
{{{
&lt;em&gt; soft    nproc   2047
&lt;/em&gt; hard    nproc   16384
&lt;em&gt; soft    nofile  65536
&lt;/em&gt; hard    nofile  65536
&lt;em&gt; soft   memlock  unlimited
&lt;/em&gt; hard   memlock  unlimited
}}}&lt;/p&gt;
&lt;p&gt;vi /etc/sysctl.conf
{{{
kernel.shmmni = 4096
kernel.sem = 250 32000 100 128
fs.file-max = 6815744
net.ipv4.ip_local_port_range = 9000 65500
net.core.rmem_default = 262144
net.core.wmem_default = 262144
net.core.rmem_max = 4194304
net.core.wmem_max = 1048576
fs.aio-max-nr = 1048576&lt;/p&gt;
&lt;p&gt;net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_tw_recycle = 1
net.ipv4.tcp_fin_timeout = 30
net.ipv4.tcp_syncookies = 1
}}}&lt;/p&gt;</summary></entry><entry><title>Describe python/PIL decoder jpeg not available here.</title><link href="http://liugehao.github.io/describe-pythonpil-decoder-jpeg-not-available-here.html" rel="alternate"></link><updated>2013-07-28T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-07-28:describe-pythonpil-decoder-jpeg-not-available-here.html</id><summary type="html">&lt;p&gt;{{{#!highlight bash
apt-get install libjpeg-dev&lt;/p&gt;
&lt;p&gt;pt-get install libfreetype6-dev
}}}&lt;/p&gt;
&lt;p&gt;Ubuntu11.10上，libjpeg.so、libz.so和libfreetype.so都在路径/usr/lib/x86_64-linux-gnu下，在/usr/lib下为这3个包创建软链接后执行ldconfig&lt;/p&gt;
&lt;p&gt;在路径/usr/lib和/usr/local下查找PIL相关文件和目录，全部删除&lt;/p&gt;
&lt;p&gt;Ubuntu11.10上，libjpeg.so、libz.so和libfreetype.so都在路径/usr/lib/x86_64-linux-gnu下，在/usr/lib下为这3个包创建软链接后执行ldconfig&lt;/p&gt;
&lt;p&gt;删除PIL解压后的安装包Imaging-1.1.7，重新解压，并修改setup.py，或者pip安装
{{{#!highlight bash
rm -rf /usr/local/lib/python2.7/dist-packages/PIL&lt;em&gt;
rm -rf /tmp/pip-&lt;/em&gt;
pip install PIL
}}}&lt;/p&gt;</summary></entry><entry><title>Describe python/scrapy error TypeError: __init__() got an unexpected keyword argument ‘_job’ here.</title><link href="http://liugehao.github.io/describe-pythonscrapy-error-typeerror-__init__-got-an-unexpected-keyword-argument-_job-here.html" rel="alternate"></link><updated>2013-07-28T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-07-28:describe-pythonscrapy-error-typeerror-__init__-got-an-unexpected-keyword-argument-_job-here.html</id><summary type="html">&lt;p&gt;{{{
2012-12-28 05:57:33+0800 [Launcher,29590/stderr] main()
File “/usr/local/lib/python2.7/dist-packages/scrapyd/runner.py”, line 36, in main
execute()
File “/usr/local/lib/python2.7/dist-packages/scrapy/cmdline.py”, line 131, in execute
_run_print_help(parser, _run_command, cmd, args, opts)
File “/usr/local/lib/python2.7/dist-packages/scrapy/cmdline.py”, line 76, in _run_print_help
func(&lt;em&gt;a, &lt;strong&gt;kw)
File “/usr/local/lib/python2.7/dist-packages/scrapy/cmdline.py”, line 138, in _run_command
cmd.run(args, opts)
File “/usr/local/lib/python2.7/dist-packages/scrapy/commands/crawl.py”, line 43, in run
spider = self.crawler.spiders.create(spname, &lt;/strong&gt;opts.spargs)
File “/usr/local/lib/python2.7/dist-packages/scrapy/spidermanager.py”, line 44, in create
return spcls(&lt;/em&gt;*spider_kwargs)
TypeError: &lt;strong&gt;init&lt;/strong&gt;() got an unexpected keyword argument ‘_job’
}}}&lt;/p&gt;
&lt;p&gt;这是因为spider的__init__函数没有加&lt;strong&gt;kwargs参数，不能接受相应的参数。
{{{#!highlight python
def &lt;strong&gt;init&lt;/strong&gt;(self,&lt;/strong&gt;kwargs):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ProductSpider&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}}}
另外，需添加__str__函数，否则也会报错&lt;/p&gt;
&lt;p&gt;{{{#!highlight python
def &lt;strong&gt;str&lt;/strong&gt;(self):
   return “ProductSpider”
}}}&lt;/p&gt;</summary></entry><entry><title>Describe python/scrapy及PIL安装 here.</title><link href="http://liugehao.github.io/describe-pythonscrapyji-pilan-zhuang-here.html" rel="alternate"></link><updated>2013-07-28T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-07-28:describe-pythonscrapyji-pilan-zhuang-here.html</id><summary type="html">&lt;p&gt;{{{
aptitude install python-setuptools python2.7-dev
easy_install pip
aptitude install libxslt-dev
aptitude install libxml2-dev&lt;/p&gt;
&lt;p&gt;pip install scrapy&lt;/p&gt;
&lt;p&gt;pip instlal sqlalchemy&lt;/p&gt;
&lt;p&gt;pip install PIL&lt;/p&gt;
&lt;p&gt;}}}
Ubuntu11.10上，libjpeg.so、libz.so和libfreetype.so都在路径/usr/lib/x86_64-linux-gnu下，在/usr/lib下为这3个包创建软链接后执行ldconfig&lt;/p&gt;</summary></entry><entry><title>Scrapy imagePipelines 图片保存路径重写</title><link href="http://liugehao.github.io/scrapy-imagepipelines-tu-pian-bao-cun-lu-jing-zhong-xie.html" rel="alternate"></link><updated>2013-07-28T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-07-28:scrapy-imagepipelines-tu-pian-bao-cun-lu-jing-zhong-xie.html</id><summary type="html">&lt;p&gt;只需要重写image_key方法即可
{{{#!highlight python
from scrapy.contrib.pipeline.images import ImagesPipeline
import hashlib
from datetime import datetime
class MyImagesPipeline(ImagesPipeline):
    def image_key(self, url):
        image_guid = hashlib.sha1(url).hexdigest()
        #return 'full/%s.jpg' % (image_guid)
        path = datetime.now().strftime("%Y/%m/%d")
        return '%s/%s.jpg' % (path, image_guid)&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>smb.conf</title><link href="http://liugehao.github.io/smbconf.html" rel="alternate"></link><updated>2013-06-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-06-13:smbconf.html</id><summary type="html">&lt;p&gt;{{{&lt;/p&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h1&gt;Sample configuration file for the Samba suite for Debian GNU/Linux.&lt;/h1&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h1&gt;This is the main Samba configuration file. You should read the&lt;/h1&gt;
&lt;h1&gt;smb.conf(5) manual page in order to understand the options listed&lt;/h1&gt;
&lt;h1&gt;here. Samba has a huge number of configurable options most of which&lt;/h1&gt;
&lt;h1&gt;are not shown in this example&lt;/h1&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h1&gt;Some options that are often worth tuning have been included as&lt;/h1&gt;
&lt;h1&gt;commented-out examples in this file.&lt;/h1&gt;
&lt;h1&gt;- When such options are commented with ";", the proposed setting&lt;/h1&gt;
&lt;h1&gt;differs from the default Samba behaviour&lt;/h1&gt;
&lt;h1&gt;- When commented with "#", the proposed setting is the default&lt;/h1&gt;
&lt;h1&gt;behaviour of Samba but the option is considered important&lt;/h1&gt;
&lt;h1&gt;enough to be mentioned here&lt;/h1&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h1&gt;NOTE: Whenever you modify this file you should run the command&lt;/h1&gt;
&lt;h1&gt;"testparm" to check that you have not made any basic syntactic&lt;/h1&gt;
&lt;h1&gt;errors.&lt;/h1&gt;
&lt;h1&gt;A well-established practice is to name the original file&lt;/h1&gt;
&lt;h1&gt;"smb.conf.master" and create the "real" config file with&lt;/h1&gt;
&lt;h1&gt;testparm -s smb.conf.master &amp;gt;smb.conf&lt;/h1&gt;
&lt;h1&gt;This minimizes the size of the really used smb.conf file&lt;/h1&gt;
&lt;h1&gt;which, according to the Samba Team, impacts performance&lt;/h1&gt;
&lt;h1&gt;However, use this with caution if your smb.conf file contains nested&lt;/h1&gt;
&lt;h1&gt;"include" statements. See Debian bug #483187 for a case&lt;/h1&gt;
&lt;h1&gt;where using a master file is not a good idea.&lt;/h1&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h1&gt;======================= Global Settings =======================&lt;/h1&gt;
&lt;p&gt;[global]&lt;/p&gt;
&lt;h2&gt;Browsing/Identification&lt;/h2&gt;
&lt;h1&gt;Change this to the workgroup/NT-domain name your Samba server will part of&lt;/h1&gt;
&lt;p&gt;workgroup = WORKGROUP
   display charset =UTF-8
   unix charset=UTF-8
   doc charset = cp936
   client lanman auth = yes
   lanman auth = yes&lt;/p&gt;
&lt;h1&gt;server string is the equivalent of the NT Description field&lt;/h1&gt;
&lt;p&gt;server string = %h server (Samba, Ubuntu)&lt;/p&gt;
&lt;h1&gt;Windows Internet Name Serving Support Section:&lt;/h1&gt;
&lt;h1&gt;WINS Support - Tells the NMBD component of Samba to enable its WINS Server&lt;/h1&gt;
&lt;h1&gt;wins support = no&lt;/h1&gt;
&lt;h1&gt;WINS Server - Tells the NMBD components of Samba to be a WINS Client&lt;/h1&gt;
&lt;h1&gt;Note: Samba can be either a WINS Server, or a WINS Client, but NOT both&lt;/h1&gt;
&lt;p&gt;;   wins server = w.x.y.z&lt;/p&gt;
&lt;h1&gt;This will prevent nmbd to search for NetBIOS names through DNS.&lt;/h1&gt;
&lt;p&gt;dns proxy = no&lt;/p&gt;
&lt;h1&gt;What naming service and in what order should we use to resolve host names&lt;/h1&gt;
&lt;h1&gt;to IP addresses&lt;/h1&gt;
&lt;p&gt;;   name resolve order = lmhosts host wins bcast&lt;/p&gt;
&lt;h4&gt;Networking&lt;/h4&gt;
&lt;h1&gt;The specific set of interfaces / networks to bind to&lt;/h1&gt;
&lt;h1&gt;This can be either the interface name or an IP address/netmask;&lt;/h1&gt;
&lt;h1&gt;interface names are normally preferred&lt;/h1&gt;
&lt;p&gt;;   interfaces = 127.0.0.0/8 eth0&lt;/p&gt;
&lt;h1&gt;Only bind to the named interfaces and/or networks; you must use the&lt;/h1&gt;
&lt;h1&gt;'interfaces' option above to use this.&lt;/h1&gt;
&lt;h1&gt;It is recommended that you enable this feature if your Samba machine is&lt;/h1&gt;
&lt;h1&gt;not protected by a firewall or is a firewall itself.  However, this&lt;/h1&gt;
&lt;h1&gt;option cannot handle dynamic or non-broadcast interfaces correctly.&lt;/h1&gt;
&lt;p&gt;;   bind interfaces only = yes&lt;/p&gt;
&lt;h4&gt;Debugging/Accounting&lt;/h4&gt;
&lt;h1&gt;This tells Samba to use a separate log file for each machine&lt;/h1&gt;
&lt;h1&gt;that connects&lt;/h1&gt;
&lt;p&gt;log file = /var/log/samba/log.%m&lt;/p&gt;
&lt;h1&gt;Cap the size of the individual log files (in KiB).&lt;/h1&gt;
&lt;p&gt;max log size = 1000&lt;/p&gt;
&lt;h1&gt;If you want Samba to only log through syslog then set the following&lt;/h1&gt;
&lt;h1&gt;parameter to 'yes'.&lt;/h1&gt;
&lt;h1&gt;syslog only = no&lt;/h1&gt;
&lt;h1&gt;We want Samba to log a minimum amount of information to syslog. Everything&lt;/h1&gt;
&lt;h1&gt;should go to /var/log/samba/log.{smbd,nmbd} instead. If you want to log&lt;/h1&gt;
&lt;h1&gt;through syslog you should set the following parameter to something higher.&lt;/h1&gt;
&lt;p&gt;syslog = 0&lt;/p&gt;
&lt;h1&gt;Do something sensible when Samba crashes: mail the admin a backtrace&lt;/h1&gt;
&lt;p&gt;panic action = /usr/share/samba/panic-action %d&lt;/p&gt;
&lt;h6&gt;# Authentication&lt;/h6&gt;
&lt;h1&gt;"security = user" is always a good idea. This will require a Unix account&lt;/h1&gt;
&lt;h1&gt;in this server for every user accessing the server. See&lt;/h1&gt;
&lt;h1&gt;/usr/share/doc/samba-doc/htmldocs/Samba3-HOWTO/ServerType.html&lt;/h1&gt;
&lt;h1&gt;in the samba-doc package for details.&lt;/h1&gt;
&lt;p&gt;security = share
   username map =/etc/samba/smbusers&lt;/p&gt;
&lt;h1&gt;You may wish to use password encryption.  See the section on&lt;/h1&gt;
&lt;h1&gt;'encrypt passwords' in the smb.conf(5) manpage before enabling.&lt;/h1&gt;
&lt;p&gt;encrypt passwords = true&lt;/p&gt;
&lt;h1&gt;If you are using encrypted passwords, Samba will need to know what&lt;/h1&gt;
&lt;h1&gt;password database type you are using.&lt;/h1&gt;
&lt;p&gt;passdb backend = tdbsam
   obey pam restrictions = yes&lt;/p&gt;
&lt;h1&gt;This boolean parameter controls whether Samba attempts to sync the Unix&lt;/h1&gt;
&lt;h1&gt;password with the SMB password when the encrypted SMB password in the&lt;/h1&gt;
&lt;h1&gt;passdb is changed.&lt;/h1&gt;
&lt;p&gt;unix password sync = yes&lt;/p&gt;
&lt;h1&gt;For Unix password sync to work on a Debian GNU/Linux system, the following&lt;/h1&gt;
&lt;h1&gt;parameters must be set (thanks to Ian Kahan &lt;a href="&amp;#109;&amp;#97;&amp;#105;&amp;#108;&amp;#116;&amp;#111;&amp;#58;&amp;#60;&amp;#107;&amp;#97;&amp;#104;&amp;#97;&amp;#110;&amp;#64;&amp;#105;&amp;#110;&amp;#102;&amp;#111;&amp;#114;&amp;#109;&amp;#97;&amp;#116;&amp;#105;&amp;#107;&amp;#46;&amp;#116;&amp;#117;&amp;#45;&amp;#109;&amp;#117;&amp;#101;&amp;#110;&amp;#99;&amp;#104;&amp;#101;&amp;#110;&amp;#46;&amp;#100;&amp;#101;"&gt;&amp;lt;&amp;#107;&amp;#97;&amp;#104;&amp;#97;&amp;#110;&amp;#64;&amp;#105;&amp;#110;&amp;#102;&amp;#111;&amp;#114;&amp;#109;&amp;#97;&amp;#116;&amp;#105;&amp;#107;&amp;#46;&amp;#116;&amp;#117;&amp;#45;&amp;#109;&amp;#117;&amp;#101;&amp;#110;&amp;#99;&amp;#104;&amp;#101;&amp;#110;&amp;#46;&amp;#100;&amp;#101;&lt;/a&gt; for&lt;/h1&gt;
&lt;h1&gt;sending the correct chat script for the passwd program in Debian Sarge).&lt;/h1&gt;
&lt;p&gt;passwd program = /usr/bin/passwd %u
   passwd chat = &lt;em&gt;Enter\snew\s&lt;/em&gt;\spassword:&lt;em&gt; %n\n &lt;/em&gt;Retype\snew\s&lt;em&gt;\spassword:&lt;/em&gt; %n\n &lt;em&gt;password\supdated\ssuccessfully&lt;/em&gt; .&lt;/p&gt;
&lt;h1&gt;This boolean controls whether PAM will be used for password changes&lt;/h1&gt;
&lt;h1&gt;when requested by an SMB client instead of the program listed in&lt;/h1&gt;
&lt;h1&gt;'passwd program'. The default is 'no'.&lt;/h1&gt;
&lt;p&gt;pam password change = yes&lt;/p&gt;
&lt;h1&gt;This option controls how unsuccessful authentication attempts are mapped&lt;/h1&gt;
&lt;h1&gt;to anonymous connections&lt;/h1&gt;
&lt;p&gt;map to guest = bad user&lt;/p&gt;
&lt;h6&gt;#### Domains&lt;/h6&gt;
&lt;h1&gt;Is this machine able to authenticate users. Both PDC and BDC&lt;/h1&gt;
&lt;h1&gt;must have this setting enabled. If you are the BDC you must&lt;/h1&gt;
&lt;h1&gt;change the 'domain master' setting to no&lt;/h1&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;p&gt;;   domain logons = yes&lt;/p&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h1&gt;The following setting only takes effect if 'domain logons' is set&lt;/h1&gt;
&lt;h1&gt;It specifies the location of the user's profile directory&lt;/h1&gt;
&lt;h1&gt;from the client point of view)&lt;/h1&gt;
&lt;h1&gt;The following required a [profiles] share to be setup on the&lt;/h1&gt;
&lt;h1&gt;samba server (see below)&lt;/h1&gt;
&lt;p&gt;;   logon path = \%N\profiles\%U&lt;/p&gt;
&lt;h1&gt;Another common choice is storing the profile in the user's home directory&lt;/h1&gt;
&lt;h1&gt;(this is Samba's default)&lt;/h1&gt;
&lt;h1&gt;logon path = \%N\%U\profile&lt;/h1&gt;
&lt;h1&gt;The following setting only takes effect if 'domain logons' is set&lt;/h1&gt;
&lt;h1&gt;It specifies the location of a user's home directory (from the client&lt;/h1&gt;
&lt;h1&gt;point of view)&lt;/h1&gt;
&lt;p&gt;;   logon drive = H:&lt;/p&gt;
&lt;h1&gt;logon home = \%N\%U&lt;/h1&gt;
&lt;h1&gt;The following setting only takes effect if 'domain logons' is set&lt;/h1&gt;
&lt;h1&gt;It specifies the script to run during logon. The script must be stored&lt;/h1&gt;
&lt;h1&gt;in the [netlogon] share&lt;/h1&gt;
&lt;h1&gt;NOTE: Must be store in 'DOS' file format convention&lt;/h1&gt;
&lt;p&gt;;   logon script = logon.cmd&lt;/p&gt;
&lt;h1&gt;This allows Unix users to be created on the domain controller via the SAMR&lt;/h1&gt;
&lt;h1&gt;RPC pipe.  The example command creates a user account with a disabled Unix&lt;/h1&gt;
&lt;h1&gt;password; please adapt to your needs&lt;/h1&gt;
&lt;p&gt;; add user script = /usr/sbin/adduser --quiet --disabled-password --gecos "" %u&lt;/p&gt;
&lt;h1&gt;This allows machine accounts to be created on the domain controller via the&lt;/h1&gt;
&lt;h1&gt;SAMR RPC pipe.&lt;/h1&gt;
&lt;h1&gt;The following assumes a "machines" group exists on the system&lt;/h1&gt;
&lt;p&gt;; add machine script  = /usr/sbin/useradd -g machines -c "%u machine account" -d /var/lib/samba -s /bin/false %u&lt;/p&gt;
&lt;h1&gt;This allows Unix groups to be created on the domain controller via the SAMR&lt;/h1&gt;
&lt;h1&gt;RPC pipe.&lt;/h1&gt;
&lt;p&gt;; add group script = /usr/sbin/addgroup --force-badname %g&lt;/p&gt;
&lt;h6&gt;#### Printing&lt;/h6&gt;
&lt;h1&gt;If you want to automatically load your printer list rather&lt;/h1&gt;
&lt;h1&gt;than setting them up individually then you'll need this&lt;/h1&gt;
&lt;h1&gt;load printers = yes&lt;/h1&gt;
&lt;h1&gt;lpr(ng) printing. You may wish to override the location of the&lt;/h1&gt;
&lt;h1&gt;printcap file&lt;/h1&gt;
&lt;p&gt;;   printing = bsd
;   printcap name = /etc/printcap&lt;/p&gt;
&lt;h1&gt;CUPS printing.  See also the cupsaddsmb(8) manpage in the&lt;/h1&gt;
&lt;h1&gt;cupsys-client package.&lt;/h1&gt;
&lt;p&gt;;   printing = cups
;   printcap name = cups&lt;/p&gt;
&lt;h6&gt;###### Misc&lt;/h6&gt;
&lt;h1&gt;Using the following line enables you to customise your configuration&lt;/h1&gt;
&lt;h1&gt;on a per machine basis. The %m gets replaced with the netbios name&lt;/h1&gt;
&lt;h1&gt;of the machine that is connecting&lt;/h1&gt;
&lt;p&gt;;   include = /home/samba/etc/smb.conf.%m&lt;/p&gt;
&lt;h1&gt;Most people will find that this option gives better performance.&lt;/h1&gt;
&lt;h1&gt;See smb.conf(5) and /usr/share/doc/samba-doc/htmldocs/Samba3-HOWTO/speed.html&lt;/h1&gt;
&lt;h1&gt;for details&lt;/h1&gt;
&lt;h1&gt;You may want to add the following on a Linux system:&lt;/h1&gt;
&lt;h1&gt;SO_RCVBUF=8192 SO_SNDBUF=8192&lt;/h1&gt;
&lt;h1&gt;socket options = TCP_NODELAY&lt;/h1&gt;
&lt;h1&gt;The following parameter is useful only if you have the linpopup package&lt;/h1&gt;
&lt;h1&gt;installed. The samba maintainer and the linpopup maintainer are&lt;/h1&gt;
&lt;h1&gt;working to ease installation and configuration of linpopup and samba.&lt;/h1&gt;
&lt;p&gt;;   message command = /bin/sh -c '/usr/bin/linpopup "%f" "%m" %s; rm %s' &amp;amp;&lt;/p&gt;
&lt;h1&gt;Domain Master specifies Samba to be the Domain Master Browser. If this&lt;/h1&gt;
&lt;h1&gt;machine will be configured as a BDC (a secondary logon server), you&lt;/h1&gt;
&lt;h1&gt;must set this to 'no'; otherwise, the default behavior is recommended.&lt;/h1&gt;
&lt;h1&gt;domain master = auto&lt;/h1&gt;
&lt;h1&gt;Some defaults for winbind (make sure you're not using the ranges&lt;/h1&gt;
&lt;h1&gt;for something else.)&lt;/h1&gt;
&lt;p&gt;;   idmap uid = 10000-20000
;   idmap gid = 10000-20000
;   template shell = /bin/bash&lt;/p&gt;
&lt;h1&gt;The following was the default behaviour in sarge,&lt;/h1&gt;
&lt;h1&gt;but samba upstream reverted the default because it might induce&lt;/h1&gt;
&lt;h1&gt;performance issues in large organizations.&lt;/h1&gt;
&lt;h1&gt;See Debian bug #368251 for some of the consequences of &lt;em&gt;not&lt;/em&gt;&lt;/h1&gt;
&lt;h1&gt;having this setting and smb.conf(5) for details.&lt;/h1&gt;
&lt;p&gt;;   winbind enum groups = yes
;   winbind enum users = yes&lt;/p&gt;
&lt;h1&gt;Setup usershare options to enable non-root users to share folders&lt;/h1&gt;
&lt;h1&gt;with the net usershare command.&lt;/h1&gt;
&lt;h1&gt;Maximum number of usershare. 0 (default) means that usershare is disabled.&lt;/h1&gt;
&lt;p&gt;;   usershare max shares = 100&lt;/p&gt;
&lt;h1&gt;Allow users who've been granted usershare privileges to create&lt;/h1&gt;
&lt;h1&gt;public shares, not just authenticated ones&lt;/h1&gt;
&lt;p&gt;usershare allow guests = yes&lt;/p&gt;
&lt;h1&gt;======================= Share Definitions =======================&lt;/h1&gt;
&lt;h1&gt;Un-comment the following (and tweak the other settings below to suit)&lt;/h1&gt;
&lt;h1&gt;to enable the default home directory shares.  This will share each&lt;/h1&gt;
&lt;h1&gt;user's home directory as \server\username&lt;/h1&gt;
&lt;p&gt;;[homes]
;   comment = Home Directories
;   browseable = no&lt;/p&gt;
&lt;h1&gt;By default, the home directories are exported read-only. Change the&lt;/h1&gt;
&lt;h1&gt;next parameter to 'no' if you want to be able to write to them.&lt;/h1&gt;
&lt;p&gt;;   read only = yes&lt;/p&gt;
&lt;h1&gt;File creation mask is set to 0700 for security reasons. If you want to&lt;/h1&gt;
&lt;h1&gt;create files with group=rw permissions, set next parameter to 0775.&lt;/h1&gt;
&lt;p&gt;;   create mask = 0700&lt;/p&gt;
&lt;h1&gt;Directory creation mask is set to 0700 for security reasons. If you want to&lt;/h1&gt;
&lt;h1&gt;create dirs. with group=rw permissions, set next parameter to 0775.&lt;/h1&gt;
&lt;p&gt;;   directory mask = 0700&lt;/p&gt;
&lt;h1&gt;By default, \server\username shares can be connected to by anyone&lt;/h1&gt;
&lt;h1&gt;with access to the samba server.  Un-comment the following parameter&lt;/h1&gt;
&lt;h1&gt;to make sure that only "username" can connect to \server\username&lt;/h1&gt;
&lt;h1&gt;This might need tweaking when using external authentication schemes&lt;/h1&gt;
&lt;p&gt;;   valid users = %S&lt;/p&gt;
&lt;h1&gt;Un-comment the following and create the netlogon directory for Domain Logons&lt;/h1&gt;
&lt;h1&gt;(you need to configure Samba to act as a domain controller too.)&lt;/h1&gt;
&lt;p&gt;;[netlogon]
;   comment = Network Logon Service
;   path = /home/samba/netlogon
;   guest ok = yes
;   read only = yes
;   share modes = no&lt;/p&gt;
&lt;h1&gt;Un-comment the following and create the profiles directory to store&lt;/h1&gt;
&lt;h1&gt;users profiles (see the "logon path" option above)&lt;/h1&gt;
&lt;h1&gt;(you need to configure Samba to act as a domain controller too.)&lt;/h1&gt;
&lt;h1&gt;The path below should be writable by all users so that their&lt;/h1&gt;
&lt;h1&gt;profile directory may be created the first time they log on&lt;/h1&gt;
&lt;p&gt;;[profiles]
;   comment = Users profiles
;   path = /home/samba/profiles
;   guest ok = no
;   browseable = no
;   create mask = 0600
;   directory mask = 0700&lt;/p&gt;
&lt;p&gt;[printers]
   comment = All Printers
   browseable = no
   path = /var/spool/samba
   printable = yes
   guest ok = no
   read only = yes
   create mask = 0700&lt;/p&gt;
&lt;h1&gt;Windows clients look for this share name as a source of downloadable&lt;/h1&gt;
&lt;h1&gt;printer drivers&lt;/h1&gt;
&lt;p&gt;[print$]&lt;/p&gt;
&lt;p&gt;comment = Printer Drivers
   path = /var/lib/samba/printers
   browseable = yes
   read only = yes
   guest ok = no&lt;/p&gt;
&lt;h1&gt;Uncomment to allow remote administration of Windows print drivers.&lt;/h1&gt;
&lt;h1&gt;You may need to replace 'lpadmin' with the name of the group your&lt;/h1&gt;
&lt;h1&gt;admin users are members of.&lt;/h1&gt;
&lt;h1&gt;Please note that you also need to set appropriate Unix permissions&lt;/h1&gt;
&lt;h1&gt;to the drivers directory for these users to have write rights in it&lt;/h1&gt;
&lt;p&gt;;   write list = root, @lpadmin&lt;/p&gt;
&lt;h1&gt;A sample share for sharing your CD-ROM with others.&lt;/h1&gt;
&lt;p&gt;;[cdrom]
;   comment = Samba server's CD-ROM
;   read only = yes
;   locking = no
;   path = /cdrom
;   guest ok = yes&lt;/p&gt;
&lt;h1&gt;The next two parameters show how to auto-mount a CD-ROM when the&lt;/h1&gt;
&lt;h1&gt;cdrom share i/s accesed. For this to work /etc/fstab must contain&lt;/h1&gt;
&lt;h1&gt;an entry like this:&lt;/h1&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h1&gt;/dev/scd0   /cdrom  iso9660 defaults,noauto,ro,user   0 0&lt;/h1&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h1&gt;The CD-ROM gets unmounted automatically after the connection to the&lt;/h1&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h1&gt;If you don't want to use auto-mounting/unmounting make sure the CD&lt;/h1&gt;
&lt;h1&gt;is mounted on /cdrom&lt;/h1&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;p&gt;;   preexec = /bin/mount /cdrom
;   postexec = /bin/umount /cdrom&lt;/p&gt;
&lt;p&gt;[share]&lt;/p&gt;
&lt;p&gt;comment=/home/ggjjlldd
browseable=yes
writeable=yes
public = yes
path=/&lt;/p&gt;
&lt;h1&gt;valid users=ggjjlldd&lt;/h1&gt;
&lt;p&gt;guest ok = yes
client lanman auth = yes
lanman auth = yes
}}}&lt;/p&gt;</summary></entry><entry><title>drupal安装模块上传错误</title><link href="http://liugehao.github.io/drupalan-zhuang-mo-kuai-shang-chuan-cuo-wu.html" rel="alternate"></link><updated>2013-06-07T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-06-07:drupalan-zhuang-mo-kuai-shang-chuan-cuo-wu.html</id><summary type="html">&lt;p&gt;装好drupal7后，安装模块时出现了这样的错误：
{{{&lt;/p&gt;
&lt;p&gt;WARNING: You are not using an encrypted connection, so your password will be sent in plain text. Learn more.&lt;/p&gt;
&lt;p&gt;To continue, provide your server connection details&lt;/p&gt;
&lt;p&gt;Connection method&lt;/p&gt;
&lt;p&gt;FTP CONNECTION SETTINGS
.....&lt;/p&gt;
&lt;p&gt;etc
}}}&lt;/p&gt;
&lt;p&gt;以前wordpress安装插件时也出现过类似的错误，我觉得可能是权限的问题，于是我给了整个module目录777的权限，再试，错误还在。&lt;/p&gt;
&lt;p&gt;于是上网找解决方法，发现有一个外国朋友的解决方案，如下：&lt;/p&gt;
&lt;p&gt;{{{&lt;/p&gt;
&lt;p&gt;I had the same problem with drupal 7rc4 on ubuntu and nginx and for me just were the permissions of drupal files&lt;/p&gt;
&lt;p&gt;I solved it as follows&lt;/p&gt;
&lt;p&gt;open a termninal and write&lt;/p&gt;
&lt;p&gt;sudo chown www-data:www-data -R /var/www/drupal&lt;/p&gt;
&lt;p&gt;where www-data is nginx user (maybe is the same with apache) and /var/www/drupal is the path drupal installation&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;他也出现了同样的错误，不过是在ubuntu的nginx环境下，我的是centos的nginx环境，解决方法是一样的。他的nginx用户名是www-data，drupal安装在/var/www/drupal下，于是打开终端输入：
{{{
sudo chown www-data:www-data -R /var/www/drupal
}}}
就可以了。&lt;/p&gt;
&lt;p&gt;我的nginx用户名是www,drupal安装在/home/wwwroot下面，在终端中输入的是：
{{{
chown www:www -R /home/wwwroot
}}}
然后再安装模块，就没有错误提示了。&lt;/p&gt;
&lt;p&gt;好像以前wordpress出现这样的问题也是这么解决的，记在这里备用吧。&lt;/p&gt;</summary></entry><entry><title>在这里详述 linux/把内存虚拟成硬盘给代码加速。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-linuxba-nei-cun-xu-ni-cheng-ying-pan-gei-dai-ma-jia-su.html" rel="alternate"></link><updated>2013-06-04T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-06-04:zai-zhe-li-xiang-shu-linuxba-nei-cun-xu-ni-cheng-ying-pan-gei-dai-ma-jia-su.html</id><summary type="html">&lt;p&gt;在linux下， 挂载一块内存是相当的简单， 也很方便。&lt;/p&gt;
&lt;p&gt;首先，创建一个文件用来挂载内存块
{{{
mkdir /tmp/sdk
}}}
接下来，挂载
{{{
mount -t tmpfs -o nosuid,mode=1777,size=10m,rw tmpfs /tmp/sdk
}}}
这样， 就成了，把频繁读写的文件方在/tmp/sdk下，   等于是直接读取内存了。&lt;/p&gt;
&lt;p&gt;注意，重启的话，/tmp/sdk下面的数据会丢失。&lt;/p&gt;
&lt;p&gt;也可以加到/etc/fstab里面，让它自动挂载。
{{{
tmpfs　　/tmp/sdk　　tpmfs　　nosuid,mode=1777,size=10m,rw　　0　　0
}}}&lt;/p&gt;
&lt;p&gt;tmpfs是一种虚拟内存文件系统正如这个定义它最大的特点就是它的存储空间在VM里面，这里提一下VM(virtual memory)，VM是由linux内核里面的vm子系统管理，现在大多数操作系统都采用了虚拟内存管理机制。linux下面VM的大小由RM(Real Memory)和swap组成，RM的大小就是物理内存的大小，而Swap的大小是由你自己决定的。Swap是通过硬盘虚拟出来的内存空间，因此它的读写速度相对RM(Real Memory）要慢许多，我们为什么需要Swap呢？当一个进程申请一定数量的内存时，如内核的vm子系统发现没有足够的RM时，就会把RM里面的一些不常用的数据交换到Swap里面，如果需要重新使用这些数据再把它们从Swap交换到RM里面。如果你有足够大的物理内存，根本不需要划分Swap分区。&lt;/p&gt;
&lt;p&gt;通过上面的说明，你该知道tmpfs使用的存储空间VM是什么了吧？前面说过VM由RM+Swap两部分组成，因此tmpfs最大的存储空间可达（The size of RM + The size of Swap）。 但是对于tmpfs本身而言，它并不知道自己使用的空间是RM还是Swap，这一切都是由内核的vm子系统管理的。&lt;/p&gt;
&lt;p&gt;怎样使用tmpfs呢？&lt;/p&gt;
&lt;p&gt;#mount  -t tmpfs -o size=20m  tmpfs /mnt/tmp&lt;/p&gt;
&lt;p&gt;上面这条命令分配了上限为20m的VM到/mnt/tmp目录下，用df命令查看一下，确实/mnt/tmp挂载点显示的大小是20m，但是tmpfs一个优点就是它的大小是随着实际存储的容量而变化的，换句话说，假如/mnt/tmp目录下什么也没有，tmpfs并不占用VM。上面的参数20m只是告诉内核这个挂载点最大可用的VM为20m，如果不加上这个参数，tmpfs默认的大小是RM的一半，假如你的物理内存是128M，那么tmpfs默认的大小就是64M，&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;tmpfs&lt;/span&gt;&lt;span class="err"&gt;有没有缺点呢&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;

&lt;span class="err"&gt;当然有，由于它的数据是在&lt;/span&gt;&lt;span class="n"&gt;VM&lt;/span&gt;&lt;span class="err"&gt;里面，因此断电或者你卸载它之后，数据就会立即丢失，这也许就是它叫&lt;/span&gt;&lt;span class="n"&gt;tmpfs&lt;/span&gt;&lt;span class="err"&gt;的原故。不过这其实不能说是缺点。那&lt;/span&gt;&lt;span class="n"&gt;tmpfs&lt;/span&gt;&lt;span class="err"&gt;到底有什么用呢？&lt;/span&gt;

&lt;span class="n"&gt;tmpfs&lt;/span&gt;&lt;span class="err"&gt;的用途&lt;/span&gt;

 &lt;span class="err"&gt;由于&lt;/span&gt;&lt;span class="n"&gt;tmpfs&lt;/span&gt;&lt;span class="err"&gt;使用的是&lt;/span&gt;&lt;span class="n"&gt;VM&lt;/span&gt;&lt;span class="err"&gt;，因此它比硬盘的速度肯定要快，因此我们可以利用这个优点使用它来提升机器的性能。&lt;/span&gt;

 &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="n"&gt;mount&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="n"&gt;tmpfs&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;   &lt;span class="n"&gt;tmpfs&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;

 &lt;span class="err"&gt;上面这条命令分配了最大&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="err"&gt;的&lt;/span&gt;&lt;span class="n"&gt;VM&lt;/span&gt;&lt;span class="err"&gt;给&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="err"&gt;。&lt;/span&gt;

  &lt;span class="err"&gt;由于&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="err"&gt;目录是放临时文件的地方，因此我们可以使用&lt;/span&gt;&lt;span class="n"&gt;tmpfs&lt;/span&gt;&lt;span class="err"&gt;来加快速度，由于没有挂载之前&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="err"&gt;目录下的文件也许正在被使用，因此挂载之后系统也许有的程序不能正常工作。没有关系，只要在&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;fstab&lt;/span&gt;&lt;span class="err"&gt;里面加上下面的语句&lt;/span&gt;

 &lt;span class="n"&gt;tmpfs&lt;/span&gt;    &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;      &lt;span class="n"&gt;tmpfs&lt;/span&gt;  &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;    &lt;span class="mi"&gt;0&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;重启电脑之后就一切OK了。&lt;/p&gt;
&lt;p&gt;好了，这样在服务器重启之后，就能够自动挂载了。。&lt;/p&gt;</summary></entry><entry><title>pgsql忘记密码 postgresql</title><link href="http://liugehao.github.io/pgsqlwang-ji-mi-ma-postgresql.html" rel="alternate"></link><updated>2013-06-01T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-06-01:pgsqlwang-ji-mi-ma-postgresql.html</id><summary type="html">&lt;p&gt;找到数据库簇目录,里面有pg_hba.conf文件,打开编辑,你将看到类似以下的一行:
{{{
host all all 127.0.0.1/32 md5
}}}
后面的也许不是md5,也许是别的.
将最后的一项改为trust,即如下:
{{{
host all all 127.0.0.1/32 trust
}}}
重新启动数据库服务器.
进入PostgreSQL安装目录的bin目录.执行命令.
{{{
psql -d template1 -U pgsql -c "alter role pgsql password 'liuyou@163.com1';"
}}}
如果服务器响应"ALTER ROLE",说明成功.
然后把pg_hba.conf恢复原样.
重新启动数据库服务器.
这样,数据库中的默认管理员帐户"postgres"的密码就改为"12345678"了. &lt;/p&gt;</summary></entry><entry><title>sql语句分组</title><link href="http://liugehao.github.io/sqlyu-ju-fen-zu.html" rel="alternate"></link><updated>2013-06-01T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-06-01:sqlyu-ju-fen-zu.html</id><summary type="html">&lt;p&gt;比如数据如下&lt;/p&gt;
&lt;p&gt;字段为
id ,v_name,v_value
{{{
v_name v_value
aa aa1 
aa aa2
aa aa3
bb bb1 
bb bb2
bb bb3
}}}
按v_name分组
如aa这一组,假设aa3为最新
bb这一组,假设bb1为最新
怎么样查询后使得记录为
{{{
aa aa3
bb bb1 
}}}
{{{
select
t.v_name,
(select v_value from test where v_name=t.v_name ORDER BY id DESC limit 1) as v_value
FROM 
(select v_name from test group by v_name) AS t 
}}}&lt;/p&gt;</summary></entry><entry><title>moinmoin禁止用户注册</title><link href="http://liugehao.github.io/moinmoinjin-zhi-yong-hu-zhu-ce.html" rel="alternate"></link><updated>2013-05-31T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-05-31:moinmoinjin-zhi-yong-hu-zhu-ce.html</id><summary type="html">&lt;p&gt;wikiconfig.py　中加入：
{{{
actions_excluded = multiconfig.DefaultConfig.actions_excluded + ['newaccount']
}}}&lt;/p&gt;</summary></entry><entry><title>在这里详述 linux/lvm kvm 扩容 缩小容量。也适用于host lvm卷调整</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-linuxlvm-kvm-kuo-rong-suo-xiao-rong-liang-ye-gua-yong-yu-host-lvmjuan-diao-zheng.html" rel="alternate"></link><updated>2013-05-22T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-05-22:zai-zhe-li-xiang-shu-linuxlvm-kvm-kuo-rong-suo-xiao-rong-liang-ye-gua-yong-yu-host-lvmjuan-diao-zheng.html</id><summary type="html">&lt;p&gt;== raw 镜像文件增加容量  ==
{{{
qemu-img info xp_4_test.disk01 #查看文件信息
qemu-img resize xp_4_test.disk01 +150M //更改大小
}}}
在windows中，查看磁盘，会出现空余容量。
==== win2003中 ====
　[[windows2003 extpart.exe更改C盘容量]] 无损增加容量，win2008 diskpart.exe
==== linux lvm ====
用free空间建立一个分区，把分区加入卷组，把卷组空间加入lvm。如果是／分区,用光盘引导进入rescue模式
{{{
fdisk /dev/vda
n //建立分区
p //主分区
lvm pvcreate /dev/vda4 //建立物理卷
lvm vgextend vg卷组名 /dev/vda4 //把物理卷添加到已有卷组
e2fsck -f /dev/vg卷组名/逻辑卷
lvm lvextend /dev/vg卷组名/逻辑卷 +1G //增加逻辑卷容量
resize2fs /dev/vg卷组名/逻辑卷
}}}&lt;/p&gt;
&lt;p&gt;== 缩小容量lvm逻辑卷容量 ==
 1. 在使用lvm命令前加lvm： lvm pvscan; lvm vgscan; lvm lvscan;
 1. 此时找不到/dev/VolGroup00/LogVol00（lvscan 逻辑卷状态不是ACTIVE时），需用lvm lvchange -ay /dev/VolGroup00/LogVol00 加载
 1. 在缩减之前需检测缩减之后的容量是否足够：e2fsck -f /dev/VolGroup00/LogVol00
 1. 调整文件系统 resize2fs /dev/VolGroup00/LogVol00 【newsize】
 1. 再调整逻辑卷 lvm lvreduce -L 【newsize】 /dev/VolGroup00/LogVol00
 1. fsck.ext4 /dev/VolGroup00/LogVol00
 1. '''缩小容量查看vg ＰＥ，lv ＬＥ，blocks是否足够，否则会出错。'''最大缩小容量等于(PE-LE)*PE size&lt;/p&gt;
&lt;p&gt;== 增加容量lvm逻辑卷容量 ==
 1. 在使用lvm命令前加lvm： lvm pvscan; lvm vgscan; lvm lvscan;
 1. 此时找不到/dev/VolGroup00/LogVol00（lvscan 逻辑卷状态不是ACTIVE时），需用lvm lvchange -ay /dev/VolGroup00/LogVol00 加载
 1. 在缩减之前需检测缩减之后的容量是否足够：e2fsck -f /dev/VolGroup00/LogVol00
 1. 调整文件系统  lvm lvextend -L +1G /dev/VolGroup00/LogVol00
 1. 再调整逻辑卷 resize2fs /dev/VolGroup00/LogVol00
 1. fsck.ext4 /dev/VolGroup00/LogVol00&lt;/p&gt;
&lt;p&gt;== 根分区调整 ==
 1. 通过安装光盘进入rescue模式。
 1. 询问是否加载根分区时，选择skip。
 1. 参考上面增减&lt;/p&gt;</summary></entry><entry><title>修改Linux内核参数，减少TCP连接中的TIME-WAIT sockets</title><link href="http://liugehao.github.io/xiu-gai-linuxnei-he-can-shu-jian-shao-tcplian-jie-zhong-de-time-wait-sockets.html" rel="alternate"></link><updated>2013-05-20T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-05-20:xiu-gai-linuxnei-he-can-shu-jian-shao-tcplian-jie-zhong-de-time-wait-sockets.html</id><summary type="html">&lt;p&gt;用netstat -an命令发现服务器中有大量状态为TIME-WAIT的TCP连接，于是用/sbin/sysctl -a查看了一下Linux的各项内核参数，并翻阅有关资料，决定修改其中的两项参数，以达到减少TCP连接中TIME-WAIT sockets的目的。&amp;lt;&lt;BR&gt;&amp;gt;&lt;/p&gt;
&lt;p&gt;vi /etc/sysctl.conf&amp;lt;&lt;BR&gt;&amp;gt;&lt;/p&gt;
&lt;p&gt;编辑/etc/sysctl.conf文件，增加三行：&amp;lt;&lt;BR&gt;&amp;gt;
{{{
net.ipv4.tcp_syncookies = 1
net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_tw_recycle = 1
}}}
说明：&amp;lt;&lt;BR&gt;&amp;gt;
net.ipv4.tcp_syncookies = 1 表示开启SYN Cookies。当出现SYN等待队列溢出时，启用cookies来处理，可防范少量SYN攻击，默认为0，表示关闭；&amp;lt;&lt;BR&gt;&amp;gt;
net.ipv4.tcp_tw_reuse = 1 表示开启重用。允许将TIME-WAIT sockets重新用于新的TCP连接，默认为0，表示关闭；&amp;lt;&lt;BR&gt;&amp;gt;
net.ipv4.tcp_tw_recycle = 1 表示开启TCP连接中TIME-WAIT sockets的快速回收，默认为0，表示关闭。&amp;lt;&lt;BR&gt;&amp;gt;
再执行以下命令，让修改结果立即生效：&amp;lt;&lt;BR&gt;&amp;gt;&lt;/p&gt;
&lt;p&gt;/sbin/sysctl -p&amp;lt;&lt;BR&gt;&amp;gt;&lt;/p&gt;
&lt;p&gt;用以下语句看了一下服务器的TCP状态：
{{{
　　netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}'
　　返回结果如下：
　　ESTABLISHED 1423
　　FIN_WAIT1 1
　　FIN_WAIT2 262
　　SYN_SENT 1
　　TIME_WAIT 962
}}}
效果：处于TIME_WAIT状态的sockets从原来的10000多减少到1000左右。处于SYN_RECV等待处理状态的sockets为0，原来的为50～300。&lt;/p&gt;</summary></entry><entry><title>moinmoin ubuntu nginx</title><link href="http://liugehao.github.io/moinmoin-ubuntu-nginx.html" rel="alternate"></link><updated>2013-05-18T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-05-18:moinmoin-ubuntu-nginx.html</id><summary type="html">&lt;p&gt;vi /etc/rc.local ，在exit 0 前面添加
{{{
uwsgi -x /www/moin/uwsgi.xml &amp;gt;/dev/null 2&amp;gt;&amp;amp;1 &amp;amp;
}}}&lt;/p&gt;
&lt;p&gt;cat /etc/nginx/sites-enabled/wiki
{{{
server {
    listen 4081;
    access_log /dev/null;
    location / {
        include uwsgi_params;
        uwsgi_pass unix:///www/moin/moin.sock;
        uwsgi_modifier1 30;
    }
}&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;cat moin/uwsgi.xml 
{{{
&lt;uwsgi&gt;
    &lt;uid&gt;www-data&lt;/uid&gt;
    &lt;gid&gt;www-data&lt;/gid&gt;
    &lt;plugin&gt;python&lt;/plugin&gt;
    &lt;socket&gt;/www/moin/moin.sock&lt;/socket&gt;
    &lt;wsgi-file&gt;/www/moin/wiki/moin.wsgi&lt;/wsgi-file&gt;
    &lt;limit-as&gt;256&lt;/limit-as&gt;
    &lt;processes&gt;1&lt;/processes&gt;
    &lt;memory-report/&gt;
    &lt;vhost/&gt;
    &lt;no-site/&gt;
&lt;/uwsgi&gt;
}}}&lt;/p&gt;</summary></entry><entry><title>windows2003 extpart.exe更改C盘容量</title><link href="http://liugehao.github.io/windows2003-extpartexegeng-gai-cpan-rong-liang.html" rel="alternate"></link><updated>2013-05-18T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-05-18:windows2003-extpartexegeng-gai-cpan-rong-liang.html</id><summary type="html">&lt;p&gt;extpart.exe&lt;/p&gt;
&lt;p&gt;解压后在 c:\dell\extpart\ 目录下 windows 2003 cmd下执行&lt;/p&gt;
&lt;p&gt;[[attachment:ExtPart.exe]] [[attachment:9347455_1331257508PE5x.jpg]]&lt;/p&gt;</summary></entry><entry><title>设置redis的持久化</title><link href="http://liugehao.github.io/she-zhi-redisde-chi-jiu-hua.html" rel="alternate"></link><updated>2013-05-17T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-05-17:she-zhi-redisde-chi-jiu-hua.html</id><summary type="html">&lt;p&gt;设置redis的配置文件相应段落，下面２种方法均可&lt;/p&gt;
&lt;p&gt;=== 一 设置快照模式 ===&lt;/p&gt;
&lt;h6&gt;&lt;/h6&gt;
&lt;p&gt;{{{&lt;/p&gt;
&lt;h1&gt;900秒（15分钟）之后，且至少1次变更&lt;/h1&gt;
&lt;p&gt;save 900 1　&lt;/p&gt;
&lt;h1&gt;300秒（5分钟）之后，且至少10次变更&lt;/h1&gt;
&lt;p&gt;save 300 10&lt;/p&gt;
&lt;h1&gt;60秒之后，且至少10000次变更&lt;/h1&gt;
&lt;p&gt;save 60 10000&lt;/p&gt;
&lt;p&gt;＃是否压缩
rdbcompression yes　&lt;/p&gt;
&lt;h1&gt;数据库的文件名&lt;/h1&gt;
&lt;p&gt;dbfilename dump.rdb&lt;/p&gt;
&lt;h1&gt;文件路径&lt;/h1&gt;
&lt;p&gt;dir ./
}}}&lt;/p&gt;
&lt;p&gt;=== 二　设置纯累加模式 ===&lt;/p&gt;
&lt;p&gt;{{{
appendonly no 纯累加模式 这里写yes的话，上面save段要都注释掉　，否则写入dump.rdb的内容不能写进aof文件&lt;/p&gt;
&lt;h1&gt;appendfsync always 每次写操作都立刻写入到aof文件。慢。&lt;/h1&gt;
&lt;p&gt;appendfsync everysec 每秒写一次&lt;/p&gt;
&lt;h1&gt;appendfsync no 不要立刻刷，只有在操作系统需要刷的时候再刷。比较快。&lt;/h1&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>moinmoin install nginx uwsgi</title><link href="http://liugehao.github.io/moinmoin-install-nginx-uwsgi.html" rel="alternate"></link><updated>2013-05-16T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-05-16:moinmoin-install-nginx-uwsgi.html</id><summary type="html">&lt;p&gt;=== Config nginx ===&lt;/p&gt;
&lt;p&gt;{{{
server {
    #server_name wiki.example.com;
    listen 4081;
    #access_log /var/log/nginx/access.log;
    #error_log /var/log/nginx/error.log;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;include&lt;/span&gt; &lt;span class="n"&gt;uwsgi_params&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;uwsgi_pass&lt;/span&gt; &lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;///srv/www/moin/moin.sock;&lt;/span&gt;
    &lt;span class="n"&gt;uwsgi_modifier1&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}
}}}&lt;/p&gt;
&lt;p&gt;vi /etc/init/moin.conf
{{{
description "moin uwsgi service"&lt;/p&gt;
&lt;p&gt;start on runlevel [2345]
stop on runlevel [!2345]&lt;/p&gt;
&lt;p&gt;chdir /srv/www/moin/wiki/
exec uwsgi -x /srv/www/moin/wiki/uwsgi.xml
respawn
}}}&lt;/p&gt;</summary></entry><entry><title>nginx/unavailable modifier requested 30 uwsgi</title><link href="http://liugehao.github.io/nginxunavailable-modifier-requested-30-uwsgi.html" rel="alternate"></link><updated>2013-05-16T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-05-16:nginxunavailable-modifier-requested-30-uwsgi.html</id><summary type="html">&lt;p&gt;{{{
your server socket listen backlog is limited to 100 connections
&lt;strong&gt;&lt;em&gt; Operational MODE: single process &lt;/em&gt;&lt;/strong&gt;
&lt;strong&gt;&lt;em&gt; no app loaded. going in full dynamic mode &lt;/em&gt;&lt;/strong&gt;
&lt;strong&gt;&lt;em&gt; uWSGI is running in multiple interpreter mode &lt;/em&gt;&lt;/strong&gt;
spawned uWSGI worker 1 (and the only) (pid: 5207, cores: 1)
-- unavailable modifier requested: 0 --
-- unavailable modifier requested: 0 --
-- unavailable modifier requested: 0 --
-- unavailable modifier requested: 0 --&lt;/p&gt;
&lt;p&gt;}}}
apt-get install uwsgi-plugin-python&lt;/p&gt;</summary></entry><entry><title>rhel5.7部署twitter storm</title><link href="http://liugehao.github.io/rhel57bu-shu-twitter-storm.html" rel="alternate"></link><updated>2013-04-16T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-04-16:rhel57bu-shu-twitter-storm.html</id><summary type="html">&lt;p&gt;== python install ==&lt;/p&gt;
&lt;p&gt;{{{&lt;/p&gt;
&lt;h1&gt;wget http://python.org/ftp/python/2.7.4/Python-2.7.4.tgz&lt;/h1&gt;
&lt;h1&gt;tar zxvf Python-2.7.2.tgz&lt;/h1&gt;
&lt;h1&gt;cd Python-2.7.2&lt;/h1&gt;
&lt;h1&gt;./configure&lt;/h1&gt;
&lt;h1&gt;make&lt;/h1&gt;
&lt;h1&gt;make install&lt;/h1&gt;
&lt;h1&gt;vi /etc/ld.so.conf&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;     &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;/sbin/ldconfig&lt;/h1&gt;
&lt;p&gt;no acceptable C compiler found in $PATH&lt;/p&gt;
&lt;h1&gt;rpm -ivh gcc-4.1.2-51.el5.x86_64.rpm glibc-devel-2.5-65.x86_64.rpm glibc-headers-2.5-65.x86_64.rpm kernel-headers-2.6.18-274.el5.x86_64.rpm&lt;/h1&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;== zookeeper install ==&lt;/p&gt;
&lt;p&gt;{{{
wget http://labs.mop.com/apache-mirror/zookeeper/zookeeper-3.4.5/zookeeper-3.4.5.tar.gz&lt;/p&gt;
&lt;h1&gt;tar zxf zookeeper-3.3.3.tar.gz&lt;/h1&gt;
&lt;h1&gt;cp -R zookeeper-3.3.3 /usr/local/&lt;/h1&gt;
&lt;h1&gt;ln -s /usr/local/zookeeper-3.3.3/ /usr/local/zookeeper&lt;/h1&gt;
&lt;h1&gt;vi ~./bashrc&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;      &lt;span class="n"&gt;export&lt;/span&gt; &lt;span class="n"&gt;ZOOKEEPER_HOME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/usr/local/zookeeper&amp;quot;&lt;/span&gt;

      &lt;span class="n"&gt;export&lt;/span&gt; &lt;span class="n"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;ZOOKEEPER_HOME&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;cp /usr/local/zookeeper/conf/zoo_sample.cfg /usr/local/zookeeper/conf/zoo.cfg&lt;/h1&gt;
&lt;h1&gt;sudo mkdir /tmp/zookeeper&lt;/h1&gt;
&lt;h1&gt;sudo mkdir /var/log/zookeeper&lt;/h1&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;== zeromq install ==&lt;/p&gt;
&lt;p&gt;{{{&lt;/p&gt;
&lt;h1&gt;wget http://download.zeromq.org/zeromq-3.2.2.tar.gz&lt;/h1&gt;
&lt;h1&gt;tar zxf zeromq-3.2.2.tar.gz&lt;/h1&gt;
&lt;h1&gt;cd zeromq-3.2.2&lt;/h1&gt;
&lt;h1&gt;./configure&lt;/h1&gt;
&lt;h1&gt;make&lt;/h1&gt;
&lt;h1&gt;make install&lt;/h1&gt;
&lt;h1&gt;/sbin/ldconfig&lt;/h1&gt;
&lt;p&gt;rpm -ivh gcc-c++-4.1.2-51.el5.x86_64.rpm libstdc++-devel-4.1.2-51.el5.x86_64.rpm &lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;== git ==&lt;/p&gt;
&lt;p&gt;{{{
rpm -ivh perl-DBI-1.52-2.el5.x86_64.rpm
rpm -ivh git-1.7.8.2-2.el5.rf.x86_64.rpm perl-Git-1.7.8.2-2.el5.rf.x86_64.rpm
}}}&lt;/p&gt;
&lt;p&gt;== jzmq install ==&lt;/p&gt;
&lt;p&gt;{{{&lt;/p&gt;
&lt;h1&gt;git clone git://github.com/nathanmarz/jzmq.git&lt;/h1&gt;
&lt;h1&gt;cd jzmq&lt;/h1&gt;
&lt;h1&gt;./autogen.sh&lt;/h1&gt;
&lt;h6&gt;&lt;/h6&gt;
&lt;p&gt;autogen.sh: error: could not find libtool.  libtool is required to run autogen.sh.&lt;/p&gt;
&lt;h1&gt;yum install uuid-devel&lt;/h1&gt;
&lt;h1&gt;rpm -ivh libtool-1.5.22-7.el5_4.x86_64.rpm autoconf-2.59-12.noarch.rpm  automake-1.9.6-2.3.el5.noarch.rpm imake-1.0.2-3.x86_64.rpm&lt;/h1&gt;
&lt;h6&gt;&lt;/h6&gt;
&lt;h1&gt;./configure&lt;/h1&gt;
&lt;p&gt;checking for zmq_init in -lzmq... yes
configure: error: the JAVA_HOME environment variable must be set to your JDK location.&lt;/p&gt;
&lt;h6&gt;&lt;/h6&gt;
&lt;h1&gt;jdk install&lt;/h1&gt;
&lt;p&gt;解压jdk.tar.gz到任意目录&lt;/p&gt;
&lt;p&gt;/etc/profile文件   -- 全部用户有效&lt;/p&gt;
&lt;p&gt;在profile 文件的尾部面加入&lt;/p&gt;
&lt;p&gt;JAVA_HOME=/usr/java/jdk1.5.0_16  -- jdk 的安装路径
PATH=$JAVA_HOME/bin:$PATH
CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar &lt;/p&gt;
&lt;p&gt;export JAVA_HOME
export PATH
export CLASSPATH
export CATALINA_HOME    &lt;/p&gt;
&lt;p&gt;保存 退出
在shell输入 source /etc/profile&lt;/p&gt;
&lt;h6&gt;&lt;/h6&gt;
&lt;hr /&gt;
&lt;h1&gt;make&lt;/h1&gt;
&lt;h1&gt;make install&lt;/h1&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;== storm install ==&lt;/p&gt;
&lt;p&gt;{{{&lt;/p&gt;
&lt;h1&gt;git clone git://github.com/nathanmarz/storm.git&lt;/h1&gt;
&lt;p&gt;wget http://cloud.github.com/downloads/nathanmarz/storm/storm-0.8.1.zip
cp -R storm /usr/local/
vi ~/.bashrc
          export STORM_HOME=/usr/local/storm-0.7.1&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;      &lt;span class="n"&gt;export&lt;/span&gt; &lt;span class="n"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;STORM_HOME&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;=== lein install ===&lt;/p&gt;
&lt;p&gt;{{{
   1. Make sure you have JDK 6 or later.
   2. Download the script.
   3. Place it on your $PATH. (~/bin is a good choice if it is on your path.)
   4. Set it to be executable. (chmod 755 ~/bin/lein)&lt;/p&gt;
&lt;p&gt;wget https://raw.github.com/technomancy/leiningen/stable/bin/lein&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;== zoo.cfg ==&lt;/p&gt;
&lt;p&gt;{{{&lt;/p&gt;
&lt;h1&gt;The number of milliseconds of each tick&lt;/h1&gt;
&lt;p&gt;tickTime=2000&lt;/p&gt;
&lt;h1&gt;The number of ticks that the initial&lt;/h1&gt;
&lt;h1&gt;synchronization phase can take&lt;/h1&gt;
&lt;p&gt;initLimit=10&lt;/p&gt;
&lt;h1&gt;The number of ticks that can pass between&lt;/h1&gt;
&lt;h1&gt;sending a request and getting an acknowledgement&lt;/h1&gt;
&lt;p&gt;syncLimit=5&lt;/p&gt;
&lt;h1&gt;the directory where the snapshot is stored.&lt;/h1&gt;
&lt;p&gt;dataDir=/state/partition1/tmp/zookeeper/data
dataLogDir=/state/partition1/tmp/zookeeper/log&lt;/p&gt;
&lt;h1&gt;the port at which the clients will connect&lt;/h1&gt;
&lt;p&gt;clientPort=2181
server.0=cluster:2888:3888
server.1=compute-0-0:2888:3888
server.2=compute-0-1:2888:3888
机器名不好用的话，改为ＩＰ&lt;/p&gt;
&lt;h1&gt;echo 0 &amp;gt; /state/partition1/tmp/zookeeper/data/myid&lt;/h1&gt;
&lt;p&gt;这一步是每台电脑上都不同的。具体的对应关系参见zoo.cfg中的server.x=hostname:portNumber:portNumber。
}}}&lt;/p&gt;
&lt;p&gt;== 监控 ==&lt;/p&gt;
&lt;p&gt;{{{
nimbus上，运行storm ui ,然后浏览器访问http://localhost:8080
}}}&lt;/p&gt;
&lt;p&gt;== 部署任务  ==&lt;/p&gt;
&lt;p&gt;{{{
[root@cluster target]# storm jar storm-starter-0.0.1-SNAPSHOT.jar storm.starter.WordCountTopology wordcountTop
}}}&lt;/p&gt;
&lt;p&gt;vi /etc/sysconfig/network　rhel修改主机名
vi /etc/sysconfig/network-script/ifcfg-eth0 修改ＩＰ　
多台机器，storm.yaml zoo.cfg要一致&lt;/p&gt;</summary></entry><entry><title>nginx php 504</title><link href="http://liugehao.github.io/nginx-php-504.html" rel="alternate"></link><updated>2013-03-14T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-03-14:nginx-php-504.html</id><summary type="html">&lt;p&gt;nginx.conf http段
{{{
fastcgi_connect_timeout 300s;
　　fastcgi_send_timeout 300s;
　　fastcgi_read_timeout 300s;
　　fastcgi_buffer_size 128k;
　　fastcgi_buffers 8 128k;#8 128
　　fastcgi_busy_buffers_size 256k;
　　fastcgi_temp_file_write_size 256k;
　　fastcgi_intercept_errors on;
}}}
　　这里最主要的设置是前三条，即
{{{
　　fastcgi_connect_timeout 300s;
　　fastcgi_send_timeout 300s;
　　fastcgi_read_timeout 300s;
}}}&lt;/p&gt;</summary></entry><entry><title>ubuntu安装xbmc</title><link href="http://liugehao.github.io/ubuntuan-zhuang-xbmc.html" rel="alternate"></link><updated>2013-02-26T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-02-26:ubuntuan-zhuang-xbmc.html</id><summary type="html">&lt;p&gt;{{{
apt-get update
sudo apt-get install xbmc xinit x11-xserver-utils
sudo adduser xbmc --gecos XBMC
sudo usermod --group audio,video,fuse,cdrom,plugdev xbmc&lt;/p&gt;
&lt;p&gt;sudo vi /etc/init/tty1.conf
}}}
把exec /sbin/getty -8 38400 tty1 换成 exec /bin/login -f xbmc &lt;/dev/tty1 &gt; /dev/tty1 2&amp;gt;&amp;amp;1 ，可以自动登录。
{{{&lt;/p&gt;
&lt;h1&gt;exec /sbin/getty -8 38400 tty1&lt;/h1&gt;
&lt;p&gt;exec /bin/login -f xbmc &lt;/dev/tty1 &gt; /dev/tty1 2&amp;gt;&amp;amp;1
}}}
xbmc帐号下  .bash_profile 文件自动运行xbmc.
{{{
$cat .bash_profile &lt;/p&gt;
&lt;p&gt;case "&lt;code&gt;tty&lt;/code&gt;" in
/dev/tty1) clear &amp;amp;&amp;amp; startx &amp;amp;&amp;gt;/dev/null;;
esac&lt;/p&gt;
&lt;p&gt;$cat .xsession&lt;/p&gt;
&lt;p&gt;exec xbmc --standalone&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;http://bbs.htpc1.com/viewthread.php?tid=88605&amp;amp;page=1&amp;amp;highlight=xbmc+nas+%CF%C2%D4%D8#pid1618908&lt;/p&gt;
&lt;p&gt;== MLDonkey下载服务设置 ==&lt;/p&gt;
&lt;p&gt;{{{
ubuntu下安装MLDonkey很简单，更新下安装包信息库，直接安装有可以了：
sudo apt-get update
sudo apt-get install mldonkey-server
复制代码
安装过程提示是否开机启动MLDonkey，我选择了no，不过作为NAS服务器选yes也许更合适。&lt;/p&gt;
&lt;p&gt;既然选择了No，就得手工启动了，让它在后台运行：
mlnet &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 &amp;amp;
复制代码
注意：如果你安装是选择了开机启动，可以用以下命令停止和启动mldonkey：
sudo /etc/init.d/mldonkey-server stop
sudo /etc/init.d/mldonkey-server start
复制代码
现在先通过telnet进行初步设置：
telnet 127.0.0.1 4000
复制代码
127.0.0.1表示访问本地服务，4000是mldonkey的默认telnet管理端口。进入管理功能后出现&amp;gt;提示符，我们先取得管理权限（现在密码是空）：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;auth admin ""&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;然后设置下管理密码（下面的newpasswd就是密码，用你自己喜欢的代替吧）：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;passwd newpasswd&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;再设置下远程管理的ip范围：
set allowed_ips "127.0.0.1 192.168.255.255"&lt;/p&gt;
&lt;p&gt;这表示本机地址或者局域网内的地址都可访问管理端口。现在可以退出管理了：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;quit&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;mldonkey启动后，它会在当前用户的home目录创建一个隐藏的配置文件目录（~/.mldonkey），所有配置及工作文件都在里面。其中下载文件存放的临时目录就是~/.mldonkey/temp，由于我的数据磁盘和系统磁盘是两个不同物理盘，而我的home目录是在系统盘上，下载的电影将保存在数据盘上，这样下载完成后又会拷贝一次，太不环保了。而mldonkey对temp目录的定义是相对路径，无法定义到其它位置。咱就用软链接方式来解决它。先在删除~/.mldonkey/temp，然后在我的数据盘建立一个目录/mnt/data1/temp，注意设置目录访问权限，然后用这个命令：
ln -s /mnt/data1/temp ~/.mldonkey/temp
复制代码
这样看起来目录在系统盘，其实文件都存放在数据盘，下载完成就不用再真正的复制一回了。&lt;/p&gt;
&lt;p&gt;注意：如果你使用开机启动或者sudo /etc/init.d/mldonkey-server start命令启动，配置文件在/var/lib/mldonkey/目录中&lt;/p&gt;
&lt;p&gt;现在重启一下mldonkey就可以到任意一台联网的电脑上通过浏览器设置及管理下载了。在浏览器中打开我的nas服务器地址，输入管理员密码：&lt;/p&gt;
&lt;p&gt;先看看我的共享目录设置，这里面incoming_files和incoming_directories类型的共享是必须有的，下载完成的东西都被扔到这里。&lt;/p&gt;
&lt;p&gt;其他配置网上很多教程，就不细说了。尝试下载看看，速度不太稳定，不知道还有什么可以改进的地方。&lt;/p&gt;
&lt;p&gt;MLDonkey优化说明
这段时间一边使用一边调整设置，终于能让mldonkey保持满速运行了，把我的主要设置参数列示如下：
max_hard_upload_rate　40
max_hard_download_rate　200（我是1M宽带，顶天就130几K，你应该根据自己的带宽进行设置，或者设为0表示不限制速度）
max_opened_connections　500（这个参数很重要，网上很多优化教程唯一没提到这个参数，默认值200。我开始一直达不到满速，加大这个值就马上满速了）&lt;/p&gt;
&lt;p&gt;ED2K-force_client_high_id　enable（这两个参数是强制高ID，设置的同时要确保电驴用到的端口在宽带路由器上做了端口映射，需要映射的端口号可通过浏览器管理时到help+－－info界面查询）
ED2K-force_high_id　enable
ED2K-max_connected_servers　10（设置服务器最大连接数，默认为3，其实设太大也没用，一般稳定下来也就三四个左右）&lt;/p&gt;
&lt;p&gt;enable_overnet　enable
enable_kademlia　enable（激活KAD网络）&lt;/p&gt;
&lt;p&gt;client_name　[CHN][VeryCD]taxigps（推荐设置成[CHN][VeryCD]yourname的形式
}}}&lt;/p&gt;</summary></entry><entry><title>在这里详述 liugehao-工作-201302。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-liugehao-gong-zuo-201302.html" rel="alternate"></link><updated>2013-02-26T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-02-26:zai-zhe-li-xiang-shu-liugehao-gong-zuo-201302.html</id><summary type="html">&lt;ol&gt;
&lt;li&gt;路由系统测试&lt;/li&gt;
&lt;li&gt;中间运输平台 TTP-12 TTP-15&lt;/li&gt;
&lt;li&gt;TTP-2 关于现付加班单报表需求&lt;/li&gt;
&lt;li&gt;[TTP-5] 车车运营管理系统部分功能修改需求&lt;/li&gt;
&lt;/ol&gt;</summary></entry><entry><title>ubuntu上配置nfs</title><link href="http://liugehao.github.io/ubuntushang-pei-zhi-nfs.html" rel="alternate"></link><updated>2013-02-21T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-02-21:ubuntushang-pei-zhi-nfs.html</id><summary type="html">&lt;p&gt;本文主要介绍Ubuntu 10.04上NFS服务的安装、配置。&lt;/p&gt;
&lt;p&gt;安装NFS相关的软件包
{{{
$ sudo apt-get install nfs-kernel-server 
}}}
进行配置
与之相关的配置文件有：&lt;/p&gt;
&lt;p&gt;/etc/default/nfs-kernel-server
{{{
NEED_SVCGSSD=no # no is default
}}}
注释： 因为我们并不打算启用NFSv4 安全配置
注意： 如果启用，客户端也必须启用&lt;/p&gt;
&lt;p&gt;/etc/default/nfs-common
这是一个common配置文件，也就是说服务器端和客户端都要有相同的配置。
{{{
NEED_IDMAPD=yes # 此项将打开ID映射
NEED_GSSD=no # no is default
}}}
注释：ID映射用于解决服务器端UID与客户机UID不同，而无法访问资源的情况。通过UID映射，只需要相同的用户名即可。&lt;/p&gt;
&lt;p&gt;/etc/idmapd.conf
既然启用了ID映射，就需要配置：
{{{
[Mapping]&lt;/p&gt;
&lt;p&gt;Nobody-User = nobody
Nobody-Group = nogroup
}}}
/etc/exports
{{{
/home/lesca/ARM 192.168.1.0/24(rw,nohide,insecure,sync,no_root_squash)
}}}
选项解释：&lt;/p&gt;
&lt;p&gt;rw - 可读写
nohide - 如果被挂载的目录下的其他目录也是挂载的，此选项将使它们可见
insecure - 允许客户端不使用保留端口
sync - 每次写操作要同步到物理存储器上（而不是仅写入内存）
no_root_squash - 当客户端以root的UID/GID（=0）挂载时，不会分配一个匿名UID/GID（也就是说它创建的文件将属于root）
重启NFS服务
{{{
$ sudo /etc/init.d/nfs-kernel-server restart
}}}
说明：如果只是更新/etc/exports，只需要运行
{{{
$ sudo exportfs -ra 
}}}
即可生效&lt;/p&gt;
&lt;p&gt;挂载
客户端必须安装nfs-common
{{{
$ sudo apt-get install nfs-common
$ sudo mount -t nfs 192.168.1.101:/home/lesca/ARM /home/lesca/test
}}}&lt;/p&gt;</summary></entry><entry><title>xbmc安装万能声卡驱动</title><link href="http://liugehao.github.io/xbmcan-zhuang-mo-neng-sheng-qia-qu-dong.html" rel="alternate"></link><updated>2013-02-18T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-02-18:xbmcan-zhuang-mo-neng-sheng-qia-qu-dong.html</id><summary type="html">&lt;p&gt;{{{
sudo apt-get install alsa-utils
}}}
然后执行
{{{
sudo alsamixer
}}}
按‘m'，把MM改成00，MM状态是静音。
按上下，调整音量。&lt;/p&gt;</summary></entry><entry><title>Cannot set LC_ALL to default locale: No such file or directory</title><link href="http://liugehao.github.io/cannot-set-lc_all-to-default-locale-no-such-file-or-directory.html" rel="alternate"></link><updated>2013-02-05T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-02-05:cannot-set-lc_all-to-default-locale-no-such-file-or-directory.html</id><summary type="html">&lt;p&gt;{{{
locale: Cannot set LC_CTYPE to default locale: No such file or directory
locale: Cannot set LC_MESSAGES to default locale: No such file or directory
locale: Cannot set LC_ALL to default locale: No such file or directory
}}}
解决办法
{{{
sudo locale-gen --lang zh_CN.UTF-8
}}}&lt;/p&gt;</summary></entry><entry><title>ubuntu 12.10中add-apt-repository的软件包</title><link href="http://liugehao.github.io/ubuntu-1210zhong-add-apt-repositoryde-ruan-jian-bao.html" rel="alternate"></link><updated>2013-02-05T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-02-05:ubuntu-1210zhong-add-apt-repositoryde-ruan-jian-bao.html</id><summary type="html">&lt;p&gt;ubuntu 12.10 中add-apt-repository已经不在python-software-properties包中了。&lt;/p&gt;
&lt;p&gt;它在　software-properties-common中&lt;/p&gt;
&lt;p&gt;{{{
sudo aptitude install software-properties-common
}}}&lt;/p&gt;</summary></entry><entry><title>## page was renamed from linux/redhat上安装nginx和php</title><link href="http://liugehao.github.io/page-was-renamed-from-linuxredhatshang-an-zhuang-nginxhe-php.html" rel="alternate"></link><updated>2013-01-14T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-01-14:page-was-renamed-from-linuxredhatshang-an-zhuang-nginxhe-php.html</id><summary type="html">&lt;p&gt;= redhat上安装nginx和php,mysql =
支持oracle,先安装下面２个包，从oracle网站下载相应版本。
{{{
oracle-instantclient-basic-10.2.0.3-1.x86_64.rpm
oracle-instantclient-devel-10.2.0.3-1.x86_64.rpm 
}}}&lt;/p&gt;
&lt;p&gt;http://vladgh.com/blog/install-nginx-and-php-533-php-fpm-mysql-and-apc
{{{
yum install pcre-devel
./configure    --prefix=/opt/nginx    --conf-path=/etc/nginx/nginx.conf    --pid-path=/var/run/nginx.pid    --lock-path=/var/lock/nginx.lock    --http-log-path=/var/log/nginx/access.log    --error-log-path=/var/log/nginx/error.log    --http-client-body-temp-path=/var/lib/nginx/body    --http-proxy-temp-path=/var/lib/nginx/proxy    --http-fastcgi-temp-path=/var/lib/nginx/fastcgi    --http-uwsgi-temp-path=/var/lib/nginx/uwsgi    --http-scgi-temp-path=/var/lib/nginx/scgi    --with-http_ssl_module    --with-http_stub_status_module    --user=apache    --group=apache    --without-mail_pop3_module    --without-mail_imap_module    --without-mail_smtp_module&lt;/p&gt;
&lt;p&gt;yum install libXpm-devel libX11-devel libXdmcp-devel xorg-x11-proto-devel mesa-ligGl-devel freetype-devel&lt;/p&gt;
&lt;p&gt;./configure    --prefix=/opt/php5    --with-config-file-path=/opt/php5/etc    --with-config-file-scan-dir=/opt/php5/etc/conf.d    --with-curl    --with-pear    --with-gd    --with-jpeg-dir    --with-png-dir    --with-zlib    --with-xpm-dir    --with-freetype-dir    --with-mhash    --with-mysql        --with-pdo-mysql    --with-openssl    --with-xmlrpc    --with-xsl    --with-bz2    --with-gettext    --with-fpm-user=apache    --with-fpm-group=apache    --disable-debug    --enable-fpm    --enable-exif    --enable-wddx    --enable-zip    --enable-bcmath    --enable-calendar    --enable-ftp    --enable-mbstring    --enable-soap    --enable-sockets    --enable-sqlite-utf8    --enable-shmop    --enable-dba    --enable-sysvsem    --enable-sysvshm    --enable-sysvmsg --with-apxs2=/usr/local/apache/bin/apxs  --with-oci8=instantclient,/usr/lib/oracle/11.2/client64/lib --with-iconv&lt;/p&gt;
&lt;h1&gt;php5.4.10 不支持 --enable-sqlite-utf8&lt;/h1&gt;
&lt;p&gt;rpm -ivh libX11-devel-1.0.3-11.el5.x86_64.rpm \
libXpm-devel-3.5.5-3.x86_64.rpm \
libX11-devel-1.0.3-11.el5.x86_64.rpm \
libXdmcp-devel-1.0.1-2.1.x86_64.rpm \
xorg-x11-proto-devel-7.1-13.el5.x86_64.rpm \
mesa-libGL-devel-6.5.1-7.8.el5.x86_64.rpm \
freetype-devel-2.2.1-21.el5_3.x86_64.rpm&lt;/p&gt;
&lt;p&gt;mkdir /var/lib/nginx/
mkdir /var/lib/nginx/body
vi /etc/nginx/nginx.conf&lt;/p&gt;
&lt;h1&gt;user  root;&lt;/h1&gt;
&lt;p&gt;worker_processes  4;&lt;/p&gt;
&lt;h1&gt;error_log  logs/error.log;&lt;/h1&gt;
&lt;h1&gt;error_log  logs/error.log  notice;&lt;/h1&gt;
&lt;h1&gt;error_log  logs/error.log  info;&lt;/h1&gt;
&lt;h1&gt;pid        logs/nginx.pid;&lt;/h1&gt;
&lt;p&gt;events {
    worker_connections  4096;
}&lt;/p&gt;
&lt;p&gt;http {
    include       mime.types;
    default_type  application/octet-stream;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#log_format  main  &amp;#39;$remote_addr - $remote_user [$time_local] &amp;quot;$request&amp;quot; &amp;#39;&lt;/span&gt;
&lt;span class="cp"&gt;#                  &amp;#39;$status $body_bytes_sent &amp;quot;$http_referer&amp;quot; &amp;#39;&lt;/span&gt;
&lt;span class="cp"&gt;#                  &amp;#39;&amp;quot;$http_user_agent&amp;quot; &amp;quot;$http_x_forwarded_for&amp;quot;&amp;#39;;&lt;/span&gt;

&lt;span class="cp"&gt;#access_log  logs/access.log  main;&lt;/span&gt;
&lt;span class="n"&gt;client_max_body_size&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;sendfile&lt;/span&gt;        &lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="cp"&gt;#tcp_nopush     on;&lt;/span&gt;

&lt;span class="cp"&gt;#keepalive_timeout  0;&lt;/span&gt;
&lt;span class="cp"&gt;#keepalive_timeout  650;&lt;/span&gt;
&lt;span class="cp"&gt;#client_header_buffer_size 128k;&lt;/span&gt;
&lt;span class="cp"&gt;#large_client_header_buffers 4 128k;&lt;/span&gt;

&lt;span class="n"&gt;gzip&lt;/span&gt;  &lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;include&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;opt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sites&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;enabled&lt;/span&gt;&lt;span class="o"&gt;/*&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;# HTTPS server&lt;/span&gt;
&lt;span class="cp"&gt;#&lt;/span&gt;
&lt;span class="cp"&gt;#server {&lt;/span&gt;
&lt;span class="cp"&gt;#    listen       443;&lt;/span&gt;
&lt;span class="cp"&gt;#    server_name  localhost;&lt;/span&gt;

&lt;span class="cp"&gt;#    ssl                  on;&lt;/span&gt;
&lt;span class="cp"&gt;#    ssl_certificate      cert.pem;&lt;/span&gt;
&lt;span class="cp"&gt;#    ssl_certificate_key  cert.key;&lt;/span&gt;

&lt;span class="cp"&gt;#    ssl_session_timeout  5m;&lt;/span&gt;

&lt;span class="cp"&gt;#    ssl_protocols  SSLv2 SSLv3 TLSv1;&lt;/span&gt;
&lt;span class="cp"&gt;#    ssl_ciphers  ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;&lt;/span&gt;
&lt;span class="cp"&gt;#    ssl_prefer_server_ciphers   on;&lt;/span&gt;

&lt;span class="cp"&gt;#    location / {&lt;/span&gt;
&lt;span class="cp"&gt;#        root   html;&lt;/span&gt;
&lt;span class="cp"&gt;#        index  index.html index.htm;&lt;/span&gt;
&lt;span class="cp"&gt;#    }&lt;/span&gt;
&lt;span class="cp"&gt;#}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;mkdir /opt/nginx/sites-enabled
vi /opt/nginx/sites-enabled/default
server {
    listen       80 default;
    #charset koi8-r;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;access_log&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;access&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;error_log&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;root&lt;/span&gt;   &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;index&lt;/span&gt;  &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;htm&lt;/span&gt; &lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#error_page  404              /404.html;&lt;/span&gt;

&lt;span class="cp"&gt;# redirect server error pages to the static page /50x.html&lt;/span&gt;
&lt;span class="cp"&gt;#&lt;/span&gt;
&lt;span class="n"&gt;error_page&lt;/span&gt;   &lt;span class="mi"&gt;500&lt;/span&gt; &lt;span class="mi"&gt;503&lt;/span&gt; &lt;span class="mi"&gt;504&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="cp"&gt;# proxy the PHP scripts to Apache listening on 127.0.0.1:80&lt;/span&gt;
&lt;span class="cp"&gt;#&lt;/span&gt;
&lt;span class="cp"&gt;#location ~ \.php$ {&lt;/span&gt;
&lt;span class="cp"&gt;#    proxy_pass   http:&lt;/span&gt;&lt;span class="c1"&gt;//127.0.0.1;&lt;/span&gt;
&lt;span class="cp"&gt;#}&lt;/span&gt;

&lt;span class="cp"&gt;# pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000&lt;/span&gt;
&lt;span class="cp"&gt;#&lt;/span&gt;
&lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="o"&gt;~*&lt;/span&gt; &lt;span class="p"&gt;.(&lt;/span&gt;&lt;span class="n"&gt;jpg&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;gif&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;png&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;js&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;css&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;request_filename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;expires&lt;/span&gt; &lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
 &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;

    &lt;span class="n"&gt;fastcgi_pass&lt;/span&gt;   &lt;span class="mf"&gt;127.0.0.1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;9000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;fastcgi_index&lt;/span&gt;  &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;fastcgi_param&lt;/span&gt;  &lt;span class="n"&gt;SCRIPT_FILENAME&lt;/span&gt;  &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;document_root&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;fastcgi_script_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;fastcgi_read_timeout&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;include&lt;/span&gt;        &lt;span class="n"&gt;fastcgi_params&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="cp"&gt;# deny access to .htaccess files, if Apache&amp;#39;s document root&lt;/span&gt;
&lt;span class="cp"&gt;# concurs with nginx&amp;#39;s one&lt;/span&gt;
&lt;span class="cp"&gt;#&lt;/span&gt;
&lt;span class="cp"&gt;#location ~ /\.ht {&lt;/span&gt;
&lt;span class="cp"&gt;#    deny  all;&lt;/span&gt;
&lt;span class="cp"&gt;#}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;vi /etc/init.d/nginx&lt;/p&gt;
&lt;h1&gt;!/bin/sh&lt;/h1&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h1&gt;nginx - this script starts and stops the nginx daemin&lt;/h1&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h1&gt;chkconfig:   - 85 15&lt;/h1&gt;
&lt;h1&gt;description:  Nginx is an HTTP(S) server, HTTP(S) reverse \&lt;/h1&gt;
&lt;h1&gt;proxy and IMAP/POP3 proxy server&lt;/h1&gt;
&lt;h1&gt;processname: nginx&lt;/h1&gt;
&lt;h1&gt;config:      /opt/nginx/conf/nginx.conf&lt;/h1&gt;
&lt;h1&gt;pidfile:     /opt/nginx/logs/nginx.pid&lt;/h1&gt;
&lt;h1&gt;Source function library.&lt;/h1&gt;
&lt;p&gt;. /etc/rc.d/init.d/functions&lt;/p&gt;
&lt;h1&gt;Source networking configuration.&lt;/h1&gt;
&lt;p&gt;. /etc/sysconfig/network&lt;/p&gt;
&lt;h1&gt;Check that networking is up.&lt;/h1&gt;
&lt;p&gt;[ "$NETWORKING" = "no" ] &amp;amp;&amp;amp; exit 0&lt;/p&gt;
&lt;p&gt;nginx="/opt/nginx/sbin/nginx"
prog=$(basename $nginx)&lt;/p&gt;
&lt;p&gt;NGINX_CONF_FILE="/etc/nginx/nginx.conf "&lt;/p&gt;
&lt;p&gt;lockfile=/var/run/nginx.pid&lt;/p&gt;
&lt;p&gt;start() {
    [ -x $nginx ] || exit 5
    [ -f $NGINX_CONF_FILE ] || exit 6
    echo -n $"Starting $prog: "
    daemon $nginx -c $NGINX_CONF_FILE
    retval=$?
    echo
    [ $retval -eq 0 ] &amp;amp;&amp;amp; touch $lockfile
    return $retval
}&lt;/p&gt;
&lt;p&gt;stop() {
    echo -n $"Stopping $prog: "
    killproc $prog -QUIT
    retval=$?
    echo
    [ $retval -eq 0 ] &amp;amp;&amp;amp; rm -f $lockfile
    return $retval
}&lt;/p&gt;
&lt;p&gt;restart() {
    configtest || return $?
    stop
    start
}&lt;/p&gt;
&lt;p&gt;reload() {
    configtest || return $?
    echo -n $"Reloading $prog: "
    killproc $nginx -HUP
    RETVAL=$?
    echo
}&lt;/p&gt;
&lt;p&gt;force_reload() {
    restart
}&lt;/p&gt;
&lt;p&gt;configtest() {
  $nginx -t -c $NGINX_CONF_FILE
}&lt;/p&gt;
&lt;p&gt;rh_status() {
    status $prog
}&lt;/p&gt;
&lt;p&gt;rh_status_q() {
    rh_status &amp;gt;/dev/null 2&amp;gt;&amp;amp;1
}&lt;/p&gt;
&lt;p&gt;case "$1" in
    start)
        rh_status_q &amp;amp;&amp;amp; exit 0
        $1
        ;;
    stop)
        rh_status_q || exit 0
        $1
        ;;
    restart|configtest)
        $1
        ;;
    reload)
        rh_status_q || exit 7
        $1
        ;;
    force-reload)
        force_reload
        ;;
    status)
        rh_status
        ;;
    condrestart|try-restart)
        rh_status_q || exit 0
            ;;
    *)
        echo $"Usage: $0 {start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest}"
        exit 2
esac&lt;/p&gt;
&lt;p&gt;chmod +x /etc/init.d/nginx
/sbin/chkconfig nginx on
/sbin/chkconfig --list nginx&lt;/p&gt;
&lt;p&gt;php-fpm.conf 中的pid设置必须打开和脚本中的一致
vi /etc/init.d/php-fpm&lt;/p&gt;
&lt;h1&gt;! /bin/sh&lt;/h1&gt;
&lt;h3&gt;BEGIN INIT INFO&lt;/h3&gt;
&lt;h1&gt;Provides:          php-fpm&lt;/h1&gt;
&lt;h1&gt;Required-Start:    $remote_fs $network&lt;/h1&gt;
&lt;h1&gt;Required-Stop:     $remote_fs $network&lt;/h1&gt;
&lt;h1&gt;Default-Start:     2 3 4 5&lt;/h1&gt;
&lt;h1&gt;Default-Stop:      0 1 6&lt;/h1&gt;
&lt;h1&gt;Short-Description: starts php-fpm&lt;/h1&gt;
&lt;h1&gt;Description:       starts the PHP FastCGI Process Manager daemon&lt;/h1&gt;
&lt;h3&gt;END INIT INFO&lt;/h3&gt;
&lt;p&gt;prefix=/opt/php5
exec_prefix=${prefix}&lt;/p&gt;
&lt;p&gt;php_fpm_BIN=${exec_prefix}/sbin/php-fpm
php_fpm_CONF=${prefix}/etc/php-fpm.conf
php_fpm_PID=/var/run/php-fpm.pid&lt;/p&gt;
&lt;p&gt;php_opts="--fpm-config $php_fpm_CONF"&lt;/p&gt;
&lt;p&gt;wait_for_pid () {
    try=0&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;test&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;try&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt; &lt;span class="mi"&gt;35&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;

    &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$1&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;in&lt;/span&gt;
        &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;created&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$2&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt;
            &lt;span class="n"&gt;try&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;
        &lt;span class="n"&gt;fi&lt;/span&gt;
        &lt;span class="p"&gt;;;&lt;/span&gt;

        &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;removed&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$2&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt;
            &lt;span class="n"&gt;try&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;
        &lt;span class="n"&gt;fi&lt;/span&gt;
        &lt;span class="p"&gt;;;&lt;/span&gt;
    &lt;span class="n"&gt;esac&lt;/span&gt;

    &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;
    &lt;span class="n"&gt;try&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;expr&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;try&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;
    &lt;span class="n"&gt;sleep&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="n"&gt;done&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;case "$1" in
    start)
        echo -n "Starting php-fpm "&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;php_fpm_BIN&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;php_opts&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$?&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt;
        &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; failed&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;exit&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="n"&gt;fi&lt;/span&gt;

    &lt;span class="n"&gt;wait_for_pid&lt;/span&gt; &lt;span class="n"&gt;created&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;php_fpm_PID&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$try&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt;
        &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; failed&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;exit&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;
        &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; done&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;fi&lt;/span&gt;
&lt;span class="p"&gt;;;&lt;/span&gt;

&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Gracefully shutting down php-fpm &amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;php_fpm_PID&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt;
        &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;warning, no pid file found - php-fpm is not running ?&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;exit&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="n"&gt;fi&lt;/span&gt;

    &lt;span class="n"&gt;kill&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;QUIT&lt;/span&gt; &lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;php_fpm_PID&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;

    &lt;span class="n"&gt;wait_for_pid&lt;/span&gt; &lt;span class="n"&gt;removed&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;php_fpm_PID&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$try&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt;
        &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; failed. Use force-exit&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;exit&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;
        &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; done&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;fi&lt;/span&gt;
&lt;span class="p"&gt;;;&lt;/span&gt;

&lt;span class="n"&gt;force&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;quit&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Terminating php-fpm &amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;php_fpm_PID&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt;
        &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;warning, no pid file found - php-fpm is not running ?&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;exit&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="n"&gt;fi&lt;/span&gt;

    &lt;span class="n"&gt;kill&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;TERM&lt;/span&gt; &lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;php_fpm_PID&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;

    &lt;span class="n"&gt;wait_for_pid&lt;/span&gt; &lt;span class="n"&gt;removed&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;php_fpm_PID&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$try&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt;
        &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; failed&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;exit&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;
        &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; done&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;fi&lt;/span&gt;
&lt;span class="p"&gt;;;&lt;/span&gt;

&lt;span class="n"&gt;restart&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;stop&lt;/span&gt;
    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;
&lt;span class="p"&gt;;;&lt;/span&gt;

&lt;span class="n"&gt;reload&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Reload service php-fpm &amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;php_fpm_PID&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt;
        &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;warning, no pid file found - php-fpm is not running ?&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;exit&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="n"&gt;fi&lt;/span&gt;

    &lt;span class="n"&gt;kill&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;USR2&lt;/span&gt; &lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;php_fpm_PID&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;

    &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; done&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;;;&lt;/span&gt;

&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Usage: $0 {start|stop|force-quit|restart|reload}&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;exit&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="p"&gt;;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;esac&lt;/p&gt;
&lt;p&gt;修改php-fpm.conf.default 
pid = /var/run/php-fpm.pid&lt;/p&gt;
&lt;p&gt;4、编译安装cmakewget http://www.cmake.org/files/v2.8/cmake-2.8.4.tar.gz&lt;/p&gt;
&lt;h1&gt;tar xvzf cmake-2.8.4.tar.gz&lt;/h1&gt;
&lt;h1&gt;cd cmake-2.8.4&lt;/h1&gt;
&lt;h1&gt;./configure&lt;/h1&gt;
&lt;h1&gt;make&amp;amp;make install&lt;/h1&gt;
&lt;p&gt;cd mysql-5.5.11
cmake . -DCMAKE_INSTALL_PREFIX=/opt/mysql55/  -DMYSQL_DATADIR=/opt/mysql55/data  -DWITH_INNOBASE_STORAGE_ENGINE=1  -DMYSQL_TCP_PORT=3306  -DMYSQL_UNIX_ADDR=/var/run/mysql.sock  -DMYSQL_USER=mysql  -DWITH_DEBUG=0&lt;/p&gt;
&lt;p&gt;make &amp;amp;&amp;amp; make install &lt;/p&gt;
&lt;h1&gt;cd /usr/local/mysql55&lt;/h1&gt;
&lt;h1&gt;chown -R mysql .&lt;/h1&gt;
&lt;h1&gt;chgrp -R mysql .&lt;/h1&gt;
&lt;h1&gt;cp support-files/my-huge.cnf /etc/my.cnf&lt;/h1&gt;
&lt;h1&gt;vi /etc/my.cnf&lt;/h1&gt;
&lt;p&gt;将数据目录和套接字文件修改为实际值.&lt;/p&gt;
&lt;h1&gt;scripts/mysql_install_db –user=mysql&lt;/h1&gt;
&lt;h1&gt;chown -R root .&lt;/h1&gt;
&lt;h1&gt;chown -R mysql data&lt;/h1&gt;
&lt;p&gt;以下命令启动mysql&lt;/p&gt;
&lt;h1&gt;bin/mysqld_safe –user=mysql &amp;amp;&lt;/h1&gt;
&lt;p&gt;以下命令测试&lt;/p&gt;
&lt;h1&gt;bin/mysqladmin version&lt;/h1&gt;
&lt;h1&gt;bin/mysqladmin variables&lt;/h1&gt;
&lt;h1&gt;chkconfig –add mysqld&lt;/h1&gt;
&lt;p&gt;到这里就完成了,现在重启电脑进入终端测试&lt;/p&gt;
&lt;h1&gt;cd /usr/local/mysql&lt;/h1&gt;
&lt;h1&gt;bin/mysqlshow&lt;/h1&gt;
&lt;p&gt;如果可以看到数据说明mysql已经自启动了,现在你可以在终端使用
service mysqld stop来停止mysql服务
使用service mysqld start 来启动mysql服务
}}}&lt;/p&gt;</summary></entry><entry><title>redhat用iso做yum源</title><link href="http://liugehao.github.io/redhatyong-isozuo-yumyuan.html" rel="alternate"></link><updated>2013-01-14T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-01-14:redhatyong-isozuo-yumyuan.html</id><summary type="html">&lt;ol&gt;
&lt;li&gt;挂载ISO文件
  {{{&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;mount -o loop RHEL_5.7\ x86_64.iso /media}}}&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;增加一个REPO文件
  {{{&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;vi /etc/yum.repos.d/abc.repo&lt;/h1&gt;
&lt;hr /&gt;
&lt;p&gt;[Server]
name=rhel6server
baseurl=file:///media/Server
enable=1
gpcheck=1
gpgkey=file:///media/RPM-GPG-KEY-redhat-release
}}}
 1. 更新源
  {{{&lt;/p&gt;
&lt;h1&gt;yum update&lt;/h1&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;CategoryRedhat CategoryLinux&lt;/p&gt;</summary></entry><entry><title>在这里详述 liugehao-工作-201301。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-liugehao-gong-zuo-201301.html" rel="alternate"></link><updated>2013-01-05T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-01-05:zai-zhe-li-xiang-shu-liugehao-gong-zuo-201301.html</id><summary type="html">&lt;p&gt;i. 内部事务测试
 i. 韵达系统域名整理
 i. 订单管理系统 与 工单系统接口 测试代码编写，测试&lt;/p&gt;</summary></entry><entry><title>python用abiword将doc转换成html,rtf,pdf...</title><link href="http://liugehao.github.io/pythonyong-abiwordjiang-doczhuan-huan-cheng-htmlrtfpdf.html" rel="alternate"></link><updated>2013-01-04T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2013-01-04:pythonyong-abiwordjiang-doczhuan-huan-cheng-htmlrtfpdf.html</id><summary type="html">&lt;p&gt;{{{
sudo apt-get install abiword -y
abiword -t output.html resume.doc # 将word转换成html
}}}&lt;/p&gt;
&lt;p&gt;{{{#!highlight python
    import subprocess&lt;br /&gt;
    import os&lt;br /&gt;
    import uuid  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;def&lt;/span&gt; &lt;span class="n"&gt;document_to_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;  
    &lt;span class="n"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;/tmp&amp;quot;&lt;/span&gt;  
    &lt;span class="n"&gt;guid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;uuid&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uuid1&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;  
    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="n"&gt;convert&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;using&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;temporary&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;  
    &lt;span class="n"&gt;command&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;abiword -t %(tmp)s/%(guid)s.html %(file_path)s; cat %(tmp)s/%(guid)s.html&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;locals&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;      
    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;subprocess&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Popen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;subprocess&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PIPE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stderr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;subprocess&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PIPE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shell&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cwd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PROJECT_DIR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;website/templates&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;  
    &lt;span class="n"&gt;error&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stderr&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readlines&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;      
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;  
        &lt;span class="n"&gt;raise&lt;/span&gt; &lt;span class="n"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;  
    &lt;span class="n"&gt;html&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readlines&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;  
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>ubuntu wine 安装 rtx</title><link href="http://liugehao.github.io/ubuntu-wine-an-zhuang-rtx.html" rel="alternate"></link><updated>2012-12-26T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-12-26:ubuntu-wine-an-zhuang-rtx.html</id><summary type="html">&lt;p&gt;有的不用安装，这是我机器上.cache上所有的东西,下载过程有的软件找不到，google之。
{{{
sudo apt-get install wine
winetricks baekmuk  flash11 ie8   msxml6    unifont  vcrun2008 win2ksp4 corefonts gdiplus msls31 takao    vb6run   vcrun6 dotnet40  ie6   msxml3 track_usage vcrun2005 wenquanyi
}}}&lt;/p&gt;
&lt;p&gt;安装 rtx
regedit 下面的注册表，解决聊天记录乱码
{{{
REGEDIT4
[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\FontSubstitutes]
"Arial"="simsun"
"Arial CE,238"="simsun"
"Arial CYR,204"="simsun"
"Arial Greek,161"="simsun"
"Arial TUR,162"="simsun"
"Courier New"="simsun"
"Courier New CE,238"="simsun"
"Courier New CYR,204"="simsun"
"Courier New Greek,161"="simsun"
"Courier New TUR,162"="simsun"
"FixedSys"="simsun"
"Helv"="simsun"
"Helvetica"="simsun"
"MS Sans Serif"="simsun"
"MS Shell Dlg"="simsun"
"MS Shell Dlg 2"="simsun"
"System"="simsun"
"Tahoma"="simsun"
"Times"="simsun"
"Times New Roman CE,238"="simsun"
"Times New Roman CYR,204"="simsun"
"Times New Roman Greek,161"="simsun"
"Times New Roman TUR,162"="simsun"
"Tms Rmn"="simsun"
}}}&lt;/p&gt;</summary></entry><entry><title>locale错误</title><link href="http://liugehao.github.io/localecuo-wu.html" rel="alternate"></link><updated>2012-12-24T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-12-24:localecuo-wu.html</id><summary type="html">&lt;p&gt;重新设置。
{{{
rm /var/lib/locales/supported.d/en
rm /var/lib/locales/supported.d/zh
cp /usr/share/i18n/SUPPORTED /var/lib/locales/supported.d/local
vi /var/lib/locales/supported.d/local #保留en zh开头的行&lt;/p&gt;
&lt;p&gt;locale-gen --purge
}}}&lt;/p&gt;</summary></entry><entry><title>在这里详述 liugehao-工作-201212。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-liugehao-gong-zuo-201212.html" rel="alternate"></link><updated>2012-12-06T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-12-06:zai-zhe-li-xiang-shu-liugehao-gong-zuo-201212.html</id><summary type="html">&lt;p&gt;I. QQ、Rtx在ubuntu系统下稳定性测试&lt;/p&gt;</summary></entry><entry><title>在这里详述 python/使用scrapyd来运行spider。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-pythonshi-yong-scrapydlai-yun-xing-spider.html" rel="alternate"></link><updated>2012-12-05T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-12-05:zai-zhe-li-xiang-shu-pythonshi-yong-scrapydlai-yun-xing-spider.html</id><summary type="html">&lt;p&gt;用scrapy写爬虫的时候都是通过crawl来执行，这样的运行方式是只执行一个爬虫，如果想同时运行多个爬虫可以考虑使用scrapyd的方式，也就是scrapy server。&lt;/p&gt;
&lt;p&gt;= 运行scrapyd: =
 . {{{
scrapy server
}}}&lt;/p&gt;
&lt;p&gt;= 部署project: =
 . 查看project的deploy列表 进入到project目录后执行下面的命令
 {{{
scrapy deploy -l
}}}
 如果有返回类似下面的内容的说明配置正确
 {{{
scrapyd              http://localhost:6800/
}}}
 如果没有显示就编辑project的scrapy.cfg里面的deploy
 {{{
[deploy]
url = http://localhost:6800/
project = pitayacd
}}}
 打包并上传
 {{{
scrapy deploy default -p pitayacd
}}}
 返回信息如下
 {{{#!highlight json
{"status": "ok", "project": "pitayacd", "version": "1348817612", "spiders": 1}
}}}&lt;/p&gt;
&lt;p&gt;= 运行jobs =
 . 部署完成后使用curl提交信息到scrapyd就可以运行指定的spiders了
 {{{
curl http://localhost:6800/schedule.json -d project=pitayacd -d spider=spider2
}}}
 参考资料: http://doc.scrapy.org/en/0.14/topics/scrapyd.html&lt;/p&gt;</summary></entry><entry><title>setting up Django with Scrapy</title><link href="http://liugehao.github.io/setting-up-django-with-scrapy.html" rel="alternate"></link><updated>2012-11-30T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-30:setting-up-django-with-scrapy.html</id><summary type="html">&lt;p&gt;Setting up Django with Scrapy&lt;/p&gt;
&lt;p&gt;This guide is about using Django, the most popular Python web framework, and Scrapy, the most popular Python scraping framework. Both of the frameworks are awesome, and they work very well standalone.&lt;/p&gt;
&lt;p&gt;Before you continue reading, make sure you are already beyond “Getting Started” stage for both the frameworks.&lt;/p&gt;
&lt;p&gt;At the end of the guide, what you can achieve is:&lt;/p&gt;
&lt;p&gt;Run scrapy, and auto save the crawled items in Django ORM
1) Scrapy’s settings.py
{{{#!highlight python
def setup_django_env(path):
    import imp, os
    from django.core.management import setup_environ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;desc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;imp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_module&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;project&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;imp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load_module&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;desc&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;setup_environ&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;project&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="cp"&gt;# Add django project to sys.path&lt;/span&gt;
&lt;span class="n"&gt;import&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;
&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abspath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pardir&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;setup_django_env('/path/to/django/myproject/myproject/')
}}}
2) Scrapy’s items.py
{{{#!highlight python
from scrapy.contrib_exp.djangoitem import DjangoItem
from myapp.models import Poll&lt;/p&gt;
&lt;p&gt;class PollItem(DjangoItem):
    django_model = Poll
}}}
3) Scrapy’s pipelines.py
{{{#!highlight python
from myapp.models import Poll&lt;/p&gt;
&lt;p&gt;class PollPipeline(object):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;def&lt;/span&gt; &lt;span class="n"&gt;process_item&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;spider&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;

    &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}}}
Done!&lt;/p&gt;
&lt;p&gt;That’s all to run scrapy and auto save the items to Django ORM. You can now run your regular
{{{#!highlight bash
scrapy crawl myspider
}}}
PS: This guide serves to be complete. It adds to a popular Stackoverflow answer, and completes the picture for Django 1.4, which Django adopts a new layout. And also provide the code for the experimental DjangoItem (rare!).&lt;/p&gt;
&lt;p&gt;== 另外一个 ==&lt;/p&gt;
&lt;p&gt;{{{#!highlight python&lt;/p&gt;
&lt;h1&gt;# django-admin.py startproject djangoapp&lt;/h1&gt;
&lt;h1&gt;# Create your django model: django startapp website&lt;/h1&gt;
&lt;h1&gt;# Edit scrapy settings.py with method to point to Django environment&lt;/h1&gt;
&lt;h1&gt;# Create a pipeline that accesses Django using the model.save() method&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;settings.py&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;import os
ITEM_PIPELINES = ['myapp.pipelines.DjangoPipeline']&lt;/p&gt;
&lt;h1&gt;http://stackoverflow.com/questions/4271975/access-django-models-inside-of-scrapy&lt;/h1&gt;
&lt;p&gt;def setup_django_env(path):
    import imp, os
    from django.core.management import setup_environ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;desc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;imp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_module&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;project&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;imp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load_module&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;desc&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;setup_environ&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;project&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;current_dir = os.path.abspath(os.path.dirname(os.path.dirname(&lt;strong&gt;file&lt;/strong&gt;)))
setup_django_env(os.path.join(current_dir, '../djangoapp/')) #注意此处　djangoapp，不是project目录，应该'/djangoproject/djangoapp/'。确切的说是django的settings.py所在目录。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;pipelines.py&lt;/em&gt;&lt;/strong&gt;
from djangoapp.websites.models import Website
from django.db.utils import IntegrityError&lt;/p&gt;
&lt;p&gt;class DjangoPipeline(object):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;def&lt;/span&gt; &lt;span class="n"&gt;process_item&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;spider&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;website&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Website&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;link&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;link&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
            &lt;span class="n"&gt;created&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
            &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nl"&gt;try:&lt;/span&gt;
      &lt;span class="n"&gt;website&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;except&lt;/span&gt; &lt;span class="n"&gt;IntegrityError&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
      &lt;span class="n"&gt;raise&lt;/span&gt; &lt;span class="n"&gt;DropItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Contains duplicate domain: %s&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;link&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;&lt;em&gt;djangoapp model&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;from django.db import models&lt;/p&gt;
&lt;p&gt;class Website(models.Model):
    link = models.CharField(max_length=200, unique=True)
    created = models.DateTimeField('date created')&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;def&lt;/span&gt; &lt;span class="n"&gt;__unicode__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%s&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;link&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Snippet imported from snippets.scrapy.org (which no longer works)&lt;/h1&gt;
&lt;h1&gt;author: redtricycle&lt;/h1&gt;
&lt;h1&gt;date  : Nov 27, 2011&lt;/h1&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>执行django脚本</title><link href="http://liugehao.github.io/zhi-xing-djangojiao-ben.html" rel="alternate"></link><updated>2012-11-29T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-29:zhi-xing-djangojiao-ben.html</id><summary type="html">&lt;p&gt;在django项目中有时候会需要写一些脚本来执行一些工作，比如初始化数据，测试等等&lt;/p&gt;
&lt;p&gt;但是脚本中必须导入django项目，这时候就需要在脚本中添加如下代码：&lt;/p&gt;
&lt;p&gt;{{{#!highlight python
import os,sys
sys.path.insert(0,os.path.abspath(os.curdir))
from django.core.management import setup_environ
import settings
setup_environ(settings)
}}}
然后该干嘛干嘛&lt;/p&gt;</summary></entry><entry><title>在这里详述 liugehao-工作-201211。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-liugehao-gong-zuo-201211.html" rel="alternate"></link><updated>2012-11-28T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-28:zai-zhe-li-xiang-shu-liugehao-gong-zuo-201211.html</id><summary type="html">&lt;p&gt;I. 1
  i. 小组会议
  i. 培训
  i. Crm系统反馈讨论
 I. 2
  i. ＰＭ谈话，团队培训和管理问题
  i. 过程改进周会
  i. 周报
 I. 5
  i. 阅读hadoop
 I. 6
  i. 帮王雪凯解决sap的webservice错误
 I. 7
  i. ＣＭＭＩ培训
  i. 手机客户端测试协调
 I. 8
  i. 小组周会
  i. sap测试讨论
 I. 9
  i. 周报　，cmmi周会
 I. 12
  i. 帮王雪凯处理分析车辆系统问题
 I. 13
  i. 测试基础信息维护页面
 I. 14
  i. 测试基础信息维护页面
 I. 15
  i. 帮刘慧明解决js脚本问题
 I. 16
  i. 查看组员周报，编写小组周报
  i. 小组周例会
  i. ＣＭＭＩ周会
 I. 19
  i. 
 I. 20
  i. 帮程卫斌处理问题
 I. 21
  i. 帮王雪凯处理问题
 I. 22
  i. 
 I. 23
  i. 小组周会
  i. 测试组培训&lt;/p&gt;
&lt;p&gt;I. 26
  i. 
 I. 27
  i. 查看团购配送项目需求说明书
 I. 28
  i. 帮王雪凯处理ＳＡＰ数据接口程序&lt;/p&gt;</summary></entry><entry><title>postgresql一站式收费脚本</title><link href="http://liugehao.github.io/postgresql-zhan-shi-shou-fei-jiao-ben.html" rel="alternate"></link><updated>2012-11-27T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-27:postgresql-zhan-shi-shou-fei-jiao-ben.html</id><summary type="html">&lt;p&gt;不考虑其它条件，粗略计算。plpythonu 存储过程。
{{{#!highlight python
-- Function: jisuan(date, integer)&lt;/p&gt;
&lt;p&gt;-- DROP FUNCTION jisuan(date, integer);&lt;/p&gt;
&lt;p&gt;CREATE OR REPLACE FUNCTION jisuan(dt date, pagesize integer)
  RETURNS text AS
$BODY$&lt;/p&gt;
&lt;p&gt;import pickle, datetime, math
startdt = datetime.datetime.now()
wd_citys = {}&lt;/p&gt;
&lt;p&gt;for row in plpy.execute('select g.bm,cc."CityID",g.sjdw as sjdw from gs g left join county cc on cc."CountyID" = g.szd::int'):
    wd_citys[row['bm']] = (row['sjdw'], row['CityID'])&lt;/p&gt;
&lt;p&gt;je = {}
plan = plpy.prepare("select szzl,szjg,xzzl,xzjg,shi1,shi2,category from jgsz  where category =1 and ssrq &amp;lt; $1 order by ssrq asc", ['date',])&lt;/p&gt;
&lt;p&gt;for row in plpy.execute(plan, [datetime.datetime.strptime(dt,'%Y-%m-%d'),]):
    if je.has_key(row['shi1']):
        if je[row['shi1']].has_key(row['shi2']):
        je[row['shi1']]['shi2'] = (row['szzl'], row['szjg'], row['xzzl'], row['xzjg'])
        else:
        je[row['shi1']]['shi2'] = (row['szzl'], row['szjg'], row['xzzl'], row['xzjg'])
    else:
        je[row['shi1']] = {row['shi2']:(row['szzl'], row['szjg'], row['xzzl'], row['xzjg'])}&lt;/p&gt;
&lt;p&gt;plan = plpy.prepare("""  select t.docid1,coalesce(g1."GS",g2."GS",g3."GS",g4."GS",0) as gs from tb_scan_je t left join wdtmfw g1 on g1.qsh3 = t.docid3 and t.docid1 between g1.qsh1 and g1.zzh1 left join wdtmfw g2 on g2.zzh3 = t.docid3 and t.docid1 between g2.qsh1 and g2.zzh1 left join gstmfw g3 on g3.qsh2 = t.docid2 and t.docid1 between g3.qsh1 and g3.zzh1 left join gstmfw g4 on g4.zzh2 = t.docid2 and t.docid1 between g4.qsh1 and g4.zzh1 where t.dt = $1 limit $2 offset $3""", ['date','int','int'])
plan1 = plpy.prepare("select scan_site::int as site,scan_type as lb,obj_wei as zl from tb_scan where doc_idint = $1 order by scan_time asc", ['bigint',])
plan2 = plpy.prepare("""INSERT INTO je( doc_id, fjfb, fjcs, djfb, djcs, zl, je, dt)    VALUES ($1, $2, $3, $4, $5, $6, $7, $8);""", ['bigint','int','int','int','int','numeric(5,2)','numeric(5,2)','date'])
plan3 = plpy.prepare("insert into log (doc_id,log) values ($1 ,$2)",['bigint','text'])
plan4 = plpy.prepare("select count(1) as co from tb_scan_je where dt=$1",['date'])
result = plpy.execute(plan4, [dt])
result = result[0]['co']
pages = int(math.ceil(float(result) / pagesize))
for i in range(pages):
    tmp1 = datetime.datetime.now() - startdt
    plpy.info('第'+str(i)+'轮查询：%s' % tmp1.seconds)
    for row in plpy.execute(plan, [dt, pagesize, pagesize * i]):
        tmp = {'doc_id':row['docid1'], 'fjfb':row['gs'], 'fjcs':0, 'djfb':0, 'djcs':0, 'zl':0, 'je':0,'dt':dt}
        try:
            for srow in plpy.execute(plan1, [row['docid1'],]):
                if srow['zl'] !='' and srow['zl'] &amp;gt; tmp['zl']:
                    tmp['zl'] = srow['zl']
                if srow['lb'] == '10' or srow['lb'] == '13':
                    tmp['djfb'] = srow['site']
                    break
                if srow['lb'] in ('03', '17', '18', '44', '96', '97'):
                    tmp['djfb'] = srow['site']&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;and&lt;/span&gt; &lt;span class="n"&gt;wd_citys&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;has_key&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;wd_citys&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;and&lt;/span&gt; &lt;span class="n"&gt;wd_citys&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;has_key&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;wd_citys&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;has_key&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]].&lt;/span&gt;&lt;span class="n"&gt;has_key&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;zl&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;and&lt;/span&gt; &lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;has_key&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]].&lt;/span&gt;&lt;span class="n"&gt;has_key&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;zl&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="nl"&gt;try:&lt;/span&gt;
            &lt;span class="n"&gt;plpy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;plan2&lt;/span&gt;&lt;span class="p"&gt;,[&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;doc_id&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;fjcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djfb&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;djcs&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;zl&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;je&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        &lt;span class="nl"&gt;except:&lt;/span&gt;
            &lt;span class="n"&gt;plpy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;docid1&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
    &lt;span class="nl"&gt;except:&lt;/span&gt;
        &lt;span class="n"&gt;plpy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;docid1&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;

&lt;span class="n"&gt;plpy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;plan3&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;startdt&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strftime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%Y%m%d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;proctime = datetime.datetime.now() - startdt
plpy.execute("insert into log values(0,'%s')"% proctime.seconds)
return str(proctime.seconds)&lt;/p&gt;
&lt;p&gt;$BODY$
  LANGUAGE plpythonu VOLATILE
  COST 100;
ALTER FUNCTION jisuan(date, integer)
  OWNER TO postgres;
}}}&lt;/p&gt;</summary></entry><entry><title>postgresql安装plphp语言</title><link href="http://liugehao.github.io/postgresqlan-zhuang-plphpyu-yan.html" rel="alternate"></link><updated>2012-11-27T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-27:postgresqlan-zhuang-plphpyu-yan.html</id><summary type="html">&lt;p&gt;ubuntu 下postgresql用python写存储过程，直接安装
{{{
apt-get install postgresql-plpython-9.1 #python2
apt-get install postgresql-plpython3-9.1 #python3
}}}
== 用php写存储过程 ==
php的话只能编译安装。&lt;/p&gt;
&lt;p&gt;{{{#!highlight bash&lt;/p&gt;
&lt;h1&gt;php安装&lt;/h1&gt;
&lt;p&gt;wget http://cn2.php.net/get/php-5.4.9.tar.bz2/from/this/mirror 
tar jxf mirror
cd php-5.4.9
./configure --prefix=/usr/local/php5.4.9 --enable-embed #必须embed
make -j 8
make install&lt;/p&gt;
&lt;p&gt;安装plphp&lt;/p&gt;
&lt;p&gt;git clone http://github.com/commandprompt/PL-php.git
cd PL-php
./configure --with-php=/usr/local/php5.4.9
make
make install&lt;/p&gt;
&lt;p&gt;}}}
{{{#!highlight sql&lt;/p&gt;
&lt;h1&gt;psql template1&lt;/h1&gt;
&lt;p&gt;INSERT INTO pg_pltemplate VALUES
('plphp', 't', 't','plphp_call_handler','plphp_call_handler', 'plphp_validator', '$libdir/plphp.so', NULL);&lt;/p&gt;
&lt;p&gt;CREATE FUNCTION plphp_call_handler() RETURNS LANGUAGE_HANDLER AS '$libdir/plphp.so' LANGUAGE C;&lt;/p&gt;
&lt;p&gt;create or replace function php2(dt int,dt1 int)
returns text as
$body$
  $t = array(1,3,4);
  return $dt+$dt1;&lt;/p&gt;
&lt;p&gt;$body$
language plphp;&lt;/p&gt;
&lt;p&gt;select php2(3,4);&lt;/p&gt;
&lt;p&gt;}}}
使用文档 https://public.commandprompt.com/projects/plphp/documents&lt;/p&gt;</summary></entry><entry><title>在PostgreSQL中如何删除重复记录</title><link href="http://liugehao.github.io/zai-postgresqlzhong-ru-he-shan-chu-zhong-fu-ji-lu.html" rel="alternate"></link><updated>2012-11-22T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-22:zai-postgresqlzhong-ru-he-shan-chu-zhong-fu-ji-lu.html</id><summary type="html">&lt;p&gt;在PostgreSQL中删除重复记录其实很简单，不论有多少行重复，只要在要删除重复记录的表中table加一列rownum字段(id为table表中的主键)，类型设置为serial类型即可，然后执行sql
{{{#!highlight sql
delete from table where rownum not in(
    select max(rownum) from table group by id
)
}}}&lt;/p&gt;
&lt;p&gt;最后删除列rownum即可&lt;/p&gt;</summary></entry><entry><title>在postgreSQL中使用正则表达式</title><link href="http://liugehao.github.io/zai-postgresqlzhong-shi-yong-zheng-ze-biao-da-shi.html" rel="alternate"></link><updated>2012-11-20T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-20:zai-postgresqlzhong-shi-yong-zheng-ze-biao-da-shi.html</id><summary type="html">&lt;p&gt;PostgreSQL真的很强，查询时候还可以用正则表达式。&lt;/p&gt;
&lt;p&gt;比如，要查询某个字段是以字母开头的纪录
{{{#!highlight sql
select * from dummy where inf1 ~* '^[A-Z]'
}}}
以数字开头的纪录
{{{#!highlight sql
select * from dummy where inf1 ~ '^[0-9]'
}}}
其他的很复杂的查询，只需修改操作符以及正则表达式。&lt;/p&gt;
&lt;p&gt;正则表达式的操作符使用方法如下：
{{{
~   匹配正则表达式，大小写相关。 例: 'thomas' ~ '.&lt;em&gt;thomas.&lt;/em&gt;'&lt;br /&gt;
~&lt;em&gt;  匹配正则表达式，大小写无关。 例: 'thomas' ~&lt;/em&gt; '.&lt;em&gt;Thomas.&lt;/em&gt;'&lt;br /&gt;
!~  不匹配正则表达式，大小写相关。例: 'thomas' !~ '.&lt;em&gt;Thomas.&lt;/em&gt;'&lt;br /&gt;
!~&lt;em&gt; 不匹配正则表达式，大小写无关。例: 'thomas' !~&lt;/em&gt; '.&lt;em&gt;vadim.&lt;/em&gt;'
}}}
如果不是特别复杂的条件，用LIKE(大小写相关)或者ILIKE(大小写无关)就可以实现。 &lt;/p&gt;</summary></entry><entry><title>nginx php 上传文件大小限制</title><link href="http://liugehao.github.io/nginx-php-shang-chuan-wen-jian-da-xiao-xian-zhi.html" rel="alternate"></link><updated>2012-11-15T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-15:nginx-php-shang-chuan-wen-jian-da-xiao-xian-zhi.html</id><summary type="html">&lt;p&gt;在php.ini里面查看如下行：
{{{
upload_max_filesize = 8M
post_max_size = 10M
memory_limit = 20M
}}}&lt;/p&gt;
&lt;p&gt;nginx主配置文件nginx.conf，找到http{}段，添加
{{{
client_max_body_size 20m;
}}}&lt;/p&gt;</summary></entry><entry><title>postgresql 导入导出压缩分割</title><link href="http://liugehao.github.io/postgresql-dao-ru-dao-chu-ya-suo-fen-ge.html" rel="alternate"></link><updated>2012-11-15T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-15:postgresql-dao-ru-dao-chu-ya-suo-fen-ge.html</id><summary type="html">&lt;p&gt;用pg_dump导出，再导入，大文件用压缩的。
{{{
pg_dump dbname | gzip &amp;gt; filename.gz&lt;/p&gt;
&lt;p&gt;Reload with:&lt;/p&gt;
&lt;p&gt;gunzip -c filename.gz | psql dbname
}}}
或者文档分割：
{{{
pg_dump dbname | split -b 1m - filename&lt;/p&gt;
&lt;p&gt;Reload with:&lt;/p&gt;
&lt;p&gt;cat filename* | psql dbname
}}}&lt;/p&gt;</summary></entry><entry><title>postgresql 进程管理</title><link href="http://liugehao.github.io/postgresql-jin-cheng-guan-li.html" rel="alternate"></link><updated>2012-11-15T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-15:postgresql-jin-cheng-guan-li.html</id><summary type="html">&lt;p&gt;虽然可以使用 kill -9 来强制删除用户进程，但是不建议这么去做。&lt;/p&gt;
&lt;p&gt;因为：对于执行update的语句来说，kill掉进程，可能会导致Postgres进入到recovery mode&lt;/p&gt;
&lt;p&gt;而在recovery mode下，会锁表，不允许链接数据库。&lt;/p&gt;
&lt;p&gt;通常情况下：使用如下语句&lt;/p&gt;
&lt;p&gt;{{{#!highlight sql
=# select datname,procpid,query_start,current_query,waiting,client_addr from pg_stat_activity where waiting='t';
}}}&lt;/p&gt;
&lt;p&gt;来查看有哪些SQL正在执行。&lt;/p&gt;
&lt;p&gt;通过命令：
{{{#!highlight sql
=# select pg_cancel_backend(线程id);
}}}
来kill掉指定的SQL语句。&lt;/p&gt;
&lt;p&gt;（这个函数只能 kill  Select 查询，而updae,delete DML不生效）&lt;/p&gt;
&lt;p&gt;使用
{{{#!highlight sql
=# select  pg_terminate_backend(pid int)
}}}
可以kill 各种DML(SELECT,UPDATE,DELETE,DROP)操作&lt;/p&gt;</summary></entry><entry><title>python技巧</title><link href="http://liugehao.github.io/pythonji-qiao.html" rel="alternate"></link><updated>2012-11-15T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-15:pythonji-qiao.html</id><summary type="html">&lt;p&gt;1到100中6出现了几次？
{{{#!highlight python
sum([str(x).count('6') for x in range(1,101) ])&lt;/p&gt;
&lt;p&gt;list(itertools.ifilter(lambda x: str(x).count('6') &amp;gt; 0, range(1,101)))
}}}&lt;/p&gt;
&lt;p&gt;实现一个函数，给一个数，只能被5整除时返回字符a，只能被7整除时返回字符b,同时能被5和7整除时返回ab，要求尽量少的使用求余运算。
{{{#!highlight python
lambda n: n / 7 * 7 == n
def fun(n)
  s = []
  if n / 5 * 5 == n:
    s.append('a')
  if n / 7 * 7 == n:
    s.append('b')
  return ''.join(s)
}}}&lt;/p&gt;</summary></entry><entry><title>How can I change 'shmmax'</title><link href="http://liugehao.github.io/how-can-i-change-shmmax.html" rel="alternate"></link><updated>2012-11-14T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-14:how-can-i-change-shmmax.html</id><summary type="html">&lt;p&gt;How can I change 'shmmax'&lt;/p&gt;
&lt;p&gt;I have installed Oracle 9i on RedHat 9.&lt;/p&gt;
&lt;p&gt;Current value of 'shmmax' is 33554432.&lt;/p&gt;
&lt;p&gt;Some people recommend value of appr. 50% of the RAM.&lt;/p&gt;
&lt;p&gt;I tried to change the value of 'shmmax' in two ways:
{{{
    1. cat 268435456 &amp;gt; /proc/sys/kernel/shmmax
    2. sysctl -w kernel.shmmax=268435456
}}}
    After restarting the machine the value of 'shmmax' is 33554432 again ?!?&lt;/p&gt;
&lt;p&gt;=== 重启后恢复无效解决办法(彻底) ===
As root I edited '''/etc/sysctl.conf''' by adding following line at the end of the file:
{{{
kernel.shmmax = 268435456
}}}
After rebooting the machine I found the same value (268435456) in /proc/sys/kernel/shmmax&lt;/p&gt;
&lt;p&gt;So, I guess the things go as follows:&lt;/p&gt;
&lt;p&gt;"/proc/sys/kernel/shmmax" reads the value from the "/etc/sysctl.conf"&lt;/p&gt;
&lt;p&gt;If there's nothing about SHMMAX excplicitly in "/etc/sysctl.conf" then I guess "/proc/sys/kernel/shmmax" accepts the 33554432 which could be the default, I suppose.&lt;/p&gt;
&lt;p&gt;That's Ok. &lt;/p&gt;</summary></entry><entry><title>vmware的linux内核补丁</title><link href="http://liugehao.github.io/vmwarede-linuxnei-he-bu-ding.html" rel="alternate"></link><updated>2012-11-14T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-14:vmwarede-linuxnei-he-bu-ding.html</id><summary type="html">&lt;p&gt;http://pavlinux.ru/vmware/
下载相应的内核的补丁，安装。
{{{&lt;/p&gt;
&lt;h1&gt;cd /usr/lib/vmware/modules;&lt;/h1&gt;
&lt;h1&gt;wget http://pavlinux.ru/vmware/8.0.4/source.tar.lzma;&lt;/h1&gt;
&lt;h1&gt;md5sum source.tar.lzma;&lt;/h1&gt;
&lt;p&gt;e37e41a818a47ec868bdb493197aaf63 source.tar.lzma&lt;/p&gt;
&lt;h1&gt;tar -xf source.tar.lzma;&lt;/h1&gt;
&lt;h1&gt;vmware-modconfig --console --install-all;&lt;/h1&gt;
&lt;p&gt;}}}
vmware版本，差不多就可以，主要是linux内核版本。&lt;/p&gt;
&lt;p&gt;比如vmware 8.0.2, kernel 3.5.0 用&lt;/p&gt;
&lt;p&gt;{{{
Patches for VMware® Workstation 8.0.4 build-744019
Tested with linux kernel 3.2.20 and 3.5.0-rc3+ (updated 17.06.2012) 
}}}&lt;/p&gt;</summary></entry><entry><title>mysql更改目录不能启动</title><link href="http://liugehao.github.io/mysqlgeng-gai-mu-lu-bu-neng-qi-dong.html" rel="alternate"></link><updated>2012-11-13T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-13:mysqlgeng-gai-mu-lu-bu-neng-qi-dong.html</id><summary type="html">&lt;p&gt;执行操作
{{{&lt;/p&gt;
&lt;h1&gt;cp -Rp /var/lib/mysql /data&lt;/h1&gt;
&lt;h1&gt;vi /etc/mysql/my.cnf&lt;/h1&gt;
&lt;p&gt;datadir = /data/mysql&lt;/p&gt;
&lt;h1&gt;service mysql start&lt;/h1&gt;
&lt;p&gt;start: Job failed to start
}}}&lt;/p&gt;
&lt;p&gt;出错，查看日志
{{{&lt;/p&gt;
&lt;h1&gt;tail -n 100 /var/log/syslog&lt;/h1&gt;
&lt;p&gt;Nov 13 16:21:18 ubuntu1204 kernel: [ 1480.661013] type=1400 audit(1352794878.342:128): apparmor="DENIED" operation="mknod" parent=1 profile="/usr/sbin/mysqld" name="/data/mysql/ubuntu1204.lower-test" pid=3436 comm="mysqld" requested_mask="c" denied_mask="c" fsuid=0 ouid=0
Nov 13 16:21:18 ubuntu1204 kernel: [ 1480.661125] type=1400 audit(1352794878.342:129): apparmor="DENIED" operation="mknod" parent=1 profile="/usr/sbin/mysqld" name="/data/mysql/ubuntu1204.lower-test" pid=3436 comm="mysqld" requested_mask="c" denied_mask="c" fsuid=0 ouid=0
Nov 13 16:21:18 ubuntu1204 kernel: [ 1480.664373] type=1400 audit(1352794878.346:130): apparmor="DENIED" operation="open" parent=1 profile="/usr/sbin/mysqld" name="/data/mysql/mysql/plugin.frm" pid=3436 comm="mysqld" requested_mask="r" denied_mask="r" fsuid=111 ouid=111
Nov 13 16:21:18 ubuntu1204 kernel: [ 1480.690690] type=1400 audit(1352794878.370:131): apparmor="DENIED" operation="open" parent=1 profile="/usr/sbin/mysqld" name="/data/mysql/ibdata1" pid=3436 comm="mysqld" requested_mask="rw" denied_mask="rw" fsuid=111 ouid=111
Nov 13 16:21:18 ubuntu1204 kernel: [ 1480.694115] init: mysql main process (3436) terminated with status 1
Nov 13 16:21:18 ubuntu1204 kernel: [ 1480.694150] init: mysql main process ended, respawning
Nov 13 16:21:19 ubuntu1204 kernel: [ 1481.666854] init: mysql post-start process (3437) terminated with status 1
Nov 13 16:21:19 ubuntu1204 kernel: [ 1481.723300] init: mysql main process (3474) terminated with status 1
Nov 13 16:21:19 ubuntu1204 kernel: [ 1481.723332] init: mysql respawning too fast, stopped&lt;/p&gt;
&lt;p&gt;}}}
== 解决办法 ==
更改 /var/lib/mysql 为/data/mysql&lt;/p&gt;
&lt;p&gt;原来是 apparmor 做了限制。AppArmor 是内核的一个安全增强模块，对程序存取资源进行限制。
{{{&lt;/p&gt;
&lt;h1&gt;vi /etc/apparmor.d/usr.sbin.mysqld&lt;/h1&gt;
&lt;p&gt;/usr/sbin/mysqld {
  #include &lt;abstractions/base&gt;
  #include &lt;abstractions/nameservice&gt;
  #include &lt;abstractions/user-tmp&gt;
  #include &lt;abstractions/mysql&gt;
  #include &lt;abstractions/winbind&gt;&lt;/p&gt;
&lt;p&gt;capability dac_override,
  capability sys_resource,
  capability setgid,
  capability setuid,&lt;/p&gt;
&lt;p&gt;network tcp,&lt;/p&gt;
&lt;p&gt;/etc/hosts.allow r,
  /etc/hosts.deny r,&lt;/p&gt;
&lt;p&gt;/etc/mysql/&lt;em&gt;.pem r,
  /etc/mysql/conf.d/ r,
  /etc/mysql/conf.d/&lt;/em&gt; r,
  /etc/mysql/&lt;em&gt;.cnf r,
  /usr/lib/mysql/plugin/ r,
  /usr/lib/mysql/plugin/&lt;/em&gt;.so&lt;em&gt; mr,
  /usr/sbin/mysqld mr,
  /usr/share/mysql/&lt;strong&gt; r,
  /var/log/mysql.log rw,
  /var/log/mysql.err rw,
  /data/mysql/ r,
  /data/mysql/&lt;/strong&gt; rwk,
  /var/log/mysql/ r,
  /var/log/mysql/&lt;/em&gt; rw,
  /var/run/mysqld/mysqld.pid w,
  /var/run/mysqld/mysqld.sock w,
  /run/mysqld/mysqld.pid w,
  /run/mysqld/mysqld.sock w,&lt;/p&gt;
&lt;p&gt;/sys/devices/system/cpu/ r,&lt;/p&gt;
&lt;p&gt;# Site-specific additions and overrides. See local/README for details.
  #include &lt;local/usr.sbin.mysqld&gt;
}&lt;/p&gt;
&lt;h1&gt;service mysql start&lt;/h1&gt;
&lt;p&gt;mysql start/running, process 3516
}}}&lt;/p&gt;</summary></entry><entry><title>阻止Google转换搜索链接地址</title><link href="http://liugehao.github.io/zu-zhi-googlezhuan-huan-sou-suo-lian-jie-di-zhi.html" rel="alternate"></link><updated>2012-11-09T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-09:zu-zhi-googlezhuan-huan-sou-suo-lian-jie-di-zhi.html</id><summary type="html">&lt;p&gt;Firefox 安装　Greasemonkey：http://www.greasespot.net/&lt;/p&gt;
&lt;p&gt;Chrome 安装　Tampermonkey：http://tampermonkey.biniok.net/crx/tampermonkey_retro.crx&lt;/p&gt;
&lt;p&gt;然后安装 http://userscripts.org/scripts/show/125473&lt;/p&gt;
&lt;p&gt;或者
{{{#!highlight javascript
// ==UserScript==
// @name           Google Real Link
// @namespace      http://userscripts.org/scripts/show/125473
// @description    Disable the Google search rewrite, always showing and using the real, original, direct link URLs, to stop being tracked, also to prevent from using redirected pages that might be temporarily unavailable in some area. See: http://userscripts.org/scripts/show/125473
// @include        http://www.google.&lt;em&gt;/&lt;/em&gt;
// @include        https://www.google.&lt;em&gt;/&lt;/em&gt;
// @include        https://encrypted.google.&lt;em&gt;/&lt;/em&gt;
// @updateURL      https://userscripts.org/scripts/source/125473.meta.js
// @downloadURL    https://userscripts.org/scripts/source/125473.user.js
// @version        1.1
// @author         tomchen1989
// @license        MIT/Expat license
// ==/UserScript==
function addEventCompatible(obj, evt, fn){
    if (obj.addEventListener) {//W3C
        obj.addEventListener(evt, fn, false);
    } else if (obj.attachEvent) {//IE
        obj.attachEvent("on" + evt, fn);
    }
}
function getWindow(windowObjName) {//works after window[windowObjName] loaded
    if (typeof(unsafeWindow) !== "undefined" &amp;amp;&amp;amp; typeof(unsafeWindow[windowObjName]) !== "undefined") {//Greasemonkey
        return unsafeWindow;
    } else if (typeof(window[windowObjName]) !== "undefined") {//Opera, etc.
        return window;
    } else {
        try {//Google Chrome
            var div = document.createElement("div");
            div.setAttribute("onclick", "return window;");
            var windowCompatible = div.onclick();
            if (typeof(windowCompatible[windowObjName]) === "undefined") {
                return false;
            } else {
                return windowCompatible;
            }
        } catch (e) {
            return false;
        }
    }
}
addEventCompatible(window, "load", function() {
    if (getWindow("rwt")) {
        getWindow("rwt").rwt = function () {}
    }
})
}}}&lt;/p&gt;</summary></entry><entry><title>r1.0.4 single node setup</title><link href="http://liugehao.github.io/r104-single-node-setup.html" rel="alternate"></link><updated>2012-11-08T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-08:r104-single-node-setup.html</id><summary type="html">&lt;p&gt;= Single Node Setup =
 * [[http://hadoop.apache.org/docs/r1.0.4/single_node_setup.html#Purpose|Purpose]]
 * [[http://hadoop.apache.org/docs/r1.0.4/single_node_setup.html#PreReqs|Prerequisites]]
  * [[http://hadoop.apache.org/docs/r1.0.4/single_node_setup.html#Supported+Platforms|Supported Platforms]]
  * [[http://hadoop.apache.org/docs/r1.0.4/single_node_setup.html#Required+Software|Required Software]]
  * [[http://hadoop.apache.org/docs/r1.0.4/single_node_setup.html#Installing+Software|Installing Software]]
 * [[http://hadoop.apache.org/docs/r1.0.4/single_node_setup.html#Download|Download]]
 * [[http://hadoop.apache.org/docs/r1.0.4/single_node_setup.html#Prepare+to+Start+the+Hadoop+Cluster|Prepare to Start the Hadoop Cluster]]
 * [[http://hadoop.apache.org/docs/r1.0.4/single_node_setup.html#Local|Standalone Operation]]
 * [[http://hadoop.apache.org/docs/r1.0.4/single_node_setup.html#PseudoDistributed|Pseudo-Distributed Operation]]
  * [[http://hadoop.apache.org/docs/r1.0.4/single_node_setup.html#Configuration|Configuration]]
  * [[http://hadoop.apache.org/docs/r1.0.4/single_node_setup.html#Setup+passphraseless|Setup passphraseless ssh]]
  * [[http://hadoop.apache.org/docs/r1.0.4/single_node_setup.html#Execution|Execution]]
 * [[http://hadoop.apache.org/docs/r1.0.4/single_node_setup.html#FullyDistributed|Fully-Distributed Operation]]&lt;/p&gt;
&lt;p&gt;== Purpose ==
This document describes how to set up and configure a single-node Hadoop       installation so that you can quickly perform simple operations using Hadoop       MapReduce and the Hadoop Distributed File System (HDFS).&lt;/p&gt;
&lt;p&gt;== Prerequisites ==
=== Supported Platforms ===
 * GNU/Linux is supported as a development and production platform.              Hadoop has been demonstrated on GNU/Linux clusters with 2000 nodes.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Win32 is supported as a ''development platform''. Distributed              operation has not been well tested on Win32, so it is not              supported as a ''production platform''.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;=== Required Software ===
 . Required software for Linux and Windows include:
  1. Java^TM^ 1.6.x, preferably from Sun, must be installed.
 * '''ssh''' must be installed and '''sshd''' must              be running to use the Hadoop scripts that manage remote Hadoop              daemons. Additional requirements for Windows include:
  1. [[http://www.cygwin.com/|Cygwin]] - Required for shell              support in addition to the required software above.&lt;/p&gt;
&lt;p&gt;=== Installing Software ===
 . If your cluster doesn't have the requisite software you will need to         install it. For example on Ubuntu Linux: $ sudo apt-get install ssh
  . $ sudo apt-get install rsync
 On Windows, if you did not install the required software when you          installed cygwin, start the cygwin installer and select the packages:
  * openssh - the ''Net'' category&lt;/p&gt;
&lt;p&gt;== Download ==
To get a Hadoop distribution, download a recent          [[http://hadoop.apache.org/core/releases.html|stable release]] from one of the Apache Download         Mirrors.&lt;/p&gt;
&lt;p&gt;== Prepare to Start the Hadoop Cluster ==
Unpack the downloaded Hadoop distribution. In the distribution, edit the         file conf/hadoop-env.sh to define at least          JAVA_HOME to be the root of your Java installation.&lt;/p&gt;
&lt;p&gt;. Try the following command:
  . $ bin/hadoop
  . This will display the usage documentation for the '''hadoop'''          script.
 Now you are ready to start your Hadoop cluster in one of the three supported       modes:
  * Local (Standalone) Mode
 * Pseudo-Distributed Mode
 * Fully-Distributed Mode&lt;/p&gt;
&lt;p&gt;== Standalone Operation ==
By default, Hadoop is configured to run in a non-distributed        mode, as a single Java process. This is useful for debugging.&lt;/p&gt;
&lt;p&gt;. The following example copies the unpacked conf directory to          use as input and then finds and displays every match of the given regular          expression. Output is written to the given output directory.
  . $ mkdir input $ cp conf/&lt;em&gt;.xml input
   . $ bin/hadoop jar hadoop-examples-&lt;/em&gt;.jar grep input output 'dfs[a-z.]+'
  $ cat output/*&lt;/p&gt;
&lt;p&gt;== Pseudo-Distributed Operation ==
Hadoop can also be run on a single-node in a pseudo-distributed mode      where each Hadoop daemon runs in a separate Java process.&lt;/p&gt;
&lt;p&gt;=== Configuration ===
 . Use the following:
  . conf/core-site.xml:
 {{{
&lt;configuration&gt;
     &lt;property&gt;
         &lt;name&gt;fs.default.name&lt;/name&gt;
         &lt;value&gt;hdfs://localhost:9000&lt;/value&gt;
     &lt;/property&gt;
&lt;/configuration&gt;
}}}
 conf/hdfs-site.xml:
 {{{
&lt;configuration&gt;
     &lt;property&gt;
         &lt;name&gt;dfs.replication&lt;/name&gt;
         &lt;value&gt;1&lt;/value&gt;
     &lt;/property&gt;
&lt;/configuration&gt;
}}}
 conf/mapred-site.xml:
 {{{
&lt;configuration&gt;
     &lt;property&gt;
         &lt;name&gt;mapred.job.tracker&lt;/name&gt;
         &lt;value&gt;localhost:9001&lt;/value&gt;
     &lt;/property&gt;
&lt;/configuration&gt;
}}}&lt;/p&gt;
&lt;p&gt;=== Setup passphraseless ssh ===
 . Now check that you can ssh to the localhost without a passphrase:
  . $ ssh localhost
 If you cannot ssh to localhost without a passphrase, execute the            following commands:
  . $ ssh-keygen -t dsa -P '' -f ~/.ssh/id_dsa $ cat ~/.ssh/id_dsa.pub &amp;gt;&amp;gt; ~/.ssh/authorized_keys ''&lt;/p&gt;
&lt;p&gt;=== Execution ===
 . ''Format a new distributed-filesystem:   . $ bin/hadoop namenode -format
Start the hadoop daemons:   . $ bin/start-all.sh
The hadoop daemon log output is written to the          ${HADOOP_LOG_DIR} directory (defaults to          ${HADOOP_HOME}/logs). Browse the web interface for the NameNode and the JobTracker; by         default they are available at:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;NameNode -              http://localhost:50070/
''&lt;/li&gt;
&lt;li&gt;''JobTracker -              http://localhost:50030/ Copy the input files into the distributed filesystem: ''
  . ''$ bin/hadoop fs -put conf input ''
 ''Run some of the examples provided:   . $ bin/hadoop jar hadoop-examples-&lt;em&gt;.jar grep input output 'dfs[a-z.]+'
Examine the output files: Copy the output files from the distributed filesystem to the local            filesytem and examine them:   . $ bin/hadoop fs -get output output $ cat output/&lt;/em&gt;
or View the output files on the distributed filesystem:   . $ bin/hadoop fs -cat output/*
When you're done, stop the daemons with:   . $ bin/stop-all.sh
''&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;== Fully-Distributed Operation ==
''For information on setting up fully-distributed, non-trivial clusters     see [[http://hadoop.apache.org/docs/r1.0.4/cluster_setup.html|Cluster Setup]]. ''&lt;/p&gt;
&lt;p&gt;Java and JNI are trademarks or registered trademarks of        Sun Microsystems, Inc. in the United States and other countries.'' ''&lt;/p&gt;</summary></entry><entry><title>postgresql更改密码</title><link href="http://liugehao.github.io/postgresqlgeng-gai-mi-ma.html" rel="alternate"></link><updated>2012-11-07T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-07:postgresqlgeng-gai-mi-ma.html</id><summary type="html">&lt;p&gt;{{{
su - postgres
psql
alter role postgres password 'new password';
}}}&lt;/p&gt;
&lt;p&gt;???下面的不好用???
{{{
alter user postgres with password 'new password'
}}}&lt;/p&gt;</summary></entry><entry><title>bash记忆指令(向上下翻相关指令)</title><link href="http://liugehao.github.io/bashji-yi-zhi-ling-xiang-shang-xia-fan-xiang-guan-zhi-ling.html" rel="alternate"></link><updated>2012-11-06T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-06:bashji-yi-zhi-ling-xiang-shang-xia-fan-xiang-guan-zhi-ling.html</id><summary type="html">&lt;p&gt;在 FreeBSD 裡面，要做到這樣非常方便，當我們在終端機輸入 vi 之後按下 Up 鍵，終端機會顯示之前下過的 vi 指令，這在常常使用 command 的使用者來講相當方便，也非常重要&lt;/p&gt;
&lt;p&gt;在 FreeBSD 底下，只要在 .cshrc 裡面加上
{{{
    bindkey “^W” backward-delete-word
    bindkey -k up history-search-backward
    bindkey -k down history-search-forward
}}}
可是在 linux 底下要如何達到這樣呢，那就是 man bash『history-search-backward』，『history-search-forward』這兩個功能，對我來說非常重要，然而你 要達到這功能，就是利用 showkey 跟 bind 這兩個指令&lt;/p&gt;
&lt;p&gt;首先你要先找到 Up 這個鍵的 16 位元的編碼&lt;/p&gt;
&lt;p&gt;{{{&lt;/p&gt;
&lt;h1&gt;showkey -a&lt;/h1&gt;
&lt;p&gt;Press any keys – Ctrl-D will terminate this program&lt;/p&gt;
&lt;p&gt;^[[A 27 0033 0x1b
     91 0133 0x5b
     65 0101 0x41
}}}
然後在 bind 上去，寫到 /etc/bashrc 地下就可以了
{{{
    bind ‘”\x1b\x5b\x41″:history-search-backward’
    bind ‘”\x1b\x5b\x42″:history-search-forward’
}}}&lt;/p&gt;
&lt;p&gt;== 我的输入 ==
在.bashrc中增加：
{{{
bind '"\e[A":history-search-backward'
bind '"\e[B":history-search-forward'
}}}&lt;/p&gt;</summary></entry><entry><title>I. 8日 分配工作内容，review韵达网站代码</title><link href="http://liugehao.github.io/i-8ri-fen-pei-gong-zuo-nei-rong-reviewyun-da-wang-zhan-dai-ma.html" rel="alternate"></link><updated>2012-11-02T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-02:i-8ri-fen-pei-gong-zuo-nei-rong-reviewyun-da-wang-zhan-dai-ma.html</id><summary type="html">&lt;p&gt;I. 9日 review网站代码，下午开会。
 I. 10日 帮王雪凯查看sap的soap不通问题　，查出是服务器没安装soap的php模块问题
 I. 11日 找相应版本php，编译安装，测试通过
 I. 12日 导出soa用户数据到ldap的代码编码，中途发现webservice不标准，与程序员说明。其让我与甘洪波联系，确认好再告诉他，说甘不让改。把xml标准发给甘，同意改。
 I. 15日 进行xml解析，编写代码。
 I. 16日 
  i. 软件开发过程改进启动会。上午开会预演。下午开会。
  i. 导出数据中没有用户密码，所以无法进行登录验证，和甘，江沟通，取得用户密码。但xml文件过大，程序耗费内存太多，导致无法正常工作。待优化。
  i. 帮徐如山处理９０服务器另一版本PHP与odbc问题。
 I. 17日
  i. 程序优化后xml处理时间在１秒左右，优化完成。
 I. 18日
  i. 跟踪crm系统进度，基本处于停止状态。但是速度有的页面要４，５秒的执行时间。
  i. 指导张宗峰，郭吉刚linux系统方面的问题。
 I. 19日
  i. 上午项目改进会议
  i. 统计项目周报
 I. 22日
  i. 先前因crm组给服务器重装，测试环境重新配置。
 I. 23日
  i. 项目改进培训
  i. 测试环境配置。
 I. 24日
  i. 小组长会议
  i. PHP程序员岗位级别标准编写
 I. 25日
  i. 小组会议　
  i. 手机客户端测试，和搜索引擎查询webservice 测试工作的协调，沟通。
  i. 下午岗位评定标准讨论
 I. 26日
  i. 汇总周报
  i. 过程改进项目会议
 I. 2９日
  i. ts系统重新转码，宋忘了上一版改哪里
  i. 192.168.14.18,192.168.14.16两台服务器优化，ＯＫ
 I. 30日
  i. 与CRM组沟通测试情况。网页慢，换用apache的mod方式来运行。
  i. 手机客户端程序ＷＥＢ服务器压力大，数据库压力非常低，错误严重。换一php脚本在２台测试服务器验证，无问题。
 I. 31日
  i. Crm 测试及情况反馈，沟通
  i. 测试服务器ＰＨＰ连接oracle测试程序。速度很快。测试机无问题&lt;/p&gt;</summary></entry><entry><title>ubuntu安装java</title><link href="http://liugehao.github.io/ubuntuan-zhuang-java.html" rel="alternate"></link><updated>2012-11-01T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-11-01:ubuntuan-zhuang-java.html</id><summary type="html">&lt;p&gt;到sun下载jdk-7u7-linux-x64.tar.gz&lt;/p&gt;
&lt;p&gt;{{{
tar zxf jdk-7u7-linux-x64.tar.gz
mv jdk1.7.0_07 /usr/lib/jvm
update-alternatives --install "/usr/bin/java" "java" "/usr/lib/jvm/jdk1.7.0_07/bin/java" 1
update-alternatives --config java
}}}&lt;/p&gt;
&lt;p&gt;=== 参考 ===&lt;/p&gt;
&lt;p&gt;首先将*.tar.gz解压&lt;/p&gt;
&lt;p&gt;具体方法为：tar -xzvf *.tar.gz&lt;/p&gt;
&lt;p&gt;假设得到的文件夹为java&lt;/p&gt;
&lt;p&gt;将其移动到/usr/中&lt;/p&gt;
&lt;p&gt;命令为：sudo mv java /usr/&lt;/p&gt;
&lt;p&gt;然后设置环境变量：&lt;/p&gt;
&lt;p&gt;sudo gedit /etc/profile&lt;/p&gt;
&lt;p&gt;打开文件&lt;/p&gt;
&lt;p&gt;在结尾处umask 022前，输入：
{{{
JAVA_HOME=/usr/java
export JRE_HOME=/usr/java/jre　　
export CLASSPATH=.:$JAVA_HOME/lib:$JRE_HOME/lib:$CLASSPATH
export PATH=$JAVA_HOME/bin:$JRE_HOME/bin:$PATH
}}}
重启生效：source xxxx.bash_profile&lt;/p&gt;
&lt;p&gt;Ubuntu 中修改默认jdk
{{{
update-alternatives --install /usr/bin/java java /usr/java/bin/java 300
update-alternatives --install /usr/bin/javac javac /usr/java/bin/javac 300
}}}
通过这一步将我们安装的jdk加入java选单。
{{{
update-alternatives --config java
}}}
选择默认的jdk
{{{
java -version
}}}&lt;/p&gt;</summary></entry><entry><title>银河系漫游指南</title><link href="http://liugehao.github.io/yin-he-xi-man-you-zhi-nan.html" rel="alternate"></link><updated>2012-10-30T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-10-30:yin-he-xi-man-you-zhi-nan.html</id><summary type="html">&lt;p&gt;《银河系漫游指南》简介&lt;/p&gt;
&lt;p&gt;'''缺少３３章'''&lt;/p&gt;
&lt;p&gt;银河系漫游指南&lt;/p&gt;
&lt;p&gt;译者: 徐百柯&lt;/p&gt;
&lt;p&gt;作者: 道格拉斯·亚当斯&lt;/p&gt;
&lt;p&gt;ISBN: 753645757X&lt;/p&gt;
&lt;p&gt;页数: 191&lt;/p&gt;
&lt;p&gt;定价: 16.00&lt;/p&gt;
&lt;p&gt;出版社: 四川科学技术出版社&lt;/p&gt;
&lt;p&gt;出版年: 2005&lt;/p&gt;
&lt;p&gt;书评：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;无法抗拒——《波士顿环球报》&lt;/span&gt;



&lt;span class="err"&gt;科幻小说，却又滑稽风趣到极点……古怪、疯狂，彻底跳出此前所有科幻小说的固有套路。——《华盛顿邮报》&lt;/span&gt;



&lt;span class="err"&gt;主角阿瑟·邓特与库尔特·冯尼格笔下的人物颇为神似，全书充满对人类社会现实的嘲讽和批判。——《芝加哥论坛报》&lt;/span&gt;



&lt;span class="err"&gt;一句话，这是有史以来最滑稽、最古怪的科幻小说，封面和封底之间，奇思妙想随处可见。——《图书周刊》&lt;/span&gt;



&lt;span class="err"&gt;荷马史诗《奥德赛》的疯狂古怪版，书中人物漫游银河，带给读者无限的欢乐。——《出版周刊》&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;=== 内容简介： ===&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;地球被毁灭了，因为要在它所在的地方修建一条超空间快速通道。主人公阿瑟·邓特活下来了，因为他有一位名叫福特·普里弗克特的朋友。这位朋友表面上是个找不着工作的演员，其实是个外星人，是名著《银河系漫游指南》派赴地球的研究员。两人开始了一场穿越银河的冒险，能够帮助他们的只有《银河系漫游指南》一书中所包括的无限智慧。&lt;/span&gt;

&lt;span class="err"&gt;旅途中，他们遇上了一批非常有趣的同伴，计有：&lt;/span&gt;

&lt;span class="err"&gt;赞福德·毕博布鲁克斯：长着两个头、三条胳膊的银河大盗，他的另一个身份是银河帝国总统。&lt;/span&gt;

&lt;span class="err"&gt;崔莉恩：赞福德的同伙，除阿瑟·邓特之外惟一一个幸存下来的地球人。事实上，阿瑟从前认识崔莉恩，而且曾经试图勾搭人家，可惜没有成功。&lt;/span&gt;

&lt;span class="err"&gt;马文：天才机器人，疑心病极其重，极其沮丧，极其唠叨。&lt;/span&gt;

&lt;span class="err"&gt;这些人物结成一个小团队，他们将揭开一个骇人听闻的大秘密……&lt;/span&gt;

&lt;span class="err"&gt;不过，记住《银河系漫游指南》封面上用大而友善的字母写下的忠告吧：不要恐慌。&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;=== 作者简介： ===&lt;/p&gt;
&lt;p&gt;亚当斯于1952年出生在英国剑桥，在埃塞克斯上了12年的学，最感兴趣的莫过于自然科学。上学时还曾打算穿越欧洲到土耳其的伊斯坦布尔，并为积攒路费打了不少零工。当18岁时从学校毕业后，亚当斯便成了名写手，除了在1974年取得了文学学士学位(后来又考取了文学硕士学位)之外，很长时间以来都没有任何进展。这一切一直持续到1977年2月，他遇到了在BBC工作的西蒙·布雷特，他们决定为第4台制作一档科幻广播喜剧，于是诞生了《银河系漫游指南》。这本书很快成为当时首屈一指的畅销书，他的主要作品就是银河系漫游五部曲，包括《银河系漫游指南》、《宇宙尽头餐馆》、《生命、宇宙及一切》、《再见，谢谢鱼》、《基本无害》。这个系列被西方科幻读者奉为科幻《圣经》之一。由于漫游银河系列小说的突出成就，国际小行星管理委员会甚至将一颗小行星命名为阿瑟·邓特——该系列的主人公。1984年，亚当斯成为最年轻的畅销书奖得主。这本书先后被改编成广播剧、电视剧、舞台剧和电脑游戏，甚至印有相关图案的浴巾也一度热销。 &lt;/p&gt;
&lt;p&gt;《银河系漫游指南》是该系列的第一本，亚当斯随后又完成了4本，而且一直陆续不断的有佳作问世，在英国、美国和澳洲的作品销量超过1500万册。此外，他还是H2G2数字媒体和网络公司的创始人，并参与制作了《星河舰队》的合籍和电脑游戏。 &lt;/p&gt;
&lt;p&gt;亚当斯还有一些鲜为人知的经历，比如作过鸡舍的清洁工，为一个阿拉伯王室家庭当过保镖，甚至还有一次为平克·弗洛伊德乐队作过吉他手！ 　 &lt;/p&gt;
&lt;p&gt;2001年5月11日，亚当斯照常到体育馆进行晨练，却因心脏病突发猝然辞世。而在他去世的前一天，国际天文学协会的小行星中心刚刚将一颗编号18610的小行星命名为“阿瑟·邓肯”，这也许是上帝送给在世的亚当斯的最后一件礼物。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="mi"&gt;2001&lt;/span&gt;&lt;span class="err"&gt;年，亚当斯因心脏病猝发，死前正在与好莱坞制片商协作，将这部作品搬上银幕。&lt;/span&gt;

&lt;span class="mi"&gt;2005&lt;/span&gt;&lt;span class="err"&gt;年&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="err"&gt;月&lt;/span&gt;&lt;span class="mi"&gt;29&lt;/span&gt;&lt;span class="err"&gt;日，由迪斯尼公司拍摄的《银河系漫游指南》正式公映，首映周便获得&lt;/span&gt;&lt;span class="mi"&gt;2170&lt;/span&gt;&lt;span class="err"&gt;多万美元，成为北美当月票房冠军。&lt;/span&gt;

&lt;span class="err"&gt;电影版的『漫游』今年&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="err"&gt;月才在北美公映，小说已经在地球上流行&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="err"&gt;多年了。&lt;/span&gt;&lt;span class="n"&gt;SFW&lt;/span&gt;&lt;span class="err"&gt;干脆拿了电影海报作书封，这样倒也好，我在书店里一眼就找到了想要的。印数是&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="err"&gt;万&lt;/span&gt;&lt;span class="mi"&gt;3000&lt;/span&gt;&lt;span class="err"&gt;册，这在&lt;/span&gt;&lt;span class="n"&gt;SFW&lt;/span&gt;&lt;span class="err"&gt;大师系列里是相当高的。然后很快地，续集『餐馆』也印好上市了。&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;科幻，为小说提供了无穷尽的想象力来源。搞笑，让这些无限的想象力，多了一层大众化的俗气魅力。于是，科幻迷也爱读这书，非科幻迷也爱读这书。 &lt;/p&gt;
&lt;p&gt;如果全书充斥的除了无厘头还是无厘头，那么『漫游』系列最多也就是网络搞笑的档次。『漫游』系列能风靡20多年，还因为他有顽强的故事主线和鲜活的主角们。五本小说，始终围绕一条线讲故事，为什么宇宙的终结命运是“42”？。几个主角，从最后地球人阿瑟，到宇宙总督赞福德，到欠扁的机器人马文，个个活灵活现。好像就是从你朋友们的身体里抽取最有魅力的人格，然后加以极端化而成德。这些主角就是你的朋友，他们在使劲干着你不敢放手去干的事情。赞福德这个讽刺狂人，一分钟不挖苦人就活不下去，可怜的地球人阿瑟明明智力正常仅仅是因为从猿人进化而来，就被赞福德讽刺为猴子。动不动就说：你怎么不回树上去？ &lt;/p&gt;
&lt;p&gt;小说的主角之一，“黄金之心”号飞船，靠一种名为“无限非概率驱动器”的发动机驱动。无限非概率驱动器的功能是，完成所有不可能完成的事情，再现所有概率小于等于零的事件。按照小说里的故事，开始，没有任何人能制作出这种驱动器，根本无从下手啊。任何制作无限非概率驱动器的企图，都失败了。 &lt;/p&gt;
&lt;p&gt;然后，一个聪明的学院学生，通过一台“有限概率发生装置”制作出了“无限非概率驱动器”。他的推理过程如下：如果无限非概率装置是可以制作的，那么制作出这个装置的概率就是一个具体的数值，我只要计算出这个数值，输入有限概率发生装置，那么无限概率装置就能制作出来。 &lt;/p&gt;
&lt;p&gt;这个学生就通过有限概率装置，制造出了无限非概率发生装置。多么无厘头啊。但是你不得不佩服“逻辑上的合理性”。『漫游』系列并没有因为无厘头而变成一部软科幻，相反，它尽量让自己看起来像一部硬科幻，凡事能提供原理解释的就一定提供。比如，有限概率发生器的制造原理：简单地把基于单个超微57型亚介子电脑的逻辑电路连接在一个挂在强布朗运动发生器上的原子矢量绘图器上就行了。不会真有人照着去做一台有限概率发生装置吧？明知道作者在扯淡，就是忍不住被他逗乐：怎么有人能一本正经地扯淡到这种程度？&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;《银河系漫游指南》原著是一部广播剧本&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1978&lt;/span&gt;&lt;span class="err"&gt;年在&lt;/span&gt;&lt;span class="n"&gt;BBC&lt;/span&gt;&lt;span class="err"&gt;播出后引起强烈轰动，原作者道格拉斯·亚当斯随即将它写成小说&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="err"&gt;化身为小说的《银河系漫游指南》成了科幻史上一座里程碑，英文版销量超过&lt;/span&gt;&lt;span class="mi"&gt;1400&lt;/span&gt;&lt;span class="err"&gt;万册。在英国广播公司一项调查中，《银河系漫游指南》取得“有史以来最受读者喜爱的小说”的第四位。道格拉斯·亚当斯的《银河系漫游指南》，颠覆了人类思维的常态。它提醒地球人，面对广袤虚空，“人”就像“无知的原始人”，人对银河系事务的了解程度，“简直和一只非洲蚊子对北京生活的了解程度没什么区别”。&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;=== 解读： ===&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;道格拉斯·亚当斯是全球第一个将喜剧与科幻艺术成功结合在一起的作家，&lt;/span&gt;&lt;span class="mi"&gt;2001&lt;/span&gt;&lt;span class="err"&gt;年&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="err"&gt;月&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="err"&gt;日，&lt;/span&gt;&lt;span class="mi"&gt;49&lt;/span&gt;&lt;span class="err"&gt;岁的亚当斯因心脏病猝然辞世。直到去世前他还在为这部电影构思新的情节和故事角色，所以他被称为《银河系漫游指南》的行政制片人。他去世的前一天，国际天文学协会将一颗小行星命名为“阿瑟·邓特”。将《银河系漫游指南》拍成电影多年来一直是数百万亚当斯迷期待的事情，同时他们也担心电影版能否保持原著的风格。从&lt;/span&gt;&lt;span class="mi"&gt;1982&lt;/span&gt;&lt;span class="err"&gt;年制片商买下改编剧本拍摄权的那天计算，影片从酝酿到最后完成拍摄制作，前后跨越&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="err"&gt;多年时间。我觉得本片没有宏大制作场景和精美音画，没有精彩的故事演绎和剧情设计，甚至对故事的展现也不充分，也许本片算不上一部好电影。也许本片只是忠实于原著，将阿瑟·邓特的太空历险喜剧故事于&lt;/span&gt;&lt;span class="mi"&gt;110&lt;/span&gt;&lt;span class="err"&gt;分钟影像中再现，这迎合了亚当斯迷们的口味，我们则需要先作一些必要了解。&lt;/span&gt;

&lt;span class="err"&gt;在古代，你要是担心天会塌下来，那叫杞人忧天。在几十年前，以《公民凯恩》成为电影教父级人物的奥森·威尔斯，在美国电台开玩笑说地球即将被外星人侵占，无数人信以为真，吓得差点落荒而逃。地球毁灭，放到什么时代都是非常严重的大事。可《银河系漫游指南》不一样。谁说地球是我们唯一的栖息地？谁说地球毁灭我们就要抱头痛哭？天外有天在这部幽默而想象力无穷的科幻巨作里表现得无比动人。&lt;/span&gt;

&lt;span class="err"&gt;定制行星是宇宙中一项全新的特种工业，超空间工程师通过太空中的白洞吸取物质，严格按照客户的要求构造各种行星。曼格拉斯人根据泛维度种族的定制建造了“地球”。一个名叫司拉提巴特法斯特的设计师甚至因为设计出漂亮的海岸线而获奖赏，奖品是地球上一处被称为挪威的地方。没错，根据那个叫做道格拉斯·亚当斯的英国佬的疯狂想法，地球就是这么来的。&lt;/span&gt;

&lt;span class="err"&gt;地球高寿？科学的答案，&lt;/span&gt;&lt;span class="mi"&gt;46&lt;/span&gt;&lt;span class="err"&gt;亿年。科幻的答案，&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="err"&gt;万年。是的，地球诞生于&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="err"&gt;万年前，或者应该说&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="err"&gt;万年前建成。茫茫宇宙中，一个“具有超级智慧的泛维度种族”对关于生命意义的无休止的争论感到厌烦了，他们决定一劳永逸地解决这个问题。他们建造了宇宙一切空间和时间中第二强大的电脑“沉思”，向它寻求“关于生命、宇宙，以及一切的终极答案”。整整&lt;/span&gt;&lt;span class="mi"&gt;750&lt;/span&gt;&lt;span class="err"&gt;万年后，“沉思”给出了答案&lt;/span&gt;&lt;span class="o"&gt;---&lt;/span&gt;&lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="err"&gt;。面对这个玄妙的答案，泛维度种族需要回过头先弄明白生命宇宙以及一切的终极问题，方能理解答案。但“沉思”不能胜任此项艰巨的任务，它说：“你们需要一台能够计算出这个终极答案的电脑，这台电脑具有无限和微妙的复杂性，以至于有机生命本身将会成为操作母体的一部分。你们自身也会以一种新的生命形式投入到这台电脑中，去操控为期&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="err"&gt;万年的程序。我将会为你们设计出这台电脑，并且我已为它取好名字。它将会被称为……地球。”&lt;/span&gt;

&lt;span class="err"&gt;地球这颗星球加上人类自身，构成一台有机电脑的母体，运行着一个为期&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="err"&gt;万年的研究程序。匪夷所思的是，那个泛维度种族在地球上的新的生命形式，居然是小小的、白色的、毛茸茸的、疯狂迷恋奶酪的、在上世纪&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="err"&gt;年代早期的肥皂剧中把女人们吓得尖叫的生物&lt;/span&gt;&lt;span class="o"&gt;---&lt;/span&gt;&lt;span class="err"&gt;老鼠。人类在老鼠身上作实验，观察它们行为的过程，竟然是老鼠精心安排的，以此用来研究人类。所以，千万别被那些虚假的幻象迷惑。地球，其实是老鼠定制的。它们不仅付了款，还负责管理。&lt;/span&gt;

&lt;span class="err"&gt;这一切直到地球人阿瑟·邓特一觉醒来，沃贡人的舰队光临地球，宣布开发银河系偏远地区的计划需要修建一条超空间快速通道穿越这个星系，地球属于被清除的范围。“你们没有必要对此表现出惊慌。所有清除计划已经在半人马座主星展示了&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="err"&gt;个地球年了，你们有足够的时间提出任何投诉意见……什么？你们没去过半人马座主星？看在上帝的份上，那只有区区&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="err"&gt;光年的路程，这你们是知道的。我很抱歉。”于是，和许多拆迁计划的执行程序一样，地球，这台宇宙一切空间和时间中第一强大的电脑，在完成它的任务之前&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="err"&gt;分钟被毁掉了。“关于生命、宇宙，以及一切的终极问题”随之湮没，&lt;/span&gt;&lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="err"&gt;，也失去了意义。所幸的是，阿瑟·邓特在最后一刻被他的朋友、正在地球上的星际漫游者福特救走。两人开始了一段充满惊奇的星河冒险之旅。旅程中，阿瑟发现毛巾是宇宙间最有用的东西，并体验到生命的全新意义，更发现他需要知道的一切居然写在一本名叫《银河系漫游指南》的电子图书里。&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;=== 引子 ===&lt;/p&gt;
&lt;p&gt;在银河系西螺旋臂的末端那片未曾标明的寂静虚空中，悬挂着—颗不被人注意的小小的黄色太阳。距离它大约9800万英里的轨道上，运行着一颗完全无足轻重的蓝绿色小行星。这颗行星上由猿演化而来的生命形式原始得令人吃惊，他们居然还认为电子表是一项非常了不起的设想。&lt;/p&gt;
&lt;p&gt;这颗行星上存在着——或者说曾经存在——一个问题，那就是：大部分的居民在大部分的时间里都感到不开心。针对这一问题曾提出过各种各样的解决方案，但其中大部分都是紧紧围绕那些绿色小纸片的运动来着手的——这很奇怪，因为实际上并不是这些绿色小纸片不开心。&lt;/p&gt;
&lt;p&gt;于是，问题依旧困扰着这颗星球。所有的人都感到不自在，其中大部分简直可以说是凄凄惨惨，甚至包括那些拥有电子表的人。&lt;/p&gt;
&lt;p&gt;不过这与我们这里要讲的故事无关。&lt;/p&gt;
&lt;p&gt;我们这个故事是关于一场可怕而又愚蠢的灾难，以及它的一系列后果。&lt;/p&gt;
&lt;p&gt;同时这个故事也是关于一本书的，书名叫做《银河系漫游指南》，这不是一本地球上的书，它从来没有在地球上出版过，并且一直到那场可怕的灾难发牛之前，没有任何地球人见过或者听说过它。&lt;/p&gt;
&lt;p&gt;然而，这绝对是一本非凡的书。&lt;/p&gt;
&lt;p&gt;事实上，它可能是小熊星座那些伟大的出版公司所出版过的最非凡的书了——当然，这些公司也没有任何—个地球人听说过。但是，在银河系东部外缘的许多更加开放的文明里，《银河系漫游指南》已经取代伟大的《银河系百科全书》成为所有知识和智慧的标准。这是因为，尽管显得冗长，并且包含许多虚假或者至少是不够准确的信息，但它却在两个极其重要的方面超越了那部更加陈旧和呆板的著作。&lt;/p&gt;
&lt;p&gt;第一，它稍微便宜一点儿；第二，在它的封面上以大而友善的字体写着“不要恐慌”这句话。&lt;/p&gt;
&lt;p&gt;不过，这个关于那个可怕而又愚蠢的星期四的故事，这个关于那次灾难的奇特后果的故事，这个关于这些后果如何无可逃避地与这本非凡的书交织在一起的故事，它的开始却非常简单。&lt;/p&gt;
&lt;p&gt;它的开始与一所房子有关。 &lt;/p&gt;
&lt;p&gt;=== 第一章 ===&lt;/p&gt;
&lt;p&gt;这是一所普通的房子，无论从哪个方面来看都毫不起眼。也许这所房子只对惟一一个人有着特殊的意义，那就是阿瑟·邓特，而这也仅仅只因为他碰巧是住在里面的人而已。自从搬出伦敦那个让他紧张和急躁的鬼地方，阿瑟住在这儿已经3年了。他大概30岁上下，高个子，深色头发，属于那种总也平静不下来的家伙。他最大的焦虑就是，周围的人总是问他为什么看上去这么焦虑。他在当地的广播电台工作，他总是告诉自己的朋友们这份工作比他们想像中的有趣得多。而实际上，他的大部分朋友本身就是在这家电台工作的。&lt;/p&gt;
&lt;p&gt;一个星期三的晚上，瓢泼大雨从天而降，乡间小道积了水，变得泥泞不堪。但到了星期四早晨，阳光明媚，照耀在阿瑟·邓特的房子上——不过，这也将是最后一次了。&lt;/p&gt;
&lt;p&gt;阿瑟并不知道，委员会已经决定要推倒这所房子，修成一条通道。&lt;/p&gt;
&lt;p&gt;星期四早上8点，阿瑟感觉有点儿不舒服。他迷迷糊糊地醒来，起床，又迷迷糊糊地在房间里转悠，他推开一扇窗户，看见了一辆推土机，他找到自己的拖鞋，咕咚咕咚走进卫生间洗漱。&lt;/p&gt;
&lt;p&gt;把牙膏涂在牙刷上——好，开始刷牙。&lt;/p&gt;
&lt;p&gt;刮胡镜——居然对着天花板。于是他开始调整，在某一个角度上，镜子正好映出第二辆推土机驶过卫生间的窗户。终于调整好位置了，镜中映出了阿瑟·邓特的胡子。他刮干净胡子，清洗，擦干，又咕咚咕咚冲进厨房，想找点儿好吃的东西填进嘴巴。&lt;/p&gt;
&lt;p&gt;“推土机”这个词儿一度在他脑海中盘旋着，想找到什么相关联的东西。&lt;/p&gt;
&lt;p&gt;厨房窗外的那台推土机可真是个大家伙。&lt;/p&gt;
&lt;p&gt;阿瑟盯着它。&lt;/p&gt;
&lt;p&gt;他站在那儿，回想着。酒馆，他想起来了。噢，天啊，那家酒馆。他模糊地记得自己当时发了火，是为了某件似乎很重要的事发火。他当时正在向别人讲述这件事，不厌其烦地详细讲述着，那是他刚刚知道的关于一条新通道的消息。这个消息应该已经传出来好几个月了，但看上去居然没有谁知道，真够荒谬的。他喝了口水。这事儿得去解决掉，他决定了，没有人想要这条破通道，委员会根本就站不住脚。这事儿得去解决去。&lt;/p&gt;
&lt;p&gt;天啊，这酒还真醉得不轻。他望着穿衣镜中的自己，伸了伸舌头。“黄色。”他想。于是“黄色”这个词儿在他脑海中盘旋着，想找到什么相关联的东西。&lt;/p&gt;
&lt;p&gt;15秒钟过后，他来到屋外，横躺在一辆巨型的黄色推土机前面，这辆推土机正向他的花园小径开过去。&lt;/p&gt;
&lt;p&gt;普洛塞先生，按照人们的说法，只是一个普通人。换句话说，他属于一种主要由碳元素构成的两足动物，直接从猿进化而来。如果要再多介绍几句的话，那么，他40岁，是个胖子，衣着破旧，为本地的委员会工作。有趣的是，虽然他本人并不知道，但他确确实实是成吉思汗的直系后代，尽管过多的代系和种族的融合早已经改变了他的基因，使他不再具有蒙古人外貌上的特征。说起来，普洛塞先生那伟大的祖先留给他的惟一遗传特征也许就是明显的矮壮身材，以及对短毛皮帽子的偏爱了。&lt;/p&gt;
&lt;p&gt;他绝对不是一个伟大的战士，实际上，他是一个紧张、焦虑的人。今天，他尤其紧张，尤其焦虑，因为他的工作遇到了不小的麻烦。他今天的任务就是，监督阿瑟·邓特的房子在一天之内给铲平。&lt;/p&gt;
&lt;p&gt;“起来吧，邓特先生，”他说，“你拗不过的，这你知道。你总不能老躺在推土机前面吧。”他极力让自己的眼神看起来恶狠狠的，但是眼睛却不听使唤。&lt;/p&gt;
&lt;p&gt;阿瑟躺在泥浆里，瞟了他一眼。&lt;/p&gt;
&lt;p&gt;“那好吧，就让咱们来玩个游戏。”他说，“瞧瞧究竟是谁先熬不住。”&lt;/p&gt;
&lt;p&gt;“我很抱歉，不过恐怕你还是得接受这个现实。”普洛塞先生说，一边用手抓住自己的毛皮帽子，一直卷到头顶上，“这条通道必须得建，它就快要建了！”&lt;/p&gt;
&lt;p&gt;“我可是第一次听说这个什么通道。”阿瑟说，“凭什么它就一定得建呢？”&lt;/p&gt;
&lt;p&gt;普洛塞先生冲他晃动着手指，好一会儿才停下来，收了回去。&lt;/p&gt;
&lt;p&gt;“你这是什么意思，凭什么它一定得建？”他说，“这是通道。你们总得建通道吧。”&lt;/p&gt;
&lt;p&gt;通道是一种装置，它使A点的人能够很快地到达B点，同时B点的人也能够很快地到达A点。住在两点之间的C点的人，通常会感到非常奇怪：A点有什么好，弄得B点的这么多人都渴望去那儿：B点又有什么好，使得A点的这么多人都渴望去那儿。他们通常倾向于希望人们能一劳永逸地去到自己想去的任何地方。&lt;/p&gt;
&lt;p&gt;普洛塞先生想去D点。D点并不是一个特定的什么地方，它只是远离A、B和C点的任何一个方便的去处。他在那儿会有一间舒适的乡间小屋，门上挂着斧头，他可以在E点度过快乐的时光，而E点是指距离D点最近的酒馆。当然，他的妻子会更希望要生长着的玫瑰，但他就是想要斧头。他也不知道为什么——就是喜欢斧头。这时，他看到了推土机司机们嘲弄的笑容，脸一下子变得通红。&lt;/p&gt;
&lt;p&gt;他换着脚支撑身体，但两只都不舒服。显然，这里将会有什么人不能胜任，上帝保佑，他希望不是自己。&lt;/p&gt;
&lt;p&gt;普洛塞先生说：“你被赋予了充分的权利在适当的时候提出建议或是抗议，这一点你是知道的。”&lt;/p&gt;
&lt;p&gt;“适当的时候？”阿瑟轻蔑地哼了一声。“适当的时候？昨天有个工人到我家来，我才头一次听说这件事情。当时我问他是不是来擦窗户的，他说不是，他是来推倒我这间房子的。当然，他并没有直接告诉我这个。他先为我擦了两扇窗户，收了我5块钱，然后才告诉我的。”&lt;/p&gt;
&lt;p&gt;“可是，邓特先生，你要知道，这些计划在本地的规划办公室已经放了9个月了。”&lt;/p&gt;
&lt;p&gt;“噢，是吗？那好吧，我告诉你，我一听到这个消息就直接去找这些计划来看，那是昨天下午的事儿。但你好像忘了去关注它们一下，不是吗？我是指，像你刚才所说的那样。”&lt;/p&gt;
&lt;p&gt;“可是，这些计划应该就是向公众展示的啊……”&lt;/p&gt;
&lt;p&gt;“展示？我最后不得不到地下室里去把它们翻出来。”&lt;/p&gt;
&lt;p&gt;“那儿就是我们的展示室呀。”&lt;/p&gt;
&lt;p&gt;“那么昏暗的灯光？”&lt;/p&gt;
&lt;p&gt;“哦，是这样，有的灯可能坏了。”&lt;/p&gt;
&lt;p&gt;“还有楼梯也坏了。”&lt;/p&gt;
&lt;p&gt;“好吧。不过你瞧，你最终还是看到通告了，不是吗？”&lt;/p&gt;
&lt;p&gt;“是，”阿瑟说，“我确实是看到了。只不过是在一间废弃厕所里扔着的一个上了锁的文件柜的最低层，厕所门上还写着‘小心豹子’。”&lt;/p&gt;
&lt;p&gt;这时，一片云飘过头顶，撒下的阴影正好罩在用肘支撑着躺在冰冷的泥浆中的阿瑟·邓特身上，也罩在他的房子上。普洛塞先生看着，皱了一下眉头。&lt;/p&gt;
&lt;p&gt;“看上去这似乎算不上一所特别好的房子。”他说。&lt;/p&gt;
&lt;p&gt;“我很遗憾，不过我恰好就喜欢它。”&lt;/p&gt;
&lt;p&gt;“你也会喜欢通道的。”&lt;/p&gt;
&lt;p&gt;“噢，闭嘴，”阿瑟·邓特说，“你给我闭嘴，然后滚蛋，带上你该死的通道。你们根本就站不住脚，这你知道。”&lt;/p&gt;
&lt;p&gt;普洛塞先生的嘴好几次张开了又闭上，这时他的脑海里突然被一种无法解释却又充满了吸引力的情景所占据：阿瑟·邓特的房子燃着大火，阿瑟本人正尖叫着从燃烧着的废墟中往外跑，至少有三支粗大的长矛从他的后心穿透出来。普洛塞先生经常被类似这样的场景困扰，这使他感到非常紧张。他支吾了好一会儿，这才定下神来。&lt;/p&gt;
&lt;p&gt;“邓特先生。”他说。&lt;/p&gt;
&lt;p&gt;“嗯？什么事？”阿瑟说。&lt;/p&gt;
&lt;p&gt;“有些很现实的情况你得明白。你想过吗，如果我让这辆推土机直接从你身上碾过去，会有什么样的后果？”&lt;/p&gt;
&lt;p&gt;“什么样的呢？”阿瑟问道。&lt;/p&gt;
&lt;p&gt;“没什么。”普洛塞先生说。现在他更紧张了，因为他弄不明白，为什么他的脑海里像是有成千的长毛骑兵一齐对着他怒吼。&lt;/p&gt;
&lt;p&gt;一个奇怪的巧合是，“没什么”正好代表了从猿进化来的阿瑟·邓特对他最亲密的朋友之一并非同样从猿进化而来这一事实的怀疑程度，那人实际上来自猎户座参宿四附近的一颗小行星，而不是他自己通常所宣称的来自吉尔福德。&lt;/p&gt;
&lt;p&gt;阿瑟·邓特却从来没有怀疑过他的话。&lt;/p&gt;
&lt;p&gt;他的这个朋友首次来到这颗叫做地球的行星是在15个地球年以前，他拼命工作，希望能融入地球社会——而在这一点上，必须承认，他还是颇为成功的。比方说，他花这15年扮演了一个失业的演员，而这差不多也就足够了。&lt;/p&gt;
&lt;p&gt;但他还是犯了一个疏忽导致的错误，这是因为他在准备工作上偷了一点儿懒。根据收集到的信息，他选择了“福特·普里弗克特”这个名字，以求不引起人们的注意。&lt;/p&gt;
&lt;p&gt;有时候，他会被一种奇怪的心烦意乱的情绪所控制，直直地盯着天空，像被催眠了一样，直到别人来问他在干什么。这时，他才放松下来，咧嘴笑道：“噢，没什么，只是在寻找天上的飞碟。”听到他这种笑话，所有人都会大笑，问他在寻找什么样的飞碟。&lt;/p&gt;
&lt;p&gt;“它们是绿色的！”他总是坏笑着回答，然后在狂笑一阵后，突然一头冲进最近的酒吧里，猛喝一轮。&lt;/p&gt;
&lt;p&gt;实际上，当他心神不宁地盯着天空时，确实是在寻找任何类型的飞碟。而他回答绿色的原因是由于绿色是参宿四贸易巡视员的传统制服颜色。&lt;/p&gt;
&lt;p&gt;福特·普里弗克特对于马上会有任何飞碟到来已经绝望了，因为15年足以使一个人困在任何地方，尤其又是地球这种枯燥得令人难以置信的星球。&lt;/p&gt;
&lt;p&gt;福特希望一架飞碟会很快到来，因为他知道如何通过旗语让飞碟降落，从里面伸出梯子来接他走。他知道如何花一天不到30牵牛星元的价钱看到宇宙中的种种奇迹。&lt;/p&gt;
&lt;p&gt;实际上，福特·普里弗克特是一个星际漫游者，专门研究那本绝对非凡的书，《银河系漫游指南》。&lt;/p&gt;
&lt;p&gt;人类真是优秀的适应者，到午饭的时候，阿瑟房前的纠纷已经进入了一种稳定的常态。阿瑟已经接受了这样的角色：躺在泥浆里，提一些临时性的要求，像是见见自己的律师和母亲，或者看一本好书什么的：而普洛塞先生也已经接受了这样的角色：用一些临时性的新策略来应付阿瑟，像给他讲公众利益，讲工程的进度，讲自己的房子也曾经被拆除，自己连回头看一眼都没有过，以及各种各样其他的甜言蜜语和恶语威胁：推土机司机的角色则是；坐在一边，喝着咖啡，静静地旁观两人如何把局势导向符合自己利益的一方。&lt;/p&gt;
&lt;p&gt;地球照常按自己每日的规律慢慢地转动着。&lt;/p&gt;
&lt;p&gt;太阳已经开始要把阿瑟躺着的泥浆晒干了。&lt;/p&gt;
&lt;p&gt;一团阴影又一次掩盖了阿瑟。&lt;/p&gt;
&lt;p&gt;“你好吗，阿瑟。”阴影说道。&lt;/p&gt;
&lt;p&gt;阿瑟向上看去，吃惊地发现福特·普里弗克特正站在他上方。&lt;/p&gt;
&lt;p&gt;“福特！嘿，你好吗？”&lt;/p&gt;
&lt;p&gt;“还行。”福特说，“喂，你很忙吗？”&lt;/p&gt;
&lt;p&gt;“我能不忙吗？”阿瑟嚷了起来，“我一个人在这里阻挡这些该死的推土机，要不然他们会推倒我的房子。不过话说回来……噢，不，也不算太忙。怎么，有事儿吗？”&lt;/p&gt;
&lt;p&gt;他们俩在一起时阿瑟从来没有嘲笑过参宿四（除非集中精力，福特·普里弗克特总是注意不到这一点）。他说：“那好，这儿有什么地方可以谈话吗？”&lt;/p&gt;
&lt;p&gt;“什么？”阿瑟·邓特一时没反应过来。&lt;/p&gt;
&lt;p&gt;有几秒钟的时间，福特像是完全忽略了他，怔怔地盯着空中看，就像一只准备躲过一辆车的兔子。然后，他突然在阿瑟身边蹲下来。&lt;/p&gt;
&lt;p&gt;“我们必须谈谈。”他急切地说。&lt;/p&gt;
&lt;p&gt;“好吧，”阿瑟说，“谈谈。”&lt;/p&gt;
&lt;p&gt;“还得喝点儿。”福特说。“交谈和喝酒都相当重要。噢，我们这就去村里的酒吧。”&lt;/p&gt;
&lt;p&gt;他又看了看天上，紧张而又期待。&lt;/p&gt;
&lt;p&gt;“嘿，难道你还不明白吗？”阿瑟嚷道。他指着普洛塞说：“这家伙想推平我的房子！”&lt;/p&gt;
&lt;p&gt;福特望着他，显得很困惑。&lt;/p&gt;
&lt;p&gt;“那好啊，你离开了，他不就可以干成这件事了吗？”他问道。&lt;/p&gt;
&lt;p&gt;“可是我并不想让他这样做啊！”&lt;/p&gt;
&lt;p&gt;“哦。”&lt;/p&gt;
&lt;p&gt;“嘿，你这是怎么了，福特？”阿瑟说。&lt;/p&gt;
&lt;p&gt;“没什么。真的没什么。你听我说——我必须告诉你一件事，这也许是你听说过的最重要的事情了。我必须现在就告诉你，还必须在‘马和马夫’沙龙酒吧里。”&lt;/p&gt;
&lt;p&gt;“为什么？”&lt;/p&gt;
&lt;p&gt;“因为到时候你会需要一杯够劲儿的酒的。”&lt;/p&gt;
&lt;p&gt;福特盯着阿瑟，阿瑟惊讶地发觉自己的意愿开始变得薄弱起来。他丝毫没有意识到这是由于福特使出了一种古老的喝酒游戏的伎俩，那是福特在那些为猎户座贝塔星系的矿区提供服务的超空间港口里学会的。&lt;/p&gt;
&lt;p&gt;这种游戏和地球上称为印第安摔跤的游戏差不多，具体是这样玩的：两名比赛者分别坐在桌子的两侧，每人面前都摆着一个玻璃杯子。&lt;/p&gt;
&lt;p&gt;桌子中间放着一瓶杰克斯酒，比赛者需要把他们的精神力集中在酒瓶上，努力使酒瓶向着对方倾斜，把酒倒在对手的杯子里，而对手就必须喝掉这些酒。&lt;/p&gt;
&lt;p&gt;然后，酒瓶会被重新灌满。游戏继续进行。然后再继续下去。&lt;/p&gt;
&lt;p&gt;一旦你开始输了，你就很可能继续输下去，因为杰克斯酒的效果之一就是削弱人的精神力。等到预先定好量的酒通通被灌下去之后，最后的输家必须接受惩罚，而这些惩罚通常是比较放荡的。&lt;/p&gt;
&lt;p&gt;福特·普里弗克特通常就在输家之列。&lt;/p&gt;
&lt;p&gt;福特盯着阿瑟，于是阿瑟开始认为也许自己真的想去“马和马夫”。&lt;/p&gt;
&lt;p&gt;“不过我的房子怎么办？”他悲哀地问。&lt;/p&gt;
&lt;p&gt;福特望向普洛塞先生，突然间，一个坏主意在他脑海中冒了出来。&lt;/p&gt;
&lt;p&gt;“就是他要把你的房子推倒吗？”&lt;/p&gt;
&lt;p&gt;“是的，他想修成……”&lt;/p&gt;
&lt;p&gt;“你躺在他的推土机前面，所以他不能得逞？”&lt;/p&gt;
&lt;p&gt;“是的，而且……”&lt;/p&gt;
&lt;p&gt;“我保证我们能把这事儿解决好。”福特说。“不好意思！”他喊了一声。&lt;/p&gt;
&lt;p&gt;普洛塞先生四下望了几眼（他正在和推土机司机们的一个代表争论阿瑟·邓特是否神经不太正常，他要真是那样的话，他们应该得到多少钱的补偿）。当他发现阿瑟居然还有同伴时，吃了一惊，还稍稍有点儿警惕。&lt;/p&gt;
&lt;p&gt;“嗯？什么事？”他问，“邓特先生恢复他的理智了吗？”&lt;/p&gt;
&lt;p&gt;“我们能否暂时——”福特说，“假设他还没有？”&lt;/p&gt;
&lt;p&gt;“是吗？”普洛塞先生叹了口气。&lt;/p&gt;
&lt;p&gt;“我们又能否假设——”福特说，“他会在这里躺上一整天？”&lt;/p&gt;
&lt;p&gt;“又怎么样？”&lt;/p&gt;
&lt;p&gt;“那么这就意味着你的人将要在这里白白等上一整天，什么事都干不成。”&lt;/p&gt;
&lt;p&gt;“有可能，有可能……”&lt;/p&gt;
&lt;p&gt;“好吧，如果你无论如何都只能听任这种情况发生的话，你实际上也就不需要他一直躺在这儿了。”&lt;/p&gt;
&lt;p&gt;“什么？”&lt;/p&gt;
&lt;p&gt;“你实际上不需要，”福特耐心地说，“他在这里。”&lt;/p&gt;
&lt;p&gt;普洛塞先生开始思考这个问题。&lt;/p&gt;
&lt;p&gt;“噢，不，不怎么……”他说，“确实不需要。”&lt;/p&gt;
&lt;p&gt;普洛塞很担心。他认为仅仅一个词还不足以表达自己的意思。&lt;/p&gt;
&lt;p&gt;福特说：“好的，如果你认为他确实没有必要待在这里的话，我和他就可以溜到酒吧去待上半个小时了。你觉得怎么样？”&lt;/p&gt;
&lt;p&gt;普洛塞先生认为这听起来相当疯狂。&lt;/p&gt;
&lt;p&gt;“听上去很有道理……”他以一种平静的语调说，却连自己要安抚的是谁都不知道。&lt;/p&gt;
&lt;p&gt;“到时候如果你突然想离开的话，”福特说，“我们随时都会反过来再接替你的。”&lt;/p&gt;
&lt;p&gt;“那真是太谢谢了。”普洛塞先生说，而他根本还不知道具体怎么做，“太谢谢了，真的，你太好……”他皱了皱眉，又笑了，然后一度想同时做这两种表情，结果当然是失败。他用手紧抓住自己的毛皮帽子，在头上转着，想找个合适的位置戴。他只能假设自己已经胜利了。&lt;/p&gt;
&lt;p&gt;“那么，”福特·普里弗克特继续说，“你愿意到这边来躺下……”&lt;/p&gt;
&lt;p&gt;“什么？”普洛塞先生问。&lt;/p&gt;
&lt;p&gt;“噢，我很抱歉，”福特说，“也许我没能把自己的意思表达清楚。总得有人躺在推土机前面，不是吗？否则这里就没有什么能阻止他们开进邓特先生的房子了，不是吗？”&lt;/p&gt;
&lt;p&gt;“什么？”普洛塞先生再一次问道。&lt;/p&gt;
&lt;p&gt;“很简单，”福特说，“我的委托人，邓特先生，表示他将停止躺在这里，只要你过来代替他。”&lt;/p&gt;
&lt;p&gt;“你在说些什么啊？”阿瑟问，但是福特踩了他一脚，示意他安静。&lt;/p&gt;
&lt;p&gt;“你希望我，”普洛塞说着，向自己表述了这个新想法，“过来躺下……”&lt;/p&gt;
&lt;p&gt;“是的。”&lt;/p&gt;
&lt;p&gt;“在这些推土机前面？”&lt;/p&gt;
&lt;p&gt;“是的。”&lt;/p&gt;
&lt;p&gt;“代替邓特先生？”&lt;/p&gt;
&lt;p&gt;“是的。”&lt;/p&gt;
&lt;p&gt;“在泥浆里。”&lt;/p&gt;
&lt;p&gt;“是的，正如你所说，泥浆。”&lt;/p&gt;
&lt;p&gt;普洛塞先生一旦意识到他最终还是输家，就仿佛从肩上卸下了千钧重担：毕竟这才更符合他所认识的世界。他叹了口气。&lt;/p&gt;
&lt;p&gt;“你要真能把邓特先生带到酒吧去，想要什么回报呢？”&lt;/p&gt;
&lt;p&gt;“什么都不要，”福特说，“是的，什么都不要。”&lt;/p&gt;
&lt;p&gt;普洛塞先生紧张地朝前挪了儿步，又停下来。&lt;/p&gt;
&lt;p&gt;“你保证？”他问。&lt;/p&gt;
&lt;p&gt;“我保证。”福特说，然后转向阿瑟。&lt;/p&gt;
&lt;p&gt;“走，”他对阿瑟说，“起来吧，让这个家伙躺下来代替你。”&lt;/p&gt;
&lt;p&gt;阿瑟站起身，感觉仿佛是在梦里。&lt;/p&gt;
&lt;p&gt;福特又朝普洛塞招了招手，于是他一脸沮丧，笨拙地坐到了泥浆里。这个时候，普洛塞感觉他的整个人生就像是一场梦，有时还不能确定这梦是谁的，以及他们能否从中获得快乐。泥浆裹住了他的下半身和手臂，还渗进了鞋子。&lt;/p&gt;
&lt;p&gt;福特严厉地看着他。&lt;/p&gt;
&lt;p&gt;“你们不会趁邓特先生离开的这会儿去打扰他的房子，是吧？”他说。&lt;/p&gt;
&lt;p&gt;“这样的念头，”普洛塞先生抱怨说，“根本还没有冒出来过呢，”他继续道，往后坐了坐，“反正在我脑子里是没有可能的。”&lt;/p&gt;
&lt;p&gt;这时，他看见推土机司机一伙的代表正走过来，于是索性头往后一倒，闭上了眼睛。他想组织一下辩论语言，以证明自己不是突然间神经出了毛病。不过这一点看上去不大可能——他的头脑里仿佛充满了噪音、马、烟雾以及血腥的气味。每当他感到自己很悲惨或者是成了牺牲品，就会出现这种情形，连他自己也解释不了。在某个我们一无所知的空间里，伟大的可汗愤怒地咆哮着，但普洛塞先生却只是微微地颤抖和呜咽。他开始感觉到眼帘后面快有泪水流出了。官僚政治一团糟，愤怒的人躺在泥浆里，身份不明的陌生人带来解释不清楚的屈辱，还有不知道从哪儿冒出来的一队骑兵在脑子里嘲笑着自己——天啊，这是什么鬼日子。&lt;/p&gt;
&lt;p&gt;什么鬼日子。福特·普里弗克特知道，阿瑟的房子现在被推倒了没有，这个问题的价值甚至不值一对澳洲野狗的腰子。&lt;/p&gt;
&lt;p&gt;阿瑟依旧很担心。&lt;/p&gt;
&lt;p&gt;“我们能相信他吗？”他问。&lt;/p&gt;
&lt;p&gt;“就我自己来说，我相信他，直到地球的毁灭。”福特说。&lt;/p&gt;
&lt;p&gt;“噢，是吗，”阿瑟说，“我们离地球毁灭有多远？”&lt;/p&gt;
&lt;p&gt;“大概12分钟的路程。”福特说，“走吧，我需要喝一杯。” &lt;/p&gt;
&lt;p&gt;=== 第二章 ===&lt;/p&gt;
&lt;p&gt;以下是《银河系百科全书》中对酒的解释。它说，酒是一种无色、易挥发的液体，由糖发酵而来，同时，它还提到了酒还具有能够使基于碳元素构成的生命形式变醉的功效。&lt;/p&gt;
&lt;p&gt;《银河系漫游指南》中也提到了酒。它说，存在的最好的饮料就是“泛银河系含漱爆破药”了。&lt;/p&gt;
&lt;p&gt;它说，喝下一杯泛银河系含漱爆破药，那感觉就像是被一大块包裹着柠檬的金砖拍碎了头。&lt;/p&gt;
&lt;p&gt;《指南》还会告诉你，哪些行星上能调配出最好的泛银河系含漱爆破药，买上一份将要花掉你多少钱，以及都有哪些帮助你饮后恢复健康的志愿组织存在。&lt;/p&gt;
&lt;p&gt;《指南》甚至会教你如何自己调配出一份泛银河系含漱爆破药来。&lt;/p&gt;
&lt;p&gt;《银河系漫游指南》卖得可比《银河系百科全书》要好得多。&lt;/p&gt;
&lt;p&gt;“给我来6品脱的啤酒。”福特·普里弗克特对“马和马夫”的服务员说，“请快一点儿，地球快完蛋了。”&lt;/p&gt;
&lt;p&gt;不过这个服务员可不该受到这样的调侃，他是一个威严的老人。他把自己的玻璃杯举到鼻子上方，冲福特·普里弗克特眨着眼睛。福特没有理他，望着窗外，于是他又转而冲着阿瑟眨眼，阿瑟无助地耸了耸肩膀，什么也没说。&lt;/p&gt;
&lt;p&gt;服务员吸了口气。“给，先生，6品脱。”他说。&lt;/p&gt;
&lt;p&gt;福特把一张5镑的钞票拍在吧台上，说：“不用找了。”&lt;/p&gt;
&lt;p&gt;“什么，5镑都不找零？那真谢谢了，先生。”&lt;/p&gt;
&lt;p&gt;“你还剩10分钟去花掉它。”&lt;/p&gt;
&lt;p&gt;于是服务员做出了一个很简单的决定，暂时避开一小会儿。&lt;/p&gt;
&lt;p&gt;“福特，”阿瑟说，“你能告诉我这他妈到底是怎么回事吗？”&lt;/p&gt;
&lt;p&gt;“干了，”福特说，“你可有3品脱的份儿。”&lt;/p&gt;
&lt;p&gt;“3品脱？”阿瑟说，“在午餐的时候？”&lt;/p&gt;
&lt;p&gt;“时间只不过是一种幻觉而已，所谓午餐时间尤其是这样。”&lt;/p&gt;
&lt;p&gt;“相当深刻，”阿瑟说，“你应该把这话寄给《读者文摘》。他们专门有一页就是为像你这种人准备的。”&lt;/p&gt;
&lt;p&gt;“干。”&lt;/p&gt;
&lt;p&gt;“为什么非要一下子干掉3品脱呢？”&lt;/p&gt;
&lt;p&gt;“放松肌肉，你会需要这个的。”&lt;/p&gt;
&lt;p&gt;“放松肌肉？”&lt;/p&gt;
&lt;p&gt;“是的，放松肌肉。”&lt;/p&gt;
&lt;p&gt;阿瑟盯着他的啤酒。&lt;/p&gt;
&lt;p&gt;“是今天我做错了什么吗，”他说，“还是这个世界其实一直就是这样，只不过我以前太沉溺于自我了，没有注意到而已？”&lt;/p&gt;
&lt;p&gt;“好吧，”福特说，“我会尽力解释给你听的。我们认识多久了？”&lt;/p&gt;
&lt;p&gt;“多久？”阿瑟想了想，“嗯，差不多5年了吧，也许6年。”他说，“大部分时间现在看起来还是挺有意思的。”&lt;/p&gt;
&lt;p&gt;“好吧，”福特说，“如果我现在告诉你，我根本就不是从吉尔福德来的，而是来自参宿四旁边的一颗小行星，你会有什么反应？”&lt;/p&gt;
&lt;p&gt;阿瑟无所谓地耸了耸肩。&lt;/p&gt;
&lt;p&gt;“不知道，”他说，一边喝了口啤酒，“为什么，这就是你打算告诉我的事吗？”&lt;/p&gt;
&lt;p&gt;于是福特只好放弃。地球都快毁灭了，在这个时候值不得为这件事烦心。他只说了一句，“干了。”&lt;/p&gt;
&lt;p&gt;随后，他又不容置疑地加了一句，“地球马上就要毁灭了。”&lt;/p&gt;
&lt;p&gt;“今天肯定是星期四，”阿瑟对自己说着，朝啤酒杯埋下了头，“我从来就搞不定星期四。” &lt;/p&gt;
&lt;p&gt;=== 第三章 ===&lt;/p&gt;
&lt;p&gt;就在这个星期四，有个东西无声无息地穿行在距离地球表面很多英里之上的电离层中。实际上，应该说是—些东西，好几十个巨大而粗矮的黄色板状物，像办公楼一样大，像鸟一样无声无息。它们轻快地滑翔着，沐浴在这颗叫做太阳的恒星的电磁射线中，花费时间集结、编队、准备着。&lt;/p&gt;
&lt;p&gt;它们下面这颗行星完全没有意识到它们的到来，惟一探测到它们的是一个叫做亚以太感应器的黑色微型仪器，它开始无声地闪烁起来。它被放在一个皮质小背包里，福特·普里弗克特总是习惯把这个小背包挂在脖子上。福特·普里弗克特的小背包里面其实相当有趣，足以使地球上的任何物理学家瞠目结舌，所以他总是把两本已经卷角的剧本（他假装自己正准备去这两个剧组试镜）放在面上遮住。除了亚以太感应器和剧本之外，包里还有一个电子拇指——一根粗短的黑色棒子，光滑但没有光泽，一头有两个扁平的开关和刻度盘。还有一个仪器，看起来很像是个巨大的电子计算器，上面有上百个扁平的小按键，以及一个大约4英寸见方的屏幕，上百万个“页面”中的任意一个转瞬之间就能被调出来显示在上面。这玩意儿看上去复杂得简直快要让人疯掉了，也许这就是尺寸刚好盖着它的那个塑料壳子上以大而友善的字体写着“不要恐慌”的原因之一吧。另一个原因则是，这个仪器实际上就是小熊星座那些伟大的出版公司所出版过的所有书中最非凡一本——《银河系漫游指南》。至于为什么它要以这种基于微亚介子的电子化形式出版，那是由于如果采用普通的纸媒形式印刷的话，一个星际间的漫游者将不得不随身准备好几座大楼才能装得下它。&lt;/p&gt;
&lt;p&gt;在福特·普里弗克特的小背包里，这几件东西下面是几支圆珠笔、一个笔记本，以及一条在M&amp;amp;S超市买的大洗澡毛巾。&lt;/p&gt;
&lt;p&gt;《银河系漫游指南》中关于毛巾这个词条也有一些解释。&lt;/p&gt;
&lt;p&gt;一条毛巾，它解释说，大概是对一个星际漫游者来说最有用的东西了。从一个方面看，毛巾有着巨大的实用价值：但更重要的是，毛巾有着巨大的心理学上的价值。也不知道出于什么原因，如果一个“正常人”（正常人：非漫游者）发现一个漫游者随身带着毛巾，那么他会很自然地认为此人同样也有牙刷、浴衣、肥皂、装饼干的罐子、保温瓶、指南针、地图、绳捆、灭蚊喷剂、雨衣、太空服……等等。于是乎，他会很乐意借给这个漫游者所有这些东西，甚至还有其他的许多东西——而这些东西通通是这个漫游者碰巧“丢失”了的。这个正常人的心理就是，一个人，在广阔的银河系中漫游，在面对了许多可怕的困难并且成功地战而胜之以后，他如果仍然还弄得清楚自己的毛巾在哪里，那么这显然是一个值得认真对待的人。&lt;/p&gt;
&lt;p&gt;因此，在搭便车漫游的行话中有这么一句，就是：“嘿，你碰过那个同行的福特·普里弗克特吗？那可是个真正知道自己的毛巾在哪里的好搭档。”（碰：知道，认识，遇见，发生过性关系；同行：确实在一起的家伙；好搭档：在一起时让人惊叹的家伙）&lt;/p&gt;
&lt;p&gt;“你带毛巾了吗？”福特突然对阿瑟说。&lt;/p&gt;
&lt;p&gt;阿瑟——这可怜的人正在对付他的第三品脱啤酒——上下打量了他几眼。&lt;/p&gt;
&lt;p&gt;“为什么？什么，不，没有……我应该带吗？”喝到这个时候，他对这种突兀的问题已经不再感到惊讶了。&lt;/p&gt;
&lt;p&gt;福特恼火地弹了一下舌头。&lt;/p&gt;
&lt;p&gt;“干。”他劝道。&lt;/p&gt;
&lt;p&gt;就在这时，外面传来轰隆一声闷响，阿瑟被啤酒噎了一下，直跺脚。&lt;/p&gt;
&lt;p&gt;“出什么事了？”他喊道。&lt;/p&gt;
&lt;p&gt;“别担心。”福特说，“他们还没有开始呢。”&lt;/p&gt;
&lt;p&gt;“喔，谢天谢地。”阿瑟这才放松下来。&lt;/p&gt;
&lt;p&gt;“可能是你的房子刚刚被推倒了。”福特说，喝下了他的最后一品脱。&lt;/p&gt;
&lt;p&gt;“什么？”阿瑟叫了起来。就在这一瞬间，福特方才咒语被打破了。阿瑟发疯般看了看他，然后跑到窗户边上。&lt;/p&gt;
&lt;p&gt;“噢，上帝，他们真的那么干了！他们正在铲平我的房子。我他妈在这该死的酒馆里干吗，福特？”&lt;/p&gt;
&lt;p&gt;“眼下看来这并没有什么不同嘛。”福特说，“就让他们乐一乐吧。”&lt;/p&gt;
&lt;p&gt;“乐一乐？”阿瑟咆哮起来，“乐一乐！”他又迅速地瞟了一眼窗外。&lt;/p&gt;
&lt;p&gt;“去他们该死的乐一乐吧！”他愤怒地嚷着，猛然冲出酒馆，差点儿带倒一个几乎已经空了的啤酒杯。&lt;/p&gt;
&lt;p&gt;“住手，你们这些野蛮人！你们这些破坏狂！”阿瑟大声喊道，“你们这些半疯狂的蛮子，住手，听见没有？！”&lt;/p&gt;
&lt;p&gt;福特看见这架势，知道自己必须跟在他后面。所以他迅速转向酒吧服务员，他刚向他要了4袋花生米。&lt;/p&gt;
&lt;p&gt;“你要的，先生。”服务员说着把花生米扔在吧台上，“28便士，谢谢。”&lt;/p&gt;
&lt;p&gt;沿着乡间小道跑了一阵，阿瑟几乎快到自己的房子了。他没有注意到天气突然之间变得很冷，他没有注意到刺骨的风，也没有注意到突然之间毫无理由砸下来的暴风雨。他没有注意到任何事，除了那些缓缓碾过一片瓦砾的履带推土机。这片瓦砾刚才还是他的房子。&lt;/p&gt;
&lt;p&gt;“你们这些野蛮人！”他高喊着，“我要起诉委员会，讨回每一个子儿！我要绞死你们，把你们五马分尸！狠狠地鞭打你们！下油锅……直到……直到……直到把你们收拾个够。”&lt;/p&gt;
&lt;p&gt;福特跟在他后面飞快地跑过来，非常非常快。&lt;/p&gt;
&lt;p&gt;“然后我还要再来上一次！”阿瑟叫道，“等我收拾完了，还要把你们的碎片都集中起来，再狠狠地踩上几脚！”&lt;/p&gt;
&lt;p&gt;阿瑟并没有注意到，他所咒骂的这些人正从推土机里钻出来：他也没有注意到普洛塞先生正仰头惊恐地看着天上。普洛塞先生关注的是那些呼啸着划过云层的巨大的黄色物体——它们大得简直不可思议。&lt;/p&gt;
&lt;p&gt;“是的，我会再狠狠地踩上几脚，”阿瑟咆哮着，仍旧在跑，“直到我脚上起了水泡，或者想到什么更让我不愉快的事儿，然后……”&lt;/p&gt;
&lt;p&gt;正说着，他脚下绊了一跤、头冲前扑下去，又滚了一圈，最后背朝下仰天摔倒在地。这时他才终于注意到了天上出现的物体。用手指指着天上，他尖叫起来：“这是什么该死的玩意儿？”&lt;/p&gt;
&lt;p&gt;就是这玩意儿，它巨大的黄色身影划过，伴随着令人头晕的噪音把天幕撕开，然后驶远，身后留下渐渐合拢的天空，还有“砰”的一声巨响，简直快把人的耳朵震到颅腔里去了。&lt;/p&gt;
&lt;p&gt;紧接着又是一个飞行物，干了同样的事情，只是发出的声响更大些。&lt;/p&gt;
&lt;p&gt;很难准确地说出这颗行星表面的人们眼下都正在干些什么，因为连他们自己也不知道自己在干些什么。不过可以肯定，没什么真正有意义的事——进进出出房屋，在一片嘈杂中发出无声的嚎叫，伴随着巨响的降临，整个世界的城市街道上挤满了人群，汽车一辆撞向一辆。然后，这声音像潮汐一样翻滚着，越过山峰和峡谷、沙漠和海洋，似乎要扫平所遇上的一切。&lt;/p&gt;
&lt;p&gt;只有一个人站着，望着天空，眼里满是悲伤。他知道正在发生什么事情，从他放在枕头旁边的亚以太感应器在深夜突然开始闪烁并且惊醒了他的那一刻起他就知道了。这是他这些年来一直在等待的，但当他破译出这些信号，独自一人坐在他那阴暗的小屋里时，一股寒意袭上他的心头。在整个银河系所有有能力到这里来向地球这颗行星打声招呼的物种中，他想，并不一定就非得是沃贡人吧。&lt;/p&gt;
&lt;p&gt;不过，他仍然知道自己该做些什么。他已经一切都准备好了，一切就绪了。他现在知道自己的毛巾在哪儿了。&lt;/p&gt;
&lt;p&gt;突然，一片寂静席卷了整个地球。这比嘈杂还要糟糕。这一刻，什么都没有发生。&lt;/p&gt;
&lt;p&gt;巨大的飞船静止在天空中，覆盖了地球上的所有国家。它们纹丝不动地悬在那里，显得巨大、沉重，这对自然是一种亵渎。许多人径直休克了，因为他们试图在头脑中理解所看见的东西。飞船就这样悬在空中，同样大小的砖石建筑可没这个本事。&lt;/p&gt;
&lt;p&gt;还是什么都没有发生。&lt;/p&gt;
&lt;p&gt;然后，传来一声轻微的响动，这突然的一声像是拧开了总开关。地球上所有的音响、所有的收音机、所有的电视、所有的录音机、所有的低音扩音器、所有的高音扩音器、所有的中音扩音器同时都自动打开了。&lt;/p&gt;
&lt;p&gt;所有罐头、所有垃圾桶，所有窗户、所有汽车、所有酒瓶、所有生锈金属片都成了发出和谐声音的器具。&lt;/p&gt;
&lt;p&gt;就在地球快要毁灭之前，它们发出了最后的声音，形成有史以来最为庞大的公众广播系统。不过，传出的不是交响乐，不是音乐，也不是嘹亮的号角，只有一条简单的信息。&lt;/p&gt;
&lt;p&gt;“地球上的人们，请你们注意了，”一个声音响起，音质美极了。这个完美的四声道声音几乎没有一丝扭曲，纯得足以使一个勇敢的人留下眼泪。&lt;/p&gt;
&lt;p&gt;“这里是银河系超空间计划委员会的沃贡·杰尔兹，”这个声音继续说道，“你们无疑已经知道，开发银河系偏远地区的计划需要修建一条超空间快速通道穿越你们这个星系。令人遗憾的是，你们居住的这颗行星属于被清除的范围。清除行动将在你们地球时间两分钟之内展开。谢谢。”&lt;/p&gt;
&lt;p&gt;然后，广播系统停止了工作。&lt;/p&gt;
&lt;p&gt;无法理解的恐惧降临到地球上围观的人们中间。这种恐惧开始慢慢在人群中蔓延开来，就像一张纸板上放着铁屑，而有一块磁铁在纸板下移动。恐慌开始蔓延，这是一种因为绝望而想逃跑的恐慌，但实际上却无路可逃。&lt;/p&gt;
&lt;p&gt;看到这些场景，沃贡人又一次打开了广播系统。它说；“没有必要对此表现出惊慌。所有的计划表格和清除指令都已经在位于半人马座主星上的你们这个地区的规划部门里展示了50个地球年，所以你们有足够的时间提出任何正式的投诉意见。现在才开始慌乱已经太晚了，没有任何意义。”&lt;/p&gt;
&lt;p&gt;广播系统又一次沉默了，只剩它的回声还在大地上回荡。巨大的飞船开始在空中缓慢侧转。每艘飞船的底部都打开了一个舱口，像是一个中空的黑色正方形。&lt;/p&gt;
&lt;p&gt;这时，在这颗星球上的某个地方，有一个人打开无线电发射器，选定了一个频率，向沃贡飞船发出信息，以地球的名义向他们恳求。没有人听到他说了些什么，人们只听到了答复。广播系统再一次响起，这次的声音显得有些恼火。它说：“你这是什么意思，难道你从来没有去过半人马座主星吗？看在上帝的份上，只有区区4光年的路程而已，这你是知道的。我很抱歉。”&lt;/p&gt;
&lt;p&gt;“启动毁灭光束。”&lt;/p&gt;
&lt;p&gt;光束从舱门中倾泻下来。&lt;/p&gt;
&lt;p&gt;“我真搞不懂，”广播系统里一个声音说，“这个冷漠而血腥的星球，我可一点儿也不同情他们。”说罢就切断了。&lt;/p&gt;
&lt;p&gt;一片令人恐怖的寂静。&lt;/p&gt;
&lt;p&gt;一片令人恐怖的嘈杂。&lt;/p&gt;
&lt;p&gt;一片令人恐怖的寂静。&lt;/p&gt;
&lt;p&gt;沃贡建筑施工舰队消失在繁星点缀的漆黑空间中。 &lt;/p&gt;
&lt;p&gt;=== 第四章 ===&lt;/p&gt;
&lt;p&gt;在遥远的银河系螺旋臂的另外一端，距离那颗叫做太阳的恒星50万光年以外的地方，银河帝国政府的总统赞福德·毕博布鲁克斯正在飞速通过达蒙葛兰的海洋，他的离子驱动德尔塔型快艇在达蒙葛兰的阳光下闪闪发光。&lt;/p&gt;
&lt;p&gt;达蒙葛兰太热了；达蒙葛兰太远了；达蒙葛兰几乎根本没有听说过。&lt;/p&gt;
&lt;p&gt;达蒙葛兰，黄金之心的秘密据点。&lt;/p&gt;
&lt;p&gt;而今天正是计划的巅峰、揭晓一切的伟大日子，即黄金之心最终向整个惊呆了的银河系展示的日子，同时也是赞福德·毕博布鲁克斯个人达到巅峰的伟大日子。因为，当年正是在这一天，他第一次决定参加总统竞选，这一决定在整个银河帝国引起了轩然大波。赞福德·毕博布鲁克斯？总统？不是赞福德·毕博布鲁克斯？不是总统？许多人把这一决定视为一条确凿的证据——已知的整个宇宙最终都疯掉了。&lt;/p&gt;
&lt;p&gt;想到这里，赞福德咧开嘴笑了，又把快艇的速度提高了一挡。&lt;/p&gt;
&lt;p&gt;赞福德·毕博布鲁克斯，投机分子、曾经的嬉皮士、一个守时的人、（骗子？很有可能）、疯狂的个人宣传家，人际关系极端恶劣，总想着外出午餐。&lt;/p&gt;
&lt;p&gt;总统？&lt;/p&gt;
&lt;p&gt;没有人发疯，至少是在这件事情上。&lt;/p&gt;
&lt;p&gt;整个银河系中只有6个人理解管理银河系的原则，他们知道，一旦赞福德·毕博布鲁克斯宣布他将竞选总统，这差不多也就是既成事实了：他绝对是一个理想的总统坯子。&lt;/p&gt;
&lt;p&gt;他们所完全不能理解的是，赞福德为什么要这样做。&lt;/p&gt;
&lt;p&gt;他正驾驶着快艇猛地拍打海面，朝着达蒙葛兰太阳的方向激起一片狂野的水幕。&lt;/p&gt;
&lt;p&gt;今天是时候了；今天他们将知道赞福德的全盘计划。今天是赞福德·毕博布鲁克斯整个总统任职的目标所在。今天也是他200岁的生日，不过这只是一个毫无意义的巧合而已。&lt;/p&gt;
&lt;p&gt;驾驶快艇在达蒙葛兰的海上飞驰时，他自己暗暗地笑着，这将是多么美妙和激动人心的一天啊。他放松下来，两只胳膊懒洋洋地撑在座椅靠背上。他用另外的一只手掌舵，这是他最近才装上的，就在右手下面，用来提高他进行滑雪拳击运动的能力。&lt;/p&gt;
&lt;p&gt;海岛悬崖的顶端站着一群迎接者。&lt;/p&gt;
&lt;p&gt;他们主要由建造了黄金之心的工程师和研究人员组成——大部分属于人类，但间或有些具有两栖动物特征的生物，两三个绿色的苗条生物，一两个八脚生物，还有一个藏青色生物（藏青色是一种超级色度的蓝色）。除了藏青色生物以外，别的都穿着彩色工作服，显得华丽而耀眼。&lt;/p&gt;
&lt;p&gt;一种狂喜的情绪使他们激动不已。他们通力合作，达到并且超越了物理法则最远的界限，重组了物质的基本结构，拉紧、拧合以及打破了可能性（概率）与不可能性（非概率）的法则。不过，最让所有人激动的是，他们即将见到一个脖子上挂着橙色饰带的人（橙色饰带是银河系总统传统的标志）。他们不会知道银河系总统实际上所拥有的权力有多么可怜：完全等于零。整个银河系中只有6个人知道，总统的作用不是掌握权力，而是吸引注意力远离这权力。&lt;/p&gt;
&lt;p&gt;赞福德·毕博布鲁克斯把这份职责完成得非常之好。&lt;/p&gt;
&lt;p&gt;总统驶进海湾时，人群一下子屏住了呼吸，他们被阳光晃了眼，更被他的驾驶技术镇住了。快艇闪耀着光芒，像是装了宽阔的滑轮一样滑行在海面上。&lt;/p&gt;
&lt;p&gt;实际上，快艇根本就不用接触水面，因为它是靠一层电离化了的原子气垫支撑的，而看上去伸进水中的鳍翼只不过是为了引人注目才装上的。驶过海湾时，这些鳍翼把海水激到空中嘶嘶作响，深深地切开海面，在船尾的痕迹中留下大团泡沫。&lt;/p&gt;
&lt;p&gt;赞福德喜欢引人注目：这正是他最擅长的。&lt;/p&gt;
&lt;p&gt;他猛地打了一下舵，快艇划出一道弧形后停在悬崖下面，在风浪中起伏。&lt;/p&gt;
&lt;p&gt;几秒钟后，他来到甲板上，向30亿人挥手微笑。这30亿人并非真的在现场，但是他们通过一架正奉承似的在附近空中盘旋的遥控三维摄像机的镜头可以清楚地看到他的一举一动。总统那些古怪的举动是最受欢迎的三维图像：三维摄像机就是专门记录这些的。&lt;/p&gt;
&lt;p&gt;他又笑了笑。这30亿零6个人并不知道，今天会发生他们根本预料不到的更大的古怪。&lt;/p&gt;
&lt;p&gt;那架遥控摄像机飞得更近了，镜头对准了他那很受欢迎的双头，他又开始挥手。他的外表完全是人类的，除了多出的一个脑袋和第三只手。他的两头金发乱七八糟地向四周炸开，蓝色的眼睛中闪烁着一些完全无法辨别的东西，下巴则几乎从来没有刮过。&lt;/p&gt;
&lt;p&gt;一片掌声雷动中，赞福德·毕博布鲁克斯走出快艇，他的橙色饰带在阳光下闪耀着。&lt;/p&gt;
&lt;p&gt;银河系总统驾到！&lt;/p&gt;
&lt;p&gt;掌声停下来后，他举起手，向人们致意。&lt;/p&gt;
&lt;p&gt;“嗨。”他说。&lt;/p&gt;
&lt;p&gt;每个人都朝他微笑着，或者，至少几乎每个人。他从人群中认出了崔莉恩。这个女孩儿是赞福德最近才从所访问的一个星球上选出来的，只是为了玩玩而已。她很苗条，肤色浅黑，人类的模样，有着一头黑色的波浪长发，嘴唇丰满，鼻子稍稍有些突出，褐色的眼睛显得很可笑。她系着一条红色的头巾，打结的方式很特别，穿着褐色的丝绸长裙，这些使她看上去多少有些像阿拉伯人。当然，这里的人们谁也没有听说过阿拉伯人，毕竟这个种族离达蒙葛兰足有50万光年之远。崔莉恩并非什么特殊人物，起码赞福德是这么声称的。&lt;/p&gt;
&lt;p&gt;“嗨，宝贝儿。”他冲她打了个招呼。&lt;/p&gt;
&lt;p&gt;她对他微微笑了笑，随即移开目光。过了一会儿，她又看过来，这次笑得热情多了——不过，此时赞福德的注意力已经转移到其他人身上去了。&lt;/p&gt;
&lt;p&gt;“嗨。”他对身边的记者们说，他们站在他周围，希望能听见他停止说“嗨”，而发表一些妙语。赞福德特意冲他们笑着，因为他知道，用不了一会儿他就会让他们大吃一惊的。&lt;/p&gt;
&lt;p&gt;他的话对这群人一点儿意义都没有。一个官员于是慌乱地判定总统今天显然没有心情再宣读精心为他准备的讲稿了，所以他摁下衣服口袋里遥控设备的开关。在他们面前，一个直刺向天空的巨大的白色穹顶啪的一声从中间裂开，折叠起来缓缓地向地面下降。每个人这时都屏住了呼吸，虽然他们很清楚即将发生什么，因为这就是他们建造的。&lt;/p&gt;
&lt;p&gt;在这个穹顶下面，露出来的是一艘巨大的飞船，足有150米长，外形看上去像一只光滑的跑鞋，纯白色的，漂亮极了。就在这艘飞船的心脏位置，看不见的地方，放着一个小小的黄金盒子，里面装着头脑所能构想出来的最伟大的装置，正是这个装置使得这艘飞船成为银河系历史上独一无二的飞船，飞船的名字正是按照这个装置的名字来取的——黄金之心。&lt;/p&gt;
&lt;p&gt;“哇！”赞福德·毕博布鲁克斯对着黄金之心赞叹道。他确实也找不到别的什么话来表达此刻的感受了。&lt;/p&gt;
&lt;p&gt;他又重复了一遍，因为他知道这会使记者们感到很恼火。“哇。”&lt;/p&gt;
&lt;p&gt;人们纷纷转过脸来期待地看着赞福德。他则冲崔莉恩眨了一下眼，她正扬起眉毛睁大眼睛望着他。她知道他将要说些什么，她很清楚他是个多么爱炫耀自己的人。&lt;/p&gt;
&lt;p&gt;“真是太惊人了，”他说，“绝对震撼！这东西简直让人疯狂，我甚至想把它偷走。”&lt;/p&gt;
&lt;p&gt;这可是句货真价实的总统语录，绝对值得大大引用一番。人群中爆发出赞赏的掌声，新闻记者们则一个个喜笑颜开地敲打着亚以太新闻机的按键。总统咧开嘴笑了。&lt;/p&gt;
&lt;p&gt;正笑着，他的心脏却发出了令人难以忍受的尖叫，他赶紧把手伸进衣兜，捏住静静躺在里面的那颗小小的麻痹剂炸弹。&lt;/p&gt;
&lt;p&gt;终于，他无法再忍受了，于是仰头向着天，用大三度的高音发出一声野性的叫喊，同时把炸弹扔到地上，然后朝前猛冲，穿过那一片突然凝固的笑脸的海洋。 &lt;/p&gt;
&lt;p&gt;=== 第五章 ===&lt;/p&gt;
&lt;p&gt;沃贡·杰尔兹长得并不讨人喜欢，即使是对其他沃贡人来说也是这样。他那醒目的半球形鼻子翘得老高，远远超过了他那很小一块像猪仔一样的前额。他之所以成为今天这副模样，完全是因为几十亿年以前，沃贞人第一次缓慢地爬上沃贡星球的原始海洋，喘着气，在这颗星球未开垦的蛮荒海滩上慢慢站立起来……就在那个早晨，年轻而明亮的沃贡太阳的第一缕阳光照在他们身上，但似乎进化的力量就在此时此地抛弃了他们，这些力量厌恶地扭头而去，把他们作为丑陋和不幸的错误一笔勾销。从此他们就再也没有进化过：他们本来不该生存下来。&lt;/p&gt;
&lt;p&gt;这样的事实在某种程度上却恰好激发了这些生物倔强的意志。进化？他们对自己说，谁需要这玩意儿？自然拒绝赋予他们的东西，他们反而通过更短的时间做到了——他们已经可以通过外科手术修补所有解剖学上的不合理结构。&lt;/p&gt;
&lt;p&gt;同时，沃贡星球上自然的力量也开始加班工作，以弥补早期犯下的大错。它们创造出了泛着宝石光泽的螃蟹，沃贡人可以用铁锥砸碎蟹壳，得到食物：高耸挺拔的树木，修长而艳丽，沃贡人可以砍来烧熟蟹肉；还有优雅的像瞪羚—样的生物，有着丝绸般的皮毛和水汪汪的眼睛，沃贡人可以捉来当椅子——因为它们的脊背很容易突然折断，所以不能用作交通工具，但沃贡人还是可以坐在上面的。&lt;/p&gt;
&lt;p&gt;就这样，沃贡星球打发掉了那些不愉快的千万年，直到突然有一天沃贡人发现了星际航行的原理。于是，在短短几个沃贡年的时间内，沃贡人就移民到了大布兰特斯星团，银河系的政治中心，直到今天早已搭建起了银河系行政部门强有力的中枢骨架。他们试图获得学问，试图获得优雅的风格，但实际上，在大部分方面，现代沃贡人和他们的原始祖先之间并没有太大的区别。每年，他们都会从自己的母亲星球进口27000只泛着宝石光泽的螃蟹，在一个烂醉的狂欢之夜用铁锥砸碎它们。&lt;/p&gt;
&lt;p&gt;因为他的粗鄙，沃贡·杰尔兹可以说是一个相当典型的沃贡人。另外，他讨厌星际漫游者。&lt;/p&gt;
&lt;p&gt;在沃贡·杰尔兹的旗舰上，一间黑暗的房间内，一根火柴燃了起来。这根火柴的主人并不是一个沃贡人，但他知道他们的一切，而且现在感到很紧张。他的名字叫做福特·普里弗克特。&lt;/p&gt;
&lt;p&gt;福特·普里弗克特暗暗地感谢了丹特拉斯人一声。丹特拉斯人是一个很难驾驭的种族，喜好美食，野蛮但又可爱，最近被沃贡人雇用，成为他们远航舰队上的厨师。他们得到了谅解，可以保持自己独立的本色。&lt;/p&gt;
&lt;p&gt;这样的合约很适合丹特拉斯人，因为他们喜欢沃贡人的钱，这是宇宙中最硬通的货币之一，但厌恶沃贡人本身。他们惟一喜欢见到的沃贡人就是一个郁闷中的沃贡人。&lt;/p&gt;
&lt;p&gt;正是由于获得了这条小小的信息，才使得福特·普里弗克特此刻还没有变成一团氢气、臭氧和一氧化碳的混合物。&lt;/p&gt;
&lt;p&gt;他听到了一声轻轻的呻吟。借着火柴的光线，他看见一团沉沉的黑影正轻轻地在地板上移动。于是他赶紧抖灭火柴，伸手从衣兜里掏出一件东西。他撕开这东西，晃动着，然后蹲下身来。黑影继续移动着。&lt;/p&gt;
&lt;p&gt;福特·普里弗克特说：“我带了一些花生来。”&lt;/p&gt;
&lt;p&gt;阿瑟·邓特移动着，又发出一声呻吟，同时语无伦次地咕哝着什么。&lt;/p&gt;
&lt;p&gt;“哎，来点儿吧。”福特劝说道，又晃了晃手中的花生，“如果你此前从没有经历过传送光束，那么你可能会失去一些盐和蛋白质。你喝下去的啤酒会稍微有点儿帮助的。”&lt;/p&gt;
&lt;p&gt;“喂……呵……”阿瑟·邓特开口了。他睁开眼睛，“这里很暗呀。”他说。&lt;/p&gt;
&lt;p&gt;“是的，”福特·普里弗克特说，“这里很暗。”&lt;/p&gt;
&lt;p&gt;“没有光，”阿瑟·邓特说，“黑暗，没有光。”&lt;/p&gt;
&lt;p&gt;人类有一个习惯是福特·普里弗克特始终感到难以理解的，那就是不断重复一个非常非常明显的事实，比如说“今天天气不错”，或者“你真高啊”，或者“噢，亲爱的，你看上去就像掉进了30英尺深的井里，一切都还好吧”……起初，福特本以为找到了一种理论来解释这种奇怪的行为：如果人类不坚持锻炼嘴唇的话，他想，他们的嘴也许会失灵。不过，在经过几个月的思考和观察之后，他放弃了这种理论，而转向了新的一种：如果他们不坚持锻炼嘴唇的话，他想，他们的大脑就会开始工作。一段时间后，他又放弃了这种理论。他想通了，不管怎样自己还是很喜欢人类的。但同时，人类毫不知晓的事情太多了，他一直为此感到近乎绝望的担忧。&lt;/p&gt;
&lt;p&gt;“是的，”他附和阿瑟道，“没有光。”他帮助阿瑟吃了一些花生。“你感觉怎么样？”他问。&lt;/p&gt;
&lt;p&gt;“如果我问你我们这是在什么鬼地方，”阿瑟虚弱地说，“我会后悔吗？”&lt;/p&gt;
&lt;p&gt;福特站起身来。“我们现在很安全。”他说。&lt;/p&gt;
&lt;p&gt;“喔，那真是太好了。”阿瑟说。&lt;/p&gt;
&lt;p&gt;“我们是在一间小厨房里，”福特说，“在沃贡建筑施工舰队的一艘飞船上。”&lt;/p&gt;
&lt;p&gt;“哦，”阿瑟说，“显然这是‘安全’这个词儿的一种奇怪的新用法，我以前可没有意识到。”&lt;/p&gt;
&lt;p&gt;福特再次划燃了一根火柴，以便找到灯的开关。巨大而怪异的阴影又开始隐约晃动起来。阿瑟在一旁担忧地抱着胳膊。可怕的阴影看起来像要扑向他，空气中有一股浓重的霉味，全都不分青红皂白地钻进他的肺里，低沉而恼人的嗡嗡声使他完全集中不起精神。&lt;/p&gt;
&lt;p&gt;“我们怎么会到这儿来的？”他问，微微地颤抖着。&lt;/p&gt;
&lt;p&gt;“我们搭了一部电梯。”福特回答说。&lt;/p&gt;
&lt;p&gt;“什么？”阿瑟说。“难道你是要告诉我，我们刚才伸出我们的大拇指，而一个长着虫眼睛的绿色怪物则探出头来，对我们说‘嗨，伙计，跳上来吧，我可以带你们去看旋转木马’？”&lt;/p&gt;
&lt;p&gt;“嗯，怎么说呢，”福特说，“你所谓的‘大拇指’实际上是一套亚以太信号收发设备，而‘旋转木马’则是6光年以外的巴纳德星。不过，从某种角度来看，你说的差不多也算对吧。”&lt;/p&gt;
&lt;p&gt;“还有长着虫眼睛的怪物呢？”&lt;/p&gt;
&lt;p&gt;“没错，是绿色的。”&lt;/p&gt;
&lt;p&gt;“好吧，”阿瑟说，“我什么时候能回家呢？”&lt;/p&gt;
&lt;p&gt;“你不能。”福特·普里弗克特说，同时找到了灯的开关。&lt;/p&gt;
&lt;p&gt;“闭上眼睛……”他说着打开灯。&lt;/p&gt;
&lt;p&gt;接下来的事甚至让福特也感到吃惊。&lt;/p&gt;
&lt;p&gt;“天啊，”阿瑟说，“这真的是一架飞碟的内部吗？”&lt;/p&gt;
&lt;p&gt;沃贡·杰尔兹绿色的身影出现在飞船的控制桥上。在毁灭了有人居住的星球之后，他通常总会感到一种莫名的暴躁。这个时候，他总是希望有什么人跑到他跟前来，指责他所做的一切都是错误的，然后他就可以一枪崩了这家伙，这样他会感觉好点儿。他重重地一屁股硒进他的座椅，很希望这玩意儿会坏掉，这样就给他提供了一个大发雷霆的借口，只可惜座椅只是诉苦似的发出吱吱声。&lt;/p&gt;
&lt;p&gt;“滚开！”他冲着一个恰好在此时进到控制桥的年轻沃贡侍卫吼道。这个侍卫顷刻间就消失了，倒像是得到了赦免一样，他很高兴接下来汇报他们刚刚接收到的报告的人不再是自己了。这份报告是一份官方文件，通知说一种新型飞船已经在达蒙葛兰上的一个政府研究基地向外界进行了展示，这一成果使得所有的超空间快速通道变得不再需要了。&lt;/p&gt;
&lt;p&gt;又有一扇门被推开了，不过这次沃贡舰长没有吼叫，因为这扇门足通向丹特拉斯人为他准备午餐的厨房间的。一顿美味的午餐在这个时候也许是最受欢迎的了。&lt;/p&gt;
&lt;p&gt;一个浑身长满毛的庞大生物从门里走出来，托着他的午餐盘。这家伙笑起来活像个疯子。&lt;/p&gt;
&lt;p&gt;沃贡·杰尔兹一下产变得很高兴。他知道，当一个丹特拉斯人看上去乐成这副模样时，就意味着在这艘飞船上的某个地方发生了一些足以让他大发雷霆的事情。&lt;/p&gt;
&lt;p&gt;福特和阿瑟望着他们四周。&lt;/p&gt;
&lt;p&gt;“好吧，你怎么想？”福特问道。&lt;/p&gt;
&lt;p&gt;“有点儿脏，不是吗？”&lt;/p&gt;
&lt;p&gt;福特皱起眉头看着身旁这些邋遢的床垫、没有洗过的杯子以及分辨不清的已经起味儿了的内衣裤。&lt;/p&gt;
&lt;p&gt;“噢，如你所见，这显然是—艘工作船，”福特说，“这些应该是丹特拉斯入睡觉的铺位。”&lt;/p&gt;
&lt;p&gt;“我想你曾经说过他们叫做沃贡人或者其他什么玩意儿。”&lt;/p&gt;
&lt;p&gt;“是的，”福特说，“沃贡人负责驾驶飞船，丹特拉斯人则是厨师；正是他们让我们登上这艘飞船的。”&lt;/p&gt;
&lt;p&gt;“你把我搞糊涂了。”阿瑟说。&lt;/p&gt;
&lt;p&gt;“过来，看看这个。”福特说。他在一张床垫上坐下来，开始在自己的背包中翻拣。阿瑟紧张兮兮地用手戳了戳床垫，然后也坐了下来。其实他根本用不着这么紧张，因为所有这些床垫在使用之前都经过了彻底的除菌消毒。&lt;/p&gt;
&lt;p&gt;福特把书递给阿瑟。&lt;/p&gt;
&lt;p&gt;“这是什么？”阿瑟问。&lt;/p&gt;
&lt;p&gt;“《银河系漫游指南》。这是一种电子书。它能告诉你你所想知道的任何事情。这就是它的功用。”&lt;/p&gt;
&lt;p&gt;阿瑟紧张地将书在手里翻了一面。&lt;/p&gt;
&lt;p&gt;“我喜欢这封面，”他说，“‘不要恐慌。’一整天来总算有人对我说了句有用或者明智的话了。”&lt;/p&gt;
&lt;p&gt;“我来给你演示一下它是如何工作的。”福特说。他一把从阿瑟手里夺过书，而阿瑟刚刚小心翼翼地把书从封面里取出来。&lt;/p&gt;
&lt;p&gt;“按这儿的这个按钮，你瞧，屏幕亮起来了，显示出索引目录。”&lt;/p&gt;
&lt;p&gt;屏幕大约有3英寸长、4英寸宽，渐渐亮起来，字母开始在上面闪过。&lt;/p&gt;
&lt;p&gt;“你想了解沃贡人，现在就可以输入这个名字。”说着他的手指开始敲击按键，“行了。”&lt;/p&gt;
&lt;p&gt;于是“沃贡建筑施工舰队”这几个词闪着绿光山现在屏幕上。&lt;/p&gt;
&lt;p&gt;福特按下屏幕下方的一个红色大按钮，一个个句子开始在屏幕上闪过。同时，电子书开始以一种冷静、节制的声音朗读这些句子。内容是这样的：“沃贡建筑施工舰队，如果你希望摆脱一个沃贡人，惟一的办法就是：忘记这事。他们是银河系中最令人不愉快的种族之一——实质上并不邪恶，但是脾气不好，官僚气严重，好管闲事并且冷酷无情。如果没有正式签署的一式三份的命令，他们甚至不会伸出哪怕是一根手指从贪婪的特拉尔怪兽口中救出自己的祖母。&lt;/p&gt;
&lt;p&gt;“让一个沃贡人把酒吐出来的最好办法就是用你的手指戳进他的喉咙，而激怒他的最好办法则是把他的祖母拿去喂贪婪的特拉尔怪兽。&lt;/p&gt;
&lt;p&gt;“绝对不能让一个沃贡人对着你念诗，”&lt;/p&gt;
&lt;p&gt;阿瑟对着书一个劲儿眨眼。&lt;/p&gt;
&lt;p&gt;“这可真是一本奇怪的书。那么，我们怎么样摆脱呢？”&lt;/p&gt;
&lt;p&gt;“这正是问题的关键所在，上面说的现在已经过时了。”福特说着把书又塞进封面，“我正在为新的修订版本进行实地调查研究，我必须要做的事情之一就足总结一下沃贡人目前是如何雇用丹特拉斯人作为厨师的，这能够使我们发现一个相当有用的小漏洞。”&lt;/p&gt;
&lt;p&gt;又有一丝痛苦的表情闪过阿瑟的脸。“可是，丹特拉斯人又是什么人呢？”他问道。&lt;/p&gt;
&lt;p&gt;“是一些了不起的家伙，”福特说，“他们是最好的厨师、最好的调酒师。还有，他们经常帮助星际漫游者上飞船来搭便车，部分原因是他们喜欢这些家伙，但最主要的还是因为他们讨厌沃贡人。如果你是一个穷光蛋漫游者，希望花一天不到30牵牛星元的价钱参观宇宙中的种种奇迹，那么这条信息是绝对需要知道的。而这正是我的情况。很有趣，不是吗？”&lt;/p&gt;
&lt;p&gt;阿瑟看上去若有所失。&lt;/p&gt;
&lt;p&gt;“是的，很有趣。”他说，同时皱眉看着另一张床垫。&lt;/p&gt;
&lt;p&gt;“不走运的是，我陷在地球上太久了，远远超出了我的预计。”福特说，“我本来计划待上一周，但实际上却待了好15年。”说着，福特干脆躺了下来，双手枕在脑后，看上去一副自得其乐的样子。&lt;/p&gt;
&lt;p&gt;“福特，”阿瑟却依旧不依不饶，“我不管这个问题听上去是不是够蠢，可是你能告诉我我在这个鬼地方干什么吗？”&lt;/p&gt;
&lt;p&gt;“好吧，你应该知道的，”福特说，“我把你从地球上救了出来。”&lt;/p&gt;
&lt;p&gt;“地球发生了什么？”&lt;/p&gt;
&lt;p&gt;“哦，它被毁灭掉了。”&lt;/p&gt;
&lt;p&gt;“是吗？”阿瑟不为所动地说。&lt;/p&gt;
&lt;p&gt;“是的。它刚刚从宇宙里蒸发掉了。”&lt;/p&gt;
&lt;p&gt;“你瞧，”阿瑟说，“我对这个有点恼火。”&lt;/p&gt;
&lt;p&gt;福特皱起眉头，看-上去像是在整理头脑中的思路。&lt;/p&gt;
&lt;p&gt;“是的，我可以理解。”他最后说道。&lt;/p&gt;
&lt;p&gt;“你理解！”阿瑟叫嚷起来，“你理解！”&lt;/p&gt;
&lt;p&gt;福特一下子跳了起来。&lt;/p&gt;
&lt;p&gt;“你给我继续看书！”他急切地嘘了一声。&lt;/p&gt;
&lt;p&gt;“什么？”&lt;/p&gt;
&lt;p&gt;“不要恐慌。”&lt;/p&gt;
&lt;p&gt;“我没有恐慌！”&lt;/p&gt;
&lt;p&gt;“足的，你恐慌了。”&lt;/p&gt;
&lt;p&gt;“好吧，就算我恐慌吧，我们还能干些什么呢？”&lt;/p&gt;
&lt;p&gt;“只需要跟着我，度过快乐的时光。银河系里其实挺好玩的。对了，你得把这条鱼放进你的耳朵。”&lt;/p&gt;
&lt;p&gt;“对不起，你说什么？”阿瑟问道，这一次他觉得自己很有礼貌。&lt;/p&gt;
&lt;p&gt;福特于里举着一个小玻璃罐，可以清楚地看到里面有—条黄色的小鱼正在游来游去。阿瑟开始冲着他眨眼。他很希望有点儿什么东西足够简单并且是可以认知的，这样他才能够领会。在丹特拉斯人的这些内衣裤、这一大堆床垫以及这个从参宿四来的拿着一条鱼要放进他的耳朵的人旁边，哪怕只见到一小包玉米片，他也会感到比较安全。但这是不可能的，所以他找不到安全感。&lt;/p&gt;
&lt;p&gt;突然，一阵狂野的叫声传过来，他判断不出方向。这声音像是一个人在和狼群搏斗时从喉头咕哝着发出的，这让他很害怕。&lt;/p&gt;
&lt;p&gt;“嘘！”福特说，“听好了，这可能很重要。”&lt;/p&gt;
&lt;p&gt;“重……重要？”&lt;/p&gt;
&lt;p&gt;“这是沃贡舰长在扩音器里宣布什么东西。”&lt;/p&gt;
&lt;p&gt;“你是说这声音就是沃贡人的语言？”&lt;/p&gt;
&lt;p&gt;“听着！”&lt;/p&gt;
&lt;p&gt;“可我根本就不懂沃贡话！”&lt;/p&gt;
&lt;p&gt;“你不需要懂。你只需要把这条鱼放进耳朵里。”&lt;/p&gt;
&lt;p&gt;福特稍微动了一步，一下子把手贴在阿瑟的耳朵上，然后阿瑟很恶心地感觉到那条鱼深深地滑进了自己的听觉孔道。出于一种本能的恐惧，他抓住耳朵抖了半天，但渐渐却开始惊讶无比地瞪大了眼睛。如果用视觉来形容他此刻的听觉，那就是，他仿佛是在看一幅画着两个黑色的脸部侧面轮廓的画，可这幅画突然间变成了一具白色烛台。或者说，在看一张纸上画着的许多彩色圆点，它们突然间组成了数字“6”。眼睛真要出了这种事，你的眼镜商就会为了一副新眼镜收你一大笔钱。&lt;/p&gt;
&lt;p&gt;他仍然在听咕哝般的嚎叫声，现在他知道了，只有这样这声音才能呈现为非常简单明了的英语。&lt;/p&gt;
&lt;p&gt;以下是他听到的……（待续，明天再扫）&lt;/p&gt;
&lt;p&gt;附：名词解释&lt;/p&gt;
&lt;p&gt;总统：全称是“银河帝国政府总统”。&lt;/p&gt;
&lt;p&gt;“帝国”一词是一直沿用下来的，其实是一个与时代不符的错误。世袭的皇帝已经死去好几个世纪了。他所有的后代也已经死去很久了，这就意味着，在没有经过剧烈的政治动荡的情况下，权力简单而有效地下放了，现在掌握在一个以前只单纯地扮演皇帝顾问这一角色的实体手中——一个选举产生的政府议会，由该议会选举产生的总统所领导。但实际上，权力并非掌握在此处。&lt;/p&gt;
&lt;p&gt;总统其实只是一个有名无实的首脑——他并没有实质性的权力，表面上看他似乎是由政府选举出来的，但要求他负责的却并非真正的决策岗位，而是那些已经决定了的暴行正是由于这个原因，总统一直就是一个争议很大的角色，总是既让人愤怒又充满了诱惑力。他的工作不是掌握权力，而是把人们的注意力从权力上引开。从这个意义上说，赞福德·毕博布鲁克斯是银河系历史上最成功的总统之一——他已经因为诈骗而在监狱里度过了10年总统任期中的2年、只有极少极少的人意识到总统和政府根本没有实质性的权力，在他们中间又只有6个人知道最终的政治权力掌握在何处。剩下的人大部分私下相信最终的决策程序是由一台电脑控制的。在这一点上，他们无疑大错而特错了。&lt;/p&gt;
&lt;p&gt;福特·普里弗克特的原名只有用参宿四的一种晦涩的方言才能读得出来，但这种方言在银河系系年03758年的那场异物大坍塌灾难之后就灭绝了。那场灾难袭击了参宿四星系7号星上的部落，而福特的父亲因为一种他自己也解释不清楚的巧合成为整个星球上惟一的幸存者。整件事都相当神秘：事实上没有人知道异物是什么，或者它为什么会恰好选择在参宿四星系7号星上坍塌。后来，福特的父亲来到参宿四星系5号星上居住，为了纪念他已经消亡的种族，他用古老的方言给儿子取名。&lt;/p&gt;
&lt;p&gt;由于福特从来没有学会读自己的原名，他的父亲是带着羞耻死去的——这在银河系的某些地方仍然还是一种疾病，学校里的其他孩子给福特取了一个绰号Ix，这在参宿四星系5号星的语言里的意思就是“不能令人满意地解释异物是什么，或者它为什么会恰好选择在参宿四星系7号星上坍塌的男孩儿”。 &lt;/p&gt;
&lt;p&gt;=== 第六章 ===&lt;/p&gt;
&lt;p&gt;“嚎叫、嚎叫、咕哝、嚎叫、咕哝、嚎叫、嚎叫、”嚎叫；咕哝、嚎叫、咕哝、嚎叫、嚎叫、咕哝、咕哝、嚎叫、咕哝、咕哝、咕哝、嚎叫……重复一遍。这里是你们的舰长在讲话，停下你们手头正在干的仟何事情，注意听着。首先，我们的仪器告诉我，飞船上来了两位搭便车的漫游者。你们好，不管你们现在在哪儿。我必须清楚地表明我们的立场：你们是不受欢迎的。我能到今天的位置，靠的是我的努力工作，能当上沃贡建筑施工飞船的舰长不是因为我会把飞船变成免费为乘客提供服务的出租车。我已经派出了一支搜索队，一旦找到你们，我会把你们扔出飞船。当然，如果你们足够幸运的话，也许我会先给你们读几句我的诗。&lt;/p&gt;
&lt;p&gt;“第二，我们即将进行通往巴纳德星的超空间跃迁。&lt;/p&gt;
&lt;p&gt;到达以后，我们将在空间码头内进行72小时检修，这期间任何人不得离开飞船。我再重复一遍，任何离开飞船到星球上去的行为都是不允许的。我自己刚刚遇上了一次很不愉快的泡妞经历，所以我不希望你们其他这些人有可能享受一次美妙的艳福。讲话完毕。“&lt;/p&gt;
&lt;p&gt;然后这声音就消失了。&lt;/p&gt;
&lt;p&gt;阿瑟这时才尴尬地发现自己已经蜷成一圈躺在地板上了，双臂还抱着脑袋。他只好勉强笑了笑。&lt;/p&gt;
&lt;p&gt;“一个很有魅力的人。”他说，“我真希望自己有个女儿，那样的话我就可以不准她嫁给这么一位……”&lt;/p&gt;
&lt;p&gt;“这你大可不必。”福特说，“这帮家伙的性关系就像马路上的交通事故—样泛滥。不，别动。”看到阿瑟开始舒展身体时，他又补充了一句，“你最好准备一下超空间跃迁。那感觉可不太舒服，就像喝醉了一样。”&lt;/p&gt;
&lt;p&gt;“喝醉了又有什么特别不舒服的呢？”&lt;/p&gt;
&lt;p&gt;“你会需要一杯水。”&lt;/p&gt;
&lt;p&gt;阿瑟想了想。&lt;/p&gt;
&lt;p&gt;“福特。”他说。&lt;/p&gt;
&lt;p&gt;“什么事？”&lt;/p&gt;
&lt;p&gt;“这条鱼在我耳朵里干了什么？”&lt;/p&gt;
&lt;p&gt;“它替你翻译啊。这是一条巴别鱼。你可以去查指南，要是你愿意的话。”&lt;/p&gt;
&lt;p&gt;说着他就把《银河系漫游指南》扔给阿瑟，然后把身体蜷缩成像胎儿一样，为跃迁做准备。&lt;/p&gt;
&lt;p&gt;就在这时，阿瑟的心里开始翻江倒海起来。&lt;/p&gt;
&lt;p&gt;他的眼睛鼓了出来，脚开始一个劲儿往头上顶。&lt;/p&gt;
&lt;p&gt;整个房间在他四周折叠起来，旋转着，宇宙中仿佛只剩下他一个人在滑行。&lt;/p&gt;
&lt;p&gt;他们正在通过超空间。&lt;/p&gt;
&lt;p&gt;“巴别鱼，”《银河系漫游指南》轻轻朗读着，“体型很小，黄色，外形像水蛭，很可能是宇宙中最奇异的事物。它靠接收脑电波的能量为生，并且不是从其携带者身上接收，而是从周围的人身上。它从这些脑电波能量中吸收所有未被人察觉的精神频率，转化成营养。然后它向携带者的思想中排泄一种由被察觉到的精神频率和大脑语言中枢提供的神经信号混合而成的心灵感应矩阵。所有这些过程的实际效果就是，如果你把一条巴别鱼塞进耳朵，你就能立刻理解以任何形式的语言对你说的任何事情。你所听到的解码信号就是巴别鱼向你的思想提供的脑电波矩阵。&lt;/p&gt;
&lt;p&gt;“这一似乎是不可能的奇异巧合已经被某些思想者作为上帝并不存在的最终和确定的证据：”关于这件事的辩论是这样的：“我拒绝证明我存在，‘上帝说，’因为证据就意味着否定了信仰，而否定了信仰我什么也不是。‘”’可是，‘凡人说，’巴别鱼泄露了秘密，不是吗？它不可能是偶然进化而来的。它恰恰证明了你的存在。因此，按照你自己的逻辑，你并不存在，证明完毕。‘“’噢，天啊，‘上帝说，’我可没想到这一点，‘然后就在一阵逻辑的烟雾中消失了。&lt;/p&gt;
&lt;p&gt;“‘噢，这很简单，’凡人说，于是又开始证明黑就是白，最后在下一个人行横道被撞死了。&lt;/p&gt;
&lt;p&gt;“大多数最高级的神学家都宣称这样的证明根本不值一哂，但这并不妨碍奥龙。卡路菲把它用作自己的畅销书《关于上帝的隐情》的主题，从而小赚了一笔。&lt;/p&gt;
&lt;p&gt;“同时，可怜的巴别鱼，虽然卓有成效地清除了不同种族和文化之间交流的障碍，但却比造物的历史上任何其他事物引发了更多更血腥的战争，”&lt;/p&gt;
&lt;p&gt;阿瑟发出一声低低的叹息。他对于通过超空间的冲击还心有余悸。现在，他已经身在地球曾经存在过的地方6光年以外了。&lt;/p&gt;
&lt;p&gt;是啊，地球。&lt;/p&gt;
&lt;p&gt;地球的景象在他脑海中快速闪过，他感到一阵令人恶心的眩晕。他的想像无法面对地球毁灭这一事实的冲击，毕竟这太震撼了。他希望通过想起他的父母和妹妹已经死去来刺痛自己的神经，但没有反应。他又回想曾经亲近的所有人，还是没有反应。接着他想起了—个完全陌生的人，两天前他在超市时曾经排在此人后面，这使他突然感觉到了一阵刺痛——超市没有了，里面的所有人都消失了。尼尔森的专栏没有了！尼尔森的专栏没有了，大声疾呼和公开抗议也就没有了，因为没有人再这样做了。从现在起，尼尔森的专栏只存在于他阿瑟的脑海中。英格兰也只存在于他的脑海中——他的脑海，目前正被囚禁在飞船上这个阴冷潮湿的钢铁空间中。一阵幽闭恐惧症的潮水开始袭向他。&lt;/p&gt;
&lt;p&gt;英格兰不存在了。他得习惯这件事——无论如何他都得习惯这件事。他又试了一次。美国，他想，同样也不存在了。但他一下子还是不能理解这件事。于是他决定从再小一点儿的开始。纽约不存在了。还是没有反应。毕竟他从来就没有真心相信过这座城市的存在。美元，他又想，已经永久性地贬值了。这一次总算有点儿震颤了。所有汉弗莱。鲍加的电影都被毁灭了，他对自己说。这又给了他一股不愉快的冲击。麦当劳，他想。再没有什么东西和麦当劳的汉堡一样了。&lt;/p&gt;
&lt;p&gt;他一下子昏了过去。几秒钟后醒过来时，他发现自己正在为母亲而啜泣。&lt;/p&gt;
&lt;p&gt;他猛地跳起来。&lt;/p&gt;
&lt;p&gt;“福特！”&lt;/p&gt;
&lt;p&gt;福特抬起头，他正坐在一个角落里自己哼哼着什么。他一直觉得空间旅行过程中实际穿越空间那部分非常难受，让人相当疲惫。&lt;/p&gt;
&lt;p&gt;“什么事？”他问。&lt;/p&gt;
&lt;p&gt;“如果你是这本书所收录内容的研究者，又在地球上，那你肯定为它收集过地球的资料吧。”&lt;/p&gt;
&lt;p&gt;“噢，是的，我确实能帮着对原始条目作一点扩充。”&lt;/p&gt;
&lt;p&gt;“让我看看关于地球这上面都说了些什么，我一定得看看。”&lt;/p&gt;
&lt;p&gt;“好吧，随便你。”这一次福特又同意了。&lt;/p&gt;
&lt;p&gt;阿瑟捧着书，努力想让自己的手不要颤抖。他按下相应页码的条目。屏幕开始闪烁，出现旋涡状的图案，最后显示出一个打印页。阿瑟盯着看了半天。&lt;/p&gt;
&lt;p&gt;“这个条目是空的啊！”他大叫一声。&lt;/p&gt;
&lt;p&gt;福特从他肩膀上看过来。&lt;/p&gt;
&lt;p&gt;“不可能，有内容的，”他说，“往下看，看屏幕的底部，就在‘奇异Gallumbits’的上边，就是那些长着三个乳房的妓女。”&lt;/p&gt;
&lt;p&gt;阿瑟顺着福特的指头看过去，找准了位置。一时间他还是没有反应过来，然后才突然爆发了。&lt;/p&gt;
&lt;p&gt;“什么！‘无害’？这就是它的全部内容吗？‘无害’！就这么一个词！”&lt;/p&gt;
&lt;p&gt;福特耸了耸肩。&lt;/p&gt;
&lt;p&gt;“噢，是这样的，银河系里有几千亿颗星球，而这本书的微处理器容量有限，”他说，“所以当然不可能讲多少地球了。”&lt;/p&gt;
&lt;p&gt;“好吧，可看在上帝的份上，你就不能稍稍调整一丁点儿吗？”&lt;/p&gt;
&lt;p&gt;“哦，是的，我当然调整了。我给编辑传送了一个新的条目。他可能会删改一点儿，但这已经是一种改进了。”&lt;/p&gt;
&lt;p&gt;“那么现在最新的解释是什么呢？”阿瑟问道。&lt;/p&gt;
&lt;p&gt;“‘基本上无害’。”福特尴尬地轻咳了一声，然后说道。&lt;/p&gt;
&lt;p&gt;“‘基本上无害’！”阿瑟叫起来。&lt;/p&gt;
&lt;p&gt;“哪来的噪音？”福特嘘了一声。&lt;/p&gt;
&lt;p&gt;“是我在叫。”阿瑟继续叫道。&lt;/p&gt;
&lt;p&gt;“不是！闭嘴！”福特说，“我想我们有麻烦了。”&lt;/p&gt;
&lt;p&gt;“你想我们有麻烦了！”&lt;/p&gt;
&lt;p&gt;门外传来清晰的脚步声。&lt;/p&gt;
&lt;p&gt;“是丹特拉斯人吗？”阿瑟小声问。&lt;/p&gt;
&lt;p&gt;“不是，是钉了铁掌的靴子。”福特说。&lt;/p&gt;
&lt;p&gt;门被猛敲了一下。&lt;/p&gt;
&lt;p&gt;“是谁呢？”阿瑟问。&lt;/p&gt;
&lt;p&gt;“噢，”福特说，“如果我们运气好的话，这只是沃贡人来把我们抓了扔到太空里去。”&lt;/p&gt;
&lt;p&gt;“那要是运气不好呢？”&lt;/p&gt;
&lt;p&gt;“要是运气不好，”福特冷酷地说，“舰长会兑现他的威胁，先读几句他的诗给我们听……” &lt;/p&gt;
&lt;p&gt;=== 第七章 ===&lt;/p&gt;
&lt;p&gt;毫无疑问，沃贡诗歌是宇宙中第三糟糕的诗歌。第二糟糕的是克瑞尔星的阿兹歌德人的诗歌。在他们的诗歌大师、自负的格朗索斯朗诵他的诗作《关于一个盛夏清晨我在自己腋窝里找到一小团绿色油灰的颂诗》的过程中，四名听众死于内出血，其中银河系艺术诈骗委员会的主席在啃掉了自己的一条腿后才得以幸存。据报道，格朗索斯对这首诗的接受情况感到“失望”，于是正在着手准备朗诵他的12卷史诗《我最爱的洗澡时的汩汩水声》。&lt;/p&gt;
&lt;p&gt;最糟糕的诗歌则随着它的创造者，英格兰埃塞克斯郡绿桥的珀拉。南茜。弥尔斯顿。詹宁斯，在那颗叫做地球的行星毁灭时一起消亡了。&lt;/p&gt;
&lt;p&gt;沃贡·杰尔兹慢慢地挤出一个笑容，不过不算太标准，因为他需要努力去回忆脸部肌肉运动的顺序。他已经冲着他的囚犯治疗性地大喊了一通，现在感觉非常放松，准备好了展示一下自己的冷酷无情。&lt;/p&gt;
&lt;p&gt;两个囚犯坐在诗歌欣赏专座上——被皮带绑着。考虑到他们的工作通常都受到严格约束，所以沃贡人基本上没有幻想可言。他们写作的最初尝试是属于某种自我强迫症的一部分——他们必须被接纳为一个充分进化、有文化的种族，但到了现在，维持写作的惟一动力仅仅只是他们嗜血的残忍心理。&lt;/p&gt;
&lt;p&gt;冷汗沾在福特·普里弗克特的眉毛上，顺着绑在他太阳穴上的电极打转。这些电极直接连着一大堆电子设备——意象强化器、节奏调节器、音韵选择器以及比喻倾泻器，所有这些都是设计用来增强对诗歌的体验的，以确保不会遗漏诗歌的任何一点儿细微思想。&lt;/p&gt;
&lt;p&gt;阿瑟。登特坐着，不停地颤抖。他丝毫不知道接下来会发生什么，但他知道迄今为止所发生的一切都是他不喜欢的，并且事情似乎没有任何改善的迹象。&lt;/p&gt;
&lt;p&gt;沃贡人开始朗诵了——他自己创作的一段臭不可言的诗歌。&lt;/p&gt;
&lt;p&gt;“哦，流着口水你贴上我的脸……”他开始了。一阵痉挛袭击了福特的身体——这诗比他已经做好思想准备的还要恶心。&lt;/p&gt;
&lt;p&gt;“……你对着我撒尿——就像一只病恹恹蜜蜂发狂似的叫。”&lt;/p&gt;
&lt;p&gt;“啊、啊、啊！……”福特·普里弗克特痛苦地呻吟着，拼命向后扭着脖子。他模模糊糊看到身旁的阿瑟慢慢在座位上蜷成了一团。他咬紧了牙关。&lt;/p&gt;
&lt;p&gt;“我哀求你，”毫无怜悯之心的沃贡人继续念道，“我长着鼻毛的爱人。”&lt;/p&gt;
&lt;p&gt;他的音调提高到了几乎快刺穿耳膜的程度，“用黏稠的液体沐浴我，或者我将会撕裂你，你看我会不会！”&lt;/p&gt;
&lt;p&gt;“不、不、不！……”福特·普里弗克特惨叫起来，在全诗的最后一行经过加强通过他的太阳穴时，他爆发了最后一次痉挛，然后整个人瘫软下去。&lt;/p&gt;
&lt;p&gt;阿瑟继续蜷缩着。&lt;/p&gt;
&lt;p&gt;“现在，地球小子……”沃贡人呼哧呼哧地说（他还不知道福特·普里弗克特实际上来自参宿四附近的一颗小行星，不过就算知道了他也丝毫不会在意），“我给你们提供一个简单的选择机会！或者死在外太空的真空中，或者……”他顿了一下，“告诉我你们多么喜欢我的诗！”&lt;/p&gt;
&lt;p&gt;说完，他向后倒进一张巨大的皮质座椅里，望着他们。他又挤出了一个笑容。&lt;/p&gt;
&lt;p&gt;福特大口地喘着粗气。他用舌头舔着火辣辣的嘴，呻吟着。&lt;/p&gt;
&lt;p&gt;阿瑟洪亮地说：“实际上，我确实很喜欢你的诗。”&lt;/p&gt;
&lt;p&gt;福特转过脸来，目瞪口呆地对着阿瑟。&lt;/p&gt;
&lt;p&gt;沃贡人扬起眉毛，这有效地削弱了他的大鼻子，因此还真不是件坏事。&lt;/p&gt;
&lt;p&gt;“喔，很好……”他说，一副相当惊讶的表情。&lt;/p&gt;
&lt;p&gt;“哦，是真的，”阿瑟继续道，“我认为其中的一些隐喻意象相当有效。”。&lt;/p&gt;
&lt;p&gt;福特继续盯着他，慢慢地开始围绕这一全新立场重组自己的思维。他们真的能借助这一立场逃脱厄运吗？&lt;/p&gt;
&lt;p&gt;“是的，继续……”沃贡人要求道。&lt;/p&gt;
&lt;p&gt;“哦……嗯……韵律也很有趣，”阿瑟说，“感觉是对应上了……嗯……嗯……”他语塞了。&lt;/p&gt;
&lt;p&gt;这时多亏福特站出来打圆场，他鼓足勇气说：“……对应上了隐喻的超现实主义原则，关于……嗯……”他也接不下去了，不过这时阿瑟已经又准备好了。&lt;/p&gt;
&lt;p&gt;“……人性……”&lt;/p&gt;
&lt;p&gt;“沃贡特质。”福特抢过话题。&lt;/p&gt;
&lt;p&gt;“噢，对，沃贡特质——对不起——诗人那富于同情心的灵魂——”阿瑟意识到现在正是最关键的时刻，“通过诗歌的结构获得升华，超越了一切术语，”他即将到达胜利的终点，“通过深刻而鲜活的洞察力直透……直透……嗯……”他的灵感突然用尽了。好在福特接了上来，最终完成了致胜的一击：“直透诗歌之所以成为诗歌的本质！”他几乎大声嚷道。嘴角边轻声一句嘀咕：“干得漂亮，阿瑟，棒极了。”&lt;/p&gt;
&lt;p&gt;沃贡人仔仔细细打量了他们一番。他的内心一度被触动了，但是他立刻便否定了自己——毕竟这触动太轻微也太迟了。他的声音听上去像是一只猫在挠尼龙布。&lt;/p&gt;
&lt;p&gt;“所以，照你们看来，我写诗是因为在我看似冷酷无情的外表下还是渴望着被爱。”他说。他顿了一下，“是这样吗？”&lt;/p&gt;
&lt;p&gt;福特紧张地笑了笑。“噢，我想，是的。”他说。&lt;/p&gt;
&lt;p&gt;沃贡人站起身来。&lt;/p&gt;
&lt;p&gt;“不，你们完全错了。”他说，“我写诗只是为了给冷酷无情的外表寻找一种平衡。所以，我还是要把你们扔出飞船。卫兵！把这两个囚犯带到3号气闸，扔出飞船！”&lt;/p&gt;
&lt;p&gt;“什么！”福特叫起来。&lt;/p&gt;
&lt;p&gt;一个体型庞大的年轻沃贡卫兵走上前来，用他肥厚多肉的胳膊一把将他们从座位上拎起来。&lt;/p&gt;
&lt;p&gt;“你不能这么做，”福特叫道，“我们正在准备写一本书。”&lt;/p&gt;
&lt;p&gt;“顽抗是没有用的！”沃贡卫兵从背后对他吼了一句。这是他加入沃贡卫兵队后学会的第一句话。&lt;/p&gt;
&lt;p&gt;舰长抱着一种超然的愉快心态看着这些，然后转过身去。&lt;/p&gt;
&lt;p&gt;阿瑟疯狂地盯着他的背影。&lt;/p&gt;
&lt;p&gt;“我可不想现在就死！”他嚷开了。“我还在头痛呢！我可不想带着头痛进天堂，我讨厌这样！”&lt;/p&gt;
&lt;p&gt;卫兵牢牢地抓住他们的脖子，恭敬地朝他的舰长的背影鞠了一躬，然后押着他们出了控制桥。随着一扇金属门的关闭，沃贡舰长又是—个人独处了。他轻声哼哼着，陷入了沉思，不时顺手在笔记本上写下—些诗句。&lt;/p&gt;
&lt;p&gt;“嗯，”他自言自语道，“‘对应上了隐喻的超现实主义原则’……”他把这句话想了一会儿，然后合上本子，冷酷地笑了笑。&lt;/p&gt;
&lt;p&gt;“死似乎太便宜他们了。”他说。&lt;/p&gt;
&lt;p&gt;长长的金属通道内回荡着两个人在沃贡卫兵铁钳般的手中虚弱无力的挣扎声。&lt;/p&gt;
&lt;p&gt;“这太好了，”阿瑟语无伦次地叫着，“真太他妈绝了。放开我，你这个畜生！”&lt;/p&gt;
&lt;p&gt;沃贡卫兵继续拎着他们前进。&lt;/p&gt;
&lt;p&gt;“别担心，”福特说，“我会想到法子的。”但这话听上去却不那么充满希望。&lt;/p&gt;
&lt;p&gt;“顽抗是没有用的！”卫兵又吼了一‘声。&lt;/p&gt;
&lt;p&gt;“别说这些自暴自弃的话，”福特结结巴巴地说，“一个人要是总在说这些，还怎么可能保持积极向卜的精神面貌呢？”&lt;/p&gt;
&lt;p&gt;“上帝啁，”阿瑟抱怨道，“居然还说什么积极向上的精神面貌，你的星球又没有今天刚刚被毁火。我今天早上爬起来，想着自己可以度过轻松愉快的—天，读读书，给狗洗洗澡……现在才刚过下午4点，可我却在这个离地球毁灭后留下的青烟6光年之外的鬼地方等着被扔出一艘外星飞船！”他噼噼啪啪冒出这一大堆话，沃贡卫兵把他抓得更紧了。&lt;/p&gt;
&lt;p&gt;“好了，”福特说，“不要这么惊惶失措！”&lt;/p&gt;
&lt;p&gt;“谁惊惶失措了？”阿瑟猛地说，“这仍然只是文化休克而已。你得等着，我在这样的环境中摸清楚方向了，然后我才会开始惊惶失措！”&lt;/p&gt;
&lt;p&gt;“阿瑟，你开始歇斯底里了。闭上嘴！”福特拼命地试图镇定下来好好想想，但马上又被卫兵的吼声打断了。&lt;/p&gt;
&lt;p&gt;“顽抗是没有用的！”&lt;/p&gt;
&lt;p&gt;“你也一样给我闭上你的鸟嘴！”福特冲他喊道。&lt;/p&gt;
&lt;p&gt;“顽抗是没有用的！”&lt;/p&gt;
&lt;p&gt;“噢，天哪，你就不能歇歇吗。”福特说。他扭转头，直到能正视抓着他的这个人的脸。突然间一个念头蹦了出来。&lt;/p&gt;
&lt;p&gt;“你真的喜欢干这样的事吗？”他突然问。&lt;/p&gt;
&lt;p&gt;沃贡卫兵停下来，死死地站住，一种极度痴呆的表情慢慢从他脸上浮现出来。&lt;/p&gt;
&lt;p&gt;“喜欢？”他瓮声瓮气地说，“你是什么意思？”&lt;/p&gt;
&lt;p&gt;“我的意思是，”福特说，“这些事能够给予你一种完整、满足的生活吗？来回踏步、吼叫、把人推出飞船……”&lt;/p&gt;
&lt;p&gt;卫兵抬头盯着低低的金属天花板，眉头拧成一团。渐渐地，他的嘴角松弛下来。最后他说：“是啊，那些时光多好啊……”&lt;/p&gt;
&lt;p&gt;“一定是的。”福特附和道。&lt;/p&gt;
&lt;p&gt;阿瑟扭过头看着福特。&lt;/p&gt;
&lt;p&gt;“福特，你在干什么？”他好奇地耳语道。&lt;/p&gt;
&lt;p&gt;“哦，你只需要试试，就能在我周围发现一点儿乐趣。行吗？”福特说，“瞧，时光变得多么美好，不是吗？”他继续道。&lt;/p&gt;
&lt;p&gt;卫兵低下头望着他，一些迟钝的念头开始在他昏暗的内心深处涌动。&lt;/p&gt;
&lt;p&gt;“是的，”他说，“你已经提到了，现实中的大部分时候真是相当龌龊。除了……”他又陷入了思考，这时他必须得抬头盯着天花板，“除了一些我很喜欢的吼叫。”他吸了一口气，吼道，“顽抗是……”&lt;/p&gt;
&lt;p&gt;“当然，是的，”福特赶忙打断他，“你很擅长这个，我敢保证。但是，如果这是最龌龊的事，”他说，语速很慢，以使每个字都有足够时间达到最佳效果，“那么你为什么还要做呢？图什么呢？女人？皮革？男子汉气概？或者仅仅只是因为这种无聊事儿对你来说是一种挺有意思的挑战？”&lt;/p&gt;
&lt;p&gt;阿瑟来回看着他俩，一脸迷惑。&lt;/p&gt;
&lt;p&gt;“嗯……”卫兵说，“嗯……嗯……我也不知道。我想我只是……简单地去做。婶婶告诉我在飞船上当卫兵对—个年轻沃贡来说是份好差事——你知道的，制服、眩晕射线枪套、不用动脑筋……”&lt;/p&gt;
&lt;p&gt;“你瞧，阿瑟，”福特以一种做总结的语气说，“你居然还认为你遇到麻烦了。”&lt;/p&gt;
&lt;p&gt;阿瑟确实认为白己遇到麻烦了。除了白己的星球被毁灭外，这个沃贡卫兵已经快把他掐得窒息了，而且他极其不喜欢被扔到太空中去的那种声音。&lt;/p&gt;
&lt;p&gt;“但你不妨试着去感受、理解一下他的苦恼。”福特继续说道，“他就在这儿，可怜的家伙，他的全部生活内容就是来回踏步、把人扔出飞船……”&lt;/p&gt;
&lt;p&gt;“还有吼叫。”卫兵补充道。&lt;/p&gt;
&lt;p&gt;“还有吼叫，当然，”福特说着，友善地拍了拍掐在自己脖子上的那只肥厚多肉的胳膊，“可是他居然还不知道自己为什么要这么做！”&lt;/p&gt;
&lt;p&gt;阿瑟同意这是一件非常可悲的事。他用一个小小的动作表达了自己的态度，因为他已经窒息得无法开腔了。&lt;/p&gt;
&lt;p&gt;卫兵彻底迷糊了，发出瓮声瓮气的呆滞的声音。&lt;/p&gt;
&lt;p&gt;“好吧。现在我想改变一下……”&lt;/p&gt;
&lt;p&gt;“真是好伙计！”福特鼓励他说。&lt;/p&gt;
&lt;p&gt;“但是，”卫兵继续呆滞地说，“另外的选择又是什么呢？”&lt;/p&gt;
&lt;p&gt;“好的，”福特兴奋地缓缓说道，“当然是停止做这些事！去告诉他们，”他继续道，“你再也不会做这些事了。”他觉得自己还应该补充一句什么，但这时卫兵似乎已经因为要思考这么多的事情，脑子简直不够用了。&lt;/p&gt;
&lt;p&gt;“嗯嗯嗯……”卫兵说，“嗯，听上去对我来说好像不是太好。”&lt;/p&gt;
&lt;p&gt;福特猛然意识到机会正在溜走。&lt;/p&gt;
&lt;p&gt;“等一下，”他说，“这只是开始，你瞧，除此之外还有很多可以做的，你瞧……”&lt;/p&gt;
&lt;p&gt;但是此刻卫兵已经恢复了神志，他重新抓紧了手里的两个人，按照原定的指示把他们押向气闸。不过他显然还是受到了相当大的震动。&lt;/p&gt;
&lt;p&gt;“不，我想你们的结局还是一样的。”他说，“我最好还是把你们俩都塞进气闸，然后回去继续我应该做的吼叫工作。”&lt;/p&gt;
&lt;p&gt;福特·普里弗克特又回到了原点。&lt;/p&gt;
&lt;p&gt;“那好吧……不过你应该再想想看！”他说得更慢了，也不再兴奋。&lt;/p&gt;
&lt;p&gt;“哼哼哼……”阿瑟含混不清地说了一串词语。&lt;/p&gt;
&lt;p&gt;“你应该坚持下去，”福特继续道，“音乐、艺术，还有其他许多事情都是可以做的！噢，真的！”&lt;/p&gt;
&lt;p&gt;“顽抗是没有用的！”卫兵又吼道，这次还补充了—句，“你瞧，如果我坚持下去，最终还能被提拔为高级吼叫军官，而我们这儿通常并没有不用吼叫、不用把人推出飞船的军官职位空缺，所以我想我最好还是按照原定的指示去做。”&lt;/p&gt;
&lt;p&gt;说话间他们已经来到了气闸——一个飞船内壁上的巨大的圆形金属舱口。卫兵操纵开关，舱门平稳地滑开厂。&lt;/p&gt;
&lt;p&gt;“不过我还是想要感谢你有趣的谈话。”沃贡卫兵说，“现在，再见了。”说着他把福特和阿瑟从舱口扔进里面的小房间里。终于摆脱了窒息，阿瑟躺在地卜直喘粗气。福特则四处乱爬，无助地用肩膀撞击正在重新关上的舱门。&lt;/p&gt;
&lt;p&gt;“你听着，”他冲卫兵喊道，“还有一个你完全不了解的世界……你觉得呢？”绝望中，他抓住了自己惟一能随时用上的一点儿文化修养——他开始哼贝多芬第五交响乐的第—小节。&lt;/p&gt;
&lt;p&gt;“砰一砰一砰——磅！难道这曲调没激发你什么感受吗？”&lt;/p&gt;
&lt;p&gt;“没有，”卫兵说，“确实没有。不过我会向婶婶提到的。”&lt;/p&gt;
&lt;p&gt;就算此后他还说了些什么，那也根本听不见，因为舱门已经紧紧地关上了。所有声音都消失了，只听见远远地传来飞船引擎的嗡嗡声。&lt;/p&gt;
&lt;p&gt;他们现在身处一个打磨得很光亮的圆柱形小房间里，直径大概6英尺，长10英尺。&lt;/p&gt;
&lt;p&gt;福特喘着粗气，开始四下打量这个房间。&lt;/p&gt;
&lt;p&gt;“没想到是个大智若愚的家伙。”他咕哝了一句，然后瘫软地靠在弧形墙壁上。&lt;/p&gt;
&lt;p&gt;阿瑟仍然躺在被扔进来时那块弧形地板上，连头都没抬一下，只是喘着粗气。&lt;/p&gt;
&lt;p&gt;“我们被困住了，是吗？”&lt;/p&gt;
&lt;p&gt;“是的，”福特说，“我们被困住了。”&lt;/p&gt;
&lt;p&gt;“那好吧，你想到什么法子了吗？我记得你好像说过你会想到的。当然，也许你已经想到了些什么，只不过我没有注意而已。”&lt;/p&gt;
&lt;p&gt;“哦，是的，我确实想到了一个主意。”福特喘息着说。&lt;/p&gt;
&lt;p&gt;阿瑟顿时满脸期待地抬起头。&lt;/p&gt;
&lt;p&gt;“但不幸的是，”福特继续道，“这个主意和密闭舱门另一侧的那个家伙有关。”说着他踢了舱门一脚。&lt;/p&gt;
&lt;p&gt;“但那确实是个好主意，是吗？”&lt;/p&gt;
&lt;p&gt;“哦，当然，相当巧妙。”&lt;/p&gt;
&lt;p&gt;“是什么呢？”&lt;/p&gt;
&lt;p&gt;“嗯，我还没有把细节想清楚。我们剩下的时间不多了吧，是吗？”&lt;/p&gt;
&lt;p&gt;“那么……嗯，接下来会发生什么事呢？”阿瑟问。&lt;/p&gt;
&lt;p&gt;“哦，嗯，奸吧，我们面前的舱门很快会自动打开，我们会被弹射进深邃的外太空，然后渐渐窒息。如果事先深深吸入一口气，那么你最多可以坚持30秒钟，当然……”福特说。他把双手背在背后，皱起眉头，开始哼一首古老的参宿四的战斗赞美诗。在阿瑟看来，他突然间变得很陌生。&lt;/p&gt;
&lt;p&gt;“看来事情是这样的，”阿瑟说，“我们快死了。”&lt;/p&gt;
&lt;p&gt;“足的，”福特说，“除非……不！等等！”他突然穿过房间朝着阿瑟背后的某个东两冲过去，“这是什么的开关？”他叫道。&lt;/p&gt;
&lt;p&gt;“什么？在哪儿？”阿瑟也跟着叫起来，迅速转过身。&lt;/p&gt;
&lt;p&gt;“没什么，我只是开个玩笑而已，”福特说，“无论如何我们都得死。”&lt;/p&gt;
&lt;p&gt;他又瘫软地靠在墙上，从刚才断掉的地方接着哼起来。&lt;/p&gt;
&lt;p&gt;“你知道吗，”阿瑟说，“在这样的时刻，当我被困在沃贡人的气闸里，和一个从参宿四来的人在—起，即将被扔进外太空窒息而死时，我真希望自己年轻时听我母亲的话。”&lt;/p&gt;
&lt;p&gt;“为什么，她告诉了你些什么？”&lt;/p&gt;
&lt;p&gt;“我不知道，我不是没有听嘛。”‘“哦。”福特继续哼哼。&lt;/p&gt;
&lt;p&gt;“真是太可怕了，”阿瑟自言自语地说，“尼尔森的专栏没有了，麦当劳没有了，剩下的只有我，以及这个词条，‘基本上无害’。再过几秒钟，惟一剩下的就只有‘基本上无害’了。而仅仅就在昨天，这颗星球看上去还一切正常。”&lt;/p&gt;
&lt;p&gt;这时，传来了—阵机械的声音。&lt;/p&gt;
&lt;p&gt;随着气流涌动渐渐由微弱的嘶嘶声变为震耳欲聋的轰鸣，外壁舱门打开了，显出一片空虚的黑暗，点缀着一些遥远的微小亮点。福特和阿瑟就像从玩具枪里射出的软木塞一样被抛入外太空。 &lt;/p&gt;
&lt;p&gt;=== 第八章 ===&lt;/p&gt;
&lt;p&gt;《银河系漫游指南》是一本绝对非凡的书。它编辑和重新编辑了许多次，历经许多年，经过许多不同的编辑者。它包含了无数漫游者和研究者的心血。&lt;/p&gt;
&lt;p&gt;书的前言是这样开头的：“太空，”它写道，“广袤无垠。确确实实广袤无垠。你简直不会相信它大得多么惊心动魄。我是说，你也许认为成为一个炼金术士的路途是遥远的，但跟太空相比只是沧海—粟。听着……”诸如此类的话。&lt;/p&gt;
&lt;p&gt;（开篇不久全书的风格就定下来了，开始告诉你你确实需要知道的东西。比如说，像神话一样美丽的星球贝丝拉敏目前忧心忡忡由于每年上百亿的游客所造成的逐渐积累的侵蚀，其担忧达到了这种程度，以至于规定在星球期间你摄入的量和排泄的量之间的净差距必须在离开星球时通过手术从你的体重中取掉：所以每次上厕所时千万千万不能忘了要开张收据。）&lt;/p&gt;
&lt;p&gt;为了便于理解，当处理星球之间的巨大里程时，书中会采取一些比前言中更有效的办法。有时它会请你设想—下这样的情形：—颗花生在英格兰的甲丁市，一颗小核桃在约翰内斯堡，还有其他像这样令人眼花缭乱的概念。&lt;/p&gt;
&lt;p&gt;一个简单的事实是，星际间的距离远远超出了人类的想像。&lt;/p&gt;
&lt;p&gt;即便是光——它运动得如此之快，大部分种族整整用了好几千年才认识到它的运动——在星际间运行时也要花费不少时间。从人阳到曾经是地球的那片空间，光要走8分钟，而要走4年才能到达距离太阳最近的恒星，半人马座的比邻星。&lt;/p&gt;
&lt;p&gt;光如果要到达银河系的另一端，比如说到达达蒙葛兰，则需要更长的时间：整整50万年。&lt;/p&gt;
&lt;p&gt;搭便车通过这段距离的最快记录是5年，不过以这么快的速度旅行，你在路上是看不见多少东西的。&lt;/p&gt;
&lt;p&gt;《银河系漫游指南》上说，如果你吸入满满一肺的空气，那么你能在绝对真空的太空里存活大约30秒。然而，它没有继续说，在如此广袤无垠的太空中，你在这30秒内被另一艘飞船救起的概率是2的276，709次方比1.一个令人难以置信的巧合是，276，709恰恰是伊思林顿一座公寓的电话号码，阿瑟曾经在那儿参加过一场非常精彩的派对。他在派对上遇到了一个很不错的姑娘，但他却没能和这个姑娘多亲热——她被一个闯派对者抢跑了。&lt;/p&gt;
&lt;p&gt;虽然地球、伊思林顿的这座公寓，以及这个电话号码现在统统灰飞烟灭了，但令人鼓舞的是，它们全都通过下述事实得到了一丝微薄的纪念——29秒之后，福特和阿瑟获救了。 &lt;/p&gt;
&lt;p&gt;=== 第九章 ===&lt;/p&gt;
&lt;p&gt;当发现了一个气闸没有任何原因地打开又自动关上后，—台电脑开始不停地自动报警。&lt;/p&gt;
&lt;p&gt;实际上，找不到原因，原因大概出去吃午饭了。&lt;/p&gt;
&lt;p&gt;一个洞出现在银河系里。确切地说，它仅仅只存在了一秒钟，仅仅只有一英寸宽，但洞两头之间的距离却有好几百万光年。&lt;/p&gt;
&lt;p&gt;当它关闭时，许多纸帽子和派对气球从里面掉出来，慢慢地飘过整个宇宙。还有一队7个3英尺高的市场分析家掉出来，已经死了，部分是由于窒息，部分则是由于惊讶。&lt;/p&gt;
&lt;p&gt;239，000个煎得很嫩的鸡蛋也掉了出来，组成摇摆不定的一大堆，落在正饱受饥荒折磨的潘塞尔星系的普格瑞尔大陆上。&lt;/p&gt;
&lt;p&gt;整个普格瑞尔大陆的部落已经全部死于饥荒，只有最后幸存的一个人，而这个人几周后也死于胆固醇中毒。&lt;/p&gt;
&lt;p&gt;这个洞只存在了短短的一秒钟，但却以一种几乎不可能的方式在此前此后的时间中产生了影响。在遥远的过去的某个点上，它影响了一组随机排列飘过虚无太空的原子，使它们按照一些相当特殊的方式组合起来。这些组合方式很快就学会了自我复制（这正是这些组合方式的部分特殊之处），并且继续发展，给它们经过的所有星球都带米了巨大的麻烦。这就是宇宙中生命的起源。&lt;/p&gt;
&lt;p&gt;五场猛烈的相对涡流翻卷喷流，变出一条人行道。&lt;/p&gt;
&lt;p&gt;福特·普里弗克特和阿瑟。登特躺在人行道上，大口喘着气，像是半死的鱼。&lt;/p&gt;
&lt;p&gt;“这不成了吗？”福特气喘吁吁地说，—边在人行道上胡乱摸索着，想寻找一个舒服的支撑点，“我告诉过你我会想到法子的。”&lt;/p&gt;
&lt;p&gt;“哦，当然，”阿瑟说，“当然。”&lt;/p&gt;
&lt;p&gt;“我的如意算盘就是，”福特说，“找一艘路过的飞船，让它把我们救起来。”&lt;/p&gt;
&lt;p&gt;真实的宇宙令人恐惧地消失了。各式各样的幻象悄然闪过，像山羊一样敏捷。原初的光亮一阵阵爆发，像给空间贴上了一片片果冻。时间膨胀，物质收缩。最大的质数安静地躲进角落，永久地隐藏起来。&lt;/p&gt;
&lt;p&gt;“噢，算了吧，你别吹牛了，”阿瑟说，“发生这种事的概率微乎其微。”&lt;/p&gt;
&lt;p&gt;“别争了，反正成了。”福特说。&lt;/p&gt;
&lt;p&gt;“我们这是在一艘什么飞船上？”阿瑟问道。&lt;/p&gt;
&lt;p&gt;“我不知道，”福特说，“我还没有睁开眼睛呢。”&lt;/p&gt;
&lt;p&gt;“我也没有。”阿瑟说。&lt;/p&gt;
&lt;p&gt;宇宙跳跃、凝结、颤抖，朝意想不到的方向扩张。&lt;/p&gt;
&lt;p&gt;阿瑟和福特睁开眼睛，惊讶无比地环顾四周。&lt;/p&gt;
&lt;p&gt;“上帝啊，”阿瑟说，“看上去像英格兰南角的海岸。”&lt;/p&gt;
&lt;p&gt;“该死的，这么说我可真的松了口气。”福特说。&lt;/p&gt;
&lt;p&gt;“为什么？”&lt;/p&gt;
&lt;p&gt;“因为我想我肯定快疯了。”&lt;/p&gt;
&lt;p&gt;“也许你是的。也许你只是以为我这样说过。”&lt;/p&gt;
&lt;p&gt;福特思考着这个问题。&lt;/p&gt;
&lt;p&gt;“好吧，你这样说过吗？”他问。&lt;/p&gt;
&lt;p&gt;“我想是的。”阿瑟回答说。&lt;/p&gt;
&lt;p&gt;“那么，也许我们俩都快要疯了。”&lt;/p&gt;
&lt;p&gt;“是的。”阿瑟说，“我们会疯掉的，所有这些东西都让人觉得这里就是南角。”&lt;/p&gt;
&lt;p&gt;“好吧，你认为这里是南角吗？”&lt;/p&gt;
&lt;p&gt;“哦，是的。”&lt;/p&gt;
&lt;p&gt;“我也是。”&lt;/p&gt;
&lt;p&gt;“所以说我们肯定已经疯了。”&lt;/p&gt;
&lt;p&gt;“今天天气不错。”&lt;/p&gt;
&lt;p&gt;“是的。”路过的一个疯子说。&lt;/p&gt;
&lt;p&gt;“他是谁？”阿瑟问。&lt;/p&gt;
&lt;p&gt;“谁——这个长着5个脑袋、满嘴喷粪的家伙吗？”&lt;/p&gt;
&lt;p&gt;“是的。”&lt;/p&gt;
&lt;p&gt;“我不知道。只是某个人而已。”&lt;/p&gt;
&lt;p&gt;“哦。”&lt;/p&gt;
&lt;p&gt;他俩坐在人行道上，带着某种不安看着个子很大的小孩子在沙滩上跳跃，望着野马挟着风雷掠过天空。&lt;/p&gt;
&lt;p&gt;“你瞧，”阿瑟轻咳一声，“如果这里是南角的话，有些东西可太怪异了……”&lt;/p&gt;
&lt;p&gt;“你是指这海面一动不动地像块岩石，这些建筑却来来回回晃个不停？”福特说，“是的，事实上我也觉得很奇怪。”他继续道。正在这时，随着一声巨响，绍森德裂成了大小相等的6块，都以一种淫靡而放肆的形式舞动着、旋转着，令人眼花缭乱，“看来，有些东西越来越奇怪了。”&lt;/p&gt;
&lt;p&gt;风中传来铜管和丝弦狂野的嚎叫声，热气腾腾的烤面包圈从路中间蹦出来，才10便士一个，受惊的鱼群出现在天空中。这些景象使阿瑟和福特决定逃跑。&lt;/p&gt;
&lt;p&gt;他们冲过声音的幕墙、古老思想的山峰和背景音乐的峡谷，突然间听到一个女孩儿的声音。&lt;/p&gt;
&lt;p&gt;这声音听上去相当清晰，却只是反复说着同一句话：“2的，00，000次方比1，正在下降。”这就是全部的内容。&lt;/p&gt;
&lt;p&gt;福特停下身来，借着一束光想找出这声音的来源，但却看不到任何他真正能够相信的东西。&lt;/p&gt;
&lt;p&gt;“那是什么声音？”阿瑟叫道。&lt;/p&gt;
&lt;p&gt;“我不知道，”福特喊着说，“我不知道。听上去像是在计算概率。”&lt;/p&gt;
&lt;p&gt;“概率？你是什么意思？”&lt;/p&gt;
&lt;p&gt;“概率。你知道的，就像2比1，3比1，5比4什么的。这声音说2的100，000次方比1.你知道，这种概率也太小了点。”&lt;/p&gt;
&lt;p&gt;一个装着一百万加仑奶油冻的巨桶在他们头上倾倒下来，事先没有任何征兆。&lt;/p&gt;
&lt;p&gt;“这又是什么意思？”阿瑟叫喊着。&lt;/p&gt;
&lt;p&gt;“什么，奶油冻吗？”&lt;/p&gt;
&lt;p&gt;“不，我是说那个不可能的极小概率测算1”&lt;/p&gt;
&lt;p&gt;“我不知道，我什么都不知道。我想我们是在一艘飞船上。”&lt;/p&gt;
&lt;p&gt;“我惟一能推测的就是，”阿瑟说，“这不是头等舱。”&lt;/p&gt;
&lt;p&gt;时空维度开始出现凸起的膨胀。巨大而丑陋的凸起。&lt;/p&gt;
&lt;p&gt;“啊、啊、啊……”阿瑟叫起来，因为他感到自己的身体正在变软，向着一些不正常的方向弯曲，“南角好像正在融化……星星形成了旋涡……像一个尘暴区……我的双脚正在向旋涡中滑去……我的左臂也快进去了。”一个恐怖的念头突然降临，“该死，”他说，“现在我怎么操作我的电子表？”他绝望地把目光转向福特。&lt;/p&gt;
&lt;p&gt;“福特，”他惊呼了一声，“你正在变成一只企鹅。快停下来。”&lt;/p&gt;
&lt;p&gt;这时，那个声音再次传来。&lt;/p&gt;
&lt;p&gt;“2的75，000次方比1，正在下降。”&lt;/p&gt;
&lt;p&gt;“嘿，你是谁？”福特呷呷叫着问，“你在哪儿？这里到底发生了什么，有办法停下来吗？”&lt;/p&gt;
&lt;p&gt;“请放松一点儿，”那声音悦耳地说，像个空中小姐，只不过是在一架只剩一只机翼的双引擎飞机上，另一只机翼正在着火，“你很安全。”&lt;/p&gt;
&lt;p&gt;“这不重要！”福特被激怒了，“重要的是我现在变成了一只很安全的企鹅，而我的同伴很快就会失去他的四肢！”&lt;/p&gt;
&lt;p&gt;“还好，我已经把它们拉回来了。”阿瑟说。&lt;/p&gt;
&lt;p&gt;“2的50，000次方比1，正在下降。”那声音又说。&lt;/p&gt;
&lt;p&gt;“很明显，”阿瑟说，“这串数字长了点儿，我不喜欢，不过……”&lt;/p&gt;
&lt;p&gt;“难道就没有什么，”福特发出愤怒的鸟叫声，“你觉得应该告诉我们的吗？”&lt;/p&gt;
&lt;p&gt;那声音清了一下嗓子。一块巨大的糖霜蛋糕向远处飘荡而去。&lt;/p&gt;
&lt;p&gt;“欢迎，”那声音说，“来到黄金之心号飞船。”&lt;/p&gt;
&lt;p&gt;那声音继续道：“请不要因为你们所见到或者听到的任何东西恐慌。开始时你们可能会有一些不适反应，因为你们刚刚被从死亡线上救起来，在那种情况下存活概率只有2的276，000次方比1——可能还要小得多，我们现在正以2的25，000次方比1的水平巡航，这个比率正在下降。一旦我们确定了什么是正常水平，很快便会恢复到正常水平。谢谢你们。2的20，000次方比1，正在下降。”&lt;/p&gt;
&lt;p&gt;声音戛然而止。&lt;/p&gt;
&lt;p&gt;福特和阿瑟在一间泛着粉红色光的小卧室里。&lt;/p&gt;
&lt;p&gt;福特感到一阵狂喜。&lt;/p&gt;
&lt;p&gt;“阿瑟！”他说，“这太神奇了！我们居然被一艘无限非概率驱动的飞船救了起来！真是不可思议！我以前听说过这样的传闻！但所有传闻都遭到了官方否认，现在他们肯定是完成了！他们实现了非概率驱动！阿瑟，这是……阿瑟？发生什么了？”&lt;/p&gt;
&lt;p&gt;阿瑟正全力顶在卧室的舱门上，试图把它关严，但总是做不到。一大堆细长的小手从门缝中拼命挤进来，手指都沾着墨水；细微的声音在外面疯狂地喋喋不休。&lt;/p&gt;
&lt;p&gt;阿瑟抬起头。&lt;/p&gt;
&lt;p&gt;“福特！”他说，“外面有无数只猴子想要进来和咱们讨论他们创作的剧本《哈姆雷特》。” &lt;/p&gt;
&lt;p&gt;=== 第十章 ===&lt;/p&gt;
&lt;p&gt;无限非概率驱动是一种惊人的新方法，可以在几乎不到一秒钟的时间内穿越星际间广阔的距离，不再需要在超空间中单调乏味地东碰西撞。&lt;/p&gt;
&lt;p&gt;这种方法是在一次幸运的偶然中被发现的，然后由银河政府在达蒙葛兰上的研究小组发展为一项可控动力推进技术。&lt;/p&gt;
&lt;p&gt;下面就是关于这项发现的简短故事。&lt;/p&gt;
&lt;p&gt;产生少量有限非概率的原理当然很好理解，只需要简单地把基于单个超微57型亚介子脑的逻辑电路接在一个挂在强布朗运动发生器（比如说一杯热茶）上的原子矢量绘图器上就行了——这样的装置通常用来打破宴会上的冷清气氛，比如把女主人内衣的所有分子转移掉，同时配合不确定原理，目标指向在场的任何一个其他人。&lt;/p&gt;
&lt;p&gt;许多有名望的物理学家声称他们不能容忍这样的做法，部分是由于这种做法贬低了科学，但更主要的原因却是他们从来没有被邀请参加过这样的宴会。&lt;/p&gt;
&lt;p&gt;他们所不能忍受的另一件事就是，他们制造一台能够产生无限非概率的仪器的尝试一再失败。这样的仪器如果用在飞船上，就能够跨越哪怕是最远的星球之间的距离。最终，他们恼怒地宣称这样的一台仪器根本就是不可能的。&lt;/p&gt;
&lt;p&gt;此后的一天，一个学生留下来打扫实验室，他这样推理：如果，他对自己说，这样的一台仪器事实上是不可能的，那么它就必定是一种有限非概率。因此，如果我要造出一台来的话，所要做的全部事情就是算出它如何不可能的精确数值，把这个数值输入有限非概率发生装置，再来上一杯热茶……然后，打开它！&lt;/p&gt;
&lt;p&gt;他这样做了，于是震惊地发现自己成功地凭空造出了人们苦苦寻求已久的珍贵的无限非概率发生装置。&lt;/p&gt;
&lt;p&gt;更让他震惊的是：当他获得银河学院杰出才智大奖后，竟然被一伙狂怒的暴徒（由著名物理学家们组成）以私刑处死。这些人最终发现，他们最无法容忍的其实是“机灵鬼”。 &lt;/p&gt;
&lt;p&gt;=== 第十一章 ===&lt;/p&gt;
&lt;p&gt;黄金之心号的防非概率控制舱和一般的飞船并没有什么两样，只是这儿特别干净——毕竟是崭新的，一些控制座椅的塑料薄膜甚至还没有撕开。控制舱的基调是白色，长方形，基本上相当于一个小型餐厅的尺寸。实际上，它并不是标准的长方形：长的两面墙微微弯出了一个平行的弧度，舱内所有角度和角落都是圆润的弧形，给人留下深刻印象。关于这一点，真实的原因是：本来建造一个普通的三维长方形房间会简单得多，也实用得多，但那样的话，设计者的腰包是鼓不起来的。这样的一间控制舱显然是经过精心设计的，控制和导航系统仪表面板上方的凹面墙上悬挂着巨大的投影屏幕，而凸面墙上则安装了一长排电脑。一个角落里坐着一个机器人，打磨得锃亮的钢铁脑袋松松垮垮地垂在打磨得锃亮的钢铁膝盖中间。它也是崭新的，不过，虽然经过精心制造和打磨，它那多多少少看上去还算是个人形的躯体却相当地不协调。其实这些部分还是很协调的，只不过某些轴承看上去本来应该安装得更好些才是。&lt;/p&gt;
&lt;p&gt;赞福德·毕博布鲁克斯正在控制舱内神经质地踱来踱去，双手拂过闪烁的仪表，不时发出兴奋的吃吃笑声。&lt;/p&gt;
&lt;p&gt;崔莉恩坐在一堆设备前，正在读出上面的数据。她的声音通过扩音系统回荡在整艘飞船内。&lt;/p&gt;
&lt;p&gt;“5比1，正在下降……”她读道，“4比1，正在下降……3比1……2……1……概率因子1比1……我们已经进入正常状态，重复一遍，我们已经进入正常状态。”她关掉麦克风——又重新打开——带着微笑继续道：“如果还有任何不适的话，那就是你们自己的问题了。放松点儿，你们很快就会没事儿的。”&lt;/p&gt;
&lt;p&gt;赞福德恼怒地问：“他们是谁，崔莉恩？”&lt;/p&gt;
&lt;p&gt;崔莉恩转过椅子，面对着他，耸了耸肩。&lt;/p&gt;
&lt;p&gt;“只是两个普通家伙，我们在外太空中把他们捞了起来，”她说，“就在229复Z阿尔发区域。”&lt;/p&gt;
&lt;p&gt;“喔，好吧，心肠不错，崔莉恩。”赞福德抱怨说，“但在目前的情况下，你认为这样做合适吗？我是说，我们正在逃亡中，身后起码跟了整个银河系一半的警察，我们却停下来搭救两个漫游者，嗯？”&lt;/p&gt;
&lt;p&gt;他暴躁地不停敲着控制面板。每次快碰到重要按钮之前，崔莉恩总是一声不吭地把他的手移开。不管赞福德的心理属于哪一类——冲动、虚张声势、狂妄——他在机械技能上总归是蠢笨不堪的，随时可能用一些莫名其妙的动作轻易地把这艘飞船弄翻。崔莉恩甚至越来越怀疑，他之所以能有今天这样成功而疯狂的人生，最主要的原因就是他从来没有真正理解过他所做的任何事情的意义和后果。&lt;/p&gt;
&lt;p&gt;“赞福德，”她耐心地解释道，“他们在外太空没有任何保护地飘来荡去……你总不希望看着他们死掉吧，对吗？”&lt;/p&gt;
&lt;p&gt;“喔，你知道……不。当然不是，可是……”&lt;/p&gt;
&lt;p&gt;“当然不是？当然不想看着他们死掉？可是？”崔莉恩的头一偏。&lt;/p&gt;
&lt;p&gt;“喔，也许会有其他什么人在我们后面把他们救起来。”&lt;/p&gt;
&lt;p&gt;“可再过一秒钟他们就已经死掉了。”&lt;/p&gt;
&lt;p&gt;“是的，所以如果你对这个问题多考虑一会儿的话，这个问题早就解决了。”&lt;/p&gt;
&lt;p&gt;“你难道很乐意让他们去死吗？”&lt;/p&gt;
&lt;p&gt;“喔，你知道，当然不能说乐意，可是……”&lt;/p&gt;
&lt;p&gt;“总之，”崔莉恩说，一边转回去面对控制面板，“又不是我把他们救起来的。”&lt;/p&gt;
&lt;p&gt;“你这是什么意思？那是谁把他们救起来的？”&lt;/p&gt;
&lt;p&gt;“这艘飞船。”&lt;/p&gt;
&lt;p&gt;“什么？”&lt;/p&gt;
&lt;p&gt;“这艘飞船，全是它自己干的。”&lt;/p&gt;
&lt;p&gt;“什么？”&lt;/p&gt;
&lt;p&gt;“在非概率驱动的过程中。”&lt;/p&gt;
&lt;p&gt;“但这是不可能的。”&lt;/p&gt;
&lt;p&gt;“对，赞福德，非常非常不可能。”&lt;/p&gt;
&lt;p&gt;“哦，是的。”&lt;/p&gt;
&lt;p&gt;“你瞧，赞福德，”她说，轻轻拍着他的胳膊，“别再担心这些陌生人了。只是两个普通家伙而已，我保证。我这就派机器人下去把他们带到这儿来。喂，马文！”&lt;/p&gt;
&lt;p&gt;一边的角落里，机器人的头猛地抬起来，随后不易察觉地摇晃着。它站起身来，看上去要比它的实际体重更重一些，然后以一种在别人眼里显得雄赳赳的姿态穿过房间。它停在崔莉恩面前，眼睛盯着她的左肩。&lt;/p&gt;
&lt;p&gt;“我想你应该知道，我感到非常沮丧。”它说。它的声音低沉，毫无生气。&lt;/p&gt;
&lt;p&gt;“噢，上帝。”赞福德咕哝了一句，一头倒在座位上。&lt;/p&gt;
&lt;p&gt;“哦。”崔莉恩以一种怜悯的语调说，“现在有件事情交给你，这也许能让你别想那么多。”&lt;/p&gt;
&lt;p&gt;“没用的。”马文嗡嗡地说，“我的脑容量太大了。”&lt;/p&gt;
&lt;p&gt;“马文！”崔莉恩警告道。&lt;/p&gt;
&lt;p&gt;“那好吧，”马文说，“你想让我干什么？”&lt;/p&gt;
&lt;p&gt;“下到2号进入舱去，把两个陌生人带到这儿来，要给我监视好了。”&lt;/p&gt;
&lt;p&gt;停顿了一微秒，稍稍调整一下语调——实际上，这些都是你察觉不到的——马文以这种方式表达了它对于人类一切事务的蔑视和厌恶。&lt;/p&gt;
&lt;p&gt;“就这个？”他说。&lt;/p&gt;
&lt;p&gt;“是的。”崔莉恩不容置疑地回答。&lt;/p&gt;
&lt;p&gt;“我不喜欢干这个。”马文说。&lt;/p&gt;
&lt;p&gt;赞福德猛地从座位上眺起来，“她不是要你喜欢干这个，”他叫道，“你只管去干，听懂了吗？”&lt;/p&gt;
&lt;p&gt;“那好吧。”马文说，声音嘶哑得像口破钟，“我这就去。”&lt;/p&gt;
&lt;p&gt;“这才像话……”赞福德说，“好的……谢谢……”&lt;/p&gt;
&lt;p&gt;马文转过身来，用自己那扁平的红色三角形眼睛对着他。&lt;/p&gt;
&lt;p&gt;“我没有让你不高兴吧？”他可怜兮兮地问。&lt;/p&gt;
&lt;p&gt;“哦，当然没有，马文。”崔莉恩轻快地说，“好了，真的……”&lt;/p&gt;
&lt;p&gt;“我不想让你不高兴。”&lt;/p&gt;
&lt;p&gt;“当然，没关系的。”轻快的声音继续道，“你只需要自自然然地去做你的事，一切都会好起来的。”&lt;/p&gt;
&lt;p&gt;“你保证你不介意？”马文试探着问。&lt;/p&gt;
&lt;p&gt;“是的，当然不会，马文。”崔莉恩说，“一切都好，真的……这只是生活的一部分。”&lt;/p&gt;
&lt;p&gt;马文的电子眼冲她闪了一下。&lt;/p&gt;
&lt;p&gt;“生活，”马文说，“别跟我提什么生活。”&lt;/p&gt;
&lt;p&gt;他绝望地转身离开控制舱，哼了一声，顺手在背后关上舱门。&lt;/p&gt;
&lt;p&gt;“我简直快受不了这个机器人了，赞福德。”崔莉恩抱怨说。&lt;/p&gt;
&lt;p&gt;《银河系百科全书》将机器人定义为用来代替人工作的机械装置。天狼星控制系统公司市场部则将机器人定义为“你的塑料秋伴，和它在一起你会非常开心”。&lt;/p&gt;
&lt;p&gt;《银河乐漫游指南》将天狼星控制系统公司市场部定义为“一伙不长脑子的龟孙，一旦革命来临，他们将是第一批被处决者”。还带了一个脚注，大意是说，编辑们热忱欢迎愿意从事机器人学方面编辑工作的求职者。&lt;/p&gt;
&lt;p&gt;一本《银河系百科全书》很幸运地穿过时间隧道，从一千年后的未采落入现在。有意思的是，这本书中对天狼星控制系统公司市场部的定义是“一伙不长脑子的龟孙，革命来临时第一批被处决者”。&lt;/p&gt;
&lt;p&gt;粉红色的小卧室闪烁着消失了，猴子们也沉入了另一个空间。福特和阿瑟发现自己置身于飞船的登船区域。这地方看上去很不错。&lt;/p&gt;
&lt;p&gt;“我想这是一艘全新的飞船。”福特说。&lt;/p&gt;
&lt;p&gt;“你怎么知道？”阿瑟问，“难道你带着什么稀奇古怪的仪器，可以测量金属的年龄？”&lt;/p&gt;
&lt;p&gt;“没有，我只是在地上发现了这本销售小册子。里面净是‘一旦拥有，宇宙在握’之类的话。噢！你瞧，我是对的。”&lt;/p&gt;
&lt;p&gt;福特翻到其中一页，指给阿瑟看。&lt;/p&gt;
&lt;p&gt;“它说，‘非概率物理学方面全新的重大突破。一旦飞船的驱动达到无限非概率状态，它就能穿越宇宙中的每一个点。让其他主要政府嫉妒你吧。’哇，口气还真不小。”&lt;/p&gt;
&lt;p&gt;福特兴奋地翻看着飞船的技术说明，不时对在他背井离乡流浪期间所错过的东西气喘吁吁地发表几句惊讶无比的评论。&lt;/p&gt;
&lt;p&gt;阿瑟注意听了一会儿，但是对福特所说的绝大部分内容都不理解，于是他开始任由自己的思想四处转悠，同时用手指触摸着一排弄不清用途的电脑的边缘。他抬起手，按下身边控制面板上的一个引人注目的红色大按钮。控制面板亮了起来，显示出一行字，“请不要再按这个按钮”。他吓得一哆嗦。&lt;/p&gt;
&lt;p&gt;“听着，”福特说，他还在钻研那本销售小册子，“他们在这艘飞船的控制系统上可下了大功夫。‘天狼星控制系统公司最新一代的机器人和电脑，具备新型的GPP特征。’”&lt;/p&gt;
&lt;p&gt;“GPP特征？”阿瑟问道，“什么玩意儿？”&lt;/p&gt;
&lt;p&gt;“哦，它的意思是‘真实的人类个性’。”&lt;/p&gt;
&lt;p&gt;“哦，”阿瑟说，“听上去有点儿糟糕。”&lt;/p&gt;
&lt;p&gt;一个声音从他们身后传来，“确实糟糕。”这声音低沉而毫无生气，伴随着轻微的叮当声。他们转过身来，看见一个可怜兮兮的金属人正站在门口。&lt;/p&gt;
&lt;p&gt;“什么？”他们问。&lt;/p&gt;
&lt;p&gt;“糟糕，”马文接着说，“确实是的，简直糟糕透了。还是别再谈论这个问题了。看着这扇门，”他一边说，一边迈步进来。这时，他的反讽电路接通了他的语音调节器，他开始戏仿起那本销售册子的风格来，“‘这艘飞船上所有的门都具备乐观开朗的好脾气。它们很乐意为你敞开，并且知道要想完成好这项工作的话它们还得自动关上。’”&lt;/p&gt;
&lt;p&gt;这扇门在他身后关闭，很显然，它确实具备了这样的好品质，伴随着一声感叹似的声音，“嗯……啊……啊！”&lt;/p&gt;
&lt;p&gt;对这扇门，马文满腔冰冷的怨怒，他的逻辑电路不停地向他灌输蔑视的信号以及应该用物理暴力对付它的概念。深层次的电路则不停插话进来：“为什么会烦恼？事情的重点是什么？没什么事情值得全力投入去干。”更深层次的电路则通过分析这扇门的分子结构以及人类脑细胞的分子结构来给自己找乐子。&lt;/p&gt;
&lt;p&gt;“来吧，”他嗡嗡地说，“我得到指令把你们俩带到控制桥上去，所以我到了这儿。我的脑容量抵得上一颗行星，他们却叫我把你们带到控制桥上去。这能称得上令人满意的工作吗？我当然不这么认为。”‘他转过身去，走回到那扇可恶的门前。&lt;/p&gt;
&lt;p&gt;“噢，打扰一下，”福特跟在他身后说，“请问这艘飞船属于哪个政府？”&lt;/p&gt;
&lt;p&gt;马文没有理他。&lt;/p&gt;
&lt;p&gt;“你盯着这扇门，”他咕哝着说，“它又要打开了。我知道，因为它突然产生出一股自以为是的气焰，真是让人无法忍受。”&lt;/p&gt;
&lt;p&gt;随着一阵讨好的吱吱声，门滑开了。马文重重地踏着步子走出门去。&lt;/p&gt;
&lt;p&gt;“跟我来。”他说。&lt;/p&gt;
&lt;p&gt;福特和阿瑟快步跟上他，然后门又带着愉快的咔嚓声滑回原位。&lt;/p&gt;
&lt;p&gt;“天狼星控制系统公司市插部！真是多谢啦，”走在过道上，马文说，“‘让我们造一种具备真实人类个性的机器人吧，’他们说。于是他们尝试着制造了我，我是一台个性原型机。你们看得出来，是吧？”&lt;/p&gt;
&lt;p&gt;福特和阿瑟尴尬地随口应付了几声。&lt;/p&gt;
&lt;p&gt;“我讨厌那扇门。”马文继续说道，“我还没把你们带到呢，是吗？”&lt;/p&gt;
&lt;p&gt;“哪个政府……”福特又开始了。&lt;/p&gt;
&lt;p&gt;“它不属于任何政府，”机器人猛地冒出一句，“它目前已经被偷了。”&lt;/p&gt;
&lt;p&gt;“被偷了？”&lt;/p&gt;
&lt;p&gt;“被偷了？”马文戏仿道。&lt;/p&gt;
&lt;p&gt;‘被谁？’福特问。&lt;/p&gt;
&lt;p&gt;“赞福德·毕博布鲁克斯。”&lt;/p&gt;
&lt;p&gt;福特的脸上立刻浮现出大异于平常的神情，起码有5种截然不同的震惊和困惑的表情堆积在上面。他的左腿本来正在大步朝前迈，但似乎一下子连地面都很难找到了。他盯着机器人，尽力放松嘴部的肌肉。&lt;/p&gt;
&lt;p&gt;“赞福德·毕博布鲁克斯？……”他微弱地说。&lt;/p&gt;
&lt;p&gt;“对不起，是我哪儿说错了吗？”马文毫不在意地问了一句，继续向前走着，“如果那样的话，请你原谅。噢，上帝啊，我太沮丧了。这儿又有一扇那种自我感觉良好的臭门。生活！别跟我提什么生活。”&lt;/p&gt;
&lt;p&gt;“根本就没有人提这个。”阿瑟恼火地说，“福特，你没事吧？”&lt;/p&gt;
&lt;p&gt;福特盯着他。“那个机器人是在说赞福德·毕博布鲁克斯吗？”他问。 &lt;/p&gt;
&lt;p&gt;=== 第十二章 ===&lt;/p&gt;
&lt;p&gt;一阵响亮的过场音乐声回荡在黄金之心号的船舱内，这是赞福德在调节亚以太广播的波段，以搜索关于自己的新闻。这台仪器相当难以操作。在很长一段时期内，广播都是通过按按钮和拧旋钮的办法来调节的。随着技术变得越来越精巧，控制器变成了触摸感应式，你只需要用手指轻拂一下控制面板就行了。而到了今天，你所要做的仅仅是朝着元件的大致方向挥一下手，头脑里起一个意念就行。这样当然可以节省不少肌肉的能量消耗，但同时也意味着如果你想要连续听一个节目的话，就得一动不动地坐在那儿，直到你变得焦躁不安。&lt;/p&gt;
&lt;p&gt;赞福德挥了一下手，‘又换了一个频道。传来更多的音乐声，不过这次是一条新闻公告的背景音乐。这些新闻总是编辑得能够配合这些音乐的节奏。&lt;/p&gt;
&lt;p&gt;“……这里是亚以太波段带给你的新闻报道，银河系整点播报。”一个刺耳的声音说，“我们要向一切地方的所有智慧生命问声好……当然，今晚的重大新闻无疑是令人震惊的新型非概率驱动原型飞船失窃事件。实施偷窃的不是别人，正是银河系总统赞福德·毕博布鲁克斯。所有人都在问同一个问题……大赞最终逃掉了吗？毕博布鲁克斯，这个一手制造了这件轰动整个银河系的大案的人，一个过于自信的骗子，一度被描述为最怪异的人，最近刚刚第七次被评为已知宇宙中穿着最缺乏品位的人……他这次会落入法网吗？我们采访了他的私人脑保健医生伽葛。哈尔佛兰特……”&lt;/p&gt;
&lt;p&gt;音乐沉寂了一会儿，然后另一个声音插了进来，大概就是哈尔佛兰特吧。他说：“喔，赞福德究竟是个怎样的家伙，你知道吗？”随即却没了下文，因为一枝电子铅笔从空中划过，正好穿过了广播的开关感应区域。赞福德转过身来，望着崔莉恩——那枝铅笔是她扔的。&lt;/p&gt;
&lt;p&gt;“哎，”他说，“你这是干什么？”&lt;/p&gt;
&lt;p&gt;崔莉恩用手指敲击着一块全是数字的屏幕。&lt;/p&gt;
&lt;p&gt;“我刚刚想起一件事。”她说。&lt;/p&gt;
&lt;p&gt;“什么？值得打断有关我的新闻广播吗？”&lt;/p&gt;
&lt;p&gt;“关于你自己的消息你已经听得够多了。”&lt;/p&gt;
&lt;p&gt;“我现在很不安全。我们都知道这一点。”&lt;/p&gt;
&lt;p&gt;“你就不能不那么自我中心一小会儿吗？这件事很重要。”&lt;/p&gt;
&lt;p&gt;“如果有什么东西比我自己还重要的话，我倒是希望它现在被抓起来毙掉。”赞福德又看了她一眼，笑了起来。&lt;/p&gt;
&lt;p&gt;“听着，”崔莉恩说，“我们救起了那两个家伙……”&lt;/p&gt;
&lt;p&gt;“哪两个家伙？”&lt;/p&gt;
&lt;p&gt;“就是那两个被我们救起来的家伙。”&lt;/p&gt;
&lt;p&gt;“哦，对了，”赞福德说，“那两个家伙。”&lt;/p&gt;
&lt;p&gt;“我们是在ZZ9复Z阿尔发区域把他们救起来的。”&lt;/p&gt;
&lt;p&gt;“又怎么样？”赞福德眨着眼睛问。&lt;/p&gt;
&lt;p&gt;崔莉恩轻轻地说：“对你来说这难道不意味着什么吗？”&lt;/p&gt;
&lt;p&gt;“嗯，”赞福德念叨着，“ZZ9复Z阿尔发。ZZ9复Z阿尔发？”&lt;/p&gt;
&lt;p&gt;“想到什么了？”崔莉恩说。&lt;/p&gt;
&lt;p&gt;“哦……Z在这里是什么意思？”赞福德说。&lt;/p&gt;
&lt;p&gt;“哪—个Z？”&lt;/p&gt;
&lt;p&gt;“所有的。”&lt;/p&gt;
&lt;p&gt;崔莉恩在处理她和赞福德的关系时所遇到的主要困难之一就是，她得学会如何区分他的愚蠢。有时他假装愚蠢以使人们放松警惕，有时他假装愚蠢则是因为自己不想费力去思考，希望别的什么人帮他这么做，有时他假装愚蠢透顶又是为了掩盖他实际上并不理解当前情况这一事实，还有的时候是真的愚蠢。他因为聪明绝顶而出名——但却并非总是这样，这使得他很焦虑，所以才会有像上面所说的那种情形。他宁可把人们弄糊涂也不愿意被蔑视。这—点在崔莉恩看来才是真正最严重的愚蠢，但她不可能一直纠缠于这个问题。&lt;/p&gt;
&lt;p&gt;她叹了口气，在屏幕上点开一幅星空图，不管他表现为现在这副样子的原因是什么，这幅图都能让他—目了然。&lt;/p&gt;
&lt;p&gt;“这里，”她指着图说，“就在这里。”&lt;/p&gt;
&lt;p&gt;“噢……是的！”赞福德说。&lt;/p&gt;
&lt;p&gt;“那么？”她说。&lt;/p&gt;
&lt;p&gt;“那么什么？”&lt;/p&gt;
&lt;p&gt;她脑袋里的一部分终于开始对着脑袋里的另一部分尖叫起来。但她仍然非常平静地说：“你最初搭我上船也是在同一个区域。”&lt;/p&gt;
&lt;p&gt;他看了她一眼，又把目光转回屏幕。&lt;/p&gt;
&lt;p&gt;“噢，没错，”他说，“那地方现在已经荒芜了。我们当时一定是直接冲进了马头星云的中心。可我们怎么会跑到那儿去？我是说，那是个不毛之地呀。”&lt;/p&gt;
&lt;p&gt;崔莉恩没有理睬这句话。&lt;/p&gt;
&lt;p&gt;“非概率驱动。”她耐心地说，“你自己还解释给我听过的。我们穿越了宇宙中的每一个点，这你知道。”&lt;/p&gt;
&lt;p&gt;“没错，但那只是一个巧合，不是吗？”&lt;/p&gt;
&lt;p&gt;“是的。”&lt;/p&gt;
&lt;p&gt;“正好在那个点上救起了这两个人？在整个宇宙所有可能的点中间？这也太……我得算一算。电脑！”&lt;/p&gt;
&lt;p&gt;天狼星控制系统舰载电脑，这个控制、渗透了飞船每一个角落的家伙，立刻切换到了交流模式。&lt;/p&gt;
&lt;p&gt;“你好！”它的声音生气勃勃，同时还输出了一小段记录纸带，上面写着“你好”。&lt;/p&gt;
&lt;p&gt;“噢，上帝呀。”赞福德说。虽然他和这台电脑共事的时间并不长，但已经开始很厌恶它了。&lt;/p&gt;
&lt;p&gt;电脑继续说着，语速很快，兴高采烈，仿佛是在推销某个牌子的清洁剂。&lt;/p&gt;
&lt;p&gt;“我要告诉你的是，无论你碰到了什么难题，我都会在这儿帮助你解决。”‘“好了，好了。”赞福德说，“是这样的，我想我需要一张纸。”&lt;/p&gt;
&lt;p&gt;“没问题，”电脑说，一边又向垃圾桶里输出—截记录，“我能够理解。如果你还需要……”&lt;/p&gt;
&lt;p&gt;“闭嘴！”赞福德吼了—句，随手操起一枝铅笔坐在崔莉恩身旁的控制台前。&lt;/p&gt;
&lt;p&gt;“好吧，好吧。”电脑用一种受了伤害的语调说，然后关闭了通话频道。&lt;/p&gt;
&lt;p&gt;赞福德和崔莉恩死死地盯着面前的非概率航行轨道扫描器上静静闪烁着的数字。&lt;/p&gt;
&lt;p&gt;“我们能算出来吗？”赞福德问，“从他们的角度看他们获救的非概率是多少？”&lt;/p&gt;
&lt;p&gt;“可以，那是个恒量。”崔莉恩说，“2的276，709次方比1.”&lt;/p&gt;
&lt;p&gt;“很高啊。这两个家伙真的是太幸运太幸运了。”&lt;/p&gt;
&lt;p&gt;“没错。”&lt;/p&gt;
&lt;p&gt;“但是相对于飞船救起他们的时候我们正在做的事来说……”&lt;/p&gt;
&lt;p&gt;崔莉恩戳了一下数字。上面显示的是2的负无穷次方比1（一个无理数，只有在非概率物理的范畴内才有意义）。&lt;/p&gt;
&lt;p&gt;“那可就太低了。”赞福德轻轻吹了声口哨继续道。&lt;/p&gt;
&lt;p&gt;“没错。”崔莉恩赞同道，一边嘲讽地看着他。&lt;/p&gt;
&lt;p&gt;“这对解释非概率来说简直是一个沉重的打击。一件几乎不可能的事情，如果要计入一个庞大的总数之内，势必会反映在平衡统计表上。”&lt;/p&gt;
&lt;p&gt;赞福德潦草地写下几个总数，又几笔划掉，然后把铅笔扔到一边。&lt;/p&gt;
&lt;p&gt;“该死的，我根本算不出来。”&lt;/p&gt;
&lt;p&gt;“那么？”&lt;/p&gt;
&lt;p&gt;赞福德恼怒地把自己的两个脑袋一碰，牙咬得痒痒的。&lt;/p&gt;
&lt;p&gt;“好吧，”他说，“电脑！”&lt;/p&gt;
&lt;p&gt;于是语音电路再次恢复工作。&lt;/p&gt;
&lt;p&gt;“嘿，你好！”它们（声音、纸带）说，“我所做的一切就是为了使你的生活一天比一天比一天更舒适……”&lt;/p&gt;
&lt;p&gt;“好了，知道了。闭上嘴，把这个给我算出来。”&lt;/p&gt;
&lt;p&gt;“没问题，”电脑说，“你是想要一个概率预测，基于……”&lt;/p&gt;
&lt;p&gt;“非概率数据，是的。”&lt;/p&gt;
&lt;p&gt;“好的，”电脑说，“有一种有趣的观点。你知道大多数人的命运是由电话号码掌握的吗？”&lt;/p&gt;
&lt;p&gt;痛苦的表情出现在赞福德的一张脸上，随后转移到另一张。&lt;/p&gt;
&lt;p&gt;“你疯了吗？”他说。&lt;/p&gt;
&lt;p&gt;“没有，不过你会疯掉的，如果我告诉你……”&lt;/p&gt;
&lt;p&gt;崔莉恩大口喘着气说，一边在非概率航行轨道扫描屏幕的按钮上一阵乱抓。&lt;/p&gt;
&lt;p&gt;“电话号码？”她说，“那东西说‘电话号码’？”&lt;/p&gt;
&lt;p&gt;数字在屏幕上闪烁着。&lt;/p&gt;
&lt;p&gt;电脑一度礼貌地停了一会儿，现在又拾起了话头：“我想说的是……”&lt;/p&gt;
&lt;p&gt;“别打岔，拜托。”崔莉恩说。&lt;/p&gt;
&lt;p&gt;“你瞧，这是什么？”赞福德问。&lt;/p&gt;
&lt;p&gt;“我不知道，”崔莉恩说，“不过，那些陌生人——他们正在跟着那个可怜的机器人朝控制桥走。我们要先看看监视器镜头吗？” &lt;/p&gt;
&lt;p&gt;=== 第十三章 ===&lt;/p&gt;
&lt;p&gt;马文走在走廊里，还在继续抱怨。&lt;/p&gt;
&lt;p&gt;“于是乎，我整个左半身的所有二极管都痛得厉害……”&lt;/p&gt;
&lt;p&gt;“什么？”走在他身旁的阿瑟冷淡地问了一句，“真的吗？”&lt;/p&gt;
&lt;p&gt;“哦，当然。”马文说，“我曾经要求把它们通通换掉，可是根本没人理我。”&lt;/p&gt;
&lt;p&gt;“我想像得到。”&lt;/p&gt;
&lt;p&gt;含糊不清的喃喃细语从福特嘴里传出，“是吗，是吗，是吗，”他一直在这样自言自语，“赞福德·毕博布鲁克斯……”&lt;/p&gt;
&lt;p&gt;马文突然停下来，举起一只手。&lt;/p&gt;
&lt;p&gt;“你知道发生了什么，对吧？”&lt;/p&gt;
&lt;p&gt;“不知道。什么？”阿瑟其实根本不想知道。&lt;/p&gt;
&lt;p&gt;“我们又碰上了—扇那种该死的门。”&lt;/p&gt;
&lt;p&gt;走廊的这一端也是一扇滑动门。马文怀疑地盯着它。&lt;/p&gt;
&lt;p&gt;“怎么？”福特不耐烦地说，“我们到底过不过去？”“‘我们到底过不过去？’”马文喃喃自语道，“当然。这是控制桥的入口。我受命把你们带到桥上去。我敢说，这也许就是今天对我的智力的最高考验了。”&lt;/p&gt;
&lt;p&gt;慢腾腾地、带着极大的厌恶之情，他朝这扇门走去，活像一个猎人正在悄悄接近目标。突然间，门滑开了。&lt;/p&gt;
&lt;p&gt;“谢谢，”它说，“你让一扇简简单单的门感到非常愉快。”&lt;/p&gt;
&lt;p&gt;马文的胸腔内，元件开始痛苦地颤动起来。&lt;/p&gt;
&lt;p&gt;“可笑啊。”他悲哀地感叹道，“当你认为生活已经糟糕得不可能再糟糕了的时候，它居然真的更糟糕了。”&lt;/p&gt;
&lt;p&gt;说着他穿过门，留下福特和阿瑟在门外面面相觑，无奈地耸着肩膀。这时门内又传来马文的声音。&lt;/p&gt;
&lt;p&gt;“我想你们现在可以见到那两个陌生人了。”他说，“你们是希望我回到角落里坐着呢，还是就这么在这里站着？”&lt;/p&gt;
&lt;p&gt;“好的，把他们带进来，好吗，马文？”另一个声音说道。&lt;/p&gt;
&lt;p&gt;阿瑟看着福特，惊讶地发现他在笑。&lt;/p&gt;
&lt;p&gt;“怎么……”&lt;/p&gt;
&lt;p&gt;“嘘，”福特说，“进去吧。”&lt;/p&gt;
&lt;p&gt;他走进控制桥。&lt;/p&gt;
&lt;p&gt;阿瑟紧张地跟在他后面，一进门就惊讶地看见一个男人懒洋洋地靠在座位里，脚放在控制台上，正在用左手剔右边那个脑袋的牙。右边这张脸几乎快被这项工作遮完了，但左边那张脸上清晰地挂着一个放松而冷漠的微笑。房间里让阿瑟难以置信的东西的数目相当大，好长—阵子他都合不拢下巴。&lt;/p&gt;
&lt;p&gt;这个奇特的人懒懒地望了福特一眼，然后用一种显得有些冷漠的声音说：“福特，嘿，你还好吗？很高兴你能来这儿。”&lt;/p&gt;
&lt;p&gt;“赞福德，”福特也漫不经心地回答道，“很高兴见到你，你看起来气色不错，这条额外的胳膊也很配。看来你偷了艘不错的飞船。”&lt;/p&gt;
&lt;p&gt;阿瑟瞪眼望着他。&lt;/p&gt;
&lt;p&gt;“你认识这家伙？”他指着赞福德问。&lt;/p&gt;
&lt;p&gt;“当然认识！”福特大叫一声，“他是……”他停顿了一下，决定把介绍的次序颠倒一下。&lt;/p&gt;
&lt;p&gt;“哦，赞福德，这位是我的一个朋友，阿瑟。登特。”他介绍说，“他的星球被毁灭时，是我救了他。”&lt;/p&gt;
&lt;p&gt;“哦，当然，”赞福德说，“你好，阿瑟，欢迎来这儿。”他的右边脑袋随意地转过来打了声招呼，然后又转回去继续剔牙。&lt;/p&gt;
&lt;p&gt;福特继续介绍道：“阿瑟，这位是我的半个堂兄，赞福德。毕博……”&lt;/p&gt;
&lt;p&gt;“我们见过。”阿瑟厉声说。&lt;/p&gt;
&lt;p&gt;当你在快车道上轻而易举地超过几辆车后，你会自我感觉非常良好，这时如果你碰巧从4挡直接打到1挡而不是3挡的话，你的引擎就会从引擎盖下飞出来，以后的事情就不必说了——这恰恰就是福特·普里弗克特听到这句话后的感觉。&lt;/p&gt;
&lt;p&gt;“喔……什么？”他说。&lt;/p&gt;
&lt;p&gt;“我说我们见过。”&lt;/p&gt;
&lt;p&gt;赞福德很尴尬地吃了一惊，使劲嚼着口香糖。&lt;/p&gt;
&lt;p&gt;“嘿……嗯，是吗？嘿……嗯……”&lt;/p&gt;
&lt;p&gt;福特转过身，对阿瑟怒目而视。现在他感到已经回到了自己的世界中，因而突然开始很厌恶自己居然会和这个无知的原始人在一起。这家伙对银河系事务的了解程度简直和一只非洲蚊子对北京城生活的了解程度没什么区别。&lt;/p&gt;
&lt;p&gt;“你说你们见过，这是什么意思？”他问，“这是从参宿四星系5号星来的赞福德·毕博布鲁克斯。你可得弄明白了，不是从克洛伊登来的该死的马丁。史密斯。”&lt;/p&gt;
&lt;p&gt;“我不管，”阿瑟冷冷地说，“我们见过，不是吗？赞福德·毕博布鲁克斯——或者我应该叫你……菲尔？”&lt;/p&gt;
&lt;p&gt;“什么？”福特叫道。&lt;/p&gt;
&lt;p&gt;“你得提醒我一下，”赞福德说，“我老是记不住人种。”&lt;/p&gt;
&lt;p&gt;“那是在一个派对上。”阿瑟继续道。&lt;/p&gt;
&lt;p&gt;“是吗，唔，我表示怀疑。”赞福德说。&lt;/p&gt;
&lt;p&gt;“冷静—点儿好吗，阿瑟！”福特说。&lt;/p&gt;
&lt;p&gt;阿瑟丝毫不听劝阻，“六个月前的一个派对，在地球上……英格兰……”&lt;/p&gt;
&lt;p&gt;赞福德摇了摇头，脸上挂着—丝勉强的笑意。&lt;/p&gt;
&lt;p&gt;“伦敦，”阿瑟坚持说，“伊思林顿。”&lt;/p&gt;
&lt;p&gt;“哦。”赞福德开始有点儿心虚了，“那个派对。”&lt;/p&gt;
&lt;p&gt;这对福特来说完全是不公平的。他脑袋转来转去，一会儿看着阿瑟，一会儿又看着赞福德。“什么？”他冲赞福德说，“你不会是说你也曾经在那个可怜的小行星上待过吧，是吗？”&lt;/p&gt;
&lt;p&gt;“没有，当然没有。”赞福德轻快地说，“不过，嗯，我好像很短暂地去过一次，是在上什么地方的途中……”&lt;/p&gt;
&lt;p&gt;“可我被困在那儿待了整整15年！”&lt;/p&gt;
&lt;p&gt;“喔，我又不知道，不是吗？”&lt;/p&gt;
&lt;p&gt;“可你去那儿干什么？”&lt;/p&gt;
&lt;p&gt;“找点儿……你知道的……”&lt;/p&gt;
&lt;p&gt;“他擅自闯入了一个派对。”阿瑟说，气得浑身直哆嗦，“一个奇装异服派对……”&lt;/p&gt;
&lt;p&gt;“那又怎么样？”福特问。&lt;/p&gt;
&lt;p&gt;“在那个派对上，”阿瑟继续道，“—个姑娘……哦，好吧，你瞧，现在已经没什么关系了。整个地球都已经灰飞烟灭了……”&lt;/p&gt;
&lt;p&gt;“我希望你别再为那颗该死的星球生闷气了。”福特说，“那位女士又是谁？”&lt;/p&gt;
&lt;p&gt;“哦，只是某个人而已。好吧，我没能搞定她。我整个晚上都在尝试。该死，她现在还在我心里。美丽、优雅、冰清玉洁。最后我终于让她靠近了我一点儿，可以好好聊聊了。然后你的这位朋友却闯进来说，‘嘿，美人儿，这个家伙惹你心烦吗？干吗不来和我聊聊呢？我来自另一颗行星。’就这样，我再也没有见过她。”&lt;/p&gt;
&lt;p&gt;“赞福德？”福特大声说。&lt;/p&gt;
&lt;p&gt;“是的。”阿瑟一边说一边瞪着他，尽量不让自己显得傻里傻气，“那时他只有两只手、一颗脑袋，自称叫菲尔，可是……”&lt;/p&gt;
&lt;p&gt;“可是你必须承认他确实来自另一颗行星。”崔莉恩说着，从控制桥的另一头进入他们的视野。她甜甜地冲阿瑟笑了笑——这一笑简直就像在阿瑟身上倾倒了整整一吨重的砖块——然后又把注意力转回飞船的控制上去了。&lt;/p&gt;
&lt;p&gt;屋子里静了几秒钟，然后，一些词语从阿瑟一团乱麻似的大脑中冒了出来。&lt;/p&gt;
&lt;p&gt;“崔茜卡，麦克米伦？”他问，“你怎么会在这儿？”&lt;/p&gt;
&lt;p&gt;“和你一样，”她说，“我在搭便车漫游。毕竟，拿了一个数学学位和一个天体物理学学位，我还能做别的什么呢？只能选择这个，要不只能在星期一排队领救济。”&lt;/p&gt;
&lt;p&gt;“无穷负1，”电脑这时又出声了，“非概率总数终于算出来了。”&lt;/p&gt;
&lt;p&gt;赞福德看了一眼自己，然后看看福特，再看阿瑟，最后看崔莉恩。&lt;/p&gt;
&lt;p&gt;“崔莉恩，”他说，“这一类事情在我们每一次使用非概率驱动的时候都会发生吗？”&lt;/p&gt;
&lt;p&gt;“恐怕很有可能。”她回答说， &lt;/p&gt;
&lt;p&gt;=== 第十四章 ===&lt;/p&gt;
&lt;p&gt;黄金之心号静静地穿过太空的暗夜，它现在使用的是常规的光子驱动。船上的四人隐隐感觉到，他们之所以走到一起来，既不是出于本人的意志，也不仅仅只是一个巧合，而是由于某种奇怪的物理倒错——仿佛人与人之间的关系同样要受到控制原子和分子之间关系的物理法则的影响。&lt;/p&gt;
&lt;p&gt;当飞船上的人工夜晚降临后，他们才谢天谢地地回到各自独立的休息舱，极力整理一下自己的思路。&lt;/p&gt;
&lt;p&gt;崔莉恩失眠了。她坐在沙发上，盯着面前的一个小笼子，里面装着她和地球之间惟一的联系——两只小白鼠。这还是她坚持说服赞福德让自己带上的。虽说她原本已经想好了再也不会回到那颗星球，但它被毁灭的消息还是给她带来了沉重的消极反应——虽然这件事看上去那么遥远，那么不真实，她完全找不到任何理由去想。她凝视着小白鼠在笼子里乱窜，在它们的塑料小踏车上疯狂地奔跑，直到它们占据了她的全部注意力。突然，她站起身，回到控制桥上，去看那些标识出飞船在虚空中行进路线的闪烁的灯光和数字。她希望知道自己正试图不去思考的那个东西究竟是什么。&lt;/p&gt;
&lt;p&gt;赞福德失眠了。他也希望知道自己无法让自己思考的那个东西究竟是什么。自从记事以来，他就被一种模模糊糊、断断续续、似是而非的感觉所困扰。大多数时间，他能把这种感觉放到一边，不去担心它。但是现在，这种感觉被福特·普里弗克特和阿瑟。登特突然而又解释不清的到来唤醒了。&lt;/p&gt;
&lt;p&gt;福特也失眠了。终于又回到漫游的路上，这让他兴奋不已。15年的煎熬终于结束了，就在他正要放弃最后的希望前的那一刹那。遇见赞福德也很有意思，虽然自己的这位半个堂兄有点儿奇怪。他成为银河系总统这个事实，以及他离开这个职位的方式，说实在的，让人觉得不可思议。这背后有什么原因吗？问赞福德肯定是没有用的，他干所有事情都没什么原因；他简直已经把深不可测变成了一门艺术。他在生活中所做的每一件事都是出于非凡的天才和无能的幼稚的混合物，而且通常很难区分出哪部分是哪部分。&lt;/p&gt;
&lt;p&gt;阿瑟睡着了：他实在是太累了。&lt;/p&gt;
&lt;p&gt;有人在敲赞福德的门。门开了。&lt;/p&gt;
&lt;p&gt;“赞福德……”&lt;/p&gt;
&lt;p&gt;“什么事？”&lt;/p&gt;
&lt;p&gt;一块椭圆形的光影中间现出崔莉恩的轮廓。&lt;/p&gt;
&lt;p&gt;“我想我们刚刚找到你来这儿要寻找的东西了。”&lt;/p&gt;
&lt;p&gt;“喔，是吗？”&lt;/p&gt;
&lt;p&gt;福特干脆放弃了睡觉的念头。他那间小卧室的角落里放着一台小电脑屏幕和键盘。他在前面坐了一会儿，尝试着为《银河系漫游指南》编写一条新条目，是关于沃贡人的。但他一时想不起足够尖酸刻薄的语言来，于是也就放弃了。他披上一件睡袍，出门朝控制桥溜达过去。&lt;/p&gt;
&lt;p&gt;走进控制桥后，他惊讶地发现里面居然有两个人，正兴奋地弯着腰站在仪器前。&lt;/p&gt;
&lt;p&gt;“看见了吗？飞船正准备驶进轨道。”崔莉恩正说着，“在这儿有一颗行星，正好坐落在你预测的坐标位置上。”&lt;/p&gt;
&lt;p&gt;赞福德听见了响动，抬起头来。&lt;/p&gt;
&lt;p&gt;“福特！”他叫了一声，“嘿，快过来看看这个。”&lt;/p&gt;
&lt;p&gt;福特走过去看了一眼，一组数字正在屏幕上闪动。&lt;/p&gt;
&lt;p&gt;“你认得出这些银河系坐标吧？”赞福德问。&lt;/p&gt;
&lt;p&gt;“不认识。”&lt;/p&gt;
&lt;p&gt;“让我给你点儿提示。电脑！”&lt;/p&gt;
&lt;p&gt;“嗨，各位！”电脑热情地说，“看来大伙儿都挺喜欢热闹的，对吗？”&lt;/p&gt;
&lt;p&gt;“闭嘴。”赞福德说，“在屏幕上演示一下。”&lt;/p&gt;
&lt;p&gt;室内的灯光暗下来。几盏小灯在控制台上闪烁，映出三双正盯着监视器屏幕的眼睛。&lt;/p&gt;
&lt;p&gt;上面没有任何东西。&lt;/p&gt;
&lt;p&gt;“认出来了吗？”赞福德耳语道。&lt;/p&gt;
&lt;p&gt;福特皱起眉头。&lt;/p&gt;
&lt;p&gt;“嗯，没有。”他说。&lt;/p&gt;
&lt;p&gt;“你看见了什么？”&lt;/p&gt;
&lt;p&gt;“什么都没有。”&lt;/p&gt;
&lt;p&gt;“认出了吗？”&lt;/p&gt;
&lt;p&gt;“你究竟在说些什么啊？”&lt;/p&gt;
&lt;p&gt;“我们现在是在马头星云内。一整片广阔的暗黑星云。”&lt;/p&gt;
&lt;p&gt;“难道你指望我从黑漆漆的屏幕上认出这个来吗？”&lt;/p&gt;
&lt;p&gt;“一片暗黑星云内部，这是整个银河系中惟——处会让我们的屏幕漆黑一片的地方。”&lt;/p&gt;
&lt;p&gt;“很好。”&lt;/p&gt;
&lt;p&gt;赞福德笑了。他显然为了某件事感到特别兴奋，几乎显得很幼稚。。&lt;/p&gt;
&lt;p&gt;“嘿，这太了不起了，简直足够远了！”&lt;/p&gt;
&lt;p&gt;“陷在一片星尘云中，有什么值得你这样高兴的？”福特问。&lt;/p&gt;
&lt;p&gt;“你不妨想想在这儿会有什么？”赞福德提示他说。&lt;/p&gt;
&lt;p&gt;“什么也没有。”&lt;/p&gt;
&lt;p&gt;“没有恒星？没有行星？”&lt;/p&gt;
&lt;p&gt;“没有。”&lt;/p&gt;
&lt;p&gt;“电脑！”赞福德吼道，把视角转1 80度，别添什么废话！“&lt;/p&gt;
&lt;p&gt;过了一阵，似乎没有任何事情发生。随即，大屏幕的边缘开始有了光亮。一颗小盘子大小的红色恒星缓缓划过屏幕，紧接着另—颗——一个双星系统。再后来是一弯巨大的新月，出现在整幅图景的一角——由红色逐渐过渡到漆黑—片，这是—颗行星的夜半球。&lt;/p&gt;
&lt;p&gt;“我找到它了！”赞福德叫起来，一边重重捶打着控制台，“我找到它了！”&lt;/p&gt;
&lt;p&gt;福特惊讶地看着这样的场面。&lt;/p&gt;
&lt;p&gt;“它是什么？”&lt;/p&gt;
&lt;p&gt;“它……”赞福德说，“是曾经存在过的最不可思议的行星。” &lt;/p&gt;
&lt;p&gt;=== 第十五章 ===&lt;/p&gt;
&lt;p&gt;（引自《银河系漫游指南》第634784页，第5a段。条目：曼格拉斯）&lt;/p&gt;
&lt;p&gt;退回到远古的迷雾中，在前一个银河帝国那些伟大而光荣的日子里，生活如火如茶，无比富足，几平没有赋税。大功率星际飞船穿梭于异星之间，在整个银河系最深远的地方追求着冒险和财富。在那些日子里，精神是勇敢的，赌注是高昂的，男人是真正的男人，女人是真正的女人，来自半人马座主星的毛茸茸的小生物是真正的来自半人马座主星的毛茸茸的小生物。所有的人都敢于面对未知的风险，追求伟大的功业，开垦此前没有任何人涉足过的充满不确定因素的领域——这些构成了帝国的坚实基础。&lt;/p&gt;
&lt;p&gt;许多人当然也因此变得非常富有，但这是再正常不过的事了，没有任何值得羞愧之处，因为并没有人是真正贫穷的——最起码值得一提的人没有一个是真正贫穷的。到了后来，所有这些最富裕和最成功的商人的生活不可避免地变得相当枯燥和琐碎，于是他们开始认为这全怪他们所居住的这个世界。他们中没有一个人是完全心满意足的：或者是嫌下午的后半段时间内天气不是大好，或者是嫌一天多了半个小时，又或者是嫌海水呈现出不正常的粉红色。&lt;/p&gt;
&lt;p&gt;于是，一种全新的特种工业应运而生：定制奢侈行星。这种产业的故乡就是曼格拉斯行星。在那里，超空间工程师通过太空中的白洞吸取物质，用来构造梦幻般的行星——黄金星、铂金星、地震频繁的柔软的橡胶星——所有这些行星都是严格按照银河系中那些最有钱的阔佬们的要求定制的。&lt;/p&gt;
&lt;p&gt;这项投资的成功达到这样一个地步：曼格拉斯自身很快变成了有史以来最富裕的行星，而银河系剩下的区域则变得一贫如洗。于是整个体系宣告解体。帝国崩溃了，漫长的沉寂笼罩着十亿个饥饿的世界，只有当学者们深夜撰写那些自呜得意的政治经济学论文时，他们挥舞的大笔才会扰动一下这份沉寂。&lt;/p&gt;
&lt;p&gt;曼格拉斯则消失了，关于它的记忆也很快成为隐晦的传说。&lt;/p&gt;
&lt;p&gt;当然，在现今这个经过启蒙的时代，没有人相信这样的传说。 &lt;/p&gt;
&lt;p&gt;=== 第十六章 ===&lt;/p&gt;
&lt;p&gt;阿瑟被一阵争吵声吵醒了，于是他来到控制桥。福特正挥动着胳膊。&lt;/p&gt;
&lt;p&gt;“你一定是疯了，赞福德。”他说，“曼格拉斯只是一个神话，一个童话故事，是那些希望自己的孩子长大后成为经济学家的父母在夜里讲给孩子们听的，它是……”&lt;/p&gt;
&lt;p&gt;“它是我们现在正绕其轨道运行的那颗行星。”赞福德强调说。&lt;/p&gt;
&lt;p&gt;“你瞧，我不知道你自己绕的是什么轨道，”福特说，“但是这艘飞船……”&lt;/p&gt;
&lt;p&gt;“电脑！”赞福德叫道。&lt;/p&gt;
&lt;p&gt;“噢，别……”&lt;/p&gt;
&lt;p&gt;“嗨，各位！我是艾迪，你们的舰载电脑。现在我感觉棒极了，弟兄们，我保证我能搞定你们在我身上运行的任何程序。”&lt;/p&gt;
&lt;p&gt;阿瑟以询问的眼神看着崔莉恩。她示意让他进来，但是要保持安静。&lt;/p&gt;
&lt;p&gt;“电脑，”赞福德说，“告诉大家我们现在所处的轨道。”&lt;/p&gt;
&lt;p&gt;“非常乐意，伙计。”它说，“我们现在正运行在那颗传说中的行星曼格拉斯上空300英里高度的轨道上。”&lt;/p&gt;
&lt;p&gt;“这说明不了任何问题。”福特反驳道，“我相信这台电脑连我的体重都说不出来。”&lt;/p&gt;
&lt;p&gt;“我当然能做到这一点。”电脑热心地说，同时打出更多的纸带，“我甚至能计算出你的个性弱点，精确到小数点后10位，如果你愿意的话。”&lt;/p&gt;
&lt;p&gt;这时崔莉恩插话了。&lt;/p&gt;
&lt;p&gt;“赞福德，”她说，“反正我们马上就会转到这颗行星的昼半球，”她又补了—句，“无论最后证实它是哪—颗。”&lt;/p&gt;
&lt;p&gt;“嘿，你这是什么意思？这颗行星正好在我预测它应该在的位置，不是吗？”&lt;/p&gt;
&lt;p&gt;“是的，我知道这儿有一颗行星。我并不是要和任何人争论，只是我还不能判断出这是不是曼格拉斯。反正黎明马上就要来了。”&lt;/p&gt;
&lt;p&gt;“好吧，好吧。”赞福德喃喃地说，“起码让我们的眼睛享受享受这一番美景。电脑！”&lt;/p&gt;
&lt;p&gt;“大家好！我能……”&lt;/p&gt;
&lt;p&gt;“你只要闭嘴，让我们大家再看看这颗行星。”&lt;/p&gt;
&lt;p&gt;一片单调的黑暗混沌又一次填满了屏幕——行星在他们下面转动着。&lt;/p&gt;
&lt;p&gt;他们静静地看了一会儿，但是赞福德按捺不住兴奋之情。&lt;/p&gt;
&lt;p&gt;“我们正在越过夜半球……”他压低嗓门道。行星继续转动着。&lt;/p&gt;
&lt;p&gt;“这颗行星的表面现在就在我们下方300英里的地方……”他继续道。他这是在试图恢复他认为面临一个伟大的时刻时所应有的感觉。曼格拉斯！他被福特的质疑伤了自尊。曼格拉斯！&lt;/p&gt;
&lt;p&gt;“再过几秒钟，”他继续说，“我们就会看见……瞧！”&lt;/p&gt;
&lt;p&gt;这个时刻终于来了。即使是阅历最丰富的星际漫游者也无法不为太空中的日出景观所震撼，双星日出更是整个银河系中的奇观之一。&lt;/p&gt;
&lt;p&gt;在绝对的黑暗中突然出现了一个闪烁的亮点。慢慢扩大，铺展成一道窄窄的光带，然后，几秒钟之内，两颗太阳都可以见到了，像是从黑暗的地平线边缘升起了白色的火焰。绚丽的色彩很快就穿越了他们下面稀薄的大气。&lt;/p&gt;
&lt;p&gt;“黎明的火焰！”赞福德赞叹道，“双星太阳，索利安里斯和拉姆……”&lt;/p&gt;
&lt;p&gt;“或者其他任何太阳。”福特平静地说。&lt;/p&gt;
&lt;p&gt;“索利安里斯和拉姆！”赞福德坚持说。&lt;/p&gt;
&lt;p&gt;双星在太空中闪耀着光芒，一阵可怕的音乐声却在控制桥内响了起来：马文在讽刺地哼哼着小曲，因为他简直恨透了人类。&lt;/p&gt;
&lt;p&gt;福特盯着眼前这光的奇观，内心也感到十分兴奋，但这仅仅是见到一颗新行星的兴奋之情；他已经看得足够多了。赞福德非要把滑稽的幻想强加在这样的场面上，从而为他自己的观点服务。这种做法使他稍微有点儿生气。所有这些关于曼格拉斯的胡说八道看起来都太过幼稚了。难道只看见一个花园非常美丽还不够，还非要相信它里面有仙女吗？&lt;/p&gt;
&lt;p&gt;所有这些关于曼格拉斯的事情对于阿瑟来说通通都是无法理解的。他靠到崔莉恩身边，问她正在发生什么事。&lt;/p&gt;
&lt;p&gt;“我也只知道赞福德告诉我的那些。”她对他耳语道，“曼格拉斯显然是一个没有人真正相信的传说。听起来有点儿像地球上关于亚特兰蒂斯的传说，只不过这个传说里说，曼格拉斯人曾经制造过行星。”&lt;/p&gt;
&lt;p&gt;阿瑟望着屏幕，感到自己似乎忘记了什么很重要的东西。突然，他意识到了那是什么。&lt;/p&gt;
&lt;p&gt;“这艘飞船上有茶吗？”他问。&lt;/p&gt;
&lt;p&gt;随着黄金之心号在它的轨道上运行，越来越多的行星表面在他们下面呈现出来。双星现在高高地悬挂在黑色的天空中，黎明的灿烂霞光已经结束，行星的表面在正常的白昼光线中显得荒凉而可怕——灰暗、布满尘土、只露出模糊的轮廓。整个星球看上去死寂而寒冷，就像地下的墓穴。有时，一些让人充满希望的影像会出现在远处的地平线上——峡谷，也许是山峰，甚至可能是城市——但当他们靠近时，这一切又都变得模糊起来，没有任何东西出现。行星的表面被时间所侵蚀，被笼罩着的稀薄空气一个世纪接着一个世纪的缓慢移动所侵蚀。&lt;/p&gt;
&lt;p&gt;显然，它非常非常古老。&lt;/p&gt;
&lt;p&gt;看着这些灰暗的景象在身下移动，一阵疑惑出现在福特的脑海中。巨大的时间跨度困扰着他，他此时此刻能够明确地感觉到。于是他清了清嗓子。&lt;/p&gt;
&lt;p&gt;“好吧，即使假定这就是……”&lt;/p&gt;
&lt;p&gt;“这就是。”赞福德说。&lt;/p&gt;
&lt;p&gt;“其实不是的。”福特继续道，“但是，你又想从这儿得到什么呢？这儿什么都没有啊。”&lt;/p&gt;
&lt;p&gt;“不是在表面上。”赞福德说。&lt;/p&gt;
&lt;p&gt;“好吧，就算假设这儿有些什么，我敢断定你来这儿决不只是为了工业考古学。你究竟在寻找什么？”&lt;/p&gt;
&lt;p&gt;赞福德的一个脑袋朝一边望去，另一个跟着去看第一个在看些什么，但是什么都没看见。&lt;/p&gt;
&lt;p&gt;“哦，”赞福德轻快地说，“一部分是出于好奇，一部分是出于冒险。但主要的，我想还是名声和金钱……”&lt;/p&gt;
&lt;p&gt;福特用一种锐利的眼神盯着他。他有一种非常强烈的感觉，赞福德来这儿其实完全没有任何意图。&lt;/p&gt;
&lt;p&gt;“你知道，我一点儿也不喜欢这颗行星的样子。”崔莉恩颤抖着说。&lt;/p&gt;
&lt;p&gt;“喔，别带什么偏见。”赞福德说，“前一个银河帝国一半的财富就藏在它上面的某个地方，就凭这一点也值得好好观察一番。”&lt;/p&gt;
&lt;p&gt;胡说八道，福特想。即使假设这确实是某个已经化作尘土的远古文明的故乡，即使假设一些最最不可能的事情是真的，也不会有什么巨大的财富以一种今天仍旧有意义的形态埋藏在这颗行星上面。于是他只能耸耸肩。&lt;/p&gt;
&lt;p&gt;“我认为这只是一颗已经死亡的行星。”他说。&lt;/p&gt;
&lt;p&gt;“老这么悬疑不决简直快要我的命了。”阿瑟恼火地说。&lt;/p&gt;
&lt;p&gt;目前，压力和紧张在银河系的任何地方都是一个相当严重的社会问题。为了使这样的状况不进一步加剧，几个事实兹提前公布如下：这颗充满了疑问的行星其实就是传说中的曼格拉斯。&lt;/p&gt;
&lt;p&gt;古代原子能防御系统即将发射的致命的导弹攻击，所造成的破坏将仅限于三个咖啡杯和一个老鼠笼子、某个人前臂上的一块瘀伤、不到时节就开放但又突然死掉的一盆牵牛花，以及一头无辜的鲸鱼。&lt;/p&gt;
&lt;p&gt;但同时也还是应该保留一些神秘感，所以，现在还不能公布究竟是谁的前臂受了伤。这个事实可以构成悬念的主体，而且无伤大雅，因为无论是谁都不重要。 &lt;/p&gt;
&lt;p&gt;=== 第十七章 ===&lt;/p&gt;
&lt;p&gt;一天就这样开始了。经历了这样一个令人相当不安的开头后，阿瑟的思维开始从前一天留给他的那些混乱的碎片中重新集中起来。他发现了一台自动营养机，这为他带来了一杯不太像但也并非完全不算是茶的饮料。这台机器工作的原理非常有趣。按钮按下去后，它就会对这个人的味蕾进行一次迅速但详细的检查，借助分光镜分析他的新陈代谢，然后向连接他大脑味觉中心的神经中枢发射微弱的试验信号，以测试什么样的口味比较合适。然而，没有人知道它为什么要做这一系列的事情，因为它最后总是提供一杯不太像但也并非完全不算是茶的饮料。这台自动营养机也是由天狼星控制系统公司设计和制造的，它的投诉部目前只受理来自天狼星系陶星系统内三颗行星上主要的大陆的业务。&lt;/p&gt;
&lt;p&gt;阿瑟喝下这杯饮料，发现它相当提神。他瞟了一眼屏幕，看到飞船又越过了几百英里灰暗而贫瘠的土地。他突然想到要问一个一直困扰着他的问题。“这地方安全吗？”他问。&lt;/p&gt;
&lt;p&gt;“曼格拉斯已经死去500万年了，”赞福德解释说，“当然是安全的。到了现在，甚至连鬼魂都应该安顿下来成家立业了。”&lt;/p&gt;
&lt;p&gt;这时，控制桥内突然响起了一阵奇怪的解释不清的响声一一仿佛遥远的号角，空洞、尖利、似幻似真。接下来，一个同样空洞、尖利、似幻似真的声音说道：“欢迎你们……”&lt;/p&gt;
&lt;p&gt;这颗已经死亡的星球上有人在对他们说话。&lt;/p&gt;
&lt;p&gt;“电脑！”赞福德吼道。&lt;/p&gt;
&lt;p&gt;“哥们，你好哇！”&lt;/p&gt;
&lt;p&gt;“这是什么声音？”&lt;/p&gt;
&lt;p&gt;“哦，只是一些有着500万年历史的录音带正在向我们广播。”&lt;/p&gt;
&lt;p&gt;“什么？录音带？”。&lt;/p&gt;
&lt;p&gt;“嘘！”福特说，“它还在说。”&lt;/p&gt;
&lt;p&gt;这声音显得老成、彬彬有礼、相当有魅力，却传达出一种明确无误的恶意。&lt;/p&gt;
&lt;p&gt;“恐怕此时我们已经全部不在人世了，”它说，“所以这是一段事先录制的声明。曼格拉斯商业委员会欢迎尊贵的客人们的到来……”&lt;/p&gt;
&lt;p&gt;（“来自远古的曼格拉斯的声音！”赞福德叫了起来。“行啊，行啊。”福特说。）&lt;/p&gt;
&lt;p&gt;“……但是很遗憾，”这声音继续道，“整颗星球目前暂时停止了一切业务。谢谢你们。如果你们愿意留下你们的名字和可以联系上你们的地址，听到信号后请留言。”&lt;/p&gt;
&lt;p&gt;接下来是一声蜂鸣，然后一片沉寂。&lt;/p&gt;
&lt;p&gt;“他们不想搭理咱们。”崔莉恩紧张地说，“我们现在该怎么办？”&lt;/p&gt;
&lt;p&gt;“这只不过是录音罢了，”赞福德说，“我们继续前进。听到了吗，电脑？”&lt;/p&gt;
&lt;p&gt;“明白。”电脑说着加快了飞船的速度。&lt;/p&gt;
&lt;p&gt;他们等待着。&lt;/p&gt;
&lt;p&gt;才过了差不多一秒，号角声再次响起，然后那声音传来。&lt;/p&gt;
&lt;p&gt;“我们向你们保证，一旦我们的生意业务重新开始，相关的声明将会刊登在所有时尚杂志和彩色副刊上，到那时我们的客户又将能够订制当代最好的地理环境了。”然后，声音中的威胁意味更明显了，“感谢贵客户对我们的兴趣，但现在，我们必须要求你们离开。马上。”&lt;/p&gt;
&lt;p&gt;阿瑟环顾同伴们神色紧张的脸。&lt;/p&gt;
&lt;p&gt;“好吧，我认为我们最好现在就走，你们说呢？”他建议道。&lt;/p&gt;
&lt;p&gt;“嘘！”赞福德说，“这没什么值得担心的。”&lt;/p&gt;
&lt;p&gt;“那怎么每个人都显得这么紧张呢？”&lt;/p&gt;
&lt;p&gt;“只是感兴趣而已！”赞福德吼道，“电脑，放下起落架，准备着陆。”&lt;/p&gt;
&lt;p&gt;这一次的号角声显得敷衍了事，而人声则变得异常地冷峻。&lt;/p&gt;
&lt;p&gt;“太好了。”它说，“你们对我们这颗星球的热情丝毫没有减弱，所以我们只好向你们保证，现在防卫导弹已经瞄准了你们的飞船，这是我们专门为所有最热情的客户准备的，这些导弹装有核弹头，当然，这些只是细枝末节的小事罢了。我们期待着你们下辈子的订单……谢谢。”&lt;/p&gt;
&lt;p&gt;声音戛然而止。&lt;/p&gt;
&lt;p&gt;“哦。”崔莉恩说。&lt;/p&gt;
&lt;p&gt;“嗯……”阿瑟说。&lt;/p&gt;
&lt;p&gt;“怎么？”福特说。&lt;/p&gt;
&lt;p&gt;“瞧瞧，”赞福德说，“难道你们还当真了不成？这只不过是录音留言而已。这玩意儿已经好几百万年了。它不是针对我们的，懂吗？”&lt;/p&gt;
&lt;p&gt;“什么？”崔莉恩反问，“你是指那些导弹吗？”&lt;/p&gt;
&lt;p&gt;“导弹？别逗了。”&lt;/p&gt;
&lt;p&gt;福特拍拍赞福德的肩膀，指指他身后的屏幕。上面可以清楚地看到两枚银色的标枪正刺破大气层朝着飞船的尾部飞来。屏幕及时放大显示，看得更清晰了——两枚真正的火箭正在穿越天空。其突然性确实令人震惊。&lt;/p&gt;
&lt;p&gt;“我想他们真准备好好给我们来一下。”福特说。&lt;/p&gt;
&lt;p&gt;赞福德惊讶地看着这一切。&lt;/p&gt;
&lt;p&gt;“嘿，真是不可思议！”他说，“下面居然有人想杀死我们！”&lt;/p&gt;
&lt;p&gt;“不可思议。”阿瑟说。&lt;/p&gt;
&lt;p&gt;“难道你还不明白这意味着什么吗？”&lt;/p&gt;
&lt;p&gt;“当然。我们快死了。”&lt;/p&gt;
&lt;p&gt;“是的，但除此之外……”&lt;/p&gt;
&lt;p&gt;“除此之外？”&lt;/p&gt;
&lt;p&gt;“这意味着我们必须到别的什么东西上去！”&lt;/p&gt;
&lt;p&gt;“我们需要多久才能离开飞船？”&lt;/p&gt;
&lt;p&gt;时间一秒一秒过去，屏幕上的导弹变得越来越大。它们已经调整了飞行姿态，正对着飞船，所以能够看见的只有满载的核弹头。&lt;/p&gt;
&lt;p&gt;“有趣的局面。”崔莉恩说，“我们现在能做些什么呢？”&lt;/p&gt;
&lt;p&gt;“只能保持冷静。”赞福德说。&lt;/p&gt;
&lt;p&gt;“就这些？”阿瑟叫起来。&lt;/p&gt;
&lt;p&gt;“不，我们还能……嗯……采取规避动作！”赞福德说，突然间感到了一阵恐慌，“电脑，我们能采取什么样的规避动作？”&lt;/p&gt;
&lt;p&gt;“嗯，我恐怕没有，伙计。”电脑说。&lt;/p&gt;
&lt;p&gt;“或者做点其他随便什么，”赞福德继续说，“……比如……”他什么都想不起来。&lt;/p&gt;
&lt;p&gt;“好像有什么东西堵塞了我的导航系统。”电脑解释说，“距离撞击还有45秒。请叫我艾迪，这样也许有助于大家放松些。”&lt;/p&gt;
&lt;p&gt;赞福德试图同时考虑几种解决之道。“对了！”他说，“嗯……我们可以手动控制这艘飞船。”&lt;/p&gt;
&lt;p&gt;“你会驾驶吗？”福特高兴地问。&lt;/p&gt;
&lt;p&gt;“不会，你呢？”&lt;/p&gt;
&lt;p&gt;“不会。”&lt;/p&gt;
&lt;p&gt;“崔莉思，你呢？”&lt;/p&gt;
&lt;p&gt;“不会。”&lt;/p&gt;
&lt;p&gt;“很好，”赞福德似乎松了一口气，“我们可以一起来干。”&lt;/p&gt;
&lt;p&gt;“我也不会。”阿瑟说，他认为现在才到他出头的时候。&lt;/p&gt;
&lt;p&gt;“我猜也是。”赞福德说，“好的，电脑，现在我需要全手动控制。”&lt;/p&gt;
&lt;p&gt;“请吧。”电脑说。&lt;/p&gt;
&lt;p&gt;几张巨大的面板滑开，一排控制台在他们面前弹出来，上面还包着聚苯乙烯袋子和玻璃纸：这套控制系统从来没用过。&lt;/p&gt;
&lt;p&gt;赞福德近乎疯狂地瞪着这些东西。&lt;/p&gt;
&lt;p&gt;“好的，福特。”他说，“全力启动制动火箭，右舷10度。或者别的什么……”&lt;/p&gt;
&lt;p&gt;“祝你们好运，伙计们。”电脑唧唧喳喳地说，“距离撞击还有30秒……”&lt;/p&gt;
&lt;p&gt;福特扑到控制台前——只有几个操纵杆他隐隐约约能猜出是干什么的，于是他把这些操纵杆一阵猛拽。飞船开始摇晃、尖叫，仿佛导航火箭要同时把它推向各个方向。他松开一半操纵杆，于是飞船掉转头驶去，正好直直地对着呼啸而来的导弹。&lt;/p&gt;
&lt;p&gt;船上的人摔向墙壁，气垫立即从墙上弹出来，做应急保护。好几秒的时间内，惯性的压力让他们透不过气来，动弹不得。赞福德绝望地疯狂挣扎着，最后总算一脚踢中导航系统中一根小小的控制杆。&lt;/p&gt;
&lt;p&gt;控制杆啪的一声折断了。飞船剧烈摇晃起来，然后开始向上爬升。船上的人重重倒在舱内。福特的（银河系漫游指南》飞出去砸碎了控制台的一部分，它自己则开始介绍起如何从心宿二向外走私心宿二长尾鹦鹉腺来（心宿二长尾鹦鹉腺粘在一根细棍上，是一种恶心但很珍贵的鸡尾酒调制工具。一些有钱的蠢蛋通常愿意为此花一大笔钱，用来向另一些有钱的蠢蛋炫耀）。飞船突然又像一粒石子一样从空中直坠下去。&lt;/p&gt;
&lt;p&gt;很自然，差不多就是在这个时候，飞船船员中有一个人的前臂撞出了一块瘀伤。这一点必须强调指出，因为如前所述，他们安全地逃脱了，除这块瘀伤之外没有其他伤亡。核导弹并没有击中飞船，船员们的安全现在绝对得到了保障。&lt;/p&gt;
&lt;p&gt;“距离撞击还有20秒，伙计们……”电脑还在汇报。&lt;/p&gt;
&lt;p&gt;“快把这该死的引擎重新打开！”赞福德大声叫唤。&lt;/p&gt;
&lt;p&gt;“嗅，这是当然，伙计。”电脑说。随着一声低吼，引擎恢复了工作，飞船平稳地从俯冲状态拉升为水平飞行，重新对着导弹飞过去。&lt;/p&gt;
&lt;p&gt;电脑开始唱歌。&lt;/p&gt;
&lt;p&gt;“当你穿过风暴……”它带着鼻音哼着，“高昂起你的头……”&lt;/p&gt;
&lt;p&gt;赞福德尖叫着让它闭嘴，但他的声音被其他人因为重新面对死亡所发出的惊叫声淹没了。&lt;/p&gt;
&lt;p&gt;“不要……害怕……黑暗！”艾迪继续嚎着。&lt;/p&gt;
&lt;p&gt;飞船在拉升过程中倒转过来，所以他们现在是被晃倒躺在天花板上，导航系统的边都别想摸到。&lt;/p&gt;
&lt;p&gt;“在风暴结束时……”艾迪唱道。&lt;/p&gt;
&lt;p&gt;两枚导弹呼啸着逐渐迫近飞船。&lt;/p&gt;
&lt;p&gt;“是晴朗的天空……”&lt;/p&gt;
&lt;p&gt;非常幸运的是，导弹并没有根据飞船不规律的摆动情况来精确修正航线，所以最后擦着飞船底部掠了过去。&lt;/p&gt;
&lt;p&gt;“……距离撞击还有15秒，伙计们……在风中飘荡……”&lt;/p&gt;
&lt;p&gt;导弹在前方猛地划了一道弧线，掉转头来，重新对准目标。&lt;/p&gt;
&lt;p&gt;“就这样了。”阿瑟盯着它们说，“我们这次死定了，是吗？”&lt;/p&gt;
&lt;p&gt;“我希望你现在别说这个。”福特冲他喊了一句。&lt;/p&gt;
&lt;p&gt;“可是，事实如此啊，不是吗？”&lt;/p&gt;
&lt;p&gt;“是的。”&lt;/p&gt;
&lt;p&gt;“穿过雨滴……”艾迪还在唱着。&lt;/p&gt;
&lt;p&gt;突然间，一个念头击中了阿瑟。他跳了起来。&lt;/p&gt;
&lt;p&gt;“为什么没有人去打开非概率驱动设备？”他说，“我们应该可以够得到那玩意儿。”&lt;/p&gt;
&lt;p&gt;“你想干什么，疯了吗？”赞福德说，“如果不按正确程序操作，任何情况都有可能发生。”&lt;/p&gt;
&lt;p&gt;“到这个时候，这些还重要吗？”阿瑟吼道。&lt;/p&gt;
&lt;p&gt;“穿过你的梦……”艾迪唱道。&lt;/p&gt;
&lt;p&gt;阿瑟爬到墙和天花板交界的弧线处。&lt;/p&gt;
&lt;p&gt;“前进，前进，心中充满希望……”&lt;/p&gt;
&lt;p&gt;“有谁知道为什么阿瑟打不开非概率驱动吗？”崔莉恩大声问。&lt;/p&gt;
&lt;p&gt;“你从不会孤单……距离撞击还有5秒，伙计们，上帝保佑……你从……不会……孤独！”&lt;/p&gt;
&lt;p&gt;“我在问，”崔莉恩叫道，“有谁知道……”&lt;/p&gt;
&lt;p&gt;接下来发生的是一场爆炸，噪音和闪光仿佛要把人的头撕裂开来。 &lt;/p&gt;
&lt;p&gt;=== 第十八章 ===&lt;/p&gt;
&lt;p&gt;这场爆炸过后，黄金之心号继续非常正常地航行在它的航线上，只是内部经过了重新设计。空间更大了些，整理得很干净，泛着淡雅柔和的绿色和蓝色。在一座不通向任何地方的螺旋形楼梯中间树立着一株蕨类植物，开着黄色的小花。旁边是一个石头日晷的基座，上面是主电脑终端。灯光和镜子布置得十分巧妙，待在这里像置身暖房中间，面对经过精心修剪的花园。在暖房区的边缘，放着几张大理石面的桌子，桌腿是漂亮的锻造金属。盯着光亮的大理石表面时便可以透过石面隐约看见里面控制设备的模糊轮廓，只要你伸手去触摸，这些设备就会真实地掌握在你手中。从适当的角度观察这些镜子，会看到所有你所需要的数据，虽然不是特别清晰。总之，这个空间实在漂亮极了。&lt;/p&gt;
&lt;p&gt;身心松弛地坐在一张柳条编成的太阳椅里，赞福德·毕博布鲁克斯说：“究竟他妈的发生了些什么？”&lt;/p&gt;
&lt;p&gt;“哦，我正准备说呢，”阿瑟懒洋洋地靠在一个小鱼池旁边，“那边是非概率驱动的开关……”他向曾经是那个开关的地方挥了挥手。那地方现在摆着一盆植物。&lt;/p&gt;
&lt;p&gt;“可我们现在是在哪儿？”福特说，他坐在螺旋形楼梯上，手里拿着一瓶冰冻的泛银河系含漱爆破药。&lt;/p&gt;
&lt;p&gt;“应该还在我们原来所在的地方，我想……”崔莉恩说，因为此时他们周围的镜子突然同时显示出曼格拉斯表面死寂的景象，这颗行星仍然在他们下方转动着。&lt;/p&gt;
&lt;p&gt;赞福德从座位上跳起来。&lt;/p&gt;
&lt;p&gt;“那些导弹怎么样了？”他问。&lt;/p&gt;
&lt;p&gt;一幅新的、令人震惊的景象出现在镜子里。&lt;/p&gt;
&lt;p&gt;“它们好像变成了，”福特怀疑地说，“一盆牵牛花和一头非常怪异的鲸鱼……”&lt;/p&gt;
&lt;p&gt;“基于一个非概率因子，”艾迪插话道，看来倒是它一点儿也没有改变，“发生这种情况的可能性是8，767，128比1.”&lt;/p&gt;
&lt;p&gt;赞福德望着阿瑟。&lt;/p&gt;
&lt;p&gt;“你想到过这种情况吗，地球人？”他问。&lt;/p&gt;
&lt;p&gt;“哦，”阿瑟说，“我所做的只是……”&lt;/p&gt;
&lt;p&gt;“你知道吗，这真是个绝妙的主意，在不事先激活保护屏的情况下启动非概率驱动。嘿，伙计，你刚刚救了我们大家的命，你知道吗？”&lt;/p&gt;
&lt;p&gt;“噢，”阿瑟说，“真的，这没什么……”&lt;/p&gt;
&lt;p&gt;“是吗？”赞福德说，“那好，让我们忘掉它吧。好了，电脑，我们登陆。”&lt;/p&gt;
&lt;p&gt;“可是……”&lt;/p&gt;
&lt;p&gt;“我说过了，忘了它。”&lt;/p&gt;
&lt;p&gt;被忽略的另一个事实是：尽管违背所有的可能性，但是一只抹香鲸确实突然间在距离一颗行星表面几英里的高度出现了。&lt;/p&gt;
&lt;p&gt;对于一只鲸鱼来说，这并不是一个很正常的位置，所以这只可怜的无辜生物并没有多少时间建立起自己作为一只鲸鱼的身份认同，反倒建立起了自己不再是一只鲸鱼的身份认同。&lt;/p&gt;
&lt;p&gt;这样的想法从它诞生那一刻起便贯穿它整个的一生，直到它的生命结束。&lt;/p&gt;
&lt;p&gt;啊……发生了什么？它想。&lt;/p&gt;
&lt;p&gt;嗯，先等等，我是谁？&lt;/p&gt;
&lt;p&gt;有人吗？&lt;/p&gt;
&lt;p&gt;我为什么会在这里？我生活的目标是什么？&lt;/p&gt;
&lt;p&gt;我问“我是谁”时是什么意思？&lt;/p&gt;
&lt;p&gt;冷静，现在试着去理解……嘿！这种感觉真有趣，是什么？这是……打哈欠，一种麻刺的感觉在我的……我的……对了，我想我最好先给东西命名，这样我才能讨论身边的这个世界，就把这个部位叫做我的胃吧。&lt;/p&gt;
&lt;p&gt;太好了。喔，它变得这么强壮。嘿，我该把这种呼啸着经过我灵机一动称为头的那部分的声音叫做什么呢？或许我可以把它叫做……风！这是个好名字吗？应该算吧……或许等弄清楚它是干什么的之后我能为它想到一个更好的名字。它一定是种相当重要的东西，因为看起来这里有很多这玩意儿。嘿！这又是什么？这是……就叫做尾巴吧……是的，尾巴。嘿！我能够很灵活地摆动它，不是吗？喔！喔！感觉真爽！看上去没什么太大的用处，不过以后我会弄明白的。现在，我是不是已经建立起关于这些东西的一个连贯的体系了呢？&lt;/p&gt;
&lt;p&gt;还没有。&lt;/p&gt;
&lt;p&gt;没关系，嘿，这真是太让我兴奋了，有这么多东西要去寻找，有这么多东西值得期待，我简直眼花缭乱了……&lt;/p&gt;
&lt;p&gt;这是风吗？&lt;/p&gt;
&lt;p&gt;这次肯定有很多风，不是吗？&lt;/p&gt;
&lt;p&gt;喔！嘿！这个突然间朝着我很快地冲过来的东西是什么？非常、非常快。这么大，这么平坦，这么圆，它一定得有个听上去气派的名字，就像……嗯……哦……大地！就是它了！真是个好名字——大地！&lt;/p&gt;
&lt;p&gt;我想知道它会和我成为朋友吗？&lt;/p&gt;
&lt;p&gt;一声猛烈撞击后，余下的全都是寂静。&lt;/p&gt;
&lt;p&gt;非常奇怪，当这盆牵牛花下坠时，它脑海中划过的念头居然是，哦，不，千万别再来一次了。许多人都曾经推测，如果我们能够确切地知道这盆牵牛花为什么会这么想的话，那么我们对宇宙的了解会比现在深入得多。 &lt;/p&gt;
&lt;p&gt;=== 第十九章 ===&lt;/p&gt;
&lt;p&gt;“我们要带上这个机器人吗？”福特厌恶地看着马文说。马文正笨拙地站在角落里的一株小棕榈树下面。&lt;/p&gt;
&lt;p&gt;赞福德盯着镜面屏幕，上面正在显示黄金之心号刚刚着陆的那片荒凉大地的全景。&lt;/p&gt;
&lt;p&gt;“哦，这个机器人幻想狂。”他回答说，“是的，我们要带上他。”&lt;/p&gt;
&lt;p&gt;“可是你指望这个狂躁而又沮丧的机器人能做些什么呢？”&lt;/p&gt;
&lt;p&gt;“你认为你自己有麻烦，”马文说，仿佛是对着一具刚刚入殓的尸体发表演说，“可是设想一下你是一个狂躁而又沮丧的机器人吧，那时你才知道真正的麻烦是什么滋味。那时你会怎么办？不，别费心回答这个问题了，即使我不知道答案。我比你聪明5万倍，要我尝试着按照你的水平去思考简直让我头痛不已。”&lt;/p&gt;
&lt;p&gt;崔莉恩突然从自己的房间闯进来。&lt;/p&gt;
&lt;p&gt;“我的小白鼠跑掉了！”她说。&lt;/p&gt;
&lt;p&gt;赞福德的两张脸上都没有表现出任何担忧和关切的神，隋。&lt;/p&gt;
&lt;p&gt;“让你的小白鼠见鬼去吧。”他说。&lt;/p&gt;
&lt;p&gt;崔莉恩心烦意乱地望了他一眼，又—次失望了。&lt;/p&gt;
&lt;p&gt;她的话也许会引起更大的关注，如果大家意识到人类其实只是那颗叫做地球的行星上第三聪明的生命形式，而不是第二（大部分独立观察家普遍都持这种看法）的话。&lt;/p&gt;
&lt;p&gt;“下午好，孩子们。”&lt;/p&gt;
&lt;p&gt;这个声音很熟悉，但又很不同，是一个女家长的腔调。船上的人来到气闸舱门前，准备前往外面的行星表面的时候，这个声音响了起来。&lt;/p&gt;
&lt;p&gt;他们迷惑地互相看着。&lt;/p&gt;
&lt;p&gt;“是我们的电脑。”赞福德解释说，“我发现它有一种备用的应急个性，我想这是为了能更好地工作。”&lt;/p&gt;
&lt;p&gt;“这将是你们踏上一个新的奇怪行星上的第一天，”艾迪的新声音继续道，“所以我希望你们大家都穿得暖和点儿，不要和任何眼睛长得像虫子的调皮怪物玩耍。”&lt;/p&gt;
&lt;p&gt;赞福德不耐烦地拍打了几下舱门。&lt;/p&gt;
&lt;p&gt;“对不起，”他说，“我认为规则灵活点会更好些。”&lt;/p&gt;
&lt;p&gt;“哼！”电脑厉声道，“这是谁说的？”&lt;/p&gt;
&lt;p&gt;“能请你打开这扇舱门吗，电脑？”赞福德说，极力压制着火气。&lt;/p&gt;
&lt;p&gt;“除非刚才说话的人道歉。”电脑不容置疑地说，同时关闭了几个神经键。&lt;/p&gt;
&lt;p&gt;“哦，上帝，”福特喃喃地说着，靠到舱壁上。他开始从1数到10.他总是绝望地担心有一天那些有知觉的生命形式会忘掉怎么数数。因为只有凭借数数，人类才能证明他们自己相对于电脑的独立性。&lt;/p&gt;
&lt;p&gt;“快点。”艾迪严厉地说。&lt;/p&gt;
&lt;p&gt;“电脑……”赞福德刚开了个头。&lt;/p&gt;
&lt;p&gt;“我在等着，”艾迪打断他说，“如果有必要，我可以等上一整天……”&lt;/p&gt;
&lt;p&gt;“电脑……”赞福德又说道，他希望能找到一些巧妙的理由来说服电脑，并且已经决定不在它的地盘上和它斗气，“如果你还不赶快开门的话，我就会直接冲进你的主数据库，删掉一大堆东西，重新给你编程，你明白吗？”&lt;/p&gt;
&lt;p&gt;艾迪一听之下镇住了，停了—会儿，开始思考这个问题。&lt;/p&gt;
&lt;p&gt;福特继续轻声数着。这也许是你能对电脑做的最具挑战性的事了，就好比你冲到一个人面前，不停地说，混蛋……混蛋……混蛋……混蛋……&lt;/p&gt;
&lt;p&gt;最后，艾迪终于轻声道：“我看，我们以后会花些时间，好好理顺咱们之间的关系。”接着，舱门打开了。&lt;/p&gt;
&lt;p&gt;一股冰冷的风迎面吹宋。他们裹紧自己的身子，走下搭在曼格拉斯贫瘠土地上的舷梯。&lt;/p&gt;
&lt;p&gt;“到时候大家都会泪流满面，我知道。”艾迪在他们身后吼道，关上了舱门。&lt;/p&gt;
&lt;p&gt;几分钟过后，在一道完全出乎他意料的命令下，他再一次打开、关闭了这扇舱门。 &lt;/p&gt;
&lt;p&gt;=== 第二十章 ===&lt;/p&gt;
&lt;p&gt;一行五人缓慢地走在荒芜的土地上。这一小片是单调的灰色，那一小片是单调的褐色，余下的则根本没法让人提起兴趣多看一眼。整片土地就像一块干涸的沼泽，寸草不生，上面覆盖着足有一英寸厚的灰。气温很低。&lt;/p&gt;
&lt;p&gt;赞福德显然对这样的景象感到很沮丧。他脱离了队伍，独自一人大步朝前走去，很快便消失在一个凸起的土丘背后。&lt;/p&gt;
&lt;p&gt;迎面吹来的风刺痛了阿瑟的眼睛和耳朵，带着腐臭味的稀薄空气箍紧了他的喉咙。然而，受刺激最深的却是他的精神。&lt;/p&gt;
&lt;p&gt;“真是不可思议……”他说，声音传进自己的耳朵，他自己都觉得有点儿别扭。空气太稀薄，声音传播效果很差。&lt;/p&gt;
&lt;p&gt;“叫我说，真是个荒凉的洞窟。”福特说，“猫屎也比这儿有趣得多。”他满腹怨气。在整个银河系的所有的星系里的所有的行星中间——许多都狂野而奇异，沸腾着生命的喧嚣——难道他只能待在这样一个地方，而且还是在刚刚结束了15年被抛弃的生活之后？这里甚至连个热狗都没有！他弯下腰，翻开一块冰冷的泥土，但是下面却没有任何值得跨越几千光年的遥远路程来看一眼的东西。&lt;/p&gt;
&lt;p&gt;“不对，”阿瑟坚持说，“你不明白。这毕竟是我第一次站在另一颗行星的表面上……另一个完全陌生的世界……虽然这里状况太糟糕了，让人有点儿遗憾。”&lt;/p&gt;
&lt;p&gt;崔莉恩缩紧身子，颤抖着，皱起眉头。她可以发誓，自己的眼角瞟见了什么东西在移动。但当她朝那个方向望去时，看见的却只有静静停在那儿的飞船，离他们大约100码。&lt;/p&gt;
&lt;p&gt;几秒钟后，她才稍微安心了一点儿。因为赞福德站在土丘的顶端向他们招手，要他们过去。&lt;/p&gt;
&lt;p&gt;他看上去很兴奋，但由于这里稀薄的空气和呼啸的风，听不清楚他在喊些什么。&lt;/p&gt;
&lt;p&gt;当他们接近这块高地的边缘时，才发现它基本上是圆形的——是一座大约150码宽的环形山。环形山的外侧斜坡上分布着一些黑色和红色的块状物。他们停下来，观察了一会儿。块状物是湿的，还有弹性。&lt;/p&gt;
&lt;p&gt;突然间，他们恐怖地意识到这些实际上是新鲜的鲸鱼肉。&lt;/p&gt;
&lt;p&gt;在环形山顶端，他们见到了赞福德。&lt;/p&gt;
&lt;p&gt;“瞧。”他指着坑底说。&lt;/p&gt;
&lt;p&gt;中心处躺着一具已经炸裂的抹香鲸的尸体，它甚至还没来得及学会为自己的命运悲哀。沉默最后被崔莉恩喉头的一阵轻微的痉挛打破了。&lt;/p&gt;
&lt;p&gt;“我认为试着去埋葬它没有什么意义。”阿瑟喃喃地说，但立刻就恨不得自己没有说过这句话。&lt;/p&gt;
&lt;p&gt;“来吧。”赞福德说，一边朝坑底走下去。&lt;/p&gt;
&lt;p&gt;“什么，下去？”崔莉恩很不情愿地说。&lt;/p&gt;
&lt;p&gt;“是的。”赞福德说，“来吧，我有一些东西要给你们看。”&lt;/p&gt;
&lt;p&gt;“我们已经看见了。”崔莉恩说。&lt;/p&gt;
&lt;p&gt;“不是这个，”赞福德说，“另外的东西。来n巴。”&lt;/p&gt;
&lt;p&gt;可大家仍然犹豫不决。&lt;/p&gt;
&lt;p&gt;“来吧，”赞福德坚持道，“我已经找到了一条进去的通道。”&lt;/p&gt;
&lt;p&gt;“进去？”阿瑟不安地问。&lt;/p&gt;
&lt;p&gt;“进入这颗行星的！一条地下通道，鲸鱼的撞击把它震开了，我们现在就可以进去。我们将进入一个500万年以来从没有人打扰过的世界，进入时间本身的深处……”&lt;/p&gt;
&lt;p&gt;马文又开始讽刺地哼哼起来。&lt;/p&gt;
&lt;p&gt;赞福德敲了他一下，他这才闭上嘴巴。&lt;/p&gt;
&lt;p&gt;他们全都恶心地战栗着，跟在赞福德身后下到环形山的坑底，尽量不去看那只不幸的家伙。&lt;/p&gt;
&lt;p&gt;“生活，”马文悲哀地说，“厌恶它或者忽略它，总之不可能喜欢它。”&lt;/p&gt;
&lt;p&gt;地面在鲸鱼撞击的地方凹陷下去，露出一个走廊和通道的网络，大部分已经被落进去的碎石和鲸鱼内脏堵塞住了。赞福德必须清理出一条路，才能进入其中任何一条通道。不过马文干起这个来要快得多。阴冷潮湿的空气从入口处吹出来。赞福德用电筒朝里面照照，一片积满尘土的黑暗，什么都看不见。&lt;/p&gt;
&lt;p&gt;“根据传说，”他说，“曼格拉斯人大部分的时间都在地下度过。”&lt;/p&gt;
&lt;p&gt;“为什么？”阿瑟问，“星球表面已经被污染得太严重？人口过剩？”&lt;/p&gt;
&lt;p&gt;“不，我想不是的。”赞福德说，“我认为他们只是不太喜欢地面。”&lt;/p&gt;
&lt;p&gt;“你确信你知道自己在干些什么吗？”崔莉恩说，不安地望着前面的一片黑暗，“我们已经被攻击过一次了，这你可别忘了。”&lt;/p&gt;
&lt;p&gt;“你瞧，宝贝儿，我向你保证，目前这颗星球上的总人口数就是零加上我们四个。来吧，我们进去。嗯，嘿，地球人……”&lt;/p&gt;
&lt;p&gt;“我有名字，叫阿瑟。”阿瑟说。&lt;/p&gt;
&lt;p&gt;“哦，是的，你带着这个机器人把守这边的通道出口，行吗？”&lt;/p&gt;
&lt;p&gt;“把守？”阿瑟问，“守什么？你刚才还说这里没有其他人啊。”&lt;/p&gt;
&lt;p&gt;“是的，嗯，只是为了安全，行了吧？”赞福德说。&lt;/p&gt;
&lt;p&gt;“谁的安全？你的还是我的？”&lt;/p&gt;
&lt;p&gt;“好伙计。得了，我们走吧。”&lt;/p&gt;
&lt;p&gt;赞福德钻进通道，后面跟着崔莉恩和福特。&lt;/p&gt;
&lt;p&gt;“好吧，我希望你们全都倒霉。”阿瑟抱怨道。&lt;/p&gt;
&lt;p&gt;“别担心，”马文附和说，“他们会的。”&lt;/p&gt;
&lt;p&gt;只几秒钟，他们便从阿瑟的视线里消失了。&lt;/p&gt;
&lt;p&gt;阿瑟恼怒地绕着圈跺脚，后来才发现鲸鱼的这块墓地并不是跺脚的好地方。&lt;/p&gt;
&lt;p&gt;马文恨恨地盯着他看了一会儿，然后转过身去。&lt;/p&gt;
&lt;p&gt;赞福德在通道内飞快地向前走，其实他也很紧张，只不过是通过果敢地大步前行掩饰而已。他用手中的电筒四下照着。周围的墙上贴着深色瓷砖，摸上去冰凉，空气中弥漫着浓重的腐臭味。&lt;/p&gt;
&lt;p&gt;“瞧这里，我怎么告诉你们来着？”他说，“这是一个曾经有人居住过的星球。曼格拉斯。”他说着，一边走过布满碎片和废墟的铺着瓷砖的地板。&lt;/p&gt;
&lt;p&gt;崔莉恩不可避免地想起了伦敦的地铁，虽然它远没有这里这么肮脏。&lt;/p&gt;
&lt;p&gt;每隔一段距离，墙上的瓷砖就让位于一大片马赛克——浅颜色，构成简单的棱角图案。崔莉恩停下来研究其中的一片，但是什么名堂都没看出来。于是她招呼了赞福德一声。&lt;/p&gt;
&lt;p&gt;“嘿，你知道这些奇怪的符号是什么意思吗？”&lt;/p&gt;
&lt;p&gt;“我想它们只是某种奇怪的符号。”赞福德说，甚至没有回过头来看一眼。&lt;/p&gt;
&lt;p&gt;崔莉恩耸了耸肩，快步跟上他。&lt;/p&gt;
&lt;p&gt;通道左右两侧不时会出现一些通往小房间的门，福特发现里面满是被遗弃的电脑设备。他把赞福德拖进其中一间，想仔细看一看。崔莉恩跟在后面。&lt;/p&gt;
&lt;p&gt;“你瞧，”福特说，“你推测这里就是曼格拉斯……”&lt;/p&gt;
&lt;p&gt;“是啊，”赞福德说，“那个录音我们不都听到了吗？”&lt;/p&gt;
&lt;p&gt;“是的，所以我才接受了这个推断——只是在当时。可你几乎从没说过你在偌大一个银河系中是如何找到它的。不会仅仅依靠星际地图吧，这是肯定的。”&lt;/p&gt;
&lt;p&gt;“研究、政府档案、侦察工作，再加上一点儿碰巧的猜测。其实很简单。”&lt;/p&gt;
&lt;p&gt;“然后你就偷了黄金之心号来找？”&lt;/p&gt;
&lt;p&gt;“我偷它是为了寻找许多东西。”&lt;/p&gt;
&lt;p&gt;“许多东西？”福特吃惊地说，“比如什么？”&lt;/p&gt;
&lt;p&gt;“我也不知道。”&lt;/p&gt;
&lt;p&gt;“什么？”&lt;/p&gt;
&lt;p&gt;“我也不知道我在寻找些什么。”&lt;/p&gt;
&lt;p&gt;“怎么会不知道呢？”&lt;/p&gt;
&lt;p&gt;“因为……因为……我想，如果知道的话，我就用不着去寻找了。”&lt;/p&gt;
&lt;p&gt;“什么，你疯了吗？”&lt;/p&gt;
&lt;p&gt;“这倒真是我还没有排除的一种可能。”赞福德平静地说，“我对自己的了解只能局限于我自己的脑子在当前情况下的实际工作状况，我想它当前的情况并不太好。”&lt;/p&gt;
&lt;p&gt;很长一段时间都没有人开口，福特则盯着赞福德，心里突然间充满忧虑。&lt;/p&gt;
&lt;p&gt;“听着，老朋友，如果你想……”最后还是福特打破了沉默。&lt;/p&gt;
&lt;p&gt;“不，等一下……我得告诉你一个情况，”赞福德说，“我从来都是率性而为。我突然间想到了要干件什么事，然后，嘿，为什么不呢？我就去干了。我想自己将成为银河系的总统，然后这件事就发生了，这很简单。我决定要偷这艘飞船，我决定要去寻找曼格拉斯，然后这些事就发生了。是的，我策划好了怎样最好地完成这项工作，于是策划便取得了成功。这就像你有一张银河系信用卡，总能用出去。可是，每当我停下来，开始思考——为什么我想干这件事、我是如何想出办法去干这件事的——我就会产生一种强烈的愿望，要停止这种思考。就像现在。其实说出这个情况就费了很大的劲儿。”&lt;/p&gt;
&lt;p&gt;赞福德停顿了一下，于是又出现了一阵沉默。然后他皱着眉头继续说道：“昨天晚上，我又在担心这件事，担心我脑子里的这部分似乎工作得不太正常。然后我突然意识到，之所以出现这样的情况，似乎是因为有别的什么人在使用我的脑子想一些好主意，却没有跟我打招呼。我把这两个念头放在一起，于是认定：极有可能是什么人为了这样的目的而锁闭了我脑子里的这个部分，所以我自己才不能使用这部分。我开始想，是否有什么办法可以检查一下。&lt;/p&gt;
&lt;p&gt;“我来到飞船的医疗舱，给自己接上了脑部照影的屏幕。我在两个脑袋上接上了所有主要的检查项目——也就是我担任银河系总统的任命正式批准生效之前，政府医疗官员对我进行的所有检查项目。结果显示没有任何问题，至少没有发现任何意想不到的情形。照影显示我很聪明、富有想像力、没有责任心、不值得信任、性格外向，总之没有任何你预料不到的，也没有任何异常。于是我开始进一步检查，完全是随机的。没有任何问题。我又把一个脑袋的照影结果叠加在另一个脑袋的照影结果上面。还是没有任何问题。最后我完全绝望了，看来我最大的问题无非就是偏执狂。在把设备收拾起来之前，我做的最后一件事情是透过一个绿色的滤波器观察重叠在一起的照影图片。你还记得吧，我小时候总是迷信绿颜色？我一直想当一名贸易侦察机的驾驶员？”&lt;/p&gt;
&lt;p&gt;福特点了点头。&lt;/p&gt;
&lt;p&gt;“结果我终于找到了，”赞福德说，“就像光天化日之下一样清楚。两个大脑各自的中部，就是只与另一个脑发生联系、与别的东西无关的那个部位，有个狗娘养的灼烧掉了那儿所有的神经键，并且造成了那两块区域的电子损伤。”&lt;/p&gt;
&lt;p&gt;福特盯着他，惊呆了。崔莉恩变得脸色苍白。&lt;/p&gt;
&lt;p&gt;“有人对你干了这个？”福特喃喃地问。&lt;/p&gt;
&lt;p&gt;“是的。”&lt;/p&gt;
&lt;p&gt;“可你知道是谁吗？或者，为什么？”&lt;/p&gt;
&lt;p&gt;“为什么？我只能猜测了。不过我倒是知道这个狗娘养的是谁。”&lt;/p&gt;
&lt;p&gt;“你知道？你怎么知道的呢？”&lt;/p&gt;
&lt;p&gt;“因为他把自己的姓名首字母烙在那些神经键上。他把首字母留在那儿，故意让我看见。”&lt;/p&gt;
&lt;p&gt;福特惊恐地看着他，感觉自己的皮肤上似乎有什么东西在蠕动。&lt;/p&gt;
&lt;p&gt;“首字母？烙在你的大脑里？”&lt;/p&gt;
&lt;p&gt;“是的。”&lt;/p&gt;
&lt;p&gt;“可是，他是谁呢，看在上帝的份上？”&lt;/p&gt;
&lt;p&gt;赞福德沉默地看了他一会儿，然后把目光移开了。&lt;/p&gt;
&lt;p&gt;“Z.B.（赞·毕）。”他平静地说。&lt;/p&gt;
&lt;p&gt;就在这个时候，他们身后的一扇金属百叶窗突然砰的一声关上了，一阵烟雾开始在房间里弥漫起来。&lt;/p&gt;
&lt;p&gt;“待会儿我再给你说这件事。”赞福德窒息着说，三人赶紧退出房间。 &lt;/p&gt;
&lt;p&gt;=== 第二十一章 ===&lt;/p&gt;
&lt;p&gt;在曼格拉斯的表面上，阿瑟郁闷地走来走去。&lt;/p&gt;
&lt;p&gt;细心的福特特意把自己的《银河系漫游指南》留给他打发时间。他随便按下几个键。&lt;/p&gt;
&lt;p&gt;《银河系漫游指南》是一本编辑得相当不均衡的书，里面包含了大量的章节，其内容仅仅在当时的编辑看来似乎还不错，值得选入。&lt;/p&gt;
&lt;p&gt;其中之一（就是阿瑟现在刚刚翻到的）是想像的关于维特。沃佳吉格的经历。他是一个马克希姆佳伦大学的年轻学生，从事着一项聪明人的学术事业，研究古代语言学、转换生成规则，以及历史感知和谐波理论。然而，一天晚上，他和赞福德·毕博布鲁克斯喝了几杯泛银河系含漱爆破药，于是他开始越来越为一个问题所困扰，这个问题就是过去这些年来他买的所有圆珠笔最后都怎么样了。&lt;/p&gt;
&lt;p&gt;接下来就是一段长时间的艰苦研究。在这段时间内他拜访了整个银河系中所有主要的圆珠笔遗失中心，最后终于得出一个很有些离奇的理论，当时还引起了公众极大的兴趣。他认为，在宇宙中的某个地方，和所有居住着人形生物、爬行类生物、鱼形生物、直立树形生物以及具有超级智慧的蓝色阴影的行星一样，还存在着一颗全部由圆珠笔形生命形式占据的行星。所有无人看管的圆珠笔都会通过空间中的虫洞无声无息地滑向这颗星球，他们知道在这个世界里自己能享受到一种独一无二的圆珠笔形生命状态，享受到一种完全平等的美好生活。&lt;/p&gt;
&lt;p&gt;这些说法作为一种理论还是相当令人愉快的，但最后维特。沃佳吉格突然宣布自己已经找到了这颗行星，并且已经在那里工作了一段时间，为一个廉价的绿色可回收圆珠笔家庭当司机，驾驶一辆豪华轿车。于是，他被带走关押起来，写了一本书，最后遭到放逐——这是那些决心当众出乖露丑的人通常的下场。&lt;/p&gt;
&lt;p&gt;有一天，一支探险队被派往沃佳吉格宣称的那颗行星所在的位置，他们只发现了一颗小行星，上面孤零零地住着一个老人，不断反复宣称一切都不是真的。当然，后来才发现他在撒谎。&lt;/p&gt;
&lt;p&gt;这个事件最后仍旧存有疑问。第一点是：神秘地每年存入他在勃兰蒂斯沃根银行账户的那6万牵牛星元，第二点当然就是赞福德·毕博布鲁克斯所从事的利润高昂的二手圆珠笔生意。&lt;/p&gt;
&lt;p&gt;阿瑟看完这些，随手把书放下了。&lt;/p&gt;
&lt;p&gt;机器人仍旧坐在那儿，一副迟钝的样子。&lt;/p&gt;
&lt;p&gt;阿瑟站起身来，爬到环形山顶端。他沿着环形山走着，看见两颗太阳正壮观地沉入曼格拉斯的地干线。&lt;/p&gt;
&lt;p&gt;他回到坑底，唤醒了机器人。毕竟，与一个狂躁的机器人说说话总比没人交谈强。&lt;/p&gt;
&lt;p&gt;“天快黑了。”他说，“你瞧，机器人，星星已经出来了。”&lt;/p&gt;
&lt;p&gt;处在暗黑星云的中心，能看见的星星很少，而且很微弱，不过它们确实在那儿，可以看见。&lt;/p&gt;
&lt;p&gt;机器人顺从地看了星星一眼，然后重又垂下头。&lt;/p&gt;
&lt;p&gt;“我知道，”他说，“悲惨啊，对吗？”&lt;/p&gt;
&lt;p&gt;“但这是日暮景象！在我最疯狂的梦里也从来没有出现过如此壮观的景象……两颗太阳！简直像是两座火焰的山峰燃烧在太空里。”&lt;/p&gt;
&lt;p&gt;“我可见得多了。”马文说，“没什么了不起。”&lt;/p&gt;
&lt;p&gt;“我的家乡只有一颗太阳，”阿瑟坚持道，“我来自一颗叫做地球的行星，这你知道。”&lt;/p&gt;
&lt;p&gt;“是的，我知道。”马文说，“你总是不断提到那儿。听上去是个很可怕的地方。”&lt;/p&gt;
&lt;p&gt;“噢，才不是呢，那儿很美。”&lt;/p&gt;
&lt;p&gt;“上面有海洋吗？”&lt;/p&gt;
&lt;p&gt;“噢，当然。”阿瑟叹了一口气说，“波涛翻滚的辽阔的蔚蓝色大海……”&lt;/p&gt;
&lt;p&gt;“我最受不了海洋。”马文说。&lt;/p&gt;
&lt;p&gt;“告诉我，”阿瑟好奇地问，“你和别的机器人处得好吗？”&lt;/p&gt;
&lt;p&gt;“我恨他们。”马文说，“你要去哪儿？”&lt;/p&gt;
&lt;p&gt;阿瑟再也忍受不了了，他已经站起身来。&lt;/p&gt;
&lt;p&gt;“我想我需要再去溜一圈。”他说。&lt;/p&gt;
&lt;p&gt;“我不怪你。”马文说，然后他在一秒钟内数了5970亿只羊，再一次进入梦乡。&lt;/p&gt;
&lt;p&gt;阿瑟双手拍打了几下自己的身体，好让血液系统工作得更卖力些，然后又开始沿着环形山壁往上爬。&lt;/p&gt;
&lt;p&gt;因为这里的空气是如此稀薄，也因为这里没有月亮，所以黑夜来临得特别快，到这时已经是漆黑一片。正因为如此，阿瑟在丝毫没有察觉到他的情况下直接走向这个老人。 &lt;/p&gt;
&lt;p&gt;=== 第二十二章 ===&lt;/p&gt;
&lt;p&gt;他背对阿瑟站在那儿，望着最后一线光芒沉入地平线以下的黑暗之中。他的身材算高的，已经上了年纪，穿着一件灰色单袍。他一会儿转过身来的时候，可以看到他的脸瘦削、高贵、饱经忧患但却很慈祥，属于那种你愿意看到的脸。但此时他还没有转过身来，甚至没有对阿瑟的惊呼声做出任何反应。&lt;/p&gt;
&lt;p&gt;太阳的余辉终于完全消失了，他这才转过身来。他的脸仍然被来自某个地方的光线照亮，当阿瑟寻找这光线的来源时，他看见几码之外停着一架小型飞行器——阿瑟猜测这是一艘小气垫船，周围散发出黯淡的光芒。&lt;/p&gt;
&lt;p&gt;老人望着阿瑟，看上去有些悲伤。&lt;/p&gt;
&lt;p&gt;“你选择了一个寒冷的夜晚来访问我们这个已经死去的星球。”他说。&lt;/p&gt;
&lt;p&gt;“你……你是谁？”阿瑟结结巴巴地问。&lt;/p&gt;
&lt;p&gt;老人把目光移开了。又一阵悲伤的表情划过他的脸。&lt;/p&gt;
&lt;p&gt;“我的名字并不重要。”他说。&lt;/p&gt;
&lt;p&gt;他看上去心事重重，显然并不热衷于交谈。阿瑟感到很尴尬。&lt;/p&gt;
&lt;p&gt;“我……嗯……你让我大吃一惊……”他断断续续地说。&lt;/p&gt;
&lt;p&gt;老人再次望向他，轻轻地扬起眉毛。&lt;/p&gt;
&lt;p&gt;“嗯？”他说。&lt;/p&gt;
&lt;p&gt;“我说你让我大吃一惊。”&lt;/p&gt;
&lt;p&gt;“别害怕，我不会伤害你的。”&lt;/p&gt;
&lt;p&gt;阿瑟皱起眉头看着他，“可你朝我们开火了！我是指那些导弹……”他说。&lt;/p&gt;
&lt;p&gt;老人朝环形山的坑底望去。马文的眼睛发出的微光在鲸鱼巨大的尸体上形成一道淡淡的红色阴影。&lt;/p&gt;
&lt;p&gt;他轻声笑了笑。&lt;/p&gt;
&lt;p&gt;“那是一套自动系统，”他微微叹了一口气，“安装在星球地下深处的那些古代的电脑在千万年的黑暗中一直运行着，一个又一个世代沉重地压在它们布满灰尘的数据库上。我想，偶尔一次发射只不过是它们希望能稍稍改变一点儿这种千篇一律的单调的努力罢了。”&lt;/p&gt;
&lt;p&gt;他看着阿瑟，庄重地说：“你知道，我是一个科学的狂热信奉者。”&lt;/p&gt;
&lt;p&gt;“哦……嗯，真的吗？”阿瑟说，老人这种和善而又怪异的态度已经开始让他感到有点惊惶不安了。&lt;/p&gt;
&lt;p&gt;“晤，是的。”老人说，随即闭上了嘴。&lt;/p&gt;
&lt;p&gt;“哦，嗯……”阿瑟突然产生了一种奇特的感觉，觉得自己就像一个正在和别人的老婆通奸的男人，看见那个当丈夫的走进房间，换了条裤子，对天气发表一通没头没脑的评论后又离开了。&lt;/p&gt;
&lt;p&gt;“你好像不太自在。”老人礼貌地问。&lt;/p&gt;
&lt;p&gt;“嗯，不……哦，是的。实际上，你瞧，我们其实并没有指望在这颗星球上找到什么人。据我了解，你们应该都死了或者……”&lt;/p&gt;
&lt;p&gt;“死？”老人说，“天啊，当然没有，我们只不过是睡了。”&lt;/p&gt;
&lt;p&gt;“睡了？”阿瑟难以置信。&lt;/p&gt;
&lt;p&gt;“是的，好渡过经济衰退。”老人说，显然并不太在意阿瑟能不能真正理解他所说的哪怕是一个词。&lt;/p&gt;
&lt;p&gt;于是阿瑟不得不再次提醒他。&lt;/p&gt;
&lt;p&gt;“嗯，经济衰退？”&lt;/p&gt;
&lt;p&gt;“是的，你瞧，500万年以前，整个银河系的经济崩溃了，而订制行星属于奢侈品。你瞧……”&lt;/p&gt;
&lt;p&gt;他停顿了一下，望着阿瑟。&lt;/p&gt;
&lt;p&gt;“你知道我们建造行星，是吧？”他严肃地问。&lt;/p&gt;
&lt;p&gt;“噢，是的，”阿瑟说，“我了解一点儿……”&lt;/p&gt;
&lt;p&gt;“诱人的贸易啊。”老人说，眼里流露出一丝怀念，“建造海岸线是我最喜欢的工作了，尤其是修建海湾，简直其乐无穷……别的也一样。”他说，一边试图重新找回自己的思路，“可是衰退期到来了。我们认为，如果在睡眠状态下度过这个时期，会减少许多麻烦。所以我们设定了程序，让电脑在衰退期完全结束后重新唤醒我们。”&lt;/p&gt;
&lt;p&gt;老人忍住一个哈欠，继续说：“这些电脑直接与银河系股票市场的价格相联，你明白吗，所以一旦别的什么人重建了经济，足够负担得起我们昂贵的服务，我们就会被全部唤醒。”&lt;/p&gt;
&lt;p&gt;一直是左翼《卫报》忠实读者的阿瑟听了这番话也不由得非常震惊。&lt;/p&gt;
&lt;p&gt;“应该不是什么令人愉快的选择，不是吗？”&lt;/p&gt;
&lt;p&gt;“真的？”老人温和地问道，“对不起，我有点儿跟不上形势了。”&lt;/p&gt;
&lt;p&gt;他指指坑底。&lt;/p&gt;
&lt;p&gt;“那是你的机器人吗？”他问。&lt;/p&gt;
&lt;p&gt;“不是。”一个金属声音从下面传来，“我是我自己的。”&lt;/p&gt;
&lt;p&gt;“如果你把它叫做机器人的话，”阿瑟喃喃道，“这玩意儿更像是某种电子愤怒机器。”&lt;/p&gt;
&lt;p&gt;“带它上来。”老人说。老人突然发出一句命令，让阿瑟吃了一惊。他招呼了马文，于是他开始往斜坡上爬，一瘸一拐装出瘸子的模样，实际上他并不瘸。&lt;/p&gt;
&lt;p&gt;“我改主意了。”老人说，“还是把它留在这儿。你必须跟我走，马上就会出大事。”他转向他的飞行器，虽然并没有给出什么明显的信号，但它正从黑暗中向他们飘来。&lt;/p&gt;
&lt;p&gt;阿瑟低头朝马文看去，他正在艰难地转身，重新回到坑底，一边还在咕哝着什么。&lt;/p&gt;
&lt;p&gt;“来吧。”老人对他喊道，“快来，不然就晚了。”&lt;/p&gt;
&lt;p&gt;“晚了？”阿瑟问，“什么晚了？”&lt;/p&gt;
&lt;p&gt;“你叫什么名字，人类？”&lt;/p&gt;
&lt;p&gt;“邓特。阿瑟·邓特。”阿瑟回答说。&lt;/p&gt;
&lt;p&gt;“我说的晚了，指的是不赶快的话，你就会成为已故的邓特、阿瑟·邓特。”老人严厉地说，“这是一种威胁，你瞧。”他疲倦而衰老的眼中又一次流露出一丝忧伤，“我自己从来就不太擅长干这种事，但我听说它们非常有效。”&lt;/p&gt;
&lt;p&gt;阿瑟直眨巴眼睛。&lt;/p&gt;
&lt;p&gt;“真是个怪人。”他自言自语地说。&lt;/p&gt;
&lt;p&gt;“你说什么？”老人问。&lt;/p&gt;
&lt;p&gt;“哦，没什么，对不起。”阿瑟窘迫地说，“好了，我们去哪儿呢？”&lt;/p&gt;
&lt;p&gt;“上我的空中飞车。”老人说，让阿瑟跨进静静地停在他们身旁的飞行器里，“我们将进入这颗行星的地下深处，在那里，我们的种族正在从500万年的沉睡中苏醒过来。曼格拉斯醒过来了。”&lt;/p&gt;
&lt;p&gt;坐在老人身边，阿瑟不由自主地开始颤抖起来。一阵无声的震动之后，这架奇怪的飞行器飞向夜空。他感到相当不安。&lt;/p&gt;
&lt;p&gt;他看着老人，他的脸被仪表盘上微弱的灯光照亮了。&lt;/p&gt;
&lt;p&gt;“对不起，”他对老人说，“你叫什么名字？”&lt;/p&gt;
&lt;p&gt;“我的名字？”老人说，同样的悲伤又出现在他的脸上。他顿了一下，“我的名字，”他说，“叫做司拉提巴特法斯特。”&lt;/p&gt;
&lt;p&gt;阿瑟哽了一下。&lt;/p&gt;
&lt;p&gt;“能请你再说一遍吗？”他说。&lt;/p&gt;
&lt;p&gt;“司拉提巴特法斯特。”老人平静地重复了一遍。&lt;/p&gt;
&lt;p&gt;“司拉提巴特法斯特？”&lt;/p&gt;
&lt;p&gt;老人阴沉地看着他。&lt;/p&gt;
&lt;p&gt;“我说过，这些并不重要。”他说。&lt;/p&gt;
&lt;p&gt;空中飞车在夜色中航行着。 &lt;/p&gt;
&lt;p&gt;=== 第二十三章 ===&lt;/p&gt;
&lt;p&gt;一个重要而普遍的事实是，事物并非总是如它们所看上去的那样。比如，在那颗叫做地球的行星上，人类总是认为自己比海豚聪明，因为他们创造了如此之多的成就——车轮、纽约、战争等等——而海豚所做的全部事情就是在水中游荡。但另一方面，海豚总是认为自己比人类聪明得多——基于几乎完全相同的原因。&lt;/p&gt;
&lt;p&gt;非常奇怪的是，海豚早就知道了地球日益迫近的毁灭命运，而且费了很大的努力来警告人类这一危机。但是它们大部分的信息传递都被人类误读为有趣的顶球尝试，或者是为了求得美味而吹的口哨。所以，它们最终放弃了努力，在沃贡人到达地球之前不久通过它们自己的方式离开了地球。&lt;/p&gt;
&lt;p&gt;海豚的最后一条信息被误读为一种复杂得让人吃惊的尝试，即一边吹着“星条旗”的口哨，一边向后翻两个筋斗穿过一个铁环。实际上，这条信息是在说：再见了所有鱼类，感谢你们。&lt;/p&gt;
&lt;p&gt;实际上，在这颗行星上只有一个物种比海豚聪明，他们在行为科学研究实验室里花费了大量时间，在人类身上进行着极其文明、极其精细的实验。但人类又一次完全错误地解读了双方之间的这种关系，之所以会出现这样的误读其实完全出于这些生物的精心安排。 &lt;/p&gt;
&lt;p&gt;=== 第二十四章 ===&lt;/p&gt;
&lt;p&gt;空中飞车悄无声息地穿行在寒冷的黑暗中，在曼格拉斯的沉沉夜幕里划出孤零零的一道微光。阿瑟的同伴似乎深深陷入了自己的思绪中。阿瑟好几次试图挑起交谈，他只是简单地用询问阿瑟是否舒服来敷衍几句，然后便重新恢复沉默。&lt;/p&gt;
&lt;p&gt;阿瑟试图估测他们前进的速度，但是车窗外的黑暗足如此彻底，他根本看不见任何可资参照的东西。飞车开动起来的感觉柔和而轻巧，几乎使他以为他们根本就没有移动。&lt;/p&gt;
&lt;p&gt;后来，一个小小的亮点出现在远处，短短几秒钟之内就变大了不少，阿瑟这才意识到这个光源正在以极高的速度朝他们驶来，于是他很想搞清楚这是一架什么样的飞行器。他凝视了半天，但看不出任何清晰轮廓。突然，他猛地倒抽一口气，因为他们乘坐的空中飞车猛然向下一沉，车头朝着地面冲去，感觉就像飞车即将坠毁一样。他们的相对速率大得让人不可思议，阿瑟几乎还没来得及吐出这口气，一切就结束了。他觉察到的下一件事是四周一片模模糊糊的银色。他使劲晃了晃脑袋，然后才发现一个黑点正在他们身后迅速缩小。几秒钟后，他终于意识到发生了什么。&lt;/p&gt;
&lt;p&gt;他们已经一头扎进了地下的一条隧道中。那种极高的速度就是他们自己的，是相对于地面一个固定洞口的高速度。刚才的光点便是这个涧口，隧道的入口。那一片模糊的银色则是隧道四周的墙面。很显然，他们是以好几百英里的时速直接冲进了这条隧道。&lt;/p&gt;
&lt;p&gt;他吓得闭上了眼睛。&lt;/p&gt;
&lt;p&gt;过了很长一段时间，他也没法去判断，他终于感觉到飞车的速度稍微降低了一点儿，又过了一会儿，他们开始缓慢地滑行，即将平稳地停下来。&lt;/p&gt;
&lt;p&gt;他睁开眼睛。他们仍然是在银色隧道中，正在穿越一个看上去由聚拢来的许多条隧道组成的交叉路口。他们最终停在一个由弯曲的钢铁构成的小房间中。另外还有几条隧道也通向这里。在这个房间的远端，阿瑟看到一个巨大的光环，微弱但令人恼火。说它令人恼火，是因为它对阿瑟的眼睛玩了一个小把戏，使视线不能准确地聚焦在它上面，也判断不出它究竟是近还是远。阿瑟猜测（其实大错而特错了）这也许是紫外线光。&lt;/p&gt;
&lt;p&gt;“地球人，”老人说，“我们现在已经深入到了曼格拉斯的心脏地带。”&lt;/p&gt;
&lt;p&gt;“你怎么知道我是地球人呢？”阿瑟好奇地问。&lt;/p&gt;
&lt;p&gt;“这些事情你慢慢就会清楚的。”老人轻轻地说，“至少，”他的声音里带着一丝怀疑，“比他们这会儿更清楚。”&lt;/p&gt;
&lt;p&gt;他继续道：“我有必要提醒你，我们接下来将会进入的房间其实并非真的存在于我们的星球上。它有点儿太……大了。我们将穿过一扇门，进入一片巨大的超空间领域。也许你会有点不安。”&lt;/p&gt;
&lt;p&gt;阿瑟紧张地哼哼了几声。&lt;/p&gt;
&lt;p&gt;司拉提巴特法斯特按下一个按钮，然后不是很有把握地补充说：“其实我也很紧张。坐稳了。”&lt;/p&gt;
&lt;p&gt;飞车笔直地朝前冲进光环。突然间，阿瑟对无限是个什么样子有了一种清晰的概念。&lt;/p&gt;
&lt;p&gt;实际上这并不是无限。无限看上去是扁平的，毫无意思。抬头仰望夜空就是仰望无限——距离广阔无垠，因而也就失去了意义。空中飞车进入的这个房间可以是任何东西，但决不是无限，它只是非常非常大，大得给人以无限的感觉，甚至比无限本身还要大。&lt;/p&gt;
&lt;p&gt;阿瑟感到天旋地转。空中飞车以最大速度前进着，他们穿过开阔的空间，把刚才进入的门甩往后面，成为他们身后那堵泛着微光的墙上的一个细不可见的小孔。&lt;/p&gt;
&lt;p&gt;那堵墙。&lt;/p&gt;
&lt;p&gt;那堵墙否定了一切想像——先引诱它，再击败它。这堵墙大得如此不可思议，又是透明的，以至于它的顶端、底部和两侧几乎不能被视线所捕捉。面对它时的那种眩晕的震撼简直能够杀死一个人。&lt;/p&gt;
&lt;p&gt;这堵墙极其平坦。看上去平直地向着两侧延伸，其实它是弯曲的，但这只有使用最高级的激光测量设备才能测出。经过13光秒的距离后，它的首尾会连接起来。换句话说，这堵墙围出了一个中空的空间，直径足有300万英里，中间充满难以想像的光。&lt;/p&gt;
&lt;p&gt;“欢迎，”司拉提巴特法斯特说，此时空中飞车就像一个小点，以3倍于音速的速度，难以察觉地在这个不可思议的空间中前进，“欢迎，”他说，“来到我们的工厂。”&lt;/p&gt;
&lt;p&gt;阿瑟以～种惊讶的恐慌盯着他。在他们前方，一段阿瑟判断不出、甚至猜测不出的距离之外，一组奇怪的悬浮物排列在空间中：一个个投下巨大阴影的球体，周围是金属和光形成的精细花纹。&lt;/p&gt;
&lt;p&gt;“这里，”司拉提巴特法斯特介绍说，“就是我们制造大部分行星的地方。”&lt;/p&gt;
&lt;p&gt;“你的意思是，”阿瑟说，一边试图组织自己的语言，“你们现在重新把这个地方开动起来了？”&lt;/p&gt;
&lt;p&gt;“不，不，天啊，不，”老人解释说，“不。目前的银河系还没有富裕到足够支付我们的产品的程度。我们被唤醒是为了接受一个非同寻常的委托，一些……很特别的客户，他们来自另一个维度。我们前方的东西……你也许有兴趣。”&lt;/p&gt;
&lt;p&gt;阿瑟顺着老人手指的方向看过去，终于分辨出了他所指的那座飘浮的结构。是这么多结构中，惟有它才有活动迹象，虽然这种迹象更多的只是一种微妙的感觉，而不是实实在在可以触摸得到的。&lt;/p&gt;
&lt;p&gt;正在这个时候，一道弧形的光在这座结构中闪了一下，照亮了它内部一片黑暗中的一些浮雕似的图案。这些图案是阿瑟所知道的，粗糙的布满斑点的形态，对他来说就像词语一样熟悉，像是他头脑中的储存物的一部分。整整几秒钟时间内，他静静地坐在那儿，仃凭这些形象在他的头脑中横冲直撞，试图找到什么地方安顿下来，形成意义。&lt;/p&gt;
&lt;p&gt;他大脑的一部分告诉他，他对眼前所看到的景象非常熟悉，清楚地知道这些图案代表着什么；与此同时，另一部分却又极力否定这样的想法，并且阻止他朝着这个方向进一步想下去。&lt;/p&gt;
&lt;p&gt;光又闪了一下。这一次没有任何疑问了。&lt;/p&gt;
&lt;p&gt;“地球……”阿瑟喃喃道。&lt;/p&gt;
&lt;p&gt;“喔，实际上应该足地球二号。”司拉提巴特法斯特愉快地说，“我们正在按照我们的原始蓝图制造一个副本。”&lt;/p&gt;
&lt;p&gt;一阵短暂的沉默。&lt;/p&gt;
&lt;p&gt;“你是想告诉我，”阿瑟缓缓说道，极力控制着自己，“是你们……制造了地球？”&lt;/p&gt;
&lt;p&gt;“噢，是的。”司拉提巴特法斯特说，“你曾经上过一个地方……我想应该是叫挪威吧？”&lt;/p&gt;
&lt;p&gt;“没有，”阿瑟说，“我没去过。”&lt;/p&gt;
&lt;p&gt;“真遗憾，”司拉提巴特法斯特说，“那是属于我的。是我的获奖作品，你知道。多么可爱的曲折海岸线啊。当我听说它被毁灭时，真是难过极了。”&lt;/p&gt;
&lt;p&gt;“你感到难过？”&lt;/p&gt;
&lt;p&gt;“是的。不过5分钟以后就好多了。真是一场令人震惊的混乱。”&lt;/p&gt;
&lt;p&gt;“什么？”阿瑟说。&lt;/p&gt;
&lt;p&gt;“老鼠发怒了。”&lt;/p&gt;
&lt;p&gt;“老鼠发怒了？”&lt;/p&gt;
&lt;p&gt;“哦，是的。”老人温和地说。&lt;/p&gt;
&lt;p&gt;“是的，好吧，我倒是希望狗啊、猫啊和鸭嘴兽什么的也这样，可是……”&lt;/p&gt;
&lt;p&gt;“哦，可是它们并没有付钱啊，明白吗？不是吗？”&lt;/p&gt;
&lt;p&gt;“你瞧，”阿瑟说，“如果我现在就放弃，然后疯掉，是不是能够节省你很多时间？”&lt;/p&gt;
&lt;p&gt;有那么一会儿，空中飞车在一阵尴尬的沉默中飞行着。然后，老人耐心地试图向阿瑟解释这一切。&lt;/p&gt;
&lt;p&gt;“地球人，你所居住的那颗行星是老鼠订制、付款和管理的。把它造出来有一个目的，但就在它实现这个目的之前5分钟，它被毁掉了。所以我们正在建造另外一个。”&lt;/p&gt;
&lt;p&gt;阿瑟整个脑子里只有一个词。&lt;/p&gt;
&lt;p&gt;“老鼠？”他说。&lt;/p&gt;
&lt;p&gt;“一点不错，地球人。”&lt;/p&gt;
&lt;p&gt;“你瞧，对不起，我们是在说那种小小的、灰色的、毛茸茸的、疯狂迷恋奶酪的、在60年代早期的肥皂剧中把女人们吓得在桌子上尖叫的生物吗？”&lt;/p&gt;
&lt;p&gt;司拉提巴特法斯特礼貌地咳嗽了一声。&lt;/p&gt;
&lt;p&gt;“地球人，”他说，“有时候真是很难适应你说话的方式。请记住，我在这颗叫做曼格拉斯的行星内部睡了整整500万年，因此一点儿也不知道你所说的什么60年代早期的肥皂剧。这些被你们称为老鼠的生物，你瞧，他们并非你们看上去的那样。他们是一些恰好进入了我们这个维度的具有超级智慧的泛维度生物。所有那些奶酪和尖叫都只是表面现象而已。”&lt;/p&gt;
&lt;p&gt;老人停顿了一下，同情地皱起了眉头。“我恐怕，他们是在你们身上作实验。”&lt;/p&gt;
&lt;p&gt;阿瑟思考了一秒钟，脸上的表情变得开朗起来。&lt;/p&gt;
&lt;p&gt;“哦，不，”他说，“我现在终于找到误解的根源了。不是这样的。你瞧，你所看到的其实足我们在它们身上作实验。它们常常被用于行为科学的研究，巴甫洛夫什么的。利用老鼠能进行各种测试。通过学习摇铃、走迷宫等等，可以分析自然的学习过程。通过对他们行为的观察，我们能够了解到我们自己的许多情况……”&lt;/p&gt;
&lt;p&gt;阿瑟的声音逐渐减弱。&lt;/p&gt;
&lt;p&gt;“高明啊……”司拉提巴特法斯特说，“真是不得不钦佩。”&lt;/p&gt;
&lt;p&gt;“什么？”阿瑟问。&lt;/p&gt;
&lt;p&gt;“多么巧妙地隐藏了他们自己的天性，又是多么巧妙地引导了你们的思维。不时还故意在迷宫中走错路，故意啃掉错误的奶酪，甚至无缘无故地死于多发性黏液瘤。如果这些都是经过精心推算的计策的话，逐渐积累下来的成果是多么惊人啊。”&lt;/p&gt;
&lt;p&gt;他略微停顿了…卜。&lt;/p&gt;
&lt;p&gt;“你瞧，地球人，他们确实是极其聪明的、具有超级智慧的泛维度生物。你们这颗星球和你们人类自身其实构成了一台有机电脑的母体，运行着，一个为期1000万年的研究程序……还是让我来告诉你整个故事吧。可能得花点儿时间。”&lt;/p&gt;
&lt;p&gt;“时间，”阿瑟虚弱地说，“跟我目前所碰上的问题比起来，根本不算一个问题。” &lt;/p&gt;
&lt;p&gt;=== 第二十五章 ===&lt;/p&gt;
&lt;p&gt;显然，有许多问题与生命有关，其中最普遍的也许莫过于：人为什么会出生？为什么会死亡？为什么会在生命的人部分时间里想要戴电了表？许多许多百万年前，一个具有超级智慧的泛维度种族（他们在自己的泛维度宇宙中的生理特征和在我们的宇宙中并没有什么不同）开始对有关生命意义的无休止的争论感到厌烦了，这种争论甚至影响到了他们最喜欢的消遣“坏小子极端板球”（一种奇怪的游戏，玩法是：毫无理由突如其来地击打他人，然后跑开），所以他们决定坐下来，一劳永逸地解决这个问题。&lt;/p&gt;
&lt;p&gt;为了达到这个目的，他们建造了一个巨大无比的超级电脑，它是如此惊人的聪明，在还没有连接上数据库以前，它就已经从“我思故我在”开始，推演出了米饭布丁以及个人所得税的存在，直到后来有人关闭了它。&lt;/p&gt;
&lt;p&gt;它的规模足有一座小城市那么大。&lt;/p&gt;
&lt;p&gt;它的主控制台安装在一间专门设计的操作室里，安放在一张巨大的操作桌上，桌子是上等的红木制成的，表面蒙着深红色的皮革。深色的地毯显得正式而豪华，异国情调的盆栽植物和电脑主要编程人员及其家人的照片精心地散布在房间各处，窗户望出去是一个绿树成行的公共广场。&lt;/p&gt;
&lt;p&gt;在正式开机的那个重大日子里，两个身着正式礼服的程序员提着公文包来到这里，谨慎地进入操作室。他们很清楚，在这个最重要的时刻，他们代表着整个种族。不过他们还是尽量让自己平静下来，镇定地坐到操作桌面前，打开公文包，拿出他们皮质封面的笔记本。&lt;/p&gt;
&lt;p&gt;他们的名字分别叫做朗克维尔和福克。&lt;/p&gt;
&lt;p&gt;开始的片刻，他们沉默地正襟危坐，然后，在和福克交换了一个眼神之后，朗克维尔身体前倾，触摸了一下一个小小的黑色仪表盘。&lt;/p&gt;
&lt;p&gt;传出微弱的嗡嗡声，表明这台巨型电脑现在已经完全进入运行状态了。稍微停顿了一会儿，它开始用一种丰满、洪亮、深沉的声音说话了。&lt;/p&gt;
&lt;p&gt;它说：“我，深思，整个宇宙一切空间和时间中第二强大的电脑，诞生的伟大任务是什么呢？”&lt;/p&gt;
&lt;p&gt;朗克维尔和福克惊讶地对望了一眼。&lt;/p&gt;
&lt;p&gt;“你的任务，电脑……”福克开始说。&lt;/p&gt;
&lt;p&gt;“不，等一下，这不对。”朗克维尔担心地说，“我们是要设计出有史以来最强大的电脑，而不是什么第二强大的。深思，”他对电脑说道，“难道你不是按照我们所设计的那样，是有史以来最大、最强有力的电脑吗？”&lt;/p&gt;
&lt;p&gt;“我把自己称为第二强大的，”深思吟诵似的说，“那么我就是。”&lt;/p&gt;
&lt;p&gt;两个程序员又一次交换了一个担忧的目光。朗克维尔清了清嗓子。&lt;/p&gt;
&lt;p&gt;“一定是出了什么差错，”他说，“难道你不是比马克希姆佳伦星上那台叫做‘十亿巨型脑’、能在一毫秒内数清楚一颗恒星所有的原子数量的电脑更强大吗？”&lt;/p&gt;
&lt;p&gt;“十亿巨型脑？”深思以一种丝毫不加掩饰的轻蔑口吻说，“它充其量也就是一把算盘而已一一不足挂齿。”&lt;/p&gt;
&lt;p&gt;“难道你不是，”福克说，一边紧张地前倾着身体，“比‘GoogIe星际思想者’——那台能够计算出丹格拉班德贝塔星上一场持续5个星期的沙尘暴中每一颗单独的沙尘的运行轨迹的电脑更强人的分析家吗？”&lt;/p&gt;
&lt;p&gt;“一场持续5个星期的沙尘暴？”深思傲慢地说，“你难道不想问问我宇宙大爆炸那一刻所有原子的确定矢量吗？请别拿这种袖珍计算器的弱智问题来烦我了。”&lt;/p&gt;
&lt;p&gt;两个程序员沉默了一会儿，感到如坐针毡。朗克维尔终于还是又朝前靠了靠身于。&lt;/p&gt;
&lt;p&gt;“可是，难道你不是，”他说，“一个比西塞罗尼克斯12号星的那个神奇而又不知疲倦的超级同源中子游说器更疯狂的辩论者吗？”&lt;/p&gt;
&lt;p&gt;“超级同源中子游说器，”深思故意卷起舌头说，“能说得大角星巨驴的四条腿分家——但是只有我能说动它向后走。”&lt;/p&gt;
&lt;p&gt;“那么，”福克问，“问题究竟出在哪儿呢？”&lt;/p&gt;
&lt;p&gt;“没有任何问题。”深思用歌唱似的洪亮音调说，“我就是整个宇宙一切空间和时间中第二强大的电脑。”&lt;/p&gt;
&lt;p&gt;“可是，第二？”朗克维尔坚持问道，“为什么你总是说第二昵？你想的肯定不会是复合类皮质激素巨型研磨机吧？也不会是思考机吧？或者……”&lt;/p&gt;
&lt;p&gt;电脑的控制台上闪烁着代表藐视的光。&lt;/p&gt;
&lt;p&gt;“我才不会为这控制系统蠢蛋们费哪怕是一丁点儿的心思呢！它强调道，”我说的不是别的，而是那台将在我之后诞生的电脑！“福克快要失去耐心了。他把自己的笔记本推到一边，咕哝道：”这他妈听起来倒像是救世主的口气。“&lt;/p&gt;
&lt;p&gt;“你对未来一无所知，”深思说，“然而我体内数量巨大的电路却能通过对关于未来可能性的无限的数据流的分析，预见到终究有一天会出现一台电脑，连它最基本的操作参数都是我所计算不出来的，但是这台电脑命中注定最终要由我来设计。”&lt;/p&gt;
&lt;p&gt;福克重重地叹了一口气，朝朗克维尔望去。&lt;/p&gt;
&lt;p&gt;“我们能够继续提问了吗？”他说。&lt;/p&gt;
&lt;p&gt;朗克维尔示意他再等一下。“你提到的这台电脑究竟是什么呢？”他问道。“眼下我不想接着谈它了。”深思说，“现在，问你们想知道的其他事情吧，尽管问。”&lt;/p&gt;
&lt;p&gt;两个程序员相对耸了耸肩。福克使自己镇定下来。&lt;/p&gt;
&lt;p&gt;“深思电脑，”他说，“我们给你的任务是这样的。我们希望你告诉我们……”他顿了一下，“答案！”&lt;/p&gt;
&lt;p&gt;“答案？”深思说，“什么的答案？”&lt;/p&gt;
&lt;p&gt;“生命！”福克迫切地说。&lt;/p&gt;
&lt;p&gt;“宇宙！”朗克维尔说。&lt;/p&gt;
&lt;p&gt;“一切！”他们俩齐声说。&lt;/p&gt;
&lt;p&gt;深思沉吟了一会儿。&lt;/p&gt;
&lt;p&gt;“有点儿棘手。”它最后说。&lt;/p&gt;
&lt;p&gt;“可是你能办到？”&lt;/p&gt;
&lt;p&gt;“是的，”深思说，“我能办到。”&lt;/p&gt;
&lt;p&gt;“有答案吗？”福克问，兴奋得连呼吸都快停止了。&lt;/p&gt;
&lt;p&gt;“一个简洁的答案，能做到吗？”朗克维尔补充了一句。&lt;/p&gt;
&lt;p&gt;“是的。”深思说，“生命、宇宙，以及一切。答案是有的。只是，”它补充道，“我必须想一想。”&lt;/p&gt;
&lt;p&gt;一阵突然的骚乱破坏了这个时刻：门被撞开了，两个满脸怒气、穿着粗糙褪色的克鲁克斯旺大学的蓝色束带长袍的人闯了进来，把一个徒劳地想阻挡他们的门卫摔到一边。&lt;/p&gt;
&lt;p&gt;“我们要求进去！”两人中比较年轻的那个高喊着，一肘推在一个年轻秘书的喉头卜。&lt;/p&gt;
&lt;p&gt;“来吧，”年长那个也喊道，“你们挡不住我们的！”说着一把将一个程序员从门里推开。&lt;/p&gt;
&lt;p&gt;“我们严正声明，你们不能把我们挡在外面！”年轻的那人叫骂着，尽管他现在已经稳稳地站在屋内，而且没有遇到任何进一步想要阻止他的尝试。&lt;/p&gt;
&lt;p&gt;“你们是谁？”朗克维尔愤怒地从座位上站起身来，“你们想干什么？”&lt;/p&gt;
&lt;p&gt;“我是曼吉克塞斯！”年长的那人宣称。&lt;/p&gt;
&lt;p&gt;“我严正声明，我是卢姆方德尔！”年轻的那人叫道。&lt;/p&gt;
&lt;p&gt;曼吉克塞斯转向卢姆方德尔。“够了，”他恼怒地说，“没有必要严正声明这个。”&lt;/p&gt;
&lt;p&gt;“好吧！”卢姆方德尔骂了一声，重重地一拳砸在身边的一张桌子上，“我是卢姆方德尔，这不是声明，而是纯粹的事实！我们所要求的就是纯粹的事实！”&lt;/p&gt;
&lt;p&gt;“不，我们不是！”曼吉克塞斯恼怒地说，“这可不是我们所要求的！”&lt;/p&gt;
&lt;p&gt;几乎没有换气，卢姆方德尔嚷道：“我们不要求纯粹的事实！我们所要求的是不要纯粹的事实。我要求我可能是也可能不是卢姆方德尔！”&lt;/p&gt;
&lt;p&gt;“见鬼了，那你到底是谁？”福克忍无町忍。&lt;/p&gt;
&lt;p&gt;“我们，”曼吉克塞斯说，“是哲学家。”&lt;/p&gt;
&lt;p&gt;“虽然我们也可能不是。”卢姆方德尔说，一边朝程序员们警告似的挥舞着手指。‘“是的，我们是哲学家。”曼吉克塞斯坚持道，“我们到这儿来的目的很明确，作为哲学家、智者、先知以及其他思想者的联合工会的代表，我们希望关闭这台机器，我们希望现在立即关闭它！”&lt;/p&gt;
&lt;p&gt;“出了什么问题呢？”朗克维尔问。&lt;/p&gt;
&lt;p&gt;“我会告诉你出了什么问题的，伙计。”曼吉克塞斯说，“分工，这就是问题所在！”&lt;/p&gt;
&lt;p&gt;“我们要求，”卢姆方德尔又开始嚷嚷了，“分工可能是也可能不是问题所在！”&lt;/p&gt;
&lt;p&gt;“你们尽管让这些机器开着吧，”曼吉克塞斯警告说，“谢谢你们。但永恒真理归我们负责。你们想要查询你们的法律地位吗，那就请便吧，伙计。根据法律，追寻终极真理很显然是你们中间的我们这些思想者们不可剥夺的特权。要是有任何该死的机器真的找到了它，那我们岂不是直截了当地失业了，不是吗？我的意思是，我们一直争论到半夜到底有没有上帝，可要是这台机器第二天一早就把上帝该死的电话号码给了你，我们的工作还有什么用？”&lt;/p&gt;
&lt;p&gt;“太对了。”卢姆方德尔叫道，“我们严正声明，要求严格将怀疑和不确定的领域划归我们！”&lt;/p&gt;
&lt;p&gt;突然间，一个洪亮的声音在屋内响起。&lt;/p&gt;
&lt;p&gt;“我能就这个问题说几句吗？”深思要求道。&lt;/p&gt;
&lt;p&gt;“我们要组织罢工！”卢姆方德尔叫道。&lt;/p&gt;
&lt;p&gt;“太对了！”曼吉克塞斯附和道，“你们将会引发全国性的哲学家罢工！”&lt;/p&gt;
&lt;p&gt;房间里的嗡嗡声突然增大。环绕房间的几个辅助性的低音音箱被打开了，用来增加深思的声音的响度。&lt;/p&gt;
&lt;p&gt;“我想说的是，”电脑咆哮着说，“我的电路现在已经无法撤销地开始计算关于生命、宇宙和一切的终极问题的答案。”它顿了一下，对于自己现在已经成功地引起了所有人的注意感到很满意，于是降低了音量，“但是运行这个程序将会稍微花费我一点儿时间。”&lt;/p&gt;
&lt;p&gt;福克迫不及待地瞟了一眼他的手表。&lt;/p&gt;
&lt;p&gt;“需要多久？”他问。&lt;/p&gt;
&lt;p&gt;“750万年。”深思回答说。&lt;/p&gt;
&lt;p&gt;朗克维尔和福克对望了一眼。&lt;/p&gt;
&lt;p&gt;“750万年！”他们异口同声地说。&lt;/p&gt;
&lt;p&gt;“是的。”深思说，“我曾经说过必须想一想，不是吗？我想到了，运行这样一个程序，势必引发以大众哲学为主题的媒体狂潮。对于我最终得出的答案，每个人都会有一种理论，而在传媒市场上，说到这个话题，有谁能够比你们更有话语权呢？只要你们坚持互相猛烈攻击，在大众传媒上互打耳光，只要你们有聪明的经纪人，你就能一辈子赚大钱，不费吹灰之力。这听起来怎么样？”&lt;/p&gt;
&lt;p&gt;两个哲学家目瞪口呆地望着他。&lt;/p&gt;
&lt;p&gt;“该死的，”曼吉克塞斯说，“这才是我称之为思想的东西。你瞧，卢姆方德尔，我们怎么从来没有想到过这些呢？”&lt;/p&gt;
&lt;p&gt;“不知道。”卢姆方德尔带着敬畏之情耳语道，“我们的脑子一定是训练得太过有素了，曼吉克塞斯。”&lt;/p&gt;
&lt;p&gt;这样说着，他们转身走出门去，投身于一种超越他们以往最疯狂的梦想的生活之中。 &lt;/p&gt;
&lt;p&gt;=== 第二十六章 ===&lt;/p&gt;
&lt;p&gt;“是的，很有教益。”司拉提巴特法斯特把这个故事最重要的内容讲给他听之后，阿瑟说，“可是我不明白这些跟地球和老鼠有什么关系？”&lt;/p&gt;
&lt;p&gt;“这只足故事的前半部分，地球人。”老人说，“如果你愿意知道750万年之后，在那个得出答案的伟大的日子里都发生了些什么。请允许我邀请你到我的书房去。在那里。通过我们的意念磁带记录，你能够亲身体验到当时所发生的事情——除非你想先在新地球的表面逛一逛。这项工程目前只完成了一半，恐怕——我们还没能结束在地壳中掩埋人造恐龙化石的工作，所以我们不得不放弃新生代的第三纪和第四纪，并且……”&lt;/p&gt;
&lt;p&gt;“不，谢谢你了。”阿瑟说，“不会和真正的地球一模一样的。”&lt;/p&gt;
&lt;p&gt;“是的，”司拉提巴特法斯特说，“不会的。”他掉转空中飞车的车头，朝着那堵让人思维麻木的墙飞回去。 &lt;/p&gt;
&lt;p&gt;=== 第二十七章 ===&lt;/p&gt;
&lt;p&gt;司拉提巴特法斯特的书房一片混乱，就像一个发生了一场爆炸的公共图书馆。进门后，老人皱起眉头。&lt;/p&gt;
&lt;p&gt;“真是太不幸了，”他说，“一台生命支持电脑里的一个二极管爆了。当我们试图唤醒我们的清扫系统时，才发现它们已经死掉差不多快3万年了。谁来清理这些垃圾呢，真是头疼呀。唔，你为什么不到那边坐下来，让我替你接上仪器好吗？”&lt;/p&gt;
&lt;p&gt;他做了个手势，让阿瑟坐到一张看上去像是由一头剑龙的胸腔制成的椅子上。&lt;/p&gt;
&lt;p&gt;“这是用一头剑龙的胸腔做的。”老人解释道，一边磨磨蹭蹭地从摇摇晃晃的纸堆下面扯出电线，接上仪器。“这儿，”他说，“拿着这些。”他把几根剥掉了外皮的电线端头递给阿瑟。&lt;/p&gt;
&lt;p&gt;阿瑟接过电线的那一瞬间，一只鸟笔直地从他面前掠过。&lt;/p&gt;
&lt;p&gt;他悬在半空中，自己完全看不见自己。在他身下是一个绿树成行的美丽的城市广场，广场四周目力所及之处全都是白色的混凝土建筑，设计风格轻快通透，只是装饰稍微差了些一许多建筑已被雨淋得痕迹斑驳。这是阳光明媚的一天，清新的微风在林间吹拂，广场和周围的街道上聚集着欢乐兴奋的人群，很容易使人产生一种奇怪的感觉，似乎所有建筑也都跟着轻声地哼哼着。某个地方，一支乐队正在表演，色彩鲜艳的旗帜在风中招展，空气中弥漫着狂欢节的气息。&lt;/p&gt;
&lt;p&gt;在空中，阿瑟甚至没有一具有形的躯体，于是他感到极端孤独，但没等他有足够的时间考虑这个问题，一个声音已经响彻整个广场，让所有人注意。&lt;/p&gt;
&lt;p&gt;一个男人站在装点得五彩缤纷的高台上，这个高台就在显然是这个广场的主体建筑物前面，他正通过扩音器向人群发表演讲。&lt;/p&gt;
&lt;p&gt;“等待在深思的阴影之下的人们！”他喊道，“光荣的卢姆方德尔和曼吉克塞斯——宇宙中有史以来最伟大、最风趣的博学者一一的子孙们，漫长的等待终于结束了！”&lt;/p&gt;
&lt;p&gt;人群中爆发出热烈的欢呼声。旗帜、横幅以及口哨声飘荡在空中。狭窄一些的街道看上去很像转过身背部着地的蜈蚣，在空中疯狂地挥舞着它们的腿。&lt;/p&gt;
&lt;p&gt;“整整750万年了，我们种族始终等待着这个伟大而充满了希望的启示之日！”狂欢领袖大叫着，“答案之日！”&lt;/p&gt;
&lt;p&gt;狂喜的人群再次⒊龌逗羯？&lt;/p&gt;
&lt;p&gt;“再也不会了，”那个男人喊道，“我们再也不会在清晨醒来时苦苦思索：”我是谁？我生命的目的是什么？按照宇宙的法则，如果我不起床去工作，真的有什么关系吗？‘因为，就在今天，对于所有这些不断困扰着我们的涉及生命、宇宙和一切的问题，我们将会一劳永逸地得到一个清晰而简洁的答案！“&lt;/p&gt;
&lt;p&gt;当人群再次沸腾起来时，阿瑟发现自己正在空中滑翔，朝着高台背后那栋建筑一楼的一扇富丽堂皇的巨大窗户下降。&lt;/p&gt;
&lt;p&gt;由于直直地冲着窗户而去，他一度经历了短暂的慌乱，但仅仅几秒钟之后慌乱就过去了，因为他发现自己已经穿越了坚固的玻璃，甚至丝毫没有碰到它。&lt;/p&gt;
&lt;p&gt;屋内并没有人察觉到这个不速之客的光临，这一点儿也不奇怪，因为他本来就不在那里。他开始意识到，所有这些经历都只是一顶接入6条70毫米磁道的头盔所产生的一种记录投影。&lt;/p&gt;
&lt;p&gt;这间屋子和司拉提巴特法斯特所描述的非常接近。在整整750万年中，它被照看得很好，几乎每个世纪都会定期清扫一番。上等红木制成的操作桌摆放在墙边，地毯稍稍有些褪色了，但是巨大的电脑终端立在皮革桌面上，闪耀着淡淡的光芒，就像昨天才刚刚组装完成似的。&lt;/p&gt;
&lt;p&gt;两个身着正式礼服的人毕恭毕敬地坐在终端前，等待着。&lt;/p&gt;
&lt;p&gt;“那一刻正在接近我们。”其中一人说，这时阿瑟惊讶的发现在他脖子旁边稀薄的空气中突然显出了一个单词。这个单词是“卢恩克沃尔”，闪烁了几次之后又消失了。还没等阿瑟把这一切存进脑子里，另一个人就开口了，于是一个单词“佛格”出现在他的脖旁边。&lt;/p&gt;
&lt;p&gt;“7万5千个世代以前，我们的祖先启动了这个程序。”第二个人说，“从那以后直到今天的漫长岁月中，我们将是第一个听见这台电脑说话的人。”&lt;/p&gt;
&lt;p&gt;“一个令人敬畏的时刻，佛格。”第一个人赞同说。阿瑟这才意识到他正在观看一段配有字幕的录像。&lt;/p&gt;
&lt;p&gt;“我们将要听到，”佛格说，“那些伟大问题的答案，生命……”&lt;/p&gt;
&lt;p&gt;“宇宙……”卢恩克沃尔说。&lt;/p&gt;
&lt;p&gt;“以及一切……”&lt;/p&gt;
&lt;p&gt;“嘘，”卢恩克沃尔轻轻打了个手势，“我想深思已经准备开口了！”&lt;/p&gt;
&lt;p&gt;伴随着一阵充满了期待的停顿，控制台前端的仪表盘慢慢地开始复苏。指示灯尝试着一明一灭地闪烁起来，构成了一幅工作中的景象。柔和而低沉的嗡嗡声从交流频道里传出。&lt;/p&gt;
&lt;p&gt;“早上好。”深思终于说。&lt;/p&gt;
&lt;p&gt;“嗯……早上好，深思。”卢恩克沃尔紧张地说，“你得到……嗯，那个……”&lt;/p&gt;
&lt;p&gt;“你们所要的答案？”深思庄严地打断了他，“是的，我得到了。”&lt;/p&gt;
&lt;p&gt;两人因为期待开始颤抖起来。他们漫长的等待毕竟不是徒劳。&lt;/p&gt;
&lt;p&gt;“真的有一个答案吗？”佛格喘着气问。&lt;/p&gt;
&lt;p&gt;“真的有一个。”深思肯定地回答说。&lt;/p&gt;
&lt;p&gt;“关于一切？关于那些伟大的问题——生命、宇宙以及一切？”&lt;/p&gt;
&lt;p&gt;“是的。”&lt;/p&gt;
&lt;p&gt;这两个人所受的训练就是为了这一刻，他们毕生都在为这一时刻作准备，他们从出生的那一天起就被选为见证这个答案的人。但即使是这样，他们仍然发觉自己喘着粗气，局促不安地扭动着身体，活像兴奋的孩一般。&lt;/p&gt;
&lt;p&gt;“你准备好把它交给我们了吗？”卢恩克沃尔迫不及待地说。&lt;/p&gt;
&lt;p&gt;“我准备好了。”&lt;/p&gt;
&lt;p&gt;“现在？”&lt;/p&gt;
&lt;p&gt;“现在。”深思说。&lt;/p&gt;
&lt;p&gt;两人同时舔了舔干燥的嘴唇。&lt;/p&gt;
&lt;p&gt;“虽然我并不认为，”深思补充说，“你们会喜欢它。”&lt;/p&gt;
&lt;p&gt;“没有关系！”佛格说，“我们必须知道答案！就是现在！”&lt;/p&gt;
&lt;p&gt;“现在？”深思又问了一句。&lt;/p&gt;
&lt;p&gt;“是的！现在……”&lt;/p&gt;
&lt;p&gt;“那好吧。”电脑说，然后再次陷入了沉默。两人变得坐立不安，紧张的气氛简直让人快要无法忍受了。&lt;/p&gt;
&lt;p&gt;“你们真的不会喜欢它的。”深思再次指出。&lt;/p&gt;
&lt;p&gt;“告诉我们！”&lt;/p&gt;
&lt;p&gt;“那好吧，”深思说，“那伟大问题的答案……”&lt;/p&gt;
&lt;p&gt;“是的！”&lt;/p&gt;
&lt;p&gt;“关于生命、宇宙以及一切……”深思继续说。&lt;/p&gt;
&lt;p&gt;“是的！”&lt;/p&gt;
&lt;p&gt;“是……”深思说，然后顿了一下。&lt;/p&gt;
&lt;p&gt;“是的！……”&lt;/p&gt;
&lt;p&gt;“是……”&lt;/p&gt;
&lt;p&gt;“是的！！！……？”&lt;/p&gt;
&lt;p&gt;“42。”深思说，语调中带着无限的威严和平静。 &lt;/p&gt;
&lt;p&gt;=== 第二十八章 ===&lt;/p&gt;
&lt;p&gt;很长一段时间，没有人开口说话。&lt;/p&gt;
&lt;p&gt;佛格的眼角甚至能够瞟见外面广场上紧张期待着的人们脸庞的海洋。&lt;/p&gt;
&lt;p&gt;“我们会被暴民们绞死的，是吗？”他喃喃地说道。&lt;/p&gt;
&lt;p&gt;“这是一件艰巨的工作。”深思温和地说。&lt;/p&gt;
&lt;p&gt;“42！”卢恩克沃尔嚷道，“难道这就是你经过750万年的运算后展示给我们的结果吗？”&lt;/p&gt;
&lt;p&gt;“我非常细致地检查过了，”电脑说，“这确实就是那个答案。我认为问题出在——老实说吧——你们从来也没有确切地知道这些问题本身到底是什么。”&lt;/p&gt;
&lt;p&gt;“可这确实是伟大的问题啊！关于生命、宇宙以及一切的终极问题。”卢恩克沃尔嚎叫起来。&lt;/p&gt;
&lt;p&gt;“是的。”深思说，带着一种很享受傻瓜们的骚扰的语气，“可它确切的内容是什么呢”&lt;/p&gt;
&lt;p&gt;接下来是一阵茫然的沉默，两人望着电脑，然后对望着。&lt;/p&gt;
&lt;p&gt;“嗯，你知道的，这是所有的一切……一切……”佛格有气无力地说。&lt;/p&gt;
&lt;p&gt;“正确！”深思说，“所以，只要你们确切地知道问题到底是什么，你们就能理解这个答案的意思。”&lt;/p&gt;
&lt;p&gt;“噢，这太好了。”佛格咕哝着，一随手将笔记本扔到一边，挥手擦掉一滴眼泪。&lt;/p&gt;
&lt;p&gt;“你瞧，好吧，好吧，”卢恩克沃尔说，“能请你告诉我们这个问题究竟是什么吗？”&lt;/p&gt;
&lt;p&gt;“这个终极问题？”&lt;/p&gt;
&lt;p&gt;“是的！”&lt;/p&gt;
&lt;p&gt;“关于生命、宇宙以及一切？”&lt;/p&gt;
&lt;p&gt;“是的！”&lt;/p&gt;
&lt;p&gt;深思沉吟了一会儿。&lt;/p&gt;
&lt;p&gt;“有点儿棘手。”它最后说。&lt;/p&gt;
&lt;p&gt;“可是你能办到吗？”卢恩克沃尔带着哭腔问。&lt;/p&gt;
&lt;p&gt;深思这一次考虑了很长时间。&lt;/p&gt;
&lt;p&gt;最后它回答说：“不能。”语气很坚定。&lt;/p&gt;
&lt;p&gt;于是两人同时绝望地瘫倒在座位上。&lt;/p&gt;
&lt;p&gt;“不过我能告诉你们谁能办到。”深思接着说。&lt;/p&gt;
&lt;p&gt;他们又同时猛然抬头看过来。&lt;/p&gt;
&lt;p&gt;“谁？告诉我们！”&lt;/p&gt;
&lt;p&gt;突然间，阿瑟开始感到有什么东西像是在他其实并不存在的头皮上蠕动着，他缓慢但却不可抗拒地朝着控制台前移。不过他可以猜想得到，这仪仅是摄制这段录像的人为了追求戏剧性效果所采取的手段。&lt;/p&gt;
&lt;p&gt;“我说的不是别的，正是那台将在我之后诞生的电脑。”深思吟唱似的说道，它的声音又重新恢复了惯常的雄辩家的腔调，“这台电脑，连它最基本的操作参数都是我所计算不出来的——但我将会为你们设计出来。这是一台能够计算出这个终极问题的答案的电脑，这台电脑具有无限和微妙的复杂性，有机生命本身将会成为它的操作母体的一部分。你们自身也将会以一种新的生命形式投入到这台电脑中，去操控它的为期1000万年的程序！是的！我将为你们设计出这台电脑，我甚至将为它取好名字。它将被称为……地球。”&lt;/p&gt;
&lt;p&gt;佛格盯着深思。&lt;/p&gt;
&lt;p&gt;“真是个无趣的名字。”他说。然后，巨大的切口贯穿了他的全身，卢恩克沃尔也突然间全身布满了不知从哪儿来的恐怖的伤口。电脑控制台开始出现斑点，噼啪作响，墙壁闪着光开始崩裂，整间屋子向着自己的屋顶坍塌“上”去……&lt;/p&gt;
&lt;p&gt;司拉提巴特法斯特站在阿瑟面前，手里握着两根电线。&lt;/p&gt;
&lt;p&gt;“磁带的结尾。”他解释说。 &lt;/p&gt;
&lt;p&gt;=== 第二十九章 ===&lt;/p&gt;
&lt;p&gt;“赞福德！醒醒l”&lt;/p&gt;
&lt;p&gt;“呃呃呃呃呃嗯嗯嗯嗯嗯？”&lt;/p&gt;
&lt;p&gt;“嘿，来吧，快醒醒。”&lt;/p&gt;
&lt;p&gt;“你就让我多干干我最擅长的事吧，嗯？”赞福德一边咕哝着，一边转过身去，很快又进入了梦乡。&lt;/p&gt;
&lt;p&gt;“你想让我踢你不成？”福特说。&lt;/p&gt;
&lt;p&gt;“那样做能给你很多快感吗？”赞福德睡眼朦咙地说。&lt;/p&gt;
&lt;p&gt;“不。”&lt;/p&gt;
&lt;p&gt;“我也不会。所以说你那样做有什么意义呢？还是别打扰我吧。”赞福德把身子蜷得更紧了。&lt;/p&gt;
&lt;p&gt;“他吸入了双倍的烟雾。”崔莉恩说，低头看着他，“谁让他有两根气管昵。”&lt;/p&gt;
&lt;p&gt;“求求你们闭嘴好吗？”赞福德说，“要睡个好觉简直太困难了。这地面又他*的是什么毛病？又冷又硬。”&lt;/p&gt;
&lt;p&gt;“这是黄金。”福特说。&lt;/p&gt;
&lt;p&gt;随着一个令人惊叹的芭蕾舞动作，赞福德已经站了起来，开始扫视地平线，因为这代表着这片黄金大地向各个方向延伸的距离。真的是一马平川。它闪烁着像……其实根本不可能说清楚它闪烁着什么样的光芒，因为宇宙中根本没有任何地方会闪烁着像这样一个完全由黄金构成的行星一样的光芒。&lt;/p&gt;
&lt;p&gt;“谁把这些黄金放在这儿的？”赞福德叫起来，瞪人了眼睛。&lt;/p&gt;
&lt;p&gt;“别太兴奋了。”福特说，“这只是一个商品目录而已。”&lt;/p&gt;
&lt;p&gt;“一个什么？”&lt;/p&gt;
&lt;p&gt;“一个商品目录，”崔莉恩说，“一个幻象。”&lt;/p&gt;
&lt;p&gt;“你们怎么能这么说呢？”赞福德一边嚷道，一边伏下身体，用手和膝盖接触地面，眼睛也盯着地面。他在上面又戳又刺。地面很厚实，有点儿软——他甚至能用手指甲在上面划出痕迹来。它泛着金黄色的光泽，当他朝上面呼气时，呼出的气从上面蒸发掉的情形和从真正的黄金表面蒸发掉的独特的情形完全一样。&lt;/p&gt;
&lt;p&gt;“崔莉恩和我早些时候醒过来，”福特说，“我们也兴奋得大喊大叫，直到有人过来。我们接着大喊大叫，最后吵得他们心烦了，于是把我们扔进他们的商品行星目录。” &lt;/p&gt;
&lt;p&gt;=== 第三十章 ===&lt;/p&gt;
&lt;p&gt;“你都看到了……”斯拉提巴特法斯特一边说，一边心不在焉马马虎虎的试图略微清理一下他混乱不堪的书房，他从一堆纸的顶端拿起一张纸，但却一时想不起能把它放在别的什么地方，于是只好又把它放回到原来那堆纸上面，却使整堆纸倒了下去，“深思设计了地球，我们建造了它，而你住在上面。”&lt;/p&gt;
&lt;p&gt;“沃贡人则来毁掉了它，就在整个程序还有5分钟就要结束的时候。”阿瑟不无怨恨的补充了一句。&lt;/p&gt;
&lt;p&gt;“是啊。”老人说，停顿了一下，不抱希望的环视了房间一圈，“1000万年的计划和工作就这样付诸东流了。1000万年，地球人，你能够想像这样漫长的时间吗？在这段时间内，一种银河系文明甚至可以从一条简单的毛虫开始循环5次了。就这样飘散了。”他又顿了一下，“哦，对你来说有点儿官僚腔了。”他补充道。&lt;/p&gt;
&lt;p&gt;“你知道，”阿瑟若有所思的说，“这样一来，很多东西都解释得通了。在我整个一生中，我一直有一种解释不清的感觉，总觉得有什么事情正在世界上发生着，很重大的事情，甚至是凶险的，可是从来没有人能告诉我这究竟是什么。”“不。”老人说，“那只是最最普通的偏执狂症状，宇宙中每一个人都有。”“每一个人？”阿瑟说，“好吧，如果每一个人都有的话，也许它正意味着什么！也许在我们已知宇宙以外的某个地方……”“说不定吧，谁在乎呢？”司拉提巴特法斯特在阿瑟过于兴奋之前说，“也许我老了，也疲倦了，可我总是在想，找出真正发生著的事情的可能性太渺茫了，简直近乎荒谬。我们唯一能做的只是将事情的意义悬置起来，自己专注的去干。看看我吧：我设计海岸线，因为挪威还得了奖呢。”他在一堆破烂中检查了一番，抽出一块很大的有机玻璃牌子，上面有他的名字，玻璃中间铸有挪威的模型。&lt;/p&gt;
&lt;p&gt;“这其中的意义是什么呢？”他说，“我根本不可能得出来。我一生都在制作海湾。它们一度很时髦，于是我也就获得了一个重要奖项。”他把牌子在手里翻了一面，耸了耸肩，不在意的随手把它扔到一边——但也并非完全毫不在意，他避开了所有坚硬的东西。&lt;/p&gt;
&lt;p&gt;“在我们正在建造的这颗替代品地球上，他们把非洲分给我做。我当然把它全部做成了海湾，谁让我碰巧喜欢它们呢。我是老派的审美观，觉得它们给这块大陆增加了一种虽然怪诞但是挺可爱的感觉。他们告诉我，它还不够接近赤道。接近赤道！”他发出一阵空洞的笑声，“这有什么关系？当然，科学能够做成一些美妙的事，但我始终认为，有比正确更令人愉快的事。”&lt;/p&gt;
&lt;p&gt;“那你照自己的感觉做了吗？”“没有。在这个问题上当然还是得妥协的。”“真是遗憾。”阿瑟同情的说，“否则的话，听起来倒真是一种挺不错的生活方式。”这时，墙上的一盏小白灯亮了起来。&lt;/p&gt;
&lt;p&gt;“来吧，”司拉提巴特法斯特说，“你将会和老鼠见面。你们的到来在这颗行星上引起了巨大的轰动。据我所知，这一事件已经被惊呼为宇宙有史以来排在第三位的非概率事件。”“前两件是什么呢？”“哦，那也许只是巧合而已。”司拉提巴特法斯特漫不经心的回答说。他推开门，站在那儿等着阿瑟跟过来。&lt;/p&gt;
&lt;p&gt;阿瑟再次上下打量了他一番，然后又看了看自己，看了看自己身上这件一股汗味儿皱巴巴的衣服，还有星期四早上他躺在泥浆里留下的痕迹。&lt;/p&gt;
&lt;p&gt;“看来我的生活方式碰到了相当大的困难。”他喃喃自语道。&lt;/p&gt;
&lt;p&gt;“对不起，你说什么？”老人温和的问。&lt;/p&gt;
&lt;p&gt;“噢，没什么，”阿瑟说，“一句玩笑而已。” &lt;/p&gt;
&lt;p&gt;=== 第三十一章 ===&lt;/p&gt;
&lt;p&gt;一句漫不经心的话也许会付出生命的代价，这一点当然是众所周知的，但人们通常并没有认识到这个问题的实质。&lt;/p&gt;
&lt;p&gt;比如，就在阿瑟说“看来我的生活方式碰到了相当大的困难”这句话的那一瞬间，在时空闭合体的构造上打开了一个反常的虫洞，把他这句话带到了在时间上很早很早以前、在空间上几乎是无限远的一个银河系中，在那里，奇怪而好战的生物们正处在一场可怕的星际战争一触即发的边缘。&lt;/p&gt;
&lt;p&gt;敌对的两位领导人正在举行最后一次会面。&lt;/p&gt;
&lt;p&gt;一阵恐怖的沉默笼罩着会议桌。维尔赫格的司令官穿着华丽的饰有宝石的战斗服冷冷的盯着蹲坐在他对面、笼罩在一团绿色的气味香甜的水汽中间的古格旺特的领袖。在他身后是上百万艘可怕的全副武装的星际巡洋舰，只等他一声令下就会释放出电子化的死亡。他要求这个卑鄙无耻的家伙收回曾经说过的辱骂他母亲的话。&lt;/p&gt;
&lt;p&gt;这家伙在他那团酷热的水汽中摇晃着，就在此时，那句“看来我的生活方式碰到了相当大的困难”飘过会议桌。&lt;/p&gt;
&lt;p&gt;不幸的是，在维尔赫格的语言中，这代表了所能想象到的最严重的侮辱。没有别的任何办法能回应这句话，除了发动延续几个世纪的可怕的战争。&lt;/p&gt;
&lt;p&gt;最终，在他们的银河系经历了数千年的大规模杀戮之后，人们才意识到整件事情居然是出于一个惊人的误会。于是战争双方的舰队抛弃了分歧，联合起来对我们自己的银河系发动了一次攻击——现在已经可以断定这里就是那句罪魁祸首的话的来源地。&lt;/p&gt;
&lt;p&gt;又经过了数千年，这支庞大的舰队穿越太空，最后来到了他们所碰上的第一颗银河系的行星——恰好是地球——在这里，由于严重的尺寸误算，整个攻击舰队不巧被一只小狗吞进了肚子。&lt;/p&gt;
&lt;p&gt;那些研究宇宙历史上因果之间复杂的相互作用的人声称，这一类事情永远都会发生，我们根本无力预防。&lt;/p&gt;
&lt;p&gt;这就是生活。他们说。&lt;/p&gt;
&lt;p&gt;空中飞车一段短暂的航程把阿瑟和曼格拉斯老人带到了一扇门前。他们下了车，穿过门，走进一间到处都是玻璃桌面的桌子和有机玻璃奖状的候见室里。随即，房间另一端的门上亮起了灯，于是他们走了进去。&lt;/p&gt;
&lt;p&gt;“阿瑟！你平安无事！”一个声音叫道。&lt;/p&gt;
&lt;p&gt;“我吗？”阿瑟说，吓了一大跳，“哦，还好。”光线相当昏暗，他花了好一会儿才看见福特、崔莉恩和赞福德正围坐在一张大桌子旁，桌上摆放着异国情调的盘子、奇怪的甜肉和怪异的水果。他们正往嘴里塞著食物。&lt;/p&gt;
&lt;p&gt;“你们都遇到了些什么？”阿瑟问。&lt;/p&gt;
&lt;p&gt;“哦，”赞福德边说边啃着一块带骨烤肉，“这里的主人让我们吸了麻醉气，扰乱了我们的思维，展示了一片光怪陆离的景象，现在终于提供了一顿丰盛的午餐作为补偿。来吧，”说着他从碗里扯吓一块气味很难闻的肉，“尝尝食草犀牛的肉排。如果你恰好喜欢这种口味的话，这可是一道美食。”“主人？”阿瑟说，“什么主人？我怎么没看见什么……”这时，一个细微的声音说道：“欢迎加入我们的午宴，地球生物。”阿瑟四下张望了一番，突然惊呼起来。&lt;/p&gt;
&lt;p&gt;“天哪！”他说，“桌子上有老鼠！”接下来是一阵尴尬的沉默，所有人的目光都严厉的盯着阿瑟。&lt;/p&gt;
&lt;p&gt;他却还直直的盯着桌上坐在看上去像是威士忌酒杯的东西里的两只小老鼠，直到意识到了这阵沉默，他才开始环顾所有的人。&lt;/p&gt;
&lt;p&gt;“噢！”他这时才猛然醒悟过来，“噢，对不起，我本来是准备……”“让我来介绍一下，”崔莉恩说，“阿瑟，这位是本吉老鼠。”“嗨。”其中一只老鼠象他打了个招呼，同时用胡须碰了一下那个象是威士忌酒杯的玩意儿里的一个显然是触摸感应面板的东西，于是酒杯朝前稍稍移动了一点儿。&lt;/p&gt;
&lt;p&gt;“这位是弗兰克老鼠。”另一只老鼠说：“很高兴见到你。”随后做了相同的动作。&lt;/p&gt;
&lt;p&gt;阿瑟目瞪口呆的立在原地。&lt;/p&gt;
&lt;p&gt;“可是他们不就是……”“是的，”崔莉恩说，“他们就是我从地球上带来的那两只老鼠。”她直视著阿瑟的眼睛，阿瑟觉得自己似乎觉察到了一个最细微的听天由命的耸肩动作。&lt;/p&gt;
&lt;p&gt;“你能把那碗大角星巨驴碎肉递给我吗？”她说。&lt;/p&gt;
&lt;p&gt;斯拉提巴特法斯特礼貌的咳嗽了一声。&lt;/p&gt;
&lt;p&gt;“噢，请原谅我的打扰。”他说。&lt;/p&gt;
&lt;p&gt;'哦，谢谢你，斯拉提巴特法斯特。“本吉老鼠随口说，”你可以走了。“”什么？嗯……嗯，好吧。“老人说，向后退了一小步，”我这就走，回去继续做我的海湾。“”哦，好的，不过实际上已经没那个必要了。“弗兰克老鼠说，”看样子我们极有可能不再需要一颗新的地球。“他转了转他那粉红色的小眼珠，”既然我们已经找到了一个那颗行星的原住民，在它毁灭的前几秒钟他就在那上面。“”什么？“斯拉提巴特法斯特惊诧的叫了起来，”这不会是真的吧！我已经做好了上千条的冰川，准备用它们去碾压非洲大陆！“”是吗，那你也许可以度一个滑雪假，在你分解掉它们之前。“弗兰克嘲弄的说。&lt;/p&gt;
&lt;p&gt;“滑雪假！”老人叫道，“那些冰川可都是艺术品！精心雕刻的轮廓、高耸的雪峰、壮阔的峡谷！在这样的高雅艺术品上滑雪简直就是一种亵渎！”“谢谢你了，斯拉提巴特法斯特。”本吉坚定的说，“就这样吧。”“是，先生，”老人冷冷的说，“谢谢你。好吧，再见，地球人，”他对阿瑟说，“希望那种生活方式能够实现。”他朝剩下的人微微点了点头，然后转过身去，伤心地走出房间。&lt;/p&gt;
&lt;p&gt;阿瑟望着他的背影，不知道该说些什么。&lt;/p&gt;
&lt;p&gt;“现在，”本吉老鼠说，“为了正事。”福特和赞福德碰了一下手中的酒杯。&lt;/p&gt;
&lt;p&gt;“为了正事！”他们说。&lt;/p&gt;
&lt;p&gt;“请原谅，可你们这是什么意思？”本吉问。&lt;/p&gt;
&lt;p&gt;福特朝四下看了看。&lt;/p&gt;
&lt;p&gt;“对不起，我还以为你是在提议祝酒呢。”他说。&lt;/p&gt;
&lt;p&gt;两只老鼠不耐烦的在他们的玻璃交通工具里踱着步。最后他们终于使自己安定下来，本吉移动过来，开始和阿瑟交谈。&lt;/p&gt;
&lt;p&gt;“目前，地球生物，”他说，“我们所面临的情况是这样的：如你所知，在过去的1000万年里，我们操控着你们的行星，目的是为了寻找那个倒霉的东西，那个叫做终极问题的东西。”“为什么？”阿瑟尖锐的问。&lt;/p&gt;
&lt;p&gt;“不——你说的这个问题我们已经考虑过了。”弗兰克插了进来，“但它不能解释那个答案。为什么？42……你瞧，没用。”“不，”阿瑟说，“我的意思是，你们为什么要这样做？”“哦，我懂了。”弗兰克说，“嗯，最终还是应该归结为习惯吧。坦率的说，我们对整件事情已经厌倦到极点了。由于那些该死的沃贡人，又得重起炉灶再来一遍。说实话，一想起这个我就神经过敏。你明白我的意思嗎？只是由于一点儿最微小的幸运，本吉和我完成了我们的任务，提前离开那颗行星去享受假期，这才得以利用你的朋友们所提供的好心回到了曼格拉斯。”&lt;/p&gt;
&lt;p&gt;“曼格拉斯是回到我们自己那个维度的一个通道。”本吉补充说。&lt;/p&gt;
&lt;p&gt;“从那时起，”他的老鼠伙伴接着说，“我们就得到了一份相当有油水的意向合同，要求将五维的脱口秀和演说电路接入我们自己的那个维度。当然，我们很愿意接受这样的活计。”“我也会的，你呢，福特？”赞福德鼓动的说。&lt;/p&gt;
&lt;p&gt;“哦，当然。”福特说，“猛扑上去，就像出膛的子弹。”阿瑟扫视着它们，不知道这些谈话将通往什么方向。&lt;/p&gt;
&lt;p&gt;“但我们必须得有产品，你瞧。”弗兰克说，“我是指，按照最理想的情况，以这样或那样的方式，我们仍然需要那个终极问题。”赞福德把身子靠向阿瑟。&lt;/p&gt;
&lt;p&gt;“是这样的，”他说，“请设想一下，：他们坐在演播室里，轻松自在，随口提一句他们恰好知道关于生命、宇宙以及一切的答案。可到头来，他们不得不承认这个答案的的确确就是42.那样一来，这个节目可能会相当短，拍不了续集。懂吗？”“我们一定的有点听上去很不赖的东西。”本吉说。&lt;/p&gt;
&lt;p&gt;“什么东西听上去很不赖？”阿瑟惊呼道，“那个终极问题听上去很不赖？从一对老鼠嘴里说出来？”两只老鼠顿时毛发上竖，勃然大怒。&lt;/p&gt;
&lt;p&gt;“好吧，我承认，理想主义是对的，纯粹学术研究的尊严是对的，对真理的各种表现形式的追求也是对的。但是恐怕到一定的时候，你就会开始怀疑是否真的存在所谓真正的真理。你会怀疑整个无限多维的宇宙背后是由一群疯子操纵。如果面临这种选择，一是再花1000万年去找出答案，二是拿了钱继续走下去，那么我当然乐意溜达溜达锻炼一下。”弗兰克说。&lt;/p&gt;
&lt;p&gt;“可是……”阿瑟绝望的开了一个头。&lt;/p&gt;
&lt;p&gt;“嘿，你还不明白吗，地球人？”赞福德打断了他，“你是那台电脑母体最后一代产品中的一个，是吧？你一直在那上面呆到你们的行星被从宇宙中弹掉那一刻，是这样吧？”“嗯……”“所以你的大脑就是电脑程序倒数第二级构造中的一个有机组成部分。”福特说，看来他把这个问题琢磨清楚了。&lt;/p&gt;
&lt;p&gt;“是不是？”赞福德说。&lt;/p&gt;
&lt;p&gt;“就算是吧。”阿瑟将信将疑的说。他从来没有觉得自己是任何东西的一个有机组成部分，这还总被他视为自己的问题之一。&lt;/p&gt;
&lt;p&gt;“换句话说，”本吉说，同时驾驶着他奇怪的微型交通工具来到阿瑟面前，“有极大的可能，那个问题的框架被编码进了你大脑的结构中——所以我们想从你这儿买走它。”“什么，那个问题吗？”阿瑟问。&lt;/p&gt;
&lt;p&gt;“是的。”福特和崔莉恩同时说。&lt;/p&gt;
&lt;p&gt;“用一大笔钱。”赞福德说。&lt;/p&gt;
&lt;p&gt;“不，不，”弗兰克老鼠赶忙说，“我们想买的是你的大脑。”“什么！”“瞎，谁会怀念那玩意儿呢？”本吉老鼠道。&lt;/p&gt;
&lt;p&gt;“我记得你当初说的是你们能够用电子手段阅读他的大脑。”福特抗议说。&lt;/p&gt;
&lt;p&gt;“噢，是的，”弗兰克说，“可是我们总得先把它取出来吧。这是必要的准备步骤。&lt;/p&gt;
&lt;p&gt;“先处理。”本吉说。&lt;/p&gt;
&lt;p&gt;“切片。”“多谢了。”阿瑟终于忍不住叫道，他从座位上猛地弹起来，惊恐的从桌边向后退去。&lt;/p&gt;
&lt;p&gt;“通常情况下，它是可以替代的。”本吉通情达理的说，“如果你真的认为它很重要的话。”“是的，一个电子脑，”弗兰克说，“一个最简单就足够了。&lt;/p&gt;
&lt;p&gt;“一个最简单的！”阿瑟简直是在哀号。&lt;/p&gt;
&lt;p&gt;“是啊。”赞福德突然一连坏笑的说，“你只需要变成让它会说‘什么？’、‘我不明白’以及‘茶在哪儿？’就行了，谁又知道两者的区别呢？”“什么？”阿瑟叫道，向后退得更远了。&lt;/p&gt;
&lt;p&gt;“你明白我的意思吗？”赞福德说，然后疼得大叫了一声，因为崔莉恩对他做了一个小小的动作。&lt;/p&gt;
&lt;p&gt;“我会注意到它们的区别的。”阿瑟说。&lt;/p&gt;
&lt;p&gt;“不，你不会的。”弗兰克老鼠说，“你会被编程设定为不会。”这时福特向门口走去。&lt;/p&gt;
&lt;p&gt;“瞧，对不起了，老鼠们，老伙计们。”他说，“我不认为我们已经达成了一致。”“我更认为我们必须达成一致。”两只老鼠齐声说。在他们细微但尖利的声音里，令人愉快的魅力顷刻之间就消失的无影无踪。带着轻微的嘶叫声，两架玻璃交通工具载着他们离开桌面，划过空中朝阿瑟飞去，而阿瑟已经退进了一个死角，完全无力反抗，也丧失了思考任何东西的能力。&lt;/p&gt;
&lt;p&gt;崔莉恩绝望的伸出手臂把阿瑟抓了过来，试图拉着他向门口逃。福特和赞福德正在竭尽全力想打开那扇门，但这时阿瑟却变得死沉死沉的——他似乎被正在从空中向他扑过来的啮齿动物们催眠了。&lt;/p&gt;
&lt;p&gt;她冲他尖叫，但他还是一脸茫然。&lt;/p&gt;
&lt;p&gt;经过一阵猛拉，福特和攒福德终于把门打开了。门外是一小群非常丑陋的人，看上去只可能是曼格拉斯的暴徒。不仅他们自身长得极其丑陋，就连他们拿着的医疗器械也远远说不上精致。他们发起了冲锋。&lt;/p&gt;
&lt;p&gt;于是——阿瑟即将被切开脑袋，崔莉恩丝毫帮不上他，而福特和赞福德则会遭到几个远比他们强壮、装备也远胜于他们的暴徒的袭击。&lt;/p&gt;
&lt;p&gt;总而言之，正好在这个时候，整个星球上所有的警报声同时震耳欲聋的响起来。对他们来说，这真是一件天大的幸事。 &lt;/p&gt;
&lt;p&gt;=== 第三十二章 ===&lt;/p&gt;
&lt;p&gt;“紧急情况！紧急情况！”高音喇叭尖利的鸣叫声响彻整个曼格拉斯，“敌方飞船已经在星球上降落。8A区域发现武装入侵者。准备抵抗，准备抵抗！”玻璃飞行器在降落到地面时摔得粉碎，两只老鼠绕着碎片愤怒的抽搐着鼻子。“他妈的，”弗兰克老鼠喃喃的骂道，“不过是两磅讨厌的地球大脑，闹出这么大麻烦。”他焦虑的来回踱步，粉红色的眼睛一闪一闪，漂亮的白色皮毛因为静电全都竖了起来。&lt;/p&gt;
&lt;p&gt;“目前我们唯一能做的，”本吉说，他一边摆弄着胡须，一边冥思苦想，“就是尽量伪造一个问题，必须听起来合情合理。”“很难阿。”弗兰克说。他想了想，“这个怎么样，‘什么是黄颜色和危险’？”&lt;/p&gt;
&lt;p&gt;本吉考虑了一会儿。&lt;/p&gt;
&lt;p&gt;“不大好，”他说，“和那个答案不相配。”有几秒钟的时间，他们陷入了沉默。&lt;/p&gt;
&lt;p&gt;“有了。”本吉说，“‘用7乘以6，你会得到什么’？”“不行，不行，太字面化了，太实际了。”弗兰克说，“这样引不起观众们的兴趣。”于是他们又开始思考。&lt;/p&gt;
&lt;p&gt;弗兰克说：“我有个想法。‘一个男人必须走完多少条路’？”“嘿！”本吉说，“哈，这个听起来很有希望！”他把这句话来回念叨了几遍。“好，”他说，“简直太棒了！听上去意味深长，实际上又不会把你框进任何具体的意义中去。‘一个男人必须走完多少条路？42。’太棒了，太棒了，一定会蒙住他们。弗兰克，亲爱的，我们成功了！”兴奋之余，他们跳了一只轻快的舞。&lt;/p&gt;
&lt;p&gt;在他们附近的地板上躺着几个相当丑陋的人，都是被沉重的设计奖奖状击中了头部。&lt;/p&gt;
&lt;p&gt;半英里之外，四个人正在一条走廊里寻找出路。他们来到了一个宽敞的开放式电脑港里，狂乱的四下打量着这个地方。&lt;/p&gt;
&lt;p&gt;“你估计出路在哪儿，赞福德？”福特问。&lt;/p&gt;
&lt;p&gt;“胡猜一把，我说在下面。”赞福德说着，从一排电脑和墙之间钻了下去。其他人正要跟上，他应被一道强度可从“击毙”或“击晕”之间选择的能量闪光挡了回来，能量闪光在他身前几英寸的空气中噼啪作响，附近一小块墙面都被烤焦了。&lt;/p&gt;
&lt;p&gt;一个声音通过手提式扩音器传来：“好了，毕博布鲁克斯，呆在那儿别动。你已经被我们包围了。”“警察！”赞福德悄声说，蹲伏著转过身来，“你想猜一把吗，福特？”“好吧，走这边。”福特说。于是四个人沿着两排电脑中间的过道前进。&lt;/p&gt;
&lt;p&gt;过道尽头出现了一个穿着重装甲和太空服的人，，手里挥舞着一支样子吓人的攻击能量枪。&lt;/p&gt;
&lt;p&gt;“我们不想向你开枪，毕博布鲁克斯！”那人喊道。&lt;/p&gt;
&lt;p&gt;“正合我意！”赞福德也喊道，同时一低头冲进两台数据处理器之间的大空隙里。&lt;/p&gt;
&lt;p&gt;其他人也跟在他后面突然改变了方向。&lt;/p&gt;
&lt;p&gt;“他们有两个人。”崔莉恩说，“我们被逼到角落里了。”接着他们挤进一台大型电脑和墙之间所形成的角落里。&lt;/p&gt;
&lt;p&gt;他们摒住呼吸等待着。&lt;/p&gt;
&lt;p&gt;一道道能量闪光在空气中闪烁，两个警察同时向他们开火了。&lt;/p&gt;
&lt;p&gt;“嘿，他们正在向我们射击。”阿瑟紧紧蜷作一团，“我记得他们说过不想这么做的。”“是啊，我也记得他们这样说过。”福特附和道。&lt;/p&gt;
&lt;p&gt;赞福德伸出脑袋，冒着危险停了一会儿。&lt;/p&gt;
&lt;p&gt;“嘿，”他喊道，“我记得你们说过不想朝我们开火的！”马上又缩了回来。&lt;/p&gt;
&lt;p&gt;他们等待着。&lt;/p&gt;
&lt;p&gt;过了一会儿，一个声音说：“当个警察可不容易！”“他说什么？”福特惊讶的耳语道。&lt;/p&gt;
&lt;p&gt;“他说当个警察可不容易。”“哦，这显然是他的问题嘛，不是吗？”“我也是这么想的。”于是福特喊道：“嘿，听着！由于你们的火力，我们自己的问题已经够多了，所以如果你们别再把你们自己的问题强加在我们头上的话，我想我们大家都会发现问题要容易解决得多。”又是一阵沉默，随后手提式扩音器的声音再次响起。&lt;/p&gt;
&lt;p&gt;“喂，伙计们。”这声音说，“你们面对的并不是头发搭在额头上、长着小小的猪眼睛、毫无交流能力的随便什么蠢货，我们是两个高智商的人，心思缜密。如果在日常交际中碰见我们的话，你们可能会相当喜欢我们！我可不是跑来毫无理由的朝人开枪、事后再拿到星际巡逻队员们的破烂酒吧炫耀的那种人，警察里有这种人，我可以举出好几个例子来！我属于那种跑来毫无理由的朝人开枪，事后会在女朋友面前痛苦整整几个小时的人！”&lt;/p&gt;
&lt;p&gt;“另外我还写小说！”另一个警察配合得相当默契，“虽然到目前为止一本也没有出版过，所以我最好还是先警告你们，我现在的心情很糟糕！”福特把眼睛从避难窝里露出一半。“这两个家伙是谁？”他说。&lt;/p&gt;
&lt;p&gt;“我哪儿知道，”赞福德说，“我倒情愿他们继续开枪。”“那么，你们是打算自己乖乖出来呢，”其中一个警察又喊道，“还是由我们把你们给炸出来？”“你们自己喜欢哪种呢？”福特吼了一声。&lt;/p&gt;
&lt;p&gt;紧紧一毫秒过后，他们身边的空气又开始被烤焦了。攻击能量枪发射的能量闪光一波又一波冲向他们面前的电脑。&lt;/p&gt;
&lt;p&gt;这一轮扫射以一种令人难以忍受的强度持续了几秒钟。&lt;/p&gt;
&lt;p&gt;当它停下来后，回声也足足用了好几秒才完全消散。&lt;/p&gt;
&lt;p&gt;“你们还在吗？”一个警察喊道。&lt;/p&gt;
&lt;p&gt;“是的。”他们回应道。&lt;/p&gt;
&lt;p&gt;“我们其实根本不想这么做。”另一个警察说。&lt;/p&gt;
&lt;p&gt;“我们知道。”福特喊道。&lt;/p&gt;
&lt;p&gt;“现在，你们听着，毕博布鲁克斯，尤其是你要听好了！”“为什么？”赞福德回喊道。&lt;/p&gt;
&lt;p&gt;“因为，”警察喊道，“这个建议将是非常睿智的，很有趣也很仁慈！现在——或者是你们所有人出来投降，让我们痛扁你们一顿，当然，我们是不会太过分的，因为你们也知道，我们坚决反对不必要的暴力；或者是我们炸掉整颗行星，顺手再捎带上我们回程中看不顺眼的一两颗！”“可是这太疯狂了！”崔莉恩叫了起来，“你们不能这么干！”“哦，不，我们当然能。”一个警察喊道。&lt;/p&gt;
&lt;p&gt;“我们能吗？”他问另外那个。&lt;/p&gt;
&lt;p&gt;“哦，当然，我们必须这么干，没有问题。”另一个警察回答说。&lt;/p&gt;
&lt;p&gt;“可是，为什么呢？”崔莉恩追问道。&lt;/p&gt;
&lt;p&gt;“因为总有一些事情是必须做的，即使你是一个开明而宽大的警察，了解人们敏感的感受以及所有其它的一切！”“我还是不相信这些家伙。”福特一边咕哝道，一边摇着头。&lt;/p&gt;
&lt;p&gt;这时一个警察对另一个喊道：“我们还应该再开一次枪吗？”“是啊，为什么不呢？”于是又一轮的“弹药”倾泻过来。&lt;/p&gt;
&lt;p&gt;这一轮的热度和噪音都相当可观。渐渐的，那台电脑开始瓦解了，正面几乎已经熔化光了，大股大股的金属液体朝着他们蹲着的地方漫过来。他们又向后挤了挤，等待最后结局。 &lt;/p&gt;
&lt;p&gt;=== 第三十四章 ===&lt;/p&gt;
&lt;p&gt;空中飞车载著他们以超过R17的速度通过那条钢铁隧道，一举冲上荒芜的行星表面，迎接他们的是又一轮黎明前的微光。诡异的灰色光芒象是凝结在大地的表面。&lt;/p&gt;
&lt;p&gt;R是一个速度计量标准，代表着一种合理的行驶速度，与乘客的生理健康、心理安适以及不超过——这么说吧——5分钟的晚点相协调。因此，它显然是一个根据环境的不同而几乎无限可变的变量，因为前两个因素不仅绝对的随速度而变化，还相对的随着对第三个因素的知觉意识而变化。这样的一个综合方程式如果处理不好的话，就会出现压力、溃疡甚至死亡。&lt;/p&gt;
&lt;p&gt;R17不是一个固定的速度，但它显然是快得有点儿离谱的那种。&lt;/p&gt;
&lt;p&gt;空中飞车以R17甚至更高的速度划过天际，最后降落在静静的停在冻僵的地面上、象一块漂白过的骨头似的“黄金之心”号旁边。放下乘客后，它就猛地向着来时的方向飞走了，大概是去执行它自己的什么重要使命。&lt;/p&gt;
&lt;p&gt;四个人站在原地看着他们的飞船，浑身发抖。&lt;/p&gt;
&lt;p&gt;它旁边还停著另外一艘。&lt;/p&gt;
&lt;p&gt;那是布拉古伦卡帕星的警用飞船，一个球状的长得鲨鱼的玩意儿，暗绿色，，船身上有些大小不一、张牙舞抓的黑色字母。这些字母像那些有耐心去读它们的人提供了一些信息，诸如这艘飞船从哪儿来、属于警察的哪个部门，以及燃料添加对接口在哪个位置。&lt;/p&gt;
&lt;p&gt;它看上暗淡和安静的有些不太正常。它的两个船员现在正僵硬的躺在几英里之外的地下一个布满烟雾的房间里，但即便是对处于这种状态的飞船来说，它也暗淡和安静得太不正常了。这虽然属于那种不可能去解释和定义的古怪事情，但是当一艘飞船彻彻底底死去的时候，人们总是能够感觉得到的。&lt;/p&gt;
&lt;p&gt;福特现在就有这样的感，他认为这是最神秘的——一艘飞船和两个警察就这么不明不白的死了。在他的经验里，宇宙的法则似乎不是这样的。&lt;/p&gt;
&lt;p&gt;另外三个人也能感觉到，不过他们更能感觉到刺骨的寒冷，所以赶忙钻进了“黄金之心”号，没有一丝一毫出于好奇心的留恋。&lt;/p&gt;
&lt;p&gt;福特却留在外面，走过去检查布拉古伦飞船。途中，他差点儿被一个脸朝下趴在寒冷灰尘中的钢铁玩意儿绊倒。&lt;/p&gt;
&lt;p&gt;“马文！”他叫了起来，“你在这儿干吗！”“请你不必管我。”一阵低沉的嗡嗡声传出。&lt;/p&gt;
&lt;p&gt;“可是你还好吧，金属人？”福特问。&lt;/p&gt;
&lt;p&gt;“非常沮丧。”“怎么了？”“我也不知道。”马文说。&lt;/p&gt;
&lt;p&gt;福特在他身边蹲了下来，冷得发抖，“为什么你会脸朝下趴在灰尘中？”“要想悲惨的话，这是一个好办法。”马文说，“别装出一副想和我说话的样子，我知道你恨我。”“不，我不恨你。”“是的，你就是恨我，大家都恨我。这是宇宙形态的一部分。我不得不和一些人交谈，然后他们就开始恨我了。甚至机器人也恨我。如果你没有注意到我的话，我想我很可能会走开的。”他用脚支撑着爬起来，坚定的面朝相反的方向。&lt;/p&gt;
&lt;p&gt;“那艘飞船也恨我。”他指着警用飞船，心灰意冷地说。&lt;/p&gt;
&lt;p&gt;“那艘飞船？”福特突然兴奋的说，“它发生了什么事情？你知道吗？”“它恨我，因为我对它说话了。”“你对它说话？”福特又叫了起来，“你这是什么意思？”“很简单。我非常无聊和沮丧，所以就跑过去把自己和它外面的电脑对接口连了起来。我对那台电脑说了很久很久，向它解释了我的观点，从宇宙一直到他自己。”马文说。&lt;/p&gt;
&lt;p&gt;“然后呢？”福特追问道。&lt;/p&gt;
&lt;p&gt;“然后它就自杀了。”马文说，随后迈开大步朝着“黄金之心”号走去。 &lt;/p&gt;
&lt;p&gt;=== 第三十五章 ===&lt;/p&gt;
&lt;p&gt;那个晚上，当“黄金之心”号忙着在自己和马头星云之间拉开数光年的距离时，赞福德懒洋洋的躺在控制桥里的那株小棕榈树下面，试图借助强力的泛银河系含漱爆破药来整理自己的思路：福特和崔莉恩坐在一个角落里讨论生命以及由此而引发的一系列问题：阿瑟躺在床上翻看福特的那本《银河系漫游指南》。既然自己从此以后就必须在这个空间内生活了，他觉得，最好还是开始了解一下这地方。&lt;/p&gt;
&lt;p&gt;他偶然翻到了这样一个条目。&lt;/p&gt;
&lt;p&gt;它说：“银河系每一个主要文明的历史都会经历三个可以清晰辨识的阶段，即生存、质疑和诡辩，或者也被称为如何、为何以及向何处去三阶段。比如，第一个阶段的特征是这样的问题：我们如何才能吃到东西？第二个阶段则是：我们为何要吃东西？第三个阶段就变成了：我们到何处吃午餐呢？”&lt;/p&gt;
&lt;p&gt;这时，飞船的对讲系统嗡嗡的响了起来，他也就沒有再继续看下去了。&lt;/p&gt;
&lt;p&gt;“嘿，地球人？你饿了吗，伙计？”赞福德的声音传来。&lt;/p&gt;
&lt;p&gt;“喔，好吧，是的，我想我是有点儿饿了。”阿瑟回答说。&lt;/p&gt;
&lt;p&gt;“那好，伙计，再稍微忍忍吧。”赞福德说。“我们很快就可以到一家餐馆美美的吃上一顿了，就在宇宙的尽头。”&lt;/p&gt;
&lt;p&gt;（完） &lt;/p&gt;</summary></entry><entry><title>SQLSTATE[HY000] [2003] Can't connect to MySQL server on 'servername' (99)</title><link href="http://liugehao.github.io/sqlstatehy000-2003-cant-connect-to-mysql-server-on-servername-99.html" rel="alternate"></link><updated>2012-10-29T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-10-29:sqlstatehy000-2003-cant-connect-to-mysql-server-on-servername-99.html</id><summary type="html">&lt;p&gt;php，mysql压力测试，mysql服务器无压力，php出现以下错误：
{{{ 
SQLSTATE[HY000] [2003] Can't connect to MySQL server on 'servername' (99)
}}}&lt;/p&gt;
&lt;p&gt;99:Cannot assign requested address [不能分配请求地址]&lt;/p&gt;
&lt;p&gt;客户端频繁的连服务器，由于每次连接都在很短的时间内结束，导致很多的TIME_WAIT，以至于用光了可用的端 口号，所以新的连接没办法绑定端口，即“Cannot assign requested address”。是客户端的问题不是服务器端的问题。通过netstat，的确看到很多TIME_WAIT状态的连接。
从网上找了解决办法：
执行命令修改如下2个内核参数&lt;br /&gt;
{{{
sysctl -w net.ipv4.tcp_timestamps=1  开启对于TCP时间戳的支持,若该项设置为0，则下面一项设置不起作用
sysctl -w net.ipv4.tcp_tw_recycle=1  表示开启TCP连接中TIME-WAIT sockets的快速回收
}}}&lt;/p&gt;
&lt;p&gt;有关内核级别的keepalive和time_wait的优化调整 
{{{&lt;/p&gt;
&lt;h1&gt;vi /etc/sysctl&lt;/h1&gt;
&lt;p&gt;net.ipv4.tcp_tw_reuse = 1 
net.ipv4.tcp_tw_recycle = 1 
net.ipv4.tcp_keepalive_time = 1800 
net.ipv4.tcp_fin_timeout = 30 
net.core.netdev_max_backlog =8096 &lt;/p&gt;
&lt;h1&gt;修改完记的使用sysctl -p 让它生效&lt;/h1&gt;
&lt;p&gt;}}}
以上参数的注解 /proc/sys/net/ipv4/tcp_tw_reuse 该文件表示是否允许重新应用处于TIME-WAIT状态的socket用于新的TCP连接。&lt;/p&gt;
&lt;p&gt;修改内核参数，快速回收time_wait sockets：
{{{
[root@centos ~]# echo "net.ipv4.tcp_tw_reuse = 1" &amp;gt;&amp;gt; /etc/sysctl.conf&lt;/p&gt;
&lt;h1&gt;表示开启重用。允许将TIME-WAIT sockets重新用于新的TCP连接，默认为0，表示关闭；&lt;/h1&gt;
&lt;p&gt;[root@centos ~]# echo "net.ipv4.tcp_tw_recycle = 1" &amp;gt;&amp;gt; /etc/sysctl.conf&lt;/p&gt;
&lt;h1&gt;表示开启TCP连接中TIME-WAIT sockets的快速回收，默认为0，表示关闭。&lt;/h1&gt;
&lt;p&gt;[root@centos ~]# sysctl -p
}}}&lt;/p&gt;
&lt;p&gt;== 重点在这里，参考 ==
修改/etc/sysctl.conf ,改完sysctl -p&lt;/p&gt;
&lt;p&gt;其中一台mysql服务器配置16G：
{{{
net.ipv4.ip_forward = 0
net.ipv4.conf.default.rp_filter = 1
net.ipv4.conf.default.accept_source_route = 0
kernel.sysrq = 0
kernel.core_uses_pid = 1
kernel.msgmnb = 65536
kernel.msgmax = 65536
kernel.shmmax = 68719476736
kernel.shmall = 4294967296
kernel.shmmni = 4096
kernel.sem = 250 32000 100 128
fs.file-max = 65536
net.ipv4.tcp_syncookies = 1
net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_timestamps = 1
net.ipv4.tcp_tw_recycle = 1
net.ipv4.tcp_fin_timeout = 30
net.ipv4.tcp_keepalive_time = 1200
net.ipv4.ip_local_port_range = 1024 65536
net.ipv4.tcp_max_syn_backlog = 262144
net.ipv4.tcp_max_tw_buckets = 8000
}}}
我的桌面机器，测试连接mysql测试机，php-fpm:
{{{
fs.file-max = 805916
net.ipv4.tcp_timestamps = 1
net.ipv4.tcp_tw_recycle = 1
}}}&lt;/p&gt;
&lt;p&gt;== 参考 ==&lt;/p&gt;
&lt;p&gt;场景：使用libcurl 向本机的nginx 发请求，每隔一段时间，会出“Couldn't connect to server”，此时使用telnet 也会有错，Couldn't connect to server，同时观察netstat 发现很多TIME_WAIT。&lt;/p&gt;
&lt;p&gt;分析：客户端频繁的连服务器，由于每次连接都在很短的时间内结束，导致很多的TIME_WAIT，以至于用光了可用的端口号，所以新的连接没办法绑定端口，即“Cannot assign requested address”&lt;/p&gt;
&lt;p&gt;解决：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;在程序中设置立即关闭不经历TIME_WAIT，以重用端口
{{{
int bReuseaddr=1;
setsockopt(s,SOL_SOCKET ,SO_REUSEADDR,(const char*)&amp;amp;bReuseaddr,sizeof(int));
}}}&lt;/li&gt;
&lt;li&gt;修改内核参数&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;vi /etc/sysctl.conf 在末尾添加以下内容：
{{{
net.ipv4.tcp_syncookies = 1
net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_tw_recycle = 1
}}}
net.ipv4.tcp_syncookies = 1 表示开启SYN Cookies。当出现SYN等待队列溢出时，启用cookies来处理，可防范少量SYN攻击，默认为0，表示关闭；&lt;/p&gt;
&lt;p&gt;net.ipv4.tcp_tw_reuse = 1 表示开启重用。允许将TIME-WAIT sockets重新用于新的TCP连接，默认为0，表示关闭；&lt;/p&gt;
&lt;p&gt;net.ipv4.tcp_tw_recycle = 1 表示开启TCP连接中TIME-WAIT sockets的快速回收，默认为0，表示关闭。&lt;/p&gt;
&lt;p&gt;使配置生效： /sbin/sysctl -p&lt;/p&gt;</summary></entry><entry><title>修改Linux内核的限制连接数</title><link href="http://liugehao.github.io/xiu-gai-linuxnei-he-de-xian-zhi-lian-jie-shu.html" rel="alternate"></link><updated>2012-10-29T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-10-29:xiu-gai-linuxnei-he-de-xian-zhi-lian-jie-shu.html</id><summary type="html">&lt;p&gt;很多问题因这个而起，Nginx,memcached,php等连接数不够，都可能与这有关，所以装完Linux，第一件事，就要修改它。&lt;/p&gt;
&lt;p&gt;1.当前测试
{{{&lt;/p&gt;
&lt;h1&gt;ulimit -n&lt;/h1&gt;
&lt;p&gt;1024&lt;/p&gt;
&lt;h1&gt;cat /proc/sys/fs/file-max&lt;/h1&gt;
&lt;p&gt;755070&lt;/p&gt;
&lt;h1&gt;ulimit -n 755070&lt;/h1&gt;
&lt;p&gt;}}}
2.编辑 /etc/sysctl.conf&lt;/p&gt;
&lt;h1&gt;在文件最末尾加入下面内容&lt;/h1&gt;
&lt;p&gt;{{{
fs.file-max = 755070
}}}
3.编辑 /etc/security/limits.conf
星号代表全局， soft为软件，hard为硬件，nofile为这里指可打开文件数。
{{{
&lt;em&gt; soft nofile 755070
&lt;/em&gt; hard nofile 755070
}}}
4.编辑 /etc/pam.d/login
session required /lib64/security/pam_limits.so&lt;/p&gt;
&lt;p&gt;5.重启系统。&lt;/p&gt;</summary></entry><entry><title>优化Linux的内核参数来提高服务器并发处理能力</title><link href="http://liugehao.github.io/you-hua-linuxde-nei-he-can-shu-lai-ti-gao-fu-wu-qi-bing-fa-chu-li-neng-li.html" rel="alternate"></link><updated>2012-10-29T00:00:00+01:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-10-29:you-hua-linuxde-nei-he-can-shu-lai-ti-gao-fu-wu-qi-bing-fa-chu-li-neng-li.html</id><summary type="html">&lt;p&gt;PS：在服务器硬件资源额定有限的情况下，最大的压榨服务器的性能，提高服务器的并发处理能力，是很多运维技术人员思考的问题。要提高Linux系统下的负载能力，可以使用nginx等原生并发处理能力就很强的web服务器，如果使用Apache的可以启用其Worker模式，来提高其并发处理能力。除此之外，在考虑节省成本的情况下，可以修改Linux的内核相关TCP参数，来最大的提高服务器性能。当然，最基础的提高负载问题，还是升级服务器硬件了，这是最根本的。&lt;/p&gt;
&lt;p&gt;Linux系统下，TCP连接断开后，会以TIME_WAIT状态保留一定的时间，然后才会释放端口。当并发请求过多的时候，就会产生大量的TIME_WAIT状态的连接，无法及时断开的话，会占用大量的端口资源和服务器资源。这个时候我们可以优化TCP的内核参数，来及时将TIME_WAIT状态的端口清理掉。&lt;/p&gt;
&lt;p&gt;本文介绍的方法只对拥有大量TIME_WAIT状态的连接导致系统资源消耗有效，如果不是这种情况下，效果可能不明显。可以使用netstat命令去查TIME_WAIT状态的连接状态，输入下面的组合命令，查看当前TCP连接的状态和对应的连接数量：&lt;/p&gt;
&lt;h1&gt;netstat -n | awk ‘/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}’&lt;/h1&gt;
&lt;p&gt;这个命令会输出类似下面的结果：
{{{
LAST_ACK 16
SYN_RECV 348
ESTABLISHED 70
FIN_WAIT1 229
FIN_WAIT2 30
CLOSING 33
TIME_WAIT 18098
}}}
我们只用关心TIME_WAIT的个数，在这里可以看到，有18000多个TIME_WAIT，这样就占用了18000多个端口。要知道端口的数量只有65535个，占用一个少一个，会严重的影响到后继的新连接。这种情况下，我们就有必要调整下Linux的TCP内核参数，让系统更快的释放TIME_WAIT连接。&lt;/p&gt;
&lt;p&gt;用vim打开配置文件：#vim /etc/sysctl.conf&lt;/p&gt;
&lt;p&gt;在这个文件中，加入下面的几行内容：
{{{
net.ipv4.tcp_syncookies = 1
net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_tw_recycle = 1
net.ipv4.tcp_fin_timeout = 30
}}}
输入下面的命令，让内核参数生效：#sysctl -p&lt;/p&gt;
&lt;p&gt;简单的说明上面的参数的含义：
{{{
net.ipv4.tcp_syncookies = 1
}}}&lt;/p&gt;
&lt;h1&gt;表示开启SYN Cookies。当出现SYN等待队列溢出时，启用cookies来处理，可防范少量SYN攻击，默认为0，表示关闭；&lt;/h1&gt;
&lt;p&gt;{{{
net.ipv4.tcp_tw_reuse = 1
}}}&lt;/p&gt;
&lt;h1&gt;表示开启重用。允许将TIME-WAIT sockets重新用于新的TCP连接，默认为0，表示关闭；&lt;/h1&gt;
&lt;p&gt;{{{
net.ipv4.tcp_tw_recycle = 1
}}}&lt;/p&gt;
&lt;h1&gt;表示开启TCP连接中TIME-WAIT sockets的快速回收，默认为0，表示关闭；&lt;/h1&gt;
&lt;p&gt;{{{
net.ipv4.tcp_fin_timeout
}}}&lt;/p&gt;
&lt;h1&gt;修改系統默认的 TIMEOUT 时间。&lt;/h1&gt;
&lt;p&gt;在经过这样的调整之后，除了会进一步提升服务器的负载能力之外，还能够防御小流量程度的DoS、CC和SYN攻击。&lt;/p&gt;
&lt;p&gt;此外，如果你的连接数本身就很多，我们可以再优化一下TCP的可使用端口范围，进一步提升服务器的并发能力。依然是往上面的参数文件中，加入下面这些配置：
{{{
net.ipv4.tcp_keepalive_time = 1200
net.ipv4.ip_local_port_range = 10000 65000
net.ipv4.tcp_max_syn_backlog = 8192
net.ipv4.tcp_max_tw_buckets = 5000
}}}&lt;/p&gt;
&lt;h1&gt;这几个参数，建议只在流量非常大的服务器上开启，会有显著的效果。一般的流量小的服务器上，没有必要去设置这几个参数。&lt;/h1&gt;
&lt;p&gt;net.ipv4.tcp_keepalive_time = 1200&lt;/p&gt;
&lt;h1&gt;表示当keepalive起用的时候，TCP发送keepalive消息的频度。缺省是2小时，改为20分钟。&lt;/h1&gt;
&lt;p&gt;net.ipv4.ip_local_port_range = 10000 65000&lt;/p&gt;
&lt;h1&gt;表示用于向外连接的端口范围。缺省情况下很小：32768到61000，改为10000到65000。（注意：这里不要将最低值设的太低，否则可能会占用掉正常的端口！）&lt;/h1&gt;
&lt;p&gt;net.ipv4.tcp_max_syn_backlog = 8192&lt;/p&gt;
&lt;h1&gt;表示SYN队列的长度，默认为1024，加大队列长度为8192，可以容纳更多等待连接的网络连接数。&lt;/h1&gt;
&lt;p&gt;net.ipv4.tcp_max_tw_buckets = 6000&lt;/p&gt;
&lt;h1&gt;表示系统同时保持TIME_WAIT的最大数量，如果超过这个数字，TIME_WAIT将立刻被清除并打印警告信息。默 认为180000，改为6000。对于Apache、Nginx等服务器，上几行的参数可以很好地减少TIME_WAIT套接字数量，但是对于 Squid，效果却不大。此项参数可以控制TIME_WAIT的最大数量，避免Squid服务器被大量的TIME_WAIT拖死。&lt;/h1&gt;
&lt;p&gt;内核其他TCP参数说明：
{{{
net.ipv4.tcp_max_syn_backlog = 65536
}}}&lt;/p&gt;
&lt;h1&gt;记录的那些尚未收到客户端确认信息的连接请求的最大值。对于有128M内存的系统而言，缺省值是1024，小内存的系统则是128。&lt;/h1&gt;
&lt;p&gt;{{{
net.core.netdev_max_backlog = 32768
}}}&lt;/p&gt;
&lt;h1&gt;每个网络接口接收数据包的速率比内核处理这些包的速率快时，允许送到队列的数据包的最大数目。&lt;/h1&gt;
&lt;p&gt;{{{
net.core.somaxconn = 32768
}}}&lt;/p&gt;
&lt;h1&gt;web应用中listen函数的backlog默认会给我们内核参数的net.core.somaxconn限制到128，而nginx定义的NGX_LISTEN_BACKLOG默认为511，所以有必要调整这个值。&lt;/h1&gt;
&lt;p&gt;{{{
net.core.wmem_default = 8388608
net.core.rmem_default = 8388608
net.core.rmem_max = 16777216           #最大socket读buffer,可参考的优化值:873200
net.core.wmem_max = 16777216           #最大socket写buffer,可参考的优化值:873200
net.ipv4.tcp_timestsmps = 0
}}}&lt;/p&gt;
&lt;h1&gt;时间戳可以避免序列号的卷绕。一个1Gbps的链路肯定会遇到以前用过的序列号。时间戳能够让内核接受这种“异常”的数据包。这里需要将其关掉。&lt;/h1&gt;
&lt;p&gt;{{{
net.ipv4.tcp_synack_retries = 2
}}}&lt;/p&gt;
&lt;h1&gt;为了打开对端的连接，内核需要发送一个SYN并附带一个回应前面一个SYN的ACK。也就是所谓三次握手中的第二次握手。这个设置决定了内核放弃连接之前发送SYN+ACK包的数量。&lt;/h1&gt;
&lt;p&gt;{{{
net.ipv4.tcp_syn_retries = 2
}}}&lt;/p&gt;
&lt;h1&gt;在内核放弃建立连接之前发送SYN包的数量。&lt;/h1&gt;
&lt;p&gt;{{{&lt;/p&gt;
&lt;h1&gt;net.ipv4.tcp_tw_len = 1&lt;/h1&gt;
&lt;p&gt;net.ipv4.tcp_tw_reuse = 1
}}}&lt;/p&gt;
&lt;h1&gt;开启重用。允许将TIME-WAIT sockets重新用于新的TCP连接。&lt;/h1&gt;
&lt;p&gt;{{{
net.ipv4.tcp_wmem = 8192 436600 873200 # TCP写buffer,可参考的优化值: 8192 436600 873200
net.ipv4.tcp_rmem  = 32768 436600 873200 # TCP读buffer,可参考的优化值: 32768 436600 873200
net.ipv4.tcp_mem = 94500000 91500000 92700000 # 同样有3个值,意思是:
}}}
 1. net.ipv4.tcp_mem[0]:低于此值，TCP没有内存压力。
 1. net.ipv4.tcp_mem[1]:在此值下，进入内存压力阶段。
 1. net.ipv4.tcp_mem[2]:高于此值，TCP拒绝分配socket。
上述内存单位是页，而不是字节。可参考的优化值是:786432 1048576 1572864&lt;/p&gt;
&lt;p&gt;{{{
net.ipv4.tcp_max_orphans = 3276800
}}}&lt;/p&gt;
&lt;h1&gt;系统中最多有多少个TCP套接字不被关联到任何一个用户文件句柄上。&lt;/h1&gt;
&lt;p&gt;如果超过这个数字，连接将即刻被复位并打印出警告信息。
这个限制仅仅是为了防止简单的DoS攻击，不能过分依靠它或者人为地减小这个值，
更应该增加这个值(如果增加了内存之后)。
{{{
net.ipv4.tcp_fin_timeout = 30
}}}&lt;/p&gt;
&lt;h1&gt;如果套接字由本端要求关闭，这个参数决定了它保持在FIN-WAIT-2状态的时间。对端可以出错并永远不关闭连接，甚至意外当机。缺省值是60秒。2.2 内核的通常值是180秒，你可以按这个设置，但要记住的是，即使你的机器是一个轻载的WEB服务器，也有因为大量的死套接字而内存溢出的风险，FIN- WAIT-2的危险性比FIN-WAIT-1要小，因为它最多只能吃掉1.5K内存，但是它们的生存期长些。&lt;/h1&gt;
&lt;p&gt;经过这样的优化配置之后，你的服务器的TCP并发处理能力会显著提高。以上配置仅供参考，用于生产环境请根据自己的实际情况。&lt;/p&gt;</summary></entry><entry><title>用Composer管理PHP包</title><link href="http://liugehao.github.io/yong-composerguan-li-phpbao.html" rel="alternate"></link><updated>2012-10-26T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-10-26:yong-composerguan-li-phpbao.html</id><summary type="html">&lt;p&gt;使用环境&lt;/p&gt;
&lt;p&gt;=== Composer帮你解决如下问题： === &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;你有一个项目，而它的运行依赖于一系列的类库&lt;/span&gt;
&lt;span class="err"&gt;这些类库依赖于别的类库&lt;/span&gt;
&lt;span class="n"&gt;Composer&lt;/span&gt;&lt;span class="err"&gt;发现合适的版本下载、安装&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;=== 安装 ===&lt;/p&gt;
&lt;p&gt;Composer包括两大逻辑部分：存储包；命令行应用程序，用来帮助你发现、下载、更新和分享代码。
{{{
    $ cd/path/to/my/project
    $ curl -s http://getcomposer.org/installer| php
    #使用下列命令看是否安装成功
    $ php composer.phar
    #便于使用，将其放到运行环境中
    $ sudo mv composer.phar /usr/bin/composer
}}}
=== 解析composer.json文件 ===&lt;/p&gt;
&lt;p&gt;composer.json中声明了应用的依赖文件
{{{ $ php composer.phar install }}}
=== 自动加载 ===&lt;/p&gt;
&lt;p&gt;安装后，同时Composer提供了&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;vendor&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;autoload&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="err"&gt;来自动加载安装的类库&lt;/span&gt;
&lt;span class="n"&gt;composer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="err"&gt;下次运行&lt;/span&gt;&lt;span class="n"&gt;install&lt;/span&gt;&lt;span class="err"&gt;就会依据次来安装指定版本，或者运行&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary></entry><entry><title>数据库和数据仓库的区别</title><link href="http://liugehao.github.io/shu-ju-ku-he-shu-ju-cang-ku-de-qu-bie.html" rel="alternate"></link><updated>2012-10-22T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-10-22:shu-ju-ku-he-shu-ju-cang-ku-de-qu-bie.html</id><summary type="html">&lt;p&gt;简而言之，数据库是面向事务的设计，数据仓库是面向主题设计的。&lt;/p&gt;
&lt;p&gt;数据库一般存储在线交易数据，数据仓库存储的一般是历史数据。&lt;/p&gt;
&lt;p&gt;数据库设计是尽量避免冗余，一般采用符合范式的规则来设计，数据仓库在设计是有意引入冗余，采用反范式的方式来设计。&lt;/p&gt;
&lt;p&gt;数据库是为捕获数据而设计，数据仓库是为分析数据而设计，它的两个基本的元素是维表和事实表。维是看问题的角度，比如时间，部门，维表放的就是这些东西的定义，事实表里放着要查询的数据，同时有维的ID。&lt;/p&gt;
&lt;p&gt;单从概念上讲，有些晦涩。任何技术都是为应用服务的，结合应用可以很容易地理解。以银行业务为例。数据库是事务系统的数据平台，客户在银行做的每笔交易都会写入数据库，被记录下来，这里，可以简单地理解为用数据库记帐。数据仓库是分析系统的数据平台，它从事务系统获取数据，并做汇总、加工，为决策者提供决策的依据。比如，某银行某分行一个月发生多少交易，该分行当前存款余额是多少。如果存款又多，消费交易又多，那么该地区就有必要设立ATM了。&lt;/p&gt;
&lt;p&gt;显然，银行的交易量是巨大的，通常以百万甚至千万次来计算。事务系统是实时的，这就要求时效性，客户存一笔钱需要几十秒是无法忍受的，这就要求数据库只能存储很短一段时间的数据。而分析系统是事后的，它要提供关注时间段内所有的有效数据。这些数据是海量的，汇总计算起来也要慢一些，但是，只要能够提供有效的分析数据就达到目的了。&lt;/p&gt;
&lt;p&gt;数据仓库，是在数据库已经大量存在的情况下，为了进一步挖掘数据资源、为了决策需要而产生的，它决不是所谓的“大型数据库”。那么，数据仓库与传统数据库比较，有哪些不同呢?让我们先看看W.H.Inmon关于数据仓库的定义:面向主题的、集成的、与时间相关且不可修改的数据集合。&lt;/p&gt;
&lt;p&gt;“面向主题的”:传统数据库主要是为应用程序进行数据处理，未必按照同一主题存储数据;数据仓库侧重于数据分析工作，是按照主题存储的。这一点，类似于传统农贸市场与超市的区别—市场里面，白菜、萝卜、香菜会在一个摊位上，如果它们是一个小贩卖的;而超市里，白菜、萝卜、香菜则各自一块。也就是说，市场里的菜(数据)是按照小贩(应用程序)归堆(存储)的，超市里面则是按照菜的类型(同主题)归堆的。&lt;/p&gt;
&lt;p&gt;“与时间相关”:数据库保存信息的时候，并不强调一定有时间信息。数据仓库则不同，出于决策的需要，数据仓库中的数据都要标明时间属性。决策中，时间属性很重要。同样都是累计购买过九车产品的顾客，一位是最近三个月购买九车，一位是最近一年从未买过，这对于决策者意义是不同的。&lt;/p&gt;
&lt;p&gt;“不可修改”:数据仓库中的数据并不是最新的，而是来源于其它数据源。数据仓库反映的是历史信息，并不是很多数据库处理的那种日常事务数据(有的数据库例如电信计费数据库甚至处理实时信息)。因此，数据仓库中的数据是极少或根本不修改的;当然，向数据仓库添加数据是允许的。&lt;/p&gt;
&lt;p&gt;数据仓库的出现，并不是要取代数据库。目前，大部分数据仓库还是用关系数据库管理系统来管理的。可以说，数据库、数据仓库相辅相成、各有千秋。&lt;/p&gt;
&lt;p&gt;补充一下，数据仓库的方案建设的目的，是为前端查询和分析作为基础，由于有较大的冗余，所以需要的存储也较大。为了更好地为前端应用服务，数据仓库必须有如下几点优点，否则是失败的数据仓库方案。&lt;/p&gt;
&lt;p&gt;1.效率足够高。客户要求的分析数据一般分为日、周、月、季、年等，可以看出，日为周期的数据要求的效率最高，要求24小时甚至12小时内，客户能看到昨天的数据分析。由于有的企业每日的数据量很大，设计不好的数据仓库经常会出问题，延迟1-3日才能给出数据，显然不行的。&lt;/p&gt;
&lt;p&gt;2.数据质量。客户要看各种信息，肯定要准确的数据，但由于数据仓库流程至少分为3步，2次ETL，复杂的架构会更多层次，那么由于数据源有脏数据或者代码不严谨，都可以导致数据失真，客户看到错误的信息就可能导致分析出错误的决策，造成损失，而不是效益。) &lt;/p&gt;
&lt;p&gt;3.扩展性。之所以有的大型数据仓库系统架构设计复杂，是因为考虑到了未来3-5年的扩展性，这样的话，客户不用太快花钱去重建数据仓库系统，就能很稳定运行。主要体现在数据建模的合理性，数据仓库方案中多出一些中间层，使海量数据流有足够的缓冲，不至于数据量大很多，就运行不起来了。&lt;/p&gt;</summary></entry><entry><title>各种不同内存情况下的mysql配置文件</title><link href="http://liugehao.github.io/ge-chong-bu-tong-nei-cun-qing-kuang-xia-de-mysqlpei-zhi-wen-jian.html" rel="alternate"></link><updated>2012-10-19T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-10-19:ge-chong-bu-tong-nei-cun-qing-kuang-xia-de-mysqlpei-zhi-wen-jian.html</id><summary type="html">&lt;ol&gt;
&lt;li&gt;(2012-10-19 08:18:39, 6.3 KB) [[attachment:my.cnf_128GB.txt]]&lt;/li&gt;
&lt;li&gt;(2012-10-19 08:18:18, 6.4 KB) [[attachment:my.cnf_16GB.txt]]&lt;/li&gt;
&lt;li&gt;(2012-10-19 08:17:57, 6.4 KB) [[attachment:my.cnf_1GB.txt]]&lt;/li&gt;
&lt;li&gt;(2012-10-19 08:18:05, 6.4 KB) [[attachment:my.cnf_2GB.txt]]&lt;/li&gt;
&lt;li&gt;(2012-10-19 08:18:22, 6.4 KB) [[attachment:my.cnf_32GB.txt]]&lt;/li&gt;
&lt;li&gt;(2012-10-19 08:18:08, 6.4 KB) [[attachment:my.cnf_4GB.txt]]&lt;/li&gt;
&lt;li&gt;(2012-10-19 08:18:28, 6.4 KB) [[attachment:my.cnf_64GB.txt]]&lt;/li&gt;
&lt;li&gt;(2012-10-19 08:18:32, 6.4 KB) [[attachment:my.cnf_72GB.txt]]&lt;/li&gt;
&lt;li&gt;(2012-10-19 08:18:12, 6.4 KB) [[attachment:my.cnf_8GB.txt]]&lt;/li&gt;
&lt;li&gt;(2012-10-19 08:18:36, 6.4 KB) [[attachment:my.cnf_96GB.txt]]&lt;/li&gt;
&lt;/ol&gt;</summary></entry><entry><title>(!) 在这里详述 liugehao-工作-201209。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-liugehao-gong-zuo-201209.html" rel="alternate"></link><updated>2012-10-18T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-10-18:zai-zhe-li-xiang-shu-liugehao-gong-zuo-201209.html</id><summary type="html">&lt;p&gt;[[liugehao]] -&amp;gt; [[liugehao工作]] -&amp;gt; [[liugehao-工作-201209]]&lt;/p&gt;
&lt;p&gt;= Todo =&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;信息中心工作协同软件需求&lt;/li&gt;
&lt;li&gt;Ldap试验,多系统用户登录.ldap服务器安装配置,从SOA中导用户到ldap,其它系统接入ldap试验.&lt;/li&gt;
&lt;li&gt;webservice 压力测试&lt;/li&gt;
&lt;li&gt;crm压力测试&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;I. 6日
  i. 人员数据导出java,系统接收参数重复,江伍波说下午回复 (!) 验证字符串更改为每次请求相同,安全系数太低,已反馈给他
  i. 帮解决面单二维码打印中间数据传输问题 (./)
 I. 7日
  i. 段以元测试内容及文档了解
  i. ldap用户帐号,实际部门设置与帐号登录部门实现方法
 I. 10日
  i. 手机客户端需求文档阅读
  i. 价格查询开发文档,查看.安排郭吉刚压力测试
  i. 装卸车对比配置文件修正
 I. 11日
  i. 阅读ＬＤＡＰ文档，
  i. 鲁改车辆系统
  i. 了解价格查询测试进度　测试机安装没有屏蔽短信，存储过程未创建
  i. 了解用户导出we service测试情况
  i. 甘洪波要我验收外包公司的手机系统，我根本不知道这回事，要来文档查看
 I. 12日
  i. 王雪凯装卸车系统修改。文件不规范，故未配置好数据库
  i. 下午开会讨论装卸车对比相关
 I. 13日
  i. 写装卸车系统的程序处理逻辑文档
  i. 小组长会议，讨论外包人员管理方法
 I. 14日
  i. crm测试及开发人员安在１８测试机上装oracle了２天未成功，安装测试服务器的oracle。
  i. 安排外包人员下周工作
  i. 与杨庆辉讨论信息中心工作协同软件需求，初步确定用redmine定制
  i. 处理测试服务器mysql未启动问题
 I. 17日
  i. 测试确定php 连接　oracle速度。速度没有问题。页面打开２，３秒初步确定为crm本身问题。
 I. 18日
  i. 部署韵达网站到测试机，更改不规范代码，入git 。规范没有制度不涉及利益，等于废话。
  i. 服务器安装php-mysql扩展.redhat配置，软件安装不是缺这个就缺那个。
  i. 韵达网站测试
 I. 19日
  i. 韵达网站测试
  i. 新来个什么经理,下午开会
 I. 20日
  i. 新来的经理调研
  i. 韵达网站测试,代码问题,服务器优化问题
  i. 测试数据库迁移至测试机
 I. 21日
  i. 测试WEB服务器优化，MYSQL优化，loadruner服务器优化
 I. 21日
  i. MYSQL优化， 测试
  i. 韵达网站部分代码review,这个任务已经开始近2个月，余华伟工作拖拉，所以让顾虎每天催2次。修改完的东西始终有问题查不出来，让李培吉放到正式服务器开个临时目录，对比一下，不同意。让他把正式的拉到测试服务器，在同一台机器对比，也不同意。道理一大堆，这个时间做都做完了。
 I. 24日
  i. MYSQL优化， 测试, 继续网站测试
 I. 25日
  i. MYSQL优化， 测试, 继续网站测试
 I. 26日
  i. 分析韵达网站测试报告，
 I. 27日
  i. 调试204服务器teradata的PHP连接，未OK
 I. 28日
  i. 于亚丽ts系统编码转换，文本替换。
  i. 调试204服务器teradata的PHP连接 OK。用了２天时间，原因是二蛋安装的ODBC缺少相应的devel
 I. 29日
  i. 粗略review ts系统代码&lt;/p&gt;</summary></entry><entry><title>初创公司的九句傻话</title><link href="http://liugehao.github.io/chu-chuang-gong-si-de-jiu-ju-sha-hua.html" rel="alternate"></link><updated>2012-10-17T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-10-17:chu-chuang-gong-si-de-jiu-ju-sha-hua.html</id><summary type="html">&lt;p&gt;人都有小时候，初创公司会说些傻话，没啥好奇怪的。不过如果老板持续说傻话，没意图深入学习互联网业，你还是考虑跳了吧。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;我要做个淘宝/阿里巴巴/百度/腾讯那样的网站/产品。
    通常这句傻话下面，往往还跟着，10W块，三个月，够不够？没说后半句就已经够傻了，说了差不多够格上春晚了。你当自己是腾讯啊，没管理没技术的初创公司，靠抄袭，和各大IT巨头的拳头产品拼，没有比这个更傻的了。要抄的对象是外国公司还算合理，具体情况具体分析。&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;.我们有来自名校出身的CXO——XXX，来自海外大公司的技术总监——XXX，前XXX公司创意总监——XXX，在他们的带领下，我们一定能XXXXXX。
    好吧，有的时候，这句话不是那么傻。问题是，说这句话的人，十个里面大概会失败九个。一方面，来自名门不代表能力超群，有时也可能是能力/人品问题而被踢出来的。另一方面，牛人多了也不行。俗话说，别带两个闹钟出海，带一个或三个。到时候财务总监说砍，业务总监说干，两个人谁都不让谁，老板的头一个比三个大。要是两个牛都在同一个部门，例如两个技术总监，那就更有趣了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;我有个创意，不过最近很忙，没法详细整理出来。我大概讲一下，你们先做起来，回头我给你们补充。
    连创意细节都不重视，或者不愿意说，还创业呢，失业吧。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;这里有份策划，你看看要多久？半年？不行，太长了。给你们加20个人，三个月给我做出来，早出来有奖金。
    很明显，这老板肯定没看过brooks的那本《人月传说》。通常这份策划一年能出来就算幸运了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;暂时没有工资/工资不高，不过我们有原始股份，将来考虑上市。&lt;/p&gt;
&lt;p&gt;明显忽悠傻小子呢，一穷二白一起创业，是要双方彼此熟悉和信任对方为前提的。人都要吃饭，光给股份不给钱，来的是什么人就不用多说了吧。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;恩，策划大概是这样。服务器准备怎么搞？租用？太花钱了。我们自己组装服务器好了，反正不复杂，你就顺手搞了吧，便宜多了。
    创业初期，专心自己的业务。一会想自己搞服务器，一会想自己搞所需要的业务库，一会又想把某个功能做成独立网站做接口，你真的想明白自己要干什么了么？&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;我要做一个产品，界面要炫，一定要好看。操作要人性化，要让用户满意。功能要全，人家有的我们都不能少。
    老板，您这产品是做什么的？&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;马云当年十八罗汉闯天下，我们为什么不行。豆瓣开始三台服务器顶住了所有业务，我们为什么不行。
    是啊是啊，朱镕基当了总理，你为什么不行？释迦摩尼当了佛祖，你为什么不行？抛开各种因素分析，就想着和别人比，你真的有那个条件么？&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;钱不是问题。
    恩，多数问题是没钱。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</summary></entry><entry><title>给初创小公司的几句话</title><link href="http://liugehao.github.io/gei-chu-chuang-xiao-gong-si-de-ji-ju-hua.html" rel="alternate"></link><updated>2012-10-17T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-10-17:gei-chu-chuang-xiao-gong-si-de-ji-ju-hua.html</id><summary type="html">&lt;p&gt;== 1 ==
贝壳做程序员到现在，没去过国企（好吧，和他们有过合作，可实在看不惯他们的作派，死也不去），没去过外企（也是有合作，可惜英语太差），全在各种私企里面打转。从初创公司到中型外包都呆过，还曾是某初创公司的第一个员工，可惜结局不怎么好——关门了。初创公司的一些问题，可谓前仆后继，大家的死法差不多。当员工时，不好给老板直接提意见。现在私下里偷偷说说，有想开公司的当故事听吧。&lt;/p&gt;
&lt;p&gt;初创公司第一怕，就是没有经验。没有经验的程序员，没有经验的经理，所以很多事情都不知道怎么办，只能摸着石头过河。实话说，完全摸石头的，还不如不开了。最起码最起码，老板做什么，就必须熟悉这行。想干互联网，必须熟悉互联网。想干企业，就必须熟悉企业。没这个要求，不如不干。至于技术上没经验，可以找合适的程序员。如果老板熟悉互联网，很多做阿里巴巴阿，做腾讯之类的傻话都不会说出来了，他要做的一定是个没有的东西，或者说在中国没有，或者有，但是市场刚要起步。在一个饱和市场内挑战一个巨头，这和唐吉柯德挑战风车是一样的，能得到的只是海明威笔下的鱼骨头。&lt;/p&gt;
&lt;p&gt;初创公司没有人熟悉技术怎么办？这就要看你的公司类型了。如果你决定以业务为核心，可以找个诚实可靠（别说看人看不准，如果人看不准，公司哪里都会碰壁）有经验的程序员做主管，记得谈分红或者股份，然后放手给他。他会帮你管理的很好的。不过记得偶尔就他的做法咨询一下其他懂行的朋友。通常这类程序员最好是来自于大型企业IT部或者大型互联网公司，他们会把大型互联网公司的规范带过来。当然，也不要无条件的接受。先文档后程序，重测试轻代码之类的东西对初创是不适用的。起码要等公司有10来个程序员再回头补课。这些人构成的程序部是写不出什么天才程序的，但是可以有效廉价的把你要做的业务做起来。&lt;/p&gt;
&lt;p&gt;如果你决定以技术为核心（实话说，中国这种公司比例不高），你起码得有一个高手在手里，才能谈公司的问题。而且公司开起来，你得分给他很高比例的股份。大部分这类创业老板，都是自己就是高级程序员，觉得挺了解程序了。这种情况下的建议反过来，你要找熟悉市场的人，不要觉得你很熟悉市场。程序员不是一个典型用户，除非你的用户都是程序员，否则大部分的需求需要重新考虑，甚至商业模式都未必成立。&lt;/p&gt;
&lt;p&gt;初创公司最怕的情况，就是老板不懂技术，也不找人，胡乱指挥。贝壳呆的头家公司，现在已经关门了，所以说说问题也不大。老板决定做销售管理软件，实话说这个决定没什么问题，问题是老板的生产过程。他先找了三个程序员过来（两个新手一个老手，贝壳就是第一个员工，当时年轻，什么都不懂），然后请一个大学教授当顾问。由于大学老师都比较忙，因此他让其中一个比较有经验的程序员负责平时管理，不过还是按照员工待遇。然后他开始做需求，结果时间太少，需求做半本就开始做程序。一下就犯了大忌，需求未系统化。老程序员心知肚明，可是能说什么呢？自己连合伙人都不是，根本说不动老板。&lt;/p&gt;
&lt;p&gt;然后制定计划的时候，老程序员制定了一个相对保守的计划——这是当然，因为只有一个老程序员和两个新手，他怎么也不敢激进阿。老板当场否决，把时间提前了两个月，变成三个月完成，并且承诺会加派招程序员。又是一个大忌，拍脑袋决定周期，也没有标杆事件控制。当天我就看到老程序员白着脸进去黑着脸出来，然后很郁闷的修改时间。不过后面的事情好玩的很，程序员来一个走一个，基本留不住人。现在想起来，当时工资实在太低了。工资低是有理由的，贝壳当时基本什么都不会，光学SSH就学了一个多月——还基本不大会用。&lt;/p&gt;
&lt;p&gt;做产品的时候，考虑使用数据库，一下子居然挑中了oracle。现在反观，我也不知道怎么做的决策。用oracle做互联网的公司，目前为止我还没听说过第二家，因为oracle的长处在于事务和稳定性，而不是性能。由于维护麻烦，因此也没有买oracle自己的授权，而是第三方公司卖的5W的版本。就贝壳后来所知，oracle从未有这个级别的版本，他们的产品都是20W一个CPU，可以支持25个同步连接来卖的。天知道这个所谓第三方公司是怎么回事。由于配置麻烦（当时还是8），因此抽调我过去处理oracle的安装问题。贝壳就花了一个多月，把linux和oracle安装学了一遍。不过这一来，一个多月贝壳就基本没怎么写代码。一个初创公司一个员工一个月不写代码，可谓是很无谓的损失了。&lt;/p&gt;
&lt;p&gt;更夸张的是，由于老板考虑部署的时候，立足点都是——用户太多怎么办，压根没考虑过没用户的问题。所以他开始就自己买机器进行IDC部署。偏偏普通服务器他又觉得太贵，所以还自己装服务器。贝壳再跑了好几次电脑城，买服务器装。虽然采购还是按照采购流程走的，但是又大概一周不干程序。服务器终于全部搞定上线了，贝壳大概一个月花掉了。几个月过去，老板发现进度跟不上计划，就先推迟了发布计划，然后找大家紧急开会。结论是，他加速做需求，我们加班搞定代码。可是有用么？完全没用。下面几个月糊里糊涂，贝壳都不记得自己做了点啥了。发布计划一推再推，贝壳一点信心都没有，就辞职走人了。&lt;/p&gt;
&lt;p&gt;后来听说，在长达一年多的开发后，他们还是搞定了系统，并且正式上线销售。但是只有几个客户愿意付钱。坚持了一段时间，老板看实在赚不到钱，只有关门走人。&lt;/p&gt;
&lt;p&gt;回顾整个里面的问题，关键是外行领导内行。做顾问的教授是内行，但不是搞互联网的，又没时间。老程序员名义上是经理，却不能否决提议。实际上是最不懂互联网的老板自己在做决策，导致最关键的几个问题上，压根没有发现决策是错的。次之的问题，是为了省钱而浪费时间。程序员出价太低，招的都是新手。买oracle舍不得买原厂带服务的，非要自己搞。服务器都不买现成的，自己组装。这里面能节约的时间，绝对不是花钱能买到的。里面还有什么老板策划需求拍脑袋，听风就是雨，甚至要求我们做一个子功能，叫做"中国地图在线”之类的小事就不提了。&lt;/p&gt;
&lt;p&gt;虽说不想埋怨老板，不过贝壳确实在那家公司浪费了生命中的八个月，除了自学linux和oracle安装外没有剩下任何有用的技能。现在这段事情也被贝壳当作一个教训，很多事情不是看起来好就好的，如果事情看起来不靠谱，早点割肉退出不失为一个好的方案。&lt;/p&gt;
&lt;p&gt;== 2 ==
上面一篇，贝壳说了说老板搞外行指挥内行的问题。这篇反过来，是我一个朋友X的经历。他经历的更加的传奇一些，是一个内行指挥外行的经历。&lt;/p&gt;
&lt;p&gt;X是一家外企的程序员，原本这家外企没有IT部，后来为了做市场，于是成立了IT部。他是头一批的老员工，情况和贝壳类似。在他们之后，进来了一个很有水平的程序员Y。Y的水平很高，所以很快的就成了IT部实际的领导人。原本的外企中方经理很是器重，承诺分一定的公司股份，但是要求IT部能够达到一定目标。例如流量多少，来多少IP访问等等。Y很快就带领整个IT部开始行动了，需求分析，计划制定，时间节点分布，系统架构，都很中规中矩。SSH开发网站本身就是一个中规中矩的过程，没有太多的创意可说。半年不到，系统就上线了，基础测试通过，公司上下都很开心。&lt;/p&gt;
&lt;p&gt;问题发生在Y拿到公司股份之后，通常按照协议，股份是不能很快变现的。我不知道Y和公司怎么谈的协议，X君作为一个局外人，也只能告诉我一些小道消息。据说Y的股票居然很快就出手了，而后Y君很快的辞职，开了家咨询公司。&lt;/p&gt;
&lt;p&gt;而后公司系统陆续发生了一些问题，本来很稳定的流量一下缩水到几分之一，而X君说，他们的营销策略从未有大的改变。更麻烦的是，系统总是出一些莫名其妙的小问题，经常无法访问。公司没办法，只能高价请回Y君来解决。每次都是问题很快解决，但是另一个问题又再出现。几次往返后，公司实在不堪忍受，就再找了一个高手进来看看系统。X君说，人家上午过来，下午走人。说从未看过如此混乱不堪的代码，几乎没有可维护性，建议直接重写。&lt;/p&gt;
&lt;p&gt;然后公司就陷入了两难，要不要重写呢？不重写，这个系统显然没有任何继续发展的可能。重写，又如何保证新来的工程师不会搞出这种不可维护的系统。
据说，到X走的时候，中方经理已经被迫辞职了，外方决定找印度阿三来解决这个问题。当然，后面就是一个新的传说了。&lt;/p&gt;
&lt;p&gt;整个事情好像是一个职场阴暗面的故事，感觉平平无奇。不过实际上，整个故事还是有几个神奇的地方存在的。首先，公司没有做过Y君的背景调查么？还是说Y君以前一直OK？其次，通常股份都是不可立刻变现的，必须经过三到五年，其目的就是防止这种事情。类似的条件还有无法转让什么的，都跑到哪里去了？最后，公司所有人，包括X君在内，没有发现Y君的系统是不可维护的么？我始终感觉这个故事的背后还有其他故事，只是这已经不是我们讨论的要点了。&lt;/p&gt;
&lt;p&gt;== 3 ==
第三篇故事，是来自于贝壳自己的惨痛经历，在另一位朋友那里也有类似教训，可惜他未及早听我一句。&lt;/p&gt;
&lt;p&gt;贝壳原来在一家公司里面做项目经理，公司做企业定制开发，现在仍在，所以具体情况隐去不表。因为某些情况，老板叫贝壳做了项目经理，按照资历和能力来说，其实并未足够。贝壳精通的是C++开发，而项目是使用 .net 技术做的。因此贝壳对项目的管理能力实际上打了一个折扣，只能负责结构设计和协调。当时对项目管理也不是很精通，可以说是半吊子水平。公司承接了一个企业的业务系统开发，经过前期准备，我们团队就开去了客户那里进驻。客户要求，界面一定要漂亮。因此我们选型下来的结果，使用了 .net 3.5的wpf开发。开发过程中其实还是有很多问题，很多都是新手问题，暴露贝壳总体设计和项目把握的缺陷。不过这和今天主题无关，就略过不谈了。主要是 .net 3.5开发，到了最后发生了几个严重问题。&lt;/p&gt;
&lt;p&gt;首先第一个问题，是客户有很多win2000机器，甚至还有一些win98。这个在当初系统设计的时候完全没有考虑。我们开发的机器一律全是winxp，.net3.5 wpf可以完全的运行在上面。而对于win2000，wpf是无法安装的。于是，我们就必须要求客户升级到winxp。企业用户，他们还必须使用正版。其次，.net 3.5在进行远程SOAP调用的时候，会出现严重的内存泄漏。其实并不是真的泄漏了，只是.net 3.5的SOAP系统没有考虑调用接口可能多达数百个的情况，对每个函数都进行了序列化器缓存。这个缓存会耗费100-200M的空间，加上其他开销，我们的系统总开销是200-300M，比大部分游戏还高。这个直接导致客户运行我们系统的时候，必须多加一倍的内存。&lt;/p&gt;
&lt;p&gt;更郁闷的问题还在后面，wpf是使用dx渲染的系统，因此如果客户没有独立显卡，系统速度就会慢如龟速。wpf的部署必须使用完整sdk，2.0的runtime安装包只有20M，而3.5的完整sdk高达350M。我们在每台机器上安装的时候都是用U盘完整安装350M的sdk。不过这都不是最郁闷的，最郁闷的是，我们项目最后问题实在太多，有个员工做了一个web版的。界面难看很多，但是方便移植部署，内存消耗小。瞬间得到全企业上下一致支持，他们的老板还问我们，当初为什么不这么设计。贝壳哪里好意思说，您不是要漂亮么？&lt;/p&gt;
&lt;p&gt;实话说，要不是老板和客户关系好，我们非要给愤怒的客户踢出大门不可。这一个项目，成功的是老板，失败的是贝壳。&lt;/p&gt;
&lt;p&gt;总结下来，两个教训。首先是设计必须实地的调查一线需求，不能光听上面的就得出结论，也不能光看部分典型用户就得出结论。如果有一些关键用户对构架支持不良，业务上又不能放弃，就必须权衡得失，甚至修改构架。如果当时我们知道win2000乃至win98的事情，就压根不会考虑使用wpf来做界面。第二个，就是不能迷信技术，或者激进的使用无法掌控的技术。宁可使用最土的办法，老老实实的把业务做出来。新技术由于刚刚出现，因此很多问题都没有完全暴露，很多领域也没有经验积累。例如这个例子里面的内存占用问题，安装包问题，系统问题，都是到了部署时才发生的问题。使用新技术，就会随时面对无人发现的问题，这和RPG的踩地雷战斗是一样的经历。只是这里不但没有经验值，而且踩多了还会直接挂掉。&lt;/p&gt;
&lt;p&gt;== 4 ==&lt;/p&gt;
&lt;p&gt;第四个故事来自一个朋友的笑话。说某人从一家公司辞职了，朋友问说什么情况。某人说，和老板相处不来。老板看到有人上班看网页，就出了条规定，不许上班时间看网页，否则罚款。看到有人带朋友进办公室，就出条规定，不许上班时带朋友进办公室，否则罚款。上个月老婆出差，没人照顾家里的仓鼠，带去两天，出条规定，不得带宠物上班。某人情感受到了强烈的伤害，所以愤而辞职。&lt;/p&gt;
&lt;p&gt;其实说起来，这些事情都不是什么大事，鸡毛蒜皮到了我们可以当笑话说的地步。细究起来也确实是员工应当执行的，属于正常雇员的基本素养。不过如果您自己开家公司，照着上面的做，搞不好手下还真就一堆辞职的。&lt;/p&gt;
&lt;p&gt;从某种意义上说，这是一个心理问题。在IBM，或者Oracle这种大公司，出现这些条款没人觉得有什么不对，关键在于两点。一方面，大公司本身就给人一种正儿八经，板着个脸的印象。员工进公司的时候，就知道自己随时会碰到各种狗屁倒灶的规定，有一定的心理准备。小公司通常老总天天见，搞不好下班还一起吃饭喝酒，上班的时候板起脸来做规矩，情感上受得了受不了就不好说了。另一方面，大公司的规定相对完备，什么可以什么不可以都规定的非常详细。小公司难免挂一漏万，天天改规矩，确实不怎么好看。&lt;/p&gt;
&lt;p&gt;反过来说，这也是初创公司对大公司的优势。在大公司里，管理层显然不会留意到每个人的特性，并且针对性的管理。然而初创公司就那么几号人，大部分都是熟人。要针对管理不是一件不可能的事情。老婆出差，家里仓鼠可以带到公司，顺便睡在公司做程序得了，反正家里也没人。诸如此类的事情并不怎么难做。当然，当初创公司上了一定规模（推荐大概是10-30人）后，管理转换必然要产生阵痛。然而也远好过在三两个人的公司里面规定四五十条的规范。&lt;/p&gt;</summary></entry><entry><title>python/lxml比xml.dom.minidom的xml文件解析速度好太多</title><link href="http://liugehao.github.io/pythonlxmlbi-xmldomminidomde-xmlwen-jian-jie-xi-su-du-hao-tai-duo.html" rel="alternate"></link><updated>2012-10-16T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-10-16:pythonlxmlbi-xmldomminidomde-xmlwen-jian-jie-xi-su-du-hao-tai-duo.html</id><summary type="html">&lt;p&gt;第一个链接monidom解析要十几二十秒，第二个８Ｇ内存机器用守内存硬盘狂闪，机器基本停止响应。
==== 而换成lxml，解析第二个，只要一秒。  ====
{{{#!highlight python&lt;/p&gt;
&lt;h1&gt;!/usr/bin/env python&lt;/h1&gt;
&lt;h1&gt;-&lt;em&gt;- coding: utf-8 -&lt;/em&gt;-&lt;/h1&gt;
&lt;p&gt;import urllib2
import base64
import cStringIO
import zipfile
from lxml import etree
s = cStringIO.StringIO()&lt;/p&gt;
&lt;h1&gt;http://192.168.1.31:82/ydec/service/datareport/getOmOrgList.action?datatype=xml&amp;amp;hucite=test&amp;amp;starttime=2012-09-04%2014:06:21&amp;amp;endtime=2012-09-04%2015:06:42&amp;amp;data=wwww&amp;amp;validation=b0bd9f607d355e38f1e35d662992f2b0&lt;/h1&gt;
&lt;p&gt;s.write(base64.b64decode(urllib2.urlopen('http://192.168.1.31:82/ydec/service/datareport/getAcOperatorList.action?datatype=xml&amp;amp;hucite=test&amp;amp;validation=b0bd9f607d355e38f1e35d662992f2b0&amp;amp;data=wwww').read()))
s.seek(0)&lt;/p&gt;
&lt;p&gt;z = zipfile.ZipFile(s)
s = cStringIO.StringIO()
s.write(z.open('zip').read())
s.seek(0)&lt;/p&gt;
&lt;p&gt;xf = etree.parse(s)
columns = []
for n in xf.find('datas'):
    print '-' * 80
    values = []
    if not len(columns):
        for nc in n:
            columns.append(nc.tag)
    for nc in n:
        values.append(nc.text and nc.text  or '')&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;in&lt;/span&gt; &lt;span class="n"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;%20s&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s"&gt;%s&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="k"&gt;break&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;""" 
from xml.dom.minidom import parse, parseString
xf = parse(s) #性能与lxml比超慢，甚至内存不够无法完成(lxml瞬间完成)
columns = []
for n in xf.documentElement.getElementsByTagName('datas')[0].childNodes:
    print '-' * 80
    values = []
    if not len(columns):
        for nc in n.childNodes:
            columns.append(nc.nodeName)
    for nc in n.childNodes:
        values.append(nc.firstChild and nc.firstChild.toxml()  or '')&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;in&lt;/span&gt; &lt;span class="n"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;%20s&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s"&gt;%s&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="k"&gt;break&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;"""&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>安装python-ldap出错：</title><link href="http://liugehao.github.io/an-zhuang-python-ldapchu-cuo.html" rel="alternate"></link><updated>2012-10-12T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-10-12:an-zhuang-python-ldapchu-cuo.html</id><summary type="html">&lt;p&gt;{{{
gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_SASL -DHAVE_TLS -DHAVE_LIBLDAP_R -DHAVE_LIBLDAP_R -DLDAPMODULE_VERSION=2.4.10 -IModules -I/opt/openldap-RE24/include -I/usr/include/sasl -I/usr/include -I/usr/include/python2.7 -c Modules/LDAPObject.c -o build/temp.linux-x86_64-2.7/Modules/LDAPObject.o&lt;/p&gt;
&lt;p&gt;Modules/LDAPObject.c:18:18: 致命错误： sasl.h：没有那个文件或目录&lt;/p&gt;
&lt;p&gt;}}}
{{{
sudo apt-get install libldap2-dev libsasl2-dev
}}}&lt;/p&gt;</summary></entry><entry><title>在这里详述 python的库的open方法时文件内容已经在变量中。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-pythonde-ku-de-openfang-fa-shi-wen-jian-nei-rong-yi-jing-zai-bian-liang-zhong.html" rel="alternate"></link><updated>2012-10-12T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-10-12:zai-zhe-li-xiang-shu-pythonde-ku-de-openfang-fa-shi-wen-jian-nei-rong-yi-jing-zai-bian-liang-zhong.html</id><summary type="html">&lt;p&gt;{{{#!highlight python&lt;/p&gt;
&lt;p&gt;import cStringIO
f = cStringIO.StringIO()
f.write('safsd')
f.seek(0)&lt;/p&gt;
&lt;p&gt;with open(f, 'r') as b:
  print b.read()
}}}&lt;/p&gt;</summary></entry><entry><title>linux用apt-get安装软件总出错</title><link href="http://liugehao.github.io/linuxyong-apt-getan-zhuang-ruan-jian-zong-chu-cuo.html" rel="alternate"></link><updated>2012-09-27T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-27:linuxyong-apt-getan-zhuang-ruan-jian-zong-chu-cuo.html</id><summary type="html">&lt;p&gt;{{{
apt-get install oracle-java7-installer
.....
/usr/bin/dpkg returned an error code (1)
}}}
由于jdk安装时下载地址不对，所以出错。
{{{
apt-get -f install 
dpkg --configure -a
}}}
都无效
{{{
cd /var/lib/dpkg/info
rm oracle*
apt-get autoremove
}}}
问题解决&lt;/p&gt;</summary></entry><entry><title>ubuntu下ssh登录慢</title><link href="http://liugehao.github.io/ubuntuxia-sshdeng-lu-man.html" rel="alternate"></link><updated>2012-09-27T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-27:ubuntuxia-sshdeng-lu-man.html</id><summary type="html">&lt;p&gt;那就是,通过ssh登录到ubuntu,登录认证的时间总要用掉10多秒甚至20多秒30秒,
可能你已经习惯了这个事实,
但是,其实,这个漫长的等待时间完全是可以免掉的,怎么免,且看下面&lt;/p&gt;
&lt;p&gt;步骤一 关闭ssh的gssapi认证
{{{
vi /etc/ssh/ssh_config&lt;/p&gt;
&lt;h1&gt;注释掉如下两行&lt;/h1&gt;
&lt;p&gt;GSSAPIAuthentication yes
GSSAPIDelegateCredentials no
}}}&lt;/p&gt;
&lt;p&gt;步骤二 关闭ssh的UseDNS&lt;/p&gt;
&lt;p&gt;{{{
vi /etc/ssh/sshd_config
}}}
注：ubuntu的sshd_config文件没有UseDNS参数,而据我了解,其它类&lt;em&gt;NIX、&lt;/em&gt;BSD操作系统的sshd_config都有UseDNS参数，且它们缺省都是"UseDNS yes"，
那估计ubuntu的sshd_config虽然没有UseDNS，那它缺省也是"UseDNS yes"了
于是，在sshd_config末尾处插入如下行
{{{
UseDNS no
}}}&lt;/p&gt;
&lt;p&gt;然后执行指令"/etc/init.d/ssh restart"，重启ssh服务，配置生效&lt;/p&gt;</summary></entry><entry><title>python自动提取页面正文</title><link href="http://liugehao.github.io/pythonzi-dong-ti-qu-ye-mian-zheng-wen.html" rel="alternate"></link><updated>2012-09-26T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-26:pythonzi-dong-ti-qu-ye-mian-zheng-wen.html</id><summary type="html">&lt;p&gt;用BeautifulSoup 库取页面中p标签，给每个p按“,"和"，"加权重分，去除无用节点。
BeautifulSoup3下正常，BeautifulSoup4有点问题
 [[attachment:readability.py]]&lt;/p&gt;</summary></entry><entry><title>在这里详述 linux/moinmoin安装。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-linuxmoinmoinan-zhuang.html" rel="alternate"></link><updated>2012-09-24T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-24:zai-zhe-li-xiang-shu-linuxmoinmoinan-zhuang.html</id><summary type="html">&lt;p&gt;{{{&lt;/p&gt;
&lt;h1&gt;Install nginx&lt;/h1&gt;
&lt;p&gt;add-apt-repository ppa:nginx/stable
aptitude update
aptitude install nginx&lt;/p&gt;
&lt;h1&gt;Install and activate python virtualenv&lt;/h1&gt;
&lt;p&gt;pip install virtualenv
mkdir -p /srv/www/moin
virtualenv /srv/www/moin/pythonenv
source /srv/www/moin/pythonenv/bin/activate&lt;/p&gt;
&lt;h1&gt;Download and install moinmoin:&lt;/h1&gt;
&lt;p&gt;cd /tmp
wget http://static.moinmo.in/files/moin-1.9.4.tar.gz
tar zxvf moin-1.9.4.tar.gz
cd moin-1.9.4
python setup.py install&lt;/p&gt;
&lt;h1&gt;Deactivate python virtualenv&lt;/h1&gt;
&lt;p&gt;deactivate&lt;/p&gt;
&lt;h1&gt;Copy wiki to /srv/www/moin&lt;/h1&gt;
&lt;p&gt;cp -r ./wiki /srv/www/moin/&lt;/p&gt;
&lt;h1&gt;Copy configs to wiki root directory&lt;/h1&gt;
&lt;p&gt;cd /srv/www/moin/wiki/
cp config/wikiconfig.py ./
cp server/moin.wsgi ./&lt;/p&gt;
&lt;p&gt;vi /srv/www/moin/wiki/moin.wsgi&lt;/p&gt;
&lt;p&gt;sys.path.insert(0, '/srv/www/moin/pythonenv/lib/python2.7/site-packages/')
sys.path.insert(0, '/srv/www/moin/wiki/')&lt;/p&gt;
&lt;p&gt;chown www-data:www-data -R /srv/www/moin
chmod o-rwx -R /srv/www/moin&lt;/p&gt;
&lt;p&gt;aptitude install uwsgi uwsgi-plugin-python&lt;/p&gt;
&lt;p&gt;vi /srv/www/moin/uwsgi.xml&lt;/p&gt;
&lt;p&gt;&lt;uwsgi&gt;
    &lt;uid&gt;www-data&lt;/uid&gt;
    &lt;gid&gt;www-data&lt;/gid&gt;
    &lt;plugin&gt;python&lt;/plugin&gt;
    &lt;socket&gt;/srv/www/moin/moin.sock&lt;/socket&gt;
    &lt;wsgi-file&gt;/srv/www/moin/wiki/moin.wsgi&lt;/wsgi-file&gt;
    &lt;limit-as&gt;256&lt;/limit-as&gt;
    &lt;processes&gt;8&lt;/processes&gt;
    &lt;memory-report/&gt;
    &lt;vhost/&gt;
    &lt;no-site/&gt;
&lt;/uwsgi&gt;&lt;/p&gt;
&lt;p&gt;server {
    server_name wiki.example.com;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;access_log&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;access&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;error_log&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;include&lt;/span&gt; &lt;span class="n"&gt;uwsgi_params&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;uwsgi_pass&lt;/span&gt; &lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;///srv/www/moin/moin.sock;&lt;/span&gt;
    &lt;span class="n"&gt;uwsgi_modifier1&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>安装php扩展apc</title><link href="http://liugehao.github.io/an-zhuang-phpkuo-zhan-apc.html" rel="alternate"></link><updated>2012-09-21T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-21:an-zhuang-phpkuo-zhan-apc.html</id><summary type="html">&lt;p&gt;下载apc http://pecl.php.net/package/apc&lt;/p&gt;
&lt;p&gt;解包,进入目录
{{{
/opt/php5/bin/phpize
./configure --with-php-config=/opt/php5/bin/php-config --enable-apc
make 
make install
cp /path/APC-3.1.13/apc.php /var/www
}}}&lt;/p&gt;</summary></entry><entry><title>loadrunner error number list</title><link href="http://liugehao.github.io/loadrunner-error-number-list.html" rel="alternate"></link><updated>2012-09-21T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-21:loadrunner-error-number-list.html</id><summary type="html">&lt;p&gt;http://bbs.51testing.com/thread-8644-1-1.html
{{{
　　sckOutOfMemory 7 内存不足 
　　sckInvalidPropertyValue 380 属性值不效 
　　sckGetNotSupported 394 属性不可读 
　　sckGetNotSupported 383 属性是只读的 
　　sckBadState 40006 所请求的事务或请求本身的错误协议或者错误连接状态 
　　sckInvalidArg 40014 传递给函数的参数格式不确定，或者不在指定范围内 
　　sckSuccess 40017 成功 
　　sckUnsupported 40018 不支持的变量类型 
　　sckInvalidOp 40020 在当前状态下的无效操作 
　　sckOutOfRange 40021 参数越界 
　　sckWrongProtocol 40026 所请求的事务或请求本身的错误协议 
　　sckOpCanceled 10004 取消操作 
　　sckInvalidArgument 10014 所请求的地址是广播地址，但未设置标记 
　　sckWouldBlock 10035 套接字不成块，而指定操作将使之成块 
　　sckInProgress 10036 制造块的Winsock操作在进行之中 
　　sckAlreadyComplete 10037 完成操作。未进行制作块的操作 
　　sckNotSocket 10038 描述符不是套接字 
　　sckMsgTooBig 10040 数据太大，不适于缓冲区的要求，因而被截断 
　　sckPortNotSupported 10043 不支持指定的端口 
　　sckAddressInUse 10048 地址在使用中 
　　sckAddressNotAvailable 10049 来自本地机器的不可用地址 
　　sckNetworkSubsystemFailed 10050 网络子系统失败 
　　sckNetworkUnreachable 10051 当前不能从主机到达网络 
　　sckNetReset 10052 在设置SO_KEEPALIVE时连接超时 
　　sckConnectAborted 10053 由于超时或者其它失败而中止接连 
　　sckConnectionReset 10054 通过远端重新设置连接 
　　sckNoBufferSpace 10055 没有可用的缓存空间 
　　sckAlreadyConnected 10056 已连接的套接字 
　　sckNotConnected 10057 未接连套接字 
　　sckSockedShutdown 10058 已关闭套接字 
　　sckTimedout 10060 套接字超时 
　　sckConnectionRefused 10061 强行拒绝连接 
　　sckNotInitialized 10093 套接字没有初始化 
　　sckHostNotFound 11001 授权应答：未找到主机 
　　sckHostNotFoundTryAgain 11002 非授权应答：未找到主机，重试 
　　sckNonRecoverableError 11003 不可恢复的错误 
　　sckNoData 11004 无效名，对所请求的类型无数据记录&lt;/p&gt;
&lt;p&gt;问题描述   :lr11 BUG？Failed to send data by channels - post message failed.
解决方法 ：http://bbs.51testing.com/thread-527804-1-1.html
HTTP协议的，windows server 2008+lr11+IE7 应该没啥特殊操作，也不是每次跑都出现这个错误，之前也跑过8小时疲劳也正常出结果。
网上搜了一圈，看到个建议把controller中的Diagnotics-configure-Web Page Diagnotics默认的Enable关掉，重新试了几次倒是正常了，现在也不确定是不是真的没问题了。
估计是兼容性的问题吧&lt;/p&gt;
&lt;p&gt;问题描述 :Error -27257: Pending web_reg_save_param/reg_find/create_html_param[_ex] request(s) detected and reset at the end of iteration number 1
http://www.mianwww.com/html/2011/11/11898.html
解决方法： web_reg_save_param位置放错了，应该放到请求页面前面。&lt;/p&gt;
&lt;p&gt;问题描述 : Action.c(19): Error -27796: Failed to connect to server "preprice1.suning.cn:80": [10048] Address already in use
解决方法： Try changing the registry value 
HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\tcpip\Parameters\TcpTimedWaitDelay to 30
and HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\tcpip\Parameters\MaxUserPort to 65534
and rebooting the machine
http://blog.csdn.net/alix_zhou/article/details/4488809
2、HKEY_LOCAL_MACHINE/System/CurrentControlSet/Services/tcpip/Parameters/TcpTimedWaitDelay to 30
and HKEY_LOCAL_MACHINE/System/CurrentControlSet/Services/tcpip/Parameters/MaxUserPort to 65534
将TcpTimedWaitDelay to 30设置为5s或者其它，同时增加了think time，需要重启机器。&lt;/p&gt;
&lt;p&gt;LoadRunner错误及解决方法总结
http://wenku.baidu.com/view/2879ff4e2b160b4e767fcf2f.html?from=rec&amp;amp;pos=0&amp;amp;weight=3&amp;amp;lastweight=1&amp;amp;count=5&lt;/p&gt;
&lt;p&gt;LoadRunner SHUNRA\CloudServices
http://dax9527.blog.163.com/blog/static/3764789520100136832542/
在某次重启以后突然发现公司的机器不能上网了,主要症状是无法获取IP,手动指定IP也不起作用,域用户下也没法联网.域防火墙无法连接.系统设备中有一个网卡带叹号,不能正常工作也没法卸载掉.
      经过半天折腾,结果无意中发现本地连接属性中有一个叫SHUNRA\Cloud WAN Emulator的服务是勾选状态.
嘿,这东西跟那个带叹号的网卡是一个名字啊,后来明白这是因为我安装了LoadRunner8.0工业级压力测试软件的原因,LR自动安装并启用了这个服务,不过却是个阉割的东西,导致不能接入到局域网.去掉勾选,完美解决.
}}}&lt;/p&gt;</summary></entry><entry><title>Nginx的一些优化</title><link href="http://liugehao.github.io/nginxde-xie-you-hua.html" rel="alternate"></link><updated>2012-09-21T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-21:nginxde-xie-you-hua.html</id><summary type="html">&lt;p&gt;=== nginx指令中的优化（配置文件） ===&lt;/p&gt;
&lt;p&gt;{{{
worker_processes 8;
}}}
nginx进程数，建议按照cpu数目来指定，一般为它的倍数。&lt;/p&gt;
&lt;p&gt;{{{
worker_cpu_affinity 00000001 00000010 00000100 00001000 00010000 00100000 01000000 10000000;
}}}
为每个进程分配cpu，上例中将8个进程分配到8个cpu，当然可以写多个，或者将一个进程分配到多个cpu。&lt;/p&gt;
&lt;p&gt;{{{
worker_rlimit_nofile 102400;
}}}
这个指令是指当一个nginx进程打开的最多文件描述符数目，理论值应该是最多打开文件数（ulimit -n）与nginx进程数相除，但是nginx分配请求并不是那么均匀，所以最好与ulimit -n的值保持一致。&lt;/p&gt;
&lt;p&gt;{{{
use epoll;
}}}
使用epoll的I/O模型，这个不用说了吧。&lt;/p&gt;
&lt;p&gt;{{{
worker_connections 102400;
}}}
每个进程允许的最多连接数，理论上每台nginx服务器的最大连接数为worker_processes*worker_connections。&lt;/p&gt;
&lt;p&gt;{{{
keepalive_timeout 60;
}}}
keepalive超时时间。&lt;/p&gt;
&lt;p&gt;{{{
client_header_buffer_size 4k;
}}}
客户端请求头部的缓冲区大小，这个可以根据你的系统分页大小来设置，一般一个请求的头部大小不会超过1k，不过由于一般系统分页都要大于1k，所以这里设置为分页大小。分页大小可以用命令getconf PAGESIZE取得。&lt;/p&gt;
&lt;p&gt;{{{
open_file_cache max=102400 inactive=20s;
}}}
这个将为打开文件指定缓存，默认是没有启用的，max指定缓存数量，建议和打开文件数一致，inactive是指经过多长时间文件没被请求后删除缓存。&lt;/p&gt;
&lt;p&gt;{{{
open_file_cache_valid 30s;
}}}
这个是指多长时间检查一次缓存的有效信息。&lt;/p&gt;
&lt;p&gt;{{{
open_file_cache_min_uses 1;
}}}
open_file_cache指令中的inactive参数时间内文件的最少使用次数，如果超过这个数字，文件描述符一直是在缓存中打开的，如上例，如果有一个文件在inactive时间内一次没被使用，它将被移除。&lt;/p&gt;
&lt;p&gt;=== 内核参数的优化 ===
{{{
net.ipv4.tcp_max_tw_buckets = 6000
}}}
timewait的数量，默认是180000。&lt;/p&gt;
&lt;p&gt;{{{
net.ipv4.ip_local_port_range = 1024    65000
}}}
允许系统打开的端口范围。&lt;/p&gt;
&lt;p&gt;{{{
net.ipv4.tcp_tw_recycle = 1
}}}
启用timewait快速回收。&lt;/p&gt;
&lt;p&gt;{{{
net.ipv4.tcp_tw_reuse = 1
}}}
开启重用。允许将TIME-WAIT sockets重新用于新的TCP连接。&lt;/p&gt;
&lt;p&gt;{{{
net.ipv4.tcp_syncookies = 1
}}}
开启SYN Cookies，当出现SYN等待队列溢出时，启用cookies来处理。&lt;/p&gt;
&lt;p&gt;{{{
net.core.somaxconn = 262144
}}}
web应用中listen函数的backlog默认会给我们内核参数的net.core.somaxconn限制到128，而nginx定义的NGX_LISTEN_BACKLOG默认为511，所以有必要调整这个值。&lt;/p&gt;
&lt;p&gt;{{{
net.core.netdev_max_backlog = 262144
}}}
每个网络接口接收数据包的速率比内核处理这些包的速率快时，允许送到队列的数据包的最大数目。&lt;/p&gt;
&lt;p&gt;{{{
net.ipv4.tcp_max_orphans = 262144
}}}
系统中最多有多少个TCP套接字不被关联到任何一个用户文件句柄上。如果超过这个数字，孤儿连接将即刻被复位并打印出警告信息。这个限制仅仅是为了防止简单的DoS攻击，不能过分依靠它或者人为地减小这个值，更应该增加这个值(如果增加了内存之后)。&lt;/p&gt;
&lt;p&gt;{{{
net.ipv4.tcp_max_syn_backlog = 262144
}}}
记录的那些尚未收到客户端确认信息的连接请求的最大值。对于有128M内存的系统而言，缺省值是1024，小内存的系统则是128。&lt;/p&gt;
&lt;p&gt;{{{
net.ipv4.tcp_timestamps = 0
}}}
时间戳可以避免序列号的卷绕。一个1Gbps的链路肯定会遇到以前用过的序列号。时间戳能够让内核接受这种“异常”的数据包。这里需要将其关掉。&lt;/p&gt;
&lt;p&gt;{{{
net.ipv4.tcp_synack_retries = 1
}}}
为了打开对端的连接，内核需要发送一个SYN并附带一个回应前面一个SYN的ACK。也就是所谓三次握手中的第二次握手。这个设置决定了内核放弃连接之前发送SYN+ACK包的数量。&lt;/p&gt;
&lt;p&gt;{{{
net.ipv4.tcp_syn_retries = 1
}}}
在内核放弃建立连接之前发送SYN包的数量。&lt;/p&gt;
&lt;p&gt;{{{
net.ipv4.tcp_fin_timeout = 1
}}}
如果套接字由本端要求关闭，这个参数决定了它保持在FIN-WAIT-2状态的时间。对端可以出错并永远不关闭连接，甚至意外当机。缺省值是60秒。2.2 内核的通常值是180秒，你可以按这个设置，但要记住的是，即使你的机器是一个轻载的WEB服务器，也有因为大量的死套接字而内存溢出的风险，FIN- WAIT-2的危险性比FIN-WAIT-1要小，因为它最多只能吃掉1.5K内存，但是它们的生存期长些。&lt;/p&gt;
&lt;p&gt;{{{
net.ipv4.tcp_keepalive_time = 30
}}}
当keepalive起用的时候，TCP发送keepalive消息的频度。缺省是2小时。&lt;/p&gt;
&lt;p&gt;=== 一个完整的内核优化配置 ===
{{{
net.ipv4.ip_forward = 0
net.ipv4.conf.default.rp_filter = 1
net.ipv4.conf.default.accept_source_route = 0
kernel.sysrq = 0
kernel.core_uses_pid = 1
net.ipv4.tcp_syncookies = 1
kernel.msgmnb = 65536
kernel.msgmax = 65536
kernel.shmmax = 68719476736
kernel.shmall = 4294967296
net.ipv4.tcp_max_tw_buckets = 6000
net.ipv4.tcp_sack = 1
net.ipv4.tcp_window_scaling = 1
net.ipv4.tcp_rmem = 4096        87380   4194304
net.ipv4.tcp_wmem = 4096        16384   4194304
net.core.wmem_default = 8388608
net.core.rmem_default = 8388608
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.core.netdev_max_backlog = 262144
net.core.somaxconn = 262144
net.ipv4.tcp_max_orphans = 3276800
net.ipv4.tcp_max_syn_backlog = 262144
net.ipv4.tcp_timestamps = 0
net.ipv4.tcp_synack_retries = 1
net.ipv4.tcp_syn_retries = 1
net.ipv4.tcp_tw_recycle = 1
net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_mem = 94500000 915000000 927000000
net.ipv4.tcp_fin_timeout = 1
net.ipv4.tcp_keepalive_time = 30
net.ipv4.ip_local_port_range = 1024    65000
}}}
=== 一个简单的nginx优化配置文件 ===
{{{
user  www www;
worker_processes 8;
worker_cpu_affinity 00000001 00000010 00000100 00001000 00010000 00100000 01000000;
error_log  /www/log/nginx_error.log  crit;
pid        /usr/local/nginx/nginx.pid;
worker_rlimit_nofile 204800;&lt;/p&gt;
&lt;p 204800_="204800;
" _="
" epoll_="epoll;
" use="use" worker_connections="worker_connections"&gt;events&lt;/p&gt;
&lt;p&gt;http
{
  include       mime.types;
  default_type  application/octet-stream;&lt;/p&gt;
&lt;p&gt;charset  utf-8;&lt;/p&gt;
&lt;p&gt;server_names_hash_bucket_size 128;
  client_header_buffer_size 2k;
  large_client_header_buffers 4 4k;
  client_max_body_size 8m;&lt;/p&gt;
&lt;p&gt;sendfile on;
  tcp_nopush     on;&lt;/p&gt;
&lt;p&gt;keepalive_timeout 60;&lt;/p&gt;
&lt;p&gt;fastcgi_cache_path /usr/local/nginx/fastcgi_cache levels=1:2
                keys_zone=TEST:10m
                inactive=5m;
  fastcgi_connect_timeout 300;
  fastcgi_send_timeout 300;
  fastcgi_read_timeout 300;
  fastcgi_buffer_size 16k;
  fastcgi_buffers 16 16k;
  fastcgi_busy_buffers_size 16k;
  fastcgi_temp_file_write_size 16k;
  fastcgi_cache TEST;
  fastcgi_cache_valid 200 302 1h;
  fastcgi_cache_valid 301 1d;
  fastcgi_cache_valid any 1m;
  fastcgi_cache_min_uses 1;
  fastcgi_cache_use_stale error timeout invalid_header http_500;&lt;/p&gt;
&lt;p&gt;open_file_cache max=204800 inactive=20s;
  open_file_cache_min_uses 1;
  open_file_cache_valid 30s;&lt;/p&gt;
&lt;p&gt;tcp_nodelay on;&lt;/p&gt;
&lt;p&gt;gzip on;
  gzip_min_length  1k;
  gzip_buffers     4 16k;
  gzip_http_version 1.0;
  gzip_comp_level 2;
  gzip_types       text/plain application/x-javascript text/css application/xml;
  gzip_vary on;&lt;/p&gt;
&lt;p&gt;server
  {
    listen       8080;
    server_name  ad.test.com;
    index index.php index.htm;
    root  /www/html/;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;stub_status&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="p"&gt;.(&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;php5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;fastcgi_pass&lt;/span&gt; &lt;span class="mf"&gt;127.0.0.1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;9000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;fastcgi_index&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;include&lt;/span&gt; &lt;span class="n"&gt;fcgi&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="p"&gt;.(&lt;/span&gt;&lt;span class="n"&gt;gif&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;jpg&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;jpeg&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;png&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;bmp&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;swf&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;js&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;css&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;expires&lt;/span&gt;      &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;log_format&lt;/span&gt;  &lt;span class="n"&gt;access&lt;/span&gt;  &lt;span class="err"&gt;&amp;#39;$&lt;/span&gt;&lt;span class="n"&gt;remote_addr&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;remote_user&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;time_local&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$request&amp;quot;&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;
          &lt;span class="err"&gt;&amp;#39;$&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;body_bytes_sent&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$http_referer&amp;quot;&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;
          &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;$http_user_agent&amp;quot;&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;http_x_forwarded_for&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;access_log&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;access&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;  &lt;span class="n"&gt;access&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}
}}}
=== 关于FastCGI的几个指令 ===
{{{
fastcgi_cache_path /usr/local/nginx/fastcgi_cache levels=1:2 keys_zone=TEST:10m inactive=5m;
}}}
这个指令为FastCGI缓存指定一个路径，目录结构等级，关键字区域存储时间和非活动删除时间。&lt;/p&gt;
&lt;p&gt;{{{
fastcgi_connect_timeout 300;
}}}
指定连接到后端FastCGI的超时时间。&lt;/p&gt;
&lt;p&gt;{{{
fastcgi_send_timeout 300;
}}}
向FastCGI传送请求的超时时间，这个值是指已经完成两次握手后向FastCGI传送请求的超时时间。&lt;/p&gt;
&lt;p&gt;{{{
fastcgi_read_timeout 300;
}}}
接收FastCGI应答的超时时间，这个值是指已经完成两次握手后接收FastCGI应答的超时时间。&lt;/p&gt;
&lt;p&gt;{{{
fastcgi_buffer_size 16k;
}}}
指定读取FastCGI应答第一部分需要用多大的缓冲区，这里可以设置为fastcgi_buffers指令指定的缓冲区大小，上面的指令指定它将使用1个16k的缓冲区去读取应答的第一部分，即应答头，其实这个应答头一般情况下都很小（不会超过1k），但是你如果在fastcgi_buffers指令中指定了缓冲区的大小，那么它也会分配一个fastcgi_buffers指定的缓冲区大小去缓存。&lt;/p&gt;
&lt;p&gt;{{{
fastcgi_buffers 16 16k;
}}}
指定本地需要用多少和多大的缓冲区来缓冲FastCGI的应答，如上所示，如果一个php脚本所产生的页面大小为256k，则会为其分配16个16k的缓冲区来缓存，如果大于256k，增大于256k的部分会缓存到fastcgi_temp指定的路径中，当然这对服务器负载来说是不明智的方案，因为内存中处理数据速度要快于硬盘，通常这个值的设置应该选择一个你的站点中的php脚本所产生的页面大小的中间值，比如你的站点大部分脚本所产生的页面大小为256k就可以把这个值设置为16 16k，或者4 64k 或者64 4k，但很显然，后两种并不是好的设置方法，因为如果产生的页面只有32k，如果用4 64k它会分配1个64k的缓冲区去缓存，而如果使用64 4k它会分配8个4k的缓冲区去缓存，而如果使用16 16k则它会分配2个16k去缓存页面，这样看起来似乎更加合理。&lt;/p&gt;
&lt;p&gt;{{{
fastcgi_busy_buffers_size 32k;
}}}
这个指令我也不知道是做什么用，只知道默认值是fastcgi_buffers的两倍。&lt;/p&gt;
&lt;p&gt;{{{
fastcgi_temp_file_write_size 32k;
}}}
在写入fastcgi_temp_path时将用多大的数据块，默认值是fastcgi_buffers的两倍。&lt;/p&gt;
&lt;p&gt;{{{
fastcgi_cache TEST
}}}
开启FastCGI缓存并且为其制定一个名称。个人感觉开启缓存非常有用，可以有效降低CPU负载，并且防止502错误。但是这个缓存会引起很多问题，因为它缓存的是动态页面。具体使用还需根据自己的需求。&lt;/p&gt;
&lt;p&gt;{{{
fastcgi_cache_valid 200 302 1h;
fastcgi_cache_valid 301 1d;
fastcgi_cache_valid any 1m;
}}}
为指定的应答代码指定缓存时间，如上例中将200，302应答缓存一小时，301应答缓存1天，其他为1分钟。&lt;/p&gt;
&lt;p&gt;{{{
fastcgi_cache_min_uses 1;
}}}
缓存在fastcgi_cache_path指令inactive参数值时间内的最少使用次数，如上例，如果在5分钟内某文件1次也没有被使用，那么这个文件将被移除。&lt;/p&gt;
&lt;p&gt;{{{
fastcgi_cache_use_stale error timeout invalid_header http_500;
}}}
不知道这个参数的作用，猜想应该是让nginx知道哪些类型的缓存是没用的。 以上为nginx中FastCGI相关参数，另外，FastCGI自身也有一些配置需要进行优化，如果你使用php-fpm来管理FastCGI，可以修改配置文件中的以下值：&lt;/p&gt;
&lt;p&gt;{{{
&lt;value name="max_children"&gt;60&lt;/value&gt;
}}}
同时处理的并发请求数，即它将开启最多60个子线程来处理并发连接。&lt;/p&gt;
&lt;p&gt;{{{
&lt;value name="rlimit_files"&gt;102400&lt;/value&gt;
}}}
最多打开文件数。&lt;/p&gt;
&lt;p&gt;{{{
&lt;value name="max_requests"&gt;204800&lt;/value&gt;
}}}
每个进程在重置之前能够执行的最多请求数。&lt;/p&gt;</summary></entry><entry><title>在这里详述 db/Warning: mysql_connect() [function.mysql-connect]: mysqlnd cannot connect to MySQL 4.1+ using the old insecure authentication.。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-dbwarning-mysql_connect-functionmysql-connect-mysqlnd-cannot-connect-to-mysql-41-using-the-old-insecure-authentication.html" rel="alternate"></link><updated>2012-09-21T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-21:zai-zhe-li-xiang-shu-dbwarning-mysql_connect-functionmysql-connect-mysqlnd-cannot-connect-to-mysql-41-using-the-old-insecure-authentication.html</id><summary type="html">&lt;p&gt;{{{
Warning: mysql_connect() [function.mysql-connect]: mysqlnd cannot connect to MySQL 4.1+ using the old insecure authentication. Please use an administration tool to reset your password with the command SET PASSWORD = PASSWORD('your_existing_password'). This will store a new, and more secure, hash value in mysql.user. If this user is used in other scripts executed by PHP 5.2 or earlier you might need to remove the old-passwords flag from your my.cnf file in path/to/the/file/where/connection/script/is/written/
}}}
更改my.cnf
{{{
old_passwords = 0
}}}&lt;/p&gt;</summary></entry><entry><title>编译安装php-mysql</title><link href="http://liugehao.github.io/bian-yi-an-zhuang-php-mysql.html" rel="alternate"></link><updated>2012-09-18T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-18:bian-yi-an-zhuang-php-mysql.html</id><summary type="html">&lt;p&gt;{{{&lt;/p&gt;
&lt;h1&gt;/usr/local/php/bin/phpize&lt;/h1&gt;
&lt;p&gt;Configuring for:
PHP Api Version:         20090626
Zend Module Api No:      20090626
Zend Extension Api No:   220090626&lt;/p&gt;
&lt;h1&gt;./configure --with-php-config=/usr/local/php/bin/php-config  --with-mysql=/usr --with-zlib-dir=/usr --with-mysql-dir=/lib64&lt;/h1&gt;
&lt;p&gt;checking for PHP installed headers prefix... /usr/local/php/include/php
checking if debug is enabled... no
checking if zts is enabled... no
checking for re2c... no
configure: WARNING: You will need re2c 0.13.4 or later if you want to regenerate PHP parsers.
checking for gawk... gawk
checking for MySQL support... yes, shared
checking for specified location of the MySQL UNIX socket... no
checking for the location of libz... /lib64
checking for mysql_close in -lmysqlclient... no
checking for mysql_error in -lmysqlclient... no
configure: error: mysql configure failed. Please check config.log for more information.
}}}&lt;/p&gt;
&lt;p&gt;通过查找libmysqlclient,发现是在/usr/lib64/mysql/目录内的libmysqlclient.so.15.0.0做的软连接,PHP默认是去的 /usr/lib/搜索,所以没有找到.找到问题了就好解决了.
解决办法就是:
 1. {{{
 cp -rp /usr/lib64/mysql/libmysqlclient.so.15.0.0 /usr/lib/libmysqlclient.so
}}}
 1. {{{
centos   : --with-mysql=/usr/lib64/mysql 或者cp /usr/lib64/mysql/* /usr/lib/mysql/
}}}&lt;/p&gt;</summary></entry><entry><title>redhat5安装oracle 10g</title><link href="http://liugehao.github.io/redhat5an-zhuang-oracle-10g.html" rel="alternate"></link><updated>2012-09-14T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-14:redhat5an-zhuang-oracle-10g.html</id><summary type="html">&lt;ol&gt;
&lt;li&gt;打开安装文件 database/install/oraparam.ini，操作如下：
  {{{&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;修改&lt;/h1&gt;
&lt;p&gt;Linux=redhat-3,SuSE-9,redhat-4,redhat-5,UnitedLinux-1.0,asianux-1,asianux-2]&lt;/p&gt;
&lt;h1&gt;增加：&lt;/h1&gt;
&lt;p&gt;[Linux-redhat-5.0-optional]
TEMP_SPACE=80
SWAP_SPACE=150
MIN_DISPLAY_COLORS=256
}}}&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;增加用户
  {{{
groupadd -g 499 oinstall;
groupadd -g 502 dba;
useradd  -u 499 -p oracle -g oinstall -G dba oracle;}}}&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;更改及应用内核
  {{{
echo "# " &amp;gt;&amp;gt; /etc/sysctl.conf
echo "# Required for Oracle 10g " &amp;gt;&amp;gt; /etc/sysctl.conf
echo "# " &amp;gt;&amp;gt; /etc/sysctl.conf
echo "kernel.shmall = 2097152" &amp;gt;&amp;gt; /etc/sysctl.conf
echo "kernel.shmmax = 2147483648" &amp;gt;&amp;gt; /etc/sysctl.conf
echo "kernel.shmmni = 4096" &amp;gt;&amp;gt; /etc/sysctl.conf 
echo "kernel.sem = 250 32000 100 128" &amp;gt;&amp;gt; /etc/sysctl.conf
echo "fs.file-max = 65536" &amp;gt;&amp;gt; /etc/sysctl.conf
echo "net.ipv4.ip_local_port_range = 1024 65000" &amp;gt;&amp;gt; /etc/sysctl.conf
/sbin/sysctl -p}}} &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;更改环境变量
  {{{
echo "ORACLE_BASE=/oracle/home" &amp;gt;&amp;gt; /home/oracle/.bash_profile
echo "ORACLE_HOME=/oracle/home/OraHome_1" &amp;gt;&amp;gt; /home/oracle/.bash_profile 
echo "export ORACLE_HOME ORACLE_BASE" &amp;gt;&amp;gt; /home/oracle/.bash_profile 
echo "PATH=$PATH:$ORACLE_HOME/bin" &amp;gt;&amp;gt; /home/oracle/.bash_profile 
echo "export PATH"
}}}&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;配置网络
  {{{
echo "128.165.101.107 test-server.my-domain.us test-server" &amp;gt;&amp;gt; /etc/hosts;
/etc/init.d/network restart
}}}&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;安装
  {{{
./runInstaller
}}}&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;参照oracle官网 http://www.oracle.com/technetwork/articles/saternos-kickstart-098543.html&lt;/p&gt;</summary></entry><entry><title>在这里详述 linux/其它。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-linuxqi-ta.html" rel="alternate"></link><updated>2012-09-14T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-14:zai-zhe-li-xiang-shu-linuxqi-ta.html</id><summary type="html">&lt;p&gt;fedora 开机启动服务
{{{#!highlight bash
systemctl enable nginx.service
}}}&lt;/p&gt;</summary></entry><entry><title>bashrc 生效</title><link href="http://liugehao.github.io/bashrc-sheng-xiao.html" rel="alternate"></link><updated>2012-09-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-13:bashrc-sheng-xiao.html</id><summary type="html">&lt;p&gt;在配置bashrc文件后，如果想使其立即生效，可以不用采用登出的方法，而直接键入下列命令即可&lt;/p&gt;
&lt;p&gt;{{{&lt;/p&gt;
&lt;h1&gt;source ./.bashrc&lt;/h1&gt;
&lt;p&gt;}}}&lt;/p&gt;
&lt;p&gt;CategoryLinux  CategoryBash&lt;/p&gt;</summary></entry><entry><title>到付费</title><link href="http://liugehao.github.io/dao-fu-fei.html" rel="alternate"></link><updated>2012-09-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-13:dao-fu-fei.html</id><summary type="html">&lt;ol&gt;
&lt;li&gt;结算省份不为Prov_Id &amp;lt;&amp;gt;900000 或者始发站点不是 Start_Org_Cd=199883&lt;/li&gt;
&lt;li&gt;录单时间-7天&amp;lt;签收时间&lt;/li&gt;
&lt;li&gt;始发地和目的地都存在,且收派网点不同&lt;/li&gt;
&lt;li&gt;费率存在&lt;/li&gt;
&lt;li&gt;扫描记录取计算帐期-3天,至-22天第一次正常签收(scantype = 10, cmt_id = 1),而且未计算过的数据(没有到付费记录)&lt;/li&gt;
&lt;li&gt;录单时间+2天,要小于帐期日期&lt;/li&gt;
&lt;li&gt;留言时间(排除有关999887所有留言) +2天,要小于帐期日期&lt;/li&gt;
&lt;li&gt;金额: 
      录单金额: 
                1.无留言(排除关于999887留言);&lt;br /&gt;
                2.双方确认留言金额(Abnormal_Flag = 1 ,因为双方确认后UPDATE录单金额)
      留言金额: 
                留言时间+2天&amp;lt; 帐期日期 (Reply_Tm + INTERVAL '2' DAY) &amp;lt; 帐期 and Abnormal_Flag = 0 )&lt;/li&gt;
&lt;li&gt;收付费代码: 999887&lt;/li&gt;
&lt;/ol&gt;</summary></entry><entry><title>iptable端口转发</title><link href="http://liugehao.github.io/iptableduan-kou-zhuan-fa.html" rel="alternate"></link><updated>2012-09-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-13:iptableduan-kou-zhuan-fa.html</id><summary type="html">&lt;p&gt;81服务器上vps商品映射,映射vps上22,80端口到公网&lt;/p&gt;
&lt;p&gt;{{{#!highlight bash
iptables -F
iptables -A PREROUTING -t nat -p tcp -i eth0 --dport 11022 -j DNAT --to-destination 10.0.2.39:22
iptables -A PREROUTING -t nat -p tcp -i eth0 --dport 12022 -j DNAT --to-destination 10.0.2.35:22
iptables -A PREROUTING -t nat -p tcp -i eth0 --dport 13022 -j DNAT --to-destination 10.0.2.40:22
iptables -A PREROUTING -t nat -p tcp -i eth0 --dport 14022 -j DNAT --to-destination 10.0.2.41:22
iptables -A PREROUTING -t nat -p tcp -i eth0 --dport 15022 -j DNAT --to-destination 10.0.2.42:22&lt;/p&gt;
&lt;p&gt;iptables -A PREROUTING -t nat -p tcp -i eth0 --dport 11080 -j DNAT --to-destination 10.0.2.39:80
iptables -A PREROUTING -t nat -p tcp -i eth0 --dport 12080 -j DNAT --to-destination 10.0.2.35:80
iptables -A PREROUTING -t nat -p tcp -i eth0 --dport 13080 -j DNAT --to-destination 10.0.2.40:80
iptables -A PREROUTING -t nat -p tcp -i eth0 --dport 14080 -j DNAT --to-destination 10.0.2.41:80
iptables -A PREROUTING -t nat -p tcp -i eth0 --dport 15080 -j DNAT --to-destination 10.0.2.42:80&lt;/p&gt;
&lt;p&gt;iptables -A PREROUTING -t nat -p tcp -i eth0 --dport 11432 -j DNAT --to-destination 10.0.2.39:5432&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>签回单</title><link href="http://liugehao.github.io/qian-hui-dan.html" rel="alternate"></link><updated>2012-09-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-13:qian-hui-dan.html</id><summary type="html">&lt;ol&gt;
&lt;li&gt;取帐期前一天9:30:00 到 帐期日9:29:59 面单开头'66'的回单扫描表的数据(pst_scan_pkg)&lt;/li&gt;
&lt;li&gt;付款 1 元&lt;/li&gt;
&lt;li&gt;付款帐号 999886&lt;/li&gt;
&lt;/ol&gt;</summary></entry><entry><title>区域补贴</title><link href="http://liugehao.github.io/qu-yu-bu-tie.html" rel="alternate"></link><updated>2012-09-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-13:qu-yu-bu-tie.html</id><summary type="html">&lt;ol&gt;
&lt;li&gt;取帐期日期0点至23:59:59的扫描到件数据('06', '13', '24'),与正常签收数据(scan_type = '10',cmt_id=1),且面单为开头不是'2','3','7','9','66'&lt;/li&gt;
&lt;li&gt;始发分部,网点从条码分配取得&lt;/li&gt;
&lt;li&gt;收付费帐号:999886&lt;/li&gt;
&lt;li&gt;到件收费:　按分组费率收取始发站费用(如果先有签收结算数据,不计算)&lt;/li&gt;
&lt;li&gt;签收收费　到件退费:　如果签收计算的费用与到件收费不一致,收签收费,退到件费&lt;/li&gt;
&lt;li&gt;付区域补贴费:　按费率付费给签收站.
*　以上所有费用:
{{{
　&lt;/li&gt;
&lt;li&gt;如无费率,则不收费.&lt;/li&gt;
&lt;li&gt;不重复计算.
}}}&lt;/li&gt;
&lt;/ol&gt;</summary></entry><entry><title>统计文件行数</title><link href="http://liugehao.github.io/tong-ji-wen-jian-xing-shu.html" rel="alternate"></link><updated>2012-09-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-13:tong-ji-wen-jian-xing-shu.html</id><summary type="html">&lt;p&gt;总结了一下有五种方法：&lt;/p&gt;
&lt;p&gt;现在有一个a文件&lt;/p&gt;
&lt;p&gt;第一种：&lt;/p&gt;
&lt;p&gt;{{{#!highlight bash
 awk '{print NR}' a|tail -n1
}}}&lt;/p&gt;
&lt;p&gt;第二种：&lt;/p&gt;
&lt;p&gt;begincwcw兄的这个：
　　{{{#!highlight bash
　　awk 'END{print NR}' a
}}}&lt;/p&gt;
&lt;p&gt;第三种：
　　{{{#!highlight bash 
grep -n "" a|awk -F: '{print '}|tail -n1
}}}&lt;/p&gt;
&lt;p&gt;第四种：&lt;/p&gt;
&lt;p&gt;honbj兄的也不错：
　　{{{#!highlight bash
 sed -n '$=' a
}}}&lt;/p&gt;
&lt;p&gt;第五种
　　{{{#!highlight bash
 wc -l a|awk '{print }'
}}}&lt;/p&gt;
&lt;p&gt;第六种
　　{{{#!highlight bash
cat a |wc -l
}}}&lt;/p&gt;</summary></entry><entry><title>文件编码转换</title><link href="http://liugehao.github.io/wen-jian-bian-ma-zhuan-huan.html" rel="alternate"></link><updated>2012-09-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-13:wen-jian-bian-ma-zhuan-huan.html</id><summary type="html">&lt;p&gt;{{{#!highlight bash
find . -type f -name '*.js' -exec iconv --verbose -f GBK -t UTF-8 {} -o {}.result \; -exec mv {} {}.bak \; -exec mv {}.result {} \;&lt;/p&gt;
&lt;p&gt;find . -type f -name '*.php' -exec iconv --verbose -f GBK -t UTF-8 {} -o {}.result \; -exec mv {} {}.bak \; -exec mv {}.result {} \;&lt;/p&gt;
&lt;p&gt;find . -type f -name '*.html' -exec iconv --verbose -f GBK -t UTF-8 {} -o {}.result \; -exec mv {} {}.bak \; -exec mv {}.result {} \;&lt;/p&gt;
&lt;p&gt;find . -type f -name '*.css' -exec iconv --verbose -f GBK -t UTF-8 {} -o {}.result \; -exec mv {} {}.bak \; -exec mv {}.result {} \;&lt;/p&gt;
&lt;p&gt;find ./ -type f -name "*.php" |xargs  sed -i  's/charset=gb2312/charset=utf-8/ig'
charset=gb2312"&lt;/p&gt;
&lt;p&gt;find ./ -name "*.bak"|xargs rm&lt;/p&gt;
&lt;p&gt;find ./ -type f -name "*.php" |xargs  sed -i  's/myxajaxResponse("gb2312/myxajaxResponse("utf-8/ig'&lt;/p&gt;
&lt;p&gt;find ./ -type f -name "&lt;em&gt;.php" |xargs sed -i  "s/iconv('gbk', 'utf-8' ,(.&lt;/em&gt;\?))/\1/ig"
find ./ -type f -name "&lt;em&gt;.php" |xargs sed -i  "s/iconv('gb2312','utf-8',(.&lt;/em&gt;\?))/\1/ig"
find ./ -type f -name "&lt;em&gt;.php" |xargs sed -i  "s/iconv('utf-8','gbk',(.&lt;/em&gt;\?))/\1/ig"
find ./ -type f -name "&lt;em&gt;.php" |xargs sed -i  "s/iconv('utf-8','gb2312',(.&lt;/em&gt;\?))/\1/ig"&lt;/p&gt;
&lt;p&gt;find ./ -type f -name "&lt;em&gt;.php" |xargs sed -i  's/iconv("gbk", "utf-8", (.&lt;/em&gt;\?))/\1/ig'&lt;/p&gt;
&lt;p&gt;grep -e 'utf-8' -r .&lt;/p&gt;
&lt;p&gt;sed -i '1d' urfile 删除第一行
sed -i '$d' urfile 最后一行&lt;/p&gt;
&lt;p&gt;}}}&lt;/p&gt;</summary></entry><entry><title>在这里详述 文档。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-wen-dang.html" rel="alternate"></link><updated>2012-09-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-13:zai-zhe-li-xiang-shu-wen-dang.html</id><summary type="html">&lt;p&gt;&amp;lt;&lt;PageList(regex:^文档/.*)&gt;&amp;gt;&lt;/p&gt;</summary></entry><entry><title>整车称重</title><link href="http://liugehao.github.io/zheng-che-cheng-zhong.html" rel="alternate"></link><updated>2012-09-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-13:zheng-che-cheng-zhong.html</id><summary type="html">&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;取帐期前一天9:30:00 到 帐期日9:29:59 称重记录数据&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;皮重：
  i. 取历史最轻皮重；
  i. 当日回皮表中存在的,取当日回皮数据。如果当日无回皮记录，取历史最轻皮重。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;1.　费率计算:　(皮重-毛重) * 费率 / 费率单位重量&lt;/p&gt;</summary></entry><entry><title>装卸车扫描系统</title><link href="http://liugehao.github.io/zhuang-xie-che-sao-miao-xi-tong.html" rel="alternate"></link><updated>2012-09-13T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-13:zhuang-xie-che-sao-miao-xi-tong.html</id><summary type="html">&lt;p&gt;=== 计算方法: ===&lt;/p&gt;
&lt;p&gt;I. 所需资料:gps记录, 刷卡记录,封签操作记录,装卸车扫描记录，车辆编码&lt;/p&gt;
&lt;p&gt;I. 方法：
  1. 始发站发车,扫描员选定发车日期,扫描车辆码,车线码,做发车动作(可省略)，服务器端生成一条车辆运行记录,状态为runing
  1. &amp;lt;&lt;BR&gt;&amp;gt;
   . (1).　封签记录,刷卡记录,ＧＰＳ记录在车辆运行记录中寻找当前运行车辆,找到后做标记（寻找方法，按运行记录车线所经途经站，时间条件），如为该运行记录的终到站，则标记该运行记录已完成。&amp;lt;&lt;BR&gt;&amp;gt; (2). 如未找到做待查标记，&amp;lt;&lt;BR&gt;&amp;gt; (3). 待一定时间后有可能始发站记录上传成功，回(1).&amp;lt;&lt;BR&gt;&amp;gt;
    . 再次查询不到时利用站点扫描记录查找车线码，再反查ＧＰＳ，刷卡确定始发站发车日期，生成车辆运行记录。&amp;lt;&lt;BR&gt;&amp;gt;
  如车线码也找不到，报警人工干预（邮件，短信，系统通知等）生成车线或标记为错误数据，一定时间内人工未进行干预，报警上级领导，一定时间内人工未进行干预，再报警上级领导.....此方法为确保错误数量尽量不累积。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;装卸车对比数据，用运行记录的上一条记录和下一条记录卡它的装卸车件量&lt;/li&gt;
&lt;li&gt;件量以及操作都正常的运行记录，班车费自动结算（不需人工审核），其它的人工审核&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;{{ attachment:装卸车对比及班车费.png }}&lt;/p&gt;</summary></entry><entry><title>##master-page:HomepageTemplate</title><link href="http://liugehao.github.io/master-pagehomepagetemplate.html" rel="alternate"></link><updated>2012-09-06T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-06:master-pagehomepagetemplate.html</id><summary type="html">&lt;h2&gt;master-date:Unknown-Date&lt;/h2&gt;
&lt;h2&gt;Please edit system and help pages ONLY in the master wiki!&lt;/h2&gt;
&lt;h2&gt;For more information, please see MoinMoin:MoinDev/Translation.&lt;/h2&gt;
&lt;h1&gt;format wiki&lt;/h1&gt;
&lt;h1&gt;language en&lt;/h1&gt;
&lt;p&gt;= liugehao =&lt;/p&gt;
&lt;p&gt;Email: &amp;lt;&lt;MailTo(you AT SPAMFREE example DOT com)&gt;&amp;gt;&lt;/p&gt;
&lt;h2&gt;You can even more obfuscate your email address by adding more uppercase letters followed by a leading and trailing blank.&lt;/h2&gt;
&lt;p&gt;== 工作列表 ==&lt;/p&gt;
&lt;p&gt;&amp;lt;&lt;PageList(regex:^liugehao-工作.*)&gt;&amp;gt;&lt;/p&gt;
&lt;p&gt;== 链接 ==
[[文章]]&lt;/p&gt;
&lt;p&gt;...&lt;/p&gt;
&lt;p&gt;CategoryHomepage&lt;/p&gt;</summary></entry><entry><title>项目经理，别让猴子跳回背上！</title><link href="http://liugehao.github.io/xiang-mu-jing-li-bie-rang-hou-zi-tiao-hui-bei-shang.html" rel="alternate"></link><updated>2012-09-06T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-06:xiang-mu-jing-li-bie-rang-hou-zi-tiao-hui-bei-shang.html</id><summary type="html">&lt;p&gt;好久没有荐书了，今天推荐一本职场好书：《别让猴子跳回背上》。&lt;/p&gt;
&lt;p&gt;职场上跳来跳去的“猴子”？怎么回事？初一看，很疑惑。莫非经理们喜欢在办公室养宠物猴？嗯，有种宠物猴很可爱的。前一阵还看过照片，萌的很。&lt;/p&gt;
&lt;p&gt;带着问题一看，感情自己幼稚了。这本书居然是一本企业管理经典，作者美国人威廉·安肯三世，全球知名的企业管理大师。在美国，“猴子在背上”已经成为经典企业管理譬喻，即所谓“业界共识”。看来自己落伍太久了。那么这只“猴子”到底是什么呢？下面举个例子：&lt;/p&gt;
&lt;p&gt;经理张三交给员工李四去做一项任务。&lt;/p&gt;
&lt;p&gt;执行中，李四发现问题“A”，于是向张三报告，请示怎么办。张三略微思考了一下，告诉李四，你“X”办。李四按照“X”方式执行，又发现了问题“B”，马上向张三汇报请示，“我按照‘X’执行，出现了‘B’问题，下面怎么办呢？”。因为“X”的方式是张三的主意，他只好继续拿主意：你“Y”办。不久，李四又带来了问题“C”，于是张三再提示“Z”。
后来，张三和李四就永远幸福滴工作在一起了。。。&lt;/p&gt;
&lt;p&gt;这究竟是怎么回事儿？为什么李四的任务，反倒成了张三和李四的共同任务？进一步说，若是最后任务失败，责任归谁呢？只怕是张三，而不是李四。因为李四每一步都是按照张三的指示执行。Oh my God，我们可怜的张三经理。&lt;/p&gt;
&lt;p&gt;在上面这个例子中，我们是否发现一只猴子在蹦来蹦去？对，是“任务”。“任务”这只猴子一会儿在张三肩膀上，一会儿跳到李四身上，跳过来跳过去。当然，大师不会就此简单了结，威廉·安肯三世指出：事实上，不是风动，不是幡动，也不是心动，是责任在动。大师进一步指出：要锁定“责任”这只猴子，将其永远锁定在李四身上。为什么？其实，工作分派就是一种授权。接受了上级的授权，也就意味着要承担责任。管理者绝不应容忍“反向授权”行为，即部下将责任再推还给管理者，譬如例中的李四。&lt;/p&gt;
&lt;p&gt;大师的话是高屋建瓴的，是放诸四海而皆准的。我觉得这不仅是给企业领导层和中层经理们的箴言，对于项目经理们也有相当的启示。在中国职场，项目经理往往是项目的核心动力，离了项目经理就完全不转的项目比比皆是。而项目经理们也充分地认识到这一点，并常常过高估计自己的能力，从而过多地承担项目中的各种责任。其结果：项目组成员的猴子们，纷纷跑到项目经理肩膀上。忽然想起自己身上曾经爬满猴子，差点儿呕吐。&lt;/p&gt;
&lt;p&gt;大师并未止步于指出问题，“大师”两字体现在他的思想深度。安肯三世说：企业高管们，要转变自己的思想。要从依赖企业家的个人能力转变成依赖以员工为核心的组织能力。企业家要真正地把企业的成长建立在员工成长的基础上。员工能否获得成长，能否变得独立，以及能否承担责任，就是让员工照顾好自己的猴子的意义所在！&lt;/p&gt;
&lt;p&gt;大师的话，给我很大触动。也许，项目经理也要转变自己的思想。将组员的“猴子”牢牢地锁定在他自己身上。这绝不是项目经理偷懒或不负责任。相反，这样做可以最大程度上让组员们获得独立能力，不断提升他们解决问题的能力。我想，这样做的项目经理，才是真正对组员成长负责的项目经理，才是真正对项目成功负责的项目经理。&lt;/p&gt;
&lt;p&gt;那么，怎样做才能将“猴子”锁定在组员身上呢？留待下回分解。&lt;/p&gt;
&lt;p&gt;本文出自 “孙继滨的博客” 博客，请务必保留此出处 http://sunjibin.blog.51cto.com/918334/980259&lt;/p&gt;</summary></entry><entry><title>在这里详述 文章列表。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-wen-zhang-lie-biao.html" rel="alternate"></link><updated>2012-09-06T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-06:zai-zhe-li-xiang-shu-wen-zhang-lie-biao.html</id><summary type="html">&lt;p&gt;文章收藏夹&lt;/p&gt;
&lt;p&gt;&amp;lt;&lt;PageList(regex:^文章/.*)&gt;&amp;gt;&lt;/p&gt;</summary></entry><entry><title>在这里详述 liugehao工作。</title><link href="http://liugehao.github.io/zai-zhe-li-xiang-shu-liugehaogong-zuo.html" rel="alternate"></link><updated>2012-09-05T00:00:00+02:00</updated><author><name>liugehao</name></author><id>tag:liugehao.github.io,2012-09-05:zai-zhe-li-xiang-shu-liugehaogong-zuo.html</id><summary type="html">&lt;p&gt;[[liugehao]] -&amp;gt; [[liugehao工作]]&lt;/p&gt;
&lt;p&gt;&amp;lt;&lt;PageList(regex:^liugehao-工作.*)&gt;&amp;gt;&lt;/p&gt;</summary></entry></feed>